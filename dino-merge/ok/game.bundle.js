(function(){var e={493:function(){HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(e,t,n){for(var i=atob(this.toDataURL(t,n).split(",")[1]),a=i.length,s=a>>2,r=new Uint8Array(a),o=new Uint32Array(r.buffer,0,s),c=0,l=0;c<s;c++)o[c]=i.charCodeAt(l++)|i.charCodeAt(l++)<<8|i.charCodeAt(l++)<<16|i.charCodeAt(l++)<<24;for(var u=3&a;u--;)r[l]=i.charCodeAt(l++);e(new Blob([r],{type:t||"image/png"}))}})},626:function(e,t,n){"use strict";n.d(t,{J:function(){return E}});var i=n(20),a=n(70),s=n.n(a),r=n(87),o=n.n(r),c=n(18),l=n.n(c),u=n(38),h=n(224),d=n(225),p=GameCore.Configs.Notification,f=p.GameTitle,g=p.GameImage,E=function(){function e(){}var t=e.prototype;return t.createAsync=function(){var e=(0,i.Z)(l().mark((function e(t){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,GameSDK.tournament.createAsync(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.shareAsync=function(){var e=(0,i.Z)(l().mark((function e(t){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,GameSDK.tournament.shareAsync(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.joinAsync=function(){var e=(0,i.Z)(l().mark((function e(t){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,GameSDK.tournament.joinAsync(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.postScoreAsync=function(){var e=(0,i.Z)(l().mark((function e(t){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,GameSDK.tournament.postScoreAsync(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.getTournamentsAsync=function(){var e=(0,i.Z)(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,GameSDK.tournament.getTournamentsAsync();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),e}(),m=function(){function e(e){var t=this;this.facebook=void 0,this.isCalledSubscribeBot=!1,this.isCalledCreateShortcut=!1,this.requestTournamentAsync=function(){var e=(0,i.Z)(l().mark((function e(n){var i;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.facebook.getTournamentAsync();case 3:return e.next=5,t.facebook.tournament.shareAsync({score:n});case 5:e.next=12;break;case 7:return e.prev=7,e.t0=e.catch(0),i=GameSDK.player.getName(),e.next=12,t.facebook.tournament.createAsync({initialScore:n,config:{tournamentTitle:i+"'s Tournament"}});case 12:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),this.facebook=e}var t=e.prototype;return t.switchAsync=function(){var e=(0,i.Z)(l().mark((function e(t){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,GameCore.Utils.Valid.isValueChangeAsync(window.__fbGameReady,!0);case 2:return e.next=4,GameSDK.context.switchAsync(t);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.chooseAsync=function(){var e=(0,i.Z)(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,GameCore.Utils.Valid.isValueChangeAsync(window.__fbGameReady,!0);case 3:return e.next=5,GameSDK.context.chooseAsync({filters:["INCLUDE_EXISTING_CHALLENGES"],minSize:2,maxSize:2});case 5:case 15:return e.abrupt("return",GameSDK.context.getID());case 8:if(e.prev=8,e.t0=e.catch(0),!(e.t0 instanceof Object&&GameCore.Utils.Object.hasOwn(e.t0,"code"))){e.next=16;break}e.t1=e.t0.code,e.next="USER_INPUT"===e.t1?14:"SAME_CONTEXT"===e.t1?15:16;break;case 14:return e.abrupt("return",!1);case 16:return e.abrupt("return",null);case 17:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),t.createAsync=function(){var e=(0,i.Z)(l().mark((function e(t){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,GameCore.Utils.Valid.isValueChangeAsync(window.__fbGameReady,!0);case 3:return e.next=5,GameSDK.context.createAsync(""+t);case 5:case 15:return e.abrupt("return",GameSDK.context.getID());case 8:if(e.prev=8,e.t0=e.catch(0),!(e.t0 instanceof Object&&GameCore.Utils.Object.hasOwn(e.t0,"code"))){e.next=16;break}e.t1=e.t0.code,e.next="USER_INPUT"===e.t1?14:"SAME_CONTEXT"===e.t1?15:16;break;case 14:return e.abrupt("return",!1);case 16:return e.abrupt("return",null);case 17:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),t.getPlayerToken=function(){var e=(0,i.Z)(l().mark((function e(){var t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,GameSDK.player.getSignedPlayerInfoAsync();case 2:return t=e.sent,e.abrupt("return",t.getSignature());case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),t.getContextPlayers=function(){var e=(0,i.Z)(l().mark((function e(t){var n,i;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,GameSDK.context.getPlayersAsync();case 3:return n=e.sent,i=[],n.forEach((function(e){var n=e.getID();if(n!==t){var a=e.getName();if(a){var s=e.getPhoto();i.push(new h.Z(n,a,s).toObject())}}})),e.abrupt("return",GameCore.Utils.Array.unique(i));case 9:return e.prev=9,e.t0=e.catch(0),console.warn("getPlayersAsync",{error:e.t0}),e.abrupt("return",[]);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),t.shareAsync=function(){var e=(0,i.Z)(l().mark((function e(t){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,GameSDK.shareAsync(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.sendMessage=function(){var e=(0,i.Z)(l().mark((function e(t){var n,i,a,s,r,o;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.data,i=t.image,a=t.template,s=t.cta,r=t.text,o={data:n,image:i,action:"CUSTOM",template:a,cta:s,text:r,strategy:"IMMEDIATE",notification:"PUSH"},e.next=4,GameSDK.updateAsync(o);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.inviteAsync=function(){var e=(0,i.Z)(l().mark((function e(t){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,GameSDK.inviteAsync(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.postSessionScoreAsync=function(){var e=(0,i.Z)(l().mark((function e(t){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,GameSDK.postSessionScoreAsync(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.getRewardedVideoAsync=function(){var e=(0,i.Z)(l().mark((function e(t){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,GameSDK.getRewardedVideoAsync(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.getInterstitialAdAsync=function(){var e=(0,i.Z)(l().mark((function e(t){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,GameSDK.getInterstitialAdAsync(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.getContextID=function(){return GameSDK.context.getID()},t.attemptToAddShortcut=function(){var e=(0,i.Z)(l().mark((function e(){var t,n,i,a,s;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isCalledCreateShortcut){e.next=2;break}return e.abrupt("return",!1);case 2:if(e.prev=2,"ANDROID"!==GameSDK.getPlatform()){e.next=6;break}return e.abrupt("return",!1);case 6:return e.next=8,GameSDK.player.getDataAsync(["lastCallCreateShortcut"]);case 8:if(e.t0=e.sent,e.t0){e.next=11;break}e.t0={};case 11:if(t=e.t0,!(n=t.lastCallCreateShortcut)||!(0,d.Gm)(+n)){e.next=15;break}return e.abrupt("return",!1);case 15:if(i=Date.now(),GameSDK.player.setDataAsync({lastCallCreateShortcut:i}),this.isSupportAPI("canCreateShortcutAsync")){e.next=20;break}return e.abrupt("return",!1);case 20:return e.next=22,GameSDK.canCreateShortcutAsync();case 22:if(!e.sent){e.next=40;break}return a=u._.SHORTCUT_CREATE,s=u._.SHORTCUT_CREATE_POPUP,this.isCalledCreateShortcut=!0,window.game.analytics.event(s),e.prev=27,e.next=30,GameCore.Utils.Valid.isValueChangeAsync(window.__fbGameReady,!0);case 30:return e.next=32,GameSDK.createShortcutAsync();case 32:return window.game.analytics.event(a,{success:!0}),e.abrupt("return",!0);case 36:return e.prev=36,e.t1=e.catch(27),window.game.analytics.event(a,{success:!1}),e.abrupt("return",!1);case 40:return e.abrupt("return",!1);case 43:return e.prev=43,e.t2=e.catch(2),e.abrupt("return",!1);case 46:case"end":return e.stop()}}),e,this,[[2,43],[27,36]])})));return function(){return e.apply(this,arguments)}}(),t.attemptToSubscribeBot=function(){var e=(0,i.Z)(l().mark((function e(){var t,n,i,a,s;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isCalledSubscribeBot){e.next=2;break}return e.abrupt("return",!1);case 2:if(e.prev=2,this.isSupportAPI("player.canSubscribeBotAsync")){e.next=6;break}return e.abrupt("return",!1);case 6:return e.next=8,GameSDK.player.canSubscribeBotAsync();case 8:if(!e.sent){e.next=37;break}return e.next=12,GameSDK.player.getDataAsync(["lastCallSubscribeBot"]);case 12:if(e.t0=e.sent,e.t0){e.next=15;break}e.t0={};case 15:if(t=e.t0,!(n=t.lastCallSubscribeBot)||!(0,d.Gm)(+n)){e.next=19;break}return e.abrupt("return",!1);case 19:return i=Date.now(),GameSDK.player.setDataAsync({lastCallSubscribeBot:i}),a=u._.BOT_SUBSCRIBE,s=u._.BOT_SUBSCRIBE_POPUP,this.isCalledSubscribeBot=!0,window.game.analytics.event(s),e.prev=24,e.next=27,GameCore.Utils.Valid.isValueChangeAsync(window.__fbGameReady,!0);case 27:return e.next=29,GameSDK.player.subscribeBotAsync();case 29:return window.game.analytics.event(a,{success:!0}),e.abrupt("return",!0);case 33:return e.prev=33,e.t1=e.catch(24),window.game.analytics.event(a,{success:!1}),e.abrupt("return",!1);case 37:return e.abrupt("return",!1);case 40:return e.prev=40,e.t2=e.catch(2),e.abrupt("return",!1);case 43:case"end":return e.stop()}}),e,this,[[2,40],[24,33]])})));return function(){return e.apply(this,arguments)}}(),t.matchPlayerAsync=function(){var e=(0,i.Z)(l().mark((function e(t,n,i){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,this.isSupportAPI("checkCanPlayerMatchAsync")){e.next=4;break}return e.abrupt("return",!1);case 4:return e.next=6,GameSDK.checkCanPlayerMatchAsync();case 6:if(e.sent){e.next=9;break}return e.abrupt("return",!1);case 9:return e.next=11,GameSDK.matchPlayerAsync(t,n,i);case 11:return e.abrupt("return",!0);case 14:return e.prev=14,e.t0=e.catch(0),e.abrupt("return",!1);case 17:case"end":return e.stop()}}),e,this,[[0,14]])})));return function(t,n,i){return e.apply(this,arguments)}}(),t.setLoadingProgress=function(e){GameSDK.setLoadingProgress(e)},t.getLocale=function(){return GameSDK.getLocale()||"en"},t.injectTournament=function(){var e=(0,i.Z)(l().mark((function e(){var t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!GameCore.Configs.Tournament.UseMock){e.next=8;break}return e.next=4,n.e(543).then(n.bind(n,675));case 4:t=e.sent.default,this.facebook.tournament=new t,e.next=9;break;case 8:this.facebook.tournament=new E;case 9:this.facebook.getTournamentAsync=this.getTournamentAsync,this.facebook.requestTournamentAsync=this.requestTournamentAsync;case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.getTournamentAsync=function(){var e=(0,i.Z)(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,GameSDK.getTournamentAsync();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),t.sendNotificationAsync=function(){var e=(0,i.Z)(l().mark((function e(t){var n,i;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("\ud83e\udd16 ? sendNotificationAsync",t),n=t.message,i=t.delayTime,e.next=5,FBInstant.graphApi.requestAsync("/me/notifications","POST",{message:s()({title:f,body:n,media_url:g}),schedule_interval:i});case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("\ud83e\udd16 ? sendNotificationAsync",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),t.isSupportAPI=function(e){var t;return o()(t=GameSDK.getSupportedAPIs()).call(t,e)},e}();t.Z=m},494:function(e,t,n){"use strict";var i=n(69),a=n.n(i),s=n(46),r=n.n(s),o=function(e,t){return void 0===t&&(t=1),a()({length:Math.ceil(e.length/t)},(function(n,i){return r()(e).call(e,i*t,i*t+t)}))},c=n(59),l=n.n(c),u=n(87),h=n.n(u),d=function(e,t){return l()(e).call(e,(function(e){return!h()(t).call(t,e)}))},p=function(e){for(var t=e.length-1;t>0;t--){var n=Math.floor(Math.random()*(t+1)),i=[e[n],e[t]];e[t]=i[0],e[n]=i[1]}},f=n(47),g=n.n(f),E=function(e,t,n){return g()(n).call(n,e)===t&&null!==e&&void 0!==e},m=function(e){return l()(e).call(e,E)},v={chunk:o,difference:d,shuffle:p,unique:m},A=n(91),S=n.n(A),T=n(297),y=n.n(T),C=y()((function(e,t){if("string"===typeof e){var n=t[e.toLowerCase()];if("string"===typeof n)return n}return"?"})),I=y()((function(e){for(var t=null,n=[],i=/:([A-Z0-9?]+)/gm;null!==(t=i.exec(e));)n.push(t[1]);return n})),R=y()((function(e){for(var t=null,n=[],i=/([0-9]+[A-Z?]{1}|[A-Z?]{1})/gm;null!==(t=i.exec(e));){var a=t[0];if(a.length>=2){var s,o=a.length,c=r()(a).call(a,0,o-1),l=a[o-1],u=S()(s=new Array(+c)).call(s,l);n.push.apply(n,u)}else n.push(a)}return n})),w=function(e,t){var n=e,i=GameCore.Utils.Object.invert(t),a={},s=0,r=0;return I(n).forEach((function(e){s=0,r++,a[r]||(a[r]={}),R(e).forEach((function(e){s++,a[r][s]=C(e,i)}))})),a},_=y()((function(e,t){var n=t[e];return"string"===typeof n?""+n.toUpperCase():"?"})),b=function e(t,n,i){void 0===i&&(i=!1);var a="";if(!GameCore.Utils.Valid.isObject(t))return a;var s="",o=1;for(var c in t)if(GameCore.Utils.Object.hasOwn(t,c)){var l=t[c];if(GameCore.Utils.Valid.isObject(l))a+=":"+e(l,n,!0);else if(GameCore.Utils.Valid.isString(l)){var u=_(l,n);u===s?(o++,a=r()(a).call(a,0,-2)):o=1,a+=""+o+u,s=u}}return a=a.replace(/1([A-Z])/g,"$1")},L=function(e){try{return atob(e)}catch(t){return""}},P={decodeMap:w,encodeMap:b,hashToString:L,stringToHash:function(e){try{return btoa(e)}catch(t){return""}}},O=function(e){try{return JSON.parse(e)}catch(t){return null}},D=n(70),k=n.n(D),N=function(e){try{return k()(e,null,0)}catch(t){return""}},B=function(e){return O(N(e))},M={clone:B,decode:O,encode:N},x=function(e){var t="object"===typeof e||"function"===typeof e,n=Array.isArray(e);return null!==e&&t&&!n},U=function(e){return void 0===e||null===e},F=function e(t){if(!x(t))return t;for(var n in t){U(t[n])&&delete t[n];var i=t[n];x(i)&&(t[n]=e(i))}return t},Z=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},G=n(88),H=n.n(G),Y=function(e){var t={};return H()(e).forEach((function(n){if(Z(e,n)){var i=e[n];"string"===typeof i&&(t[i]=n)}})),t},K=function(e,t){if(!Array.isArray(e))return{};var n={};return e.forEach((function(e){if(Z(e,t)){var i=e[t];"string"===typeof i&&(n[i]=e)}})),n},V={clear:F,hasOwn:Z,invert:Y,keyBy:K},W=function(e){return e?e[0].toUpperCase()+r()(e).call(e,1):e},j=function(e){var t=0;if(0==e.length)return t;for(var n=0;n<e.length;n++){t=(t<<5)-t+e.charCodeAt(n),t&=t}return t},z=n(101),X=n.n(z),q=function(e){var t;return X()(t=H()(e)).call(t,(function(t,n){var i=e[n];return void 0!==i&&t.push(n+"="+i),t}),[]).join("&")},Q=function(e){void 0===e&&(e="0x");for(var t=e,n=0;n<6;n++)t+="0123456789ABCDEF"[Math.floor(16*Math.random())];return t},J=function(e,t){var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789*#%&!",i="",a=e;void 0!=t&&(a-=t.length,i+=t);for(var s=0;s<a;s++){var r=Math.floor(67*Math.random());i+=n.charAt(r)}return i},$=function(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[\u0111\u0110]/g,(function(e){return"\u0111"===e?"d":"D"}))},ee=n(41),te=n.n(ee),ne=n(300),ie=n.n(ne),ae=function(e,t){var n,i=e.split(" "),a=(i.length<=1?te()(n=[]).call(n,i):[i[0],i.pop()]).join(" "),s=ie()(a).call(a," ")||0,r=s>=0?s:t;return(a.length>t?a.substring(0,r):a).substring(0,t)},se=n(305),re=n.n(se),oe={capitalize:W,hashCode:j,params:q,toCamelCase:function(e){return e.replace(/^([a-z])|\s+([a-z])/g,(function(e,t){return t?t.toUpperCase():e.toLowerCase()})).replace(/\s+/g,"")},toUpperCamelCase:function(e){return e.replace(/^([a-z])|\s+([a-z])/g,(function(e,t){return t?t.toUpperCase():e.toUpperCase()})).replace(/\s+/g,"")},randomColor:Q,random:J,removeDiacritics:$,getShortName:ae,generateObjectId:function(e){void 0===e&&(e=16);var t=function(t){return Math.floor(t).toString(e)};return t(Date.now()/1e3)+re()(" ").call(" ",e).replace(/./g,(function(){return t(Math.random()*e)}))}},ce=function(e){return"boolean"===typeof e},le=function(){return true},ue=function(e){return"function"===typeof e},he=function(e){return"number"===typeof e&&!isNaN(e)},de=function(e){var t;return g()(t=["string","number","symbol"]).call(t,typeof e)>-1},pe=function(e){return"string"===typeof e},fe=n(53),ge=n.n(fe),Ee=function(e,t,n){var i=n||{},a=i.timeout,s=void 0===a?1e3:a,r=i.checkInterval,o=void 0===r?100:r;return new(ge())((function(n){var i=setInterval((function(){("function"===typeof e?e():e)===("function"===typeof t?t():t)&&(clearInterval(i),n(!0))}),o);s>0&&setTimeout((function(){clearInterval(i),n(!1)}),s)}))},me=function(e){var t=e.scene,n=e.key,i=e.newKey,a=e.radius,s=e.width,r=e.height,o=t.textures.get(n).getSourceImage();if(!o)return!1;s||(s=o.width),r||(r=o.height),i||t.textures.removeKey(n);var c=t.textures.createCanvas(i||n,s,r),l=c.context,u=Math.min(s,r)/100*a/2;return l.beginPath(),l.moveTo(0+u,0),l.lineTo(0+s-u,0),l.quadraticCurveTo(0+s,0,0+s,0+u),l.lineTo(0+s,0+r-u),l.quadraticCurveTo(0+s,0+r,0+s-u,0+r),l.lineTo(0+u,0+r),l.quadraticCurveTo(0,0+r,0,0+r-u),l.lineTo(0,0+u),l.quadraticCurveTo(0,0,0+u,0),l.closePath(),l.clip(),c.draw(0,0,o),!0},ve=["","K","M","B","T","AA","AB","AC","AD","AE","AF","AG","AH","AI","AJ","AK","AL","AM","AN","AO","AP","AQ","AR","AS","AT","AU","AV","AW","AX","AY","AZ","BA","BB","BC","BD","BE","BF","BG","BH","BI","BJ","BK","BL","BM","BN","BO","BP","BQ","BR"],Ae=function(e){if(g()(e).call(e,".")<0)return e;for(var t=e.length-1;t>=0;t--){if("."==e[t])return e.substring(0,t);if("0"!=e[t])return e.substring(0,t+1)}return e},Se=function(e,t){var n=t||{},i=n.fractionalDigits,a=void 0===i?0:i,s=n.startAbbreviate,r=void 0===s?1e3:s,o=n.abbreviateStep,c=void 0===o?3:o,l=n.maxLength,u=void 0===l?-1:l,h=n.removeLastZero,d=void 0===h||h,p=n.suffixes,f=void 0===p?ve:p,g=-1===u?99999999:u;if(e>=r){var E=Math.floor(e/Math.pow(10,c)),m=Math.floor((E.toString().length-1)/c)+1,v=(e/Math.pow(Math.pow(10,c),m)).toFixed(a),A=g-f[m].length,S=v.substring(0,A);return(d?Ae(S):S)+f[m]}var T=e.toFixed(a),y=g-f[0].length,C=T.substring(0,y);return d?Ae(C):C+f[0]},Te={Array:v,Hash:P,Json:M,Object:V,String:oe,Valid:{isBoolean:ce,isDebugger:le,isFunction:ue,isNumber:he,isObject:x,isPropertyKey:de,isString:pe,isValueChangeAsync:Ee},Image:{drawCircle:function(e){var t=e.scene,n=e.key,i=e.newKey,a=t.textures.get(n).getSourceImage();if(!a)return!1;var s=Math.min(a.width,a.height);i||t.textures.removeKey(n);var r=t.textures.createCanvas(i||n,s,s),o=r.context;return o.beginPath(),o.arc(s/2,s/2,s/2,0,2*Math.PI,!1),o.clip(),r.draw((a.width-s)/2,(a.height-s)/2,a),!0},drawBorder:me},Number:{toAbbreviatedString:Se,padStart:function(e,t,n){void 0===n&&(n="0");for(var i=e.toString(),a=i.length,s=0;s<t-a;s++)i=n+i;return i},padEnd:function(e,t,n){void 0===n&&(n="0");for(var i=e.toString(),a=i.length,s=0;s<t-a;s++)i+=n;return i}},Device:{isDesktop:function(){var e=navigator.userAgent;return/Windows|Mac OS/i.test(e)&&!/like Mac OS/.test(e)},isMobile:function(){var e=navigator.userAgent;return/Android|iP[ao]d|iPhone/i.test(e)},isAndroid:function(){return"ANDROID"===FBInstant.getPlatform()},isIOS:function(){return"IOS"===FBInstant.getPlatform()},isMobileWeb:function(){return"MOBILE_WEB"===FBInstant.getPlatform()},pixelRatio:function(){return Math.round(window.devicePixelRatio)||1}}},ye=n(33),Ce=n(124),Ie={Game:{LandscapeRatio:430/540,LandscapeWidth:430,LandscapeHeight:540,ForcePixelRatio:0},Statistics:{Enable:!1},Rollbar:{Enable:!1},Ads:{Enabled:!0},Analytics:{FacebookAnalytics:{}}},Re={ENV:"production",ApiHost:"https://fbig-singleplay-apps.citigo.site",OtherHost:"https://fbig-leaderboards.citigo.site",Notification:{Enable:!1},LeadersBoard:{Prefix:"leaderboards"},Debugger:{ShowConsole:!1,ShowInspector:!1,ShowMonitoring:!1},Statistics:{Enable:!1,ShowFPSInGame:!1,ShowMemoryInGame:!1},Ads:{Enabled:!0,Mockup:{Enable:!1}}},we={ENV:"development",AppId:"512001921139",ApiHost:"https://fbig-singleplay-apps-dev.sunstudio.io",OtherHost:"https://leaderboards-dev.sunstudio.io",SyncProfileFromAPI:!0,Notification:{Enable:!1,ApiUrl:"https://notifications.sunstudio.io",GameTitle:"Pop Jewels",GameImage:"https://static-tt.citigo.site/fbig-singleplay-apps/pop-jewels-banner.jpg"},PlayerMock:{id:"",signature:""},OpponentMock:{id:"",signature:""},MatchMockFailRate:5,Gameplay:{StartLevel:1,StartCoins:6,DelayFinishGame:1700,HintWaitTime:5e3,Powers:{FreeCoins:{enable:!0,duration:18e4},SpeedUp:{enable:!0,modifier:2}},MaxLevel:1598,MaximumMeleeLevel:11,MaximumRangedLevel:11,CheaterIds:[],ChallengeFriends:{activePerLevel:2,maxActiveCount:1}},Tutorial:{ForceUseTutorial:!1,NumberOfTutorial:{GuideOne:1,GuideTwo:1,GuidePrevent:-1,GuideThree:1}},PlayerDataStore:"playerData",Game:{AutoResize:!0,PortraitRatio:320/518,PortraitWidth:375,PortraitHeight:667,LandscapeRatio:430/540,LandscapeWidth:430,LandscapeHeight:540,ForcePixelRatio:0,DisableLandscape:!1,FullSizeOnLandscape:!1},Debugger:{ShowInspector:!1,ShowMonitoring:!1,ShowConsole:!1,Expanded:!1,AutoRefresh:!0,InspectorAutoUpdate:!0,Opacity:.8},Statistics:{Enable:!1,DisplayMode:0,FPS:!0,MS:!0,MB:!0,Opacity:.8,ShowFPSInGame:!0,ShowMemoryInGame:!1},ParticleEditor:{Enable:!1,Opacity:.8,Expanded:!0},LevelBuilder:{Enable:!1,Opacity:.8,Expanded:!1},OfflineReward:{Enable:!0,ValuePerMinute:1,MinimumTimeToActive:36e5,LevelScalingModifier:1.12},ProfilerPlugin:{Enable:!1},Match:{MaxRescueCount:1,RescueGamePopupTimeout:15,ContinueSingleMatchEnabled:!1,SingleMatchStore:"singleMatch",LocalSingleMatchDefault:{_id:"12345678890",status:"open",playerId:"",score:0,level:1,startedAt:0,updateAt:0,finishAt:0,data:{}}},DailyRewards:{MaxDays:6,MockTime:0,CheckInterrupt:!0},DailyTasks:{Duration:86400},Tournament:{UseMock:!1,ForcePlay:!1,UseLeaderboard:!1,TournamentContextIds:[]},Battle:{UseMock:!1,RankingDevTest:!1},LeadersBoard:{Name:null,UseMock:!1,Prefix:"leaderboards",LeaderboardId:"636ccc620067886be24bd071",Limit:50},EnableEffectSceneTransition:!1,Ads:{Enabled:!0,CalculateSafeAreaBottom:!0,EnableRewardVideoResetInterstitial:!1,Mockup:{Enable:!1,ErrorRate:5,GiphyApiKey:""},InterstitialAdOptions:{pID:"",showWhenStartGame:!1,secondsFirstTime:30,secondsBetweenAds:60},RewardAdOptions:{pID:"",secondsFirstTime:0,secondsBetweenAds:0},BannerAdOptions:[]},Network:{MaximumRequest:6,Timeout:15e3,Retries:3},Analytics:{GoogleAnalytics:{consoleLog:!1},FacebookAnalytics:null},Sentry:{errorCodes:{accepted:[],ignored:["USER_INPUT","NETWORK_FAILURE"]},errorMessages:{accepted:[],ignored:["Load image failed","Request failed to be processed","Failed to fetch","reading 'renderList'","reading 'skeletonData'"]}},Rollbar:{Enable:!1,UseMockup:!1,FilterError:{Codes:{accepted:[],ignored:["USER_INPUT","NETWORK_FAILURE"]},Messages:{accepted:[],ignored:["Load image failed","Request failed to be processed","Failed to fetch","reading 'renderList'","reading 'skeletonData'"]}},ListPlayerDevIds:[]},UnitsConfig:{MELEE:{listLevelsUseSprite:[]},RANGED:{listLevelsUseSprite:[]}},Performance:{Enable:!1,trackingSceneKeys:["DASHBOARD_SCENE","GAME_SCENE"],minQuality:1,maxQuality:2,fpsThreshold:48,checkInterval:2e3,qualityAdjustStep:.1,autoUpgradeQuality:!0,onlyUpdateWhenSwitchScene:!0}};we=(0,Ce.TS)((0,ye.Z)({},we),Re);var _e=we=(0,Ce.TS)((0,ye.Z)({},we),Ie),be=n(114),Le=n.n(be),Pe=function(e){return function(t){try{var n=window.game,i=t.module,a=n.scene.getScenes(!0);if(!Le()(a).call(a,(function(t){return t.scene.key===e})))return;var s=i.default;n.scene.remove(e),n.scene.add(e,s,!0),n.scene.bringToTop(n.globalScene),console.log("%c HotScene: ",e)}catch(o){var r;null==(r=void 0)||r.invalidate()}}},Oe=n(526),De=n.n(Oe),ke=n(528),Ne=n.n(ke),Be=n(530),Me=n.n(Be),xe=n(156),Ue=!1,Fe=function e(t,n,i){n.forEach((function(n){if(n.name){var a=null;if(a=i?i.getByName(n.name):t.children.getByName(n.name),Ue&&console.log("Checking object: ",n.name,n.type),a){if("Container"===n.type){var s=a,r=n.getAll();if(e(t,r,s),s.freezeContainer)return;console.log("%c Update container: ",s.name)}var o=De()(n),c=["_events","_sysEvents","input","localTransform","list","displayList","frame"],u=l()(o).call(o,(function(e){if("string"!==typeof e)return!1;if(g()(c).call(c,e)>=0)return!1;if(!a)return!1;var t=Ne()(n,e);return!(t instanceof Function)&&(!(t instanceof Phaser.Scene)&&(!(t instanceof Phaser.GameObjects.Group)&&(!(t instanceof Phaser.GameObjects.GameObject)&&t!==Ne()(a,e))))}));u.length<1||(Ue&&console.log("HotObject: ",n.name,u),u.forEach((function(e){if(a){var t=Ne()(n,e),i=Ne()(a,e),s=Me()(a,e,t);Ue&&console.log("Update property: ",s,e,{oldValue:i,newValue:t})}})))}}}))},Ze={Configs:_e,Utils:Te,LiveUpdate:{Scene:Pe,SceneObjects:function(e,t){return void 0===t&&(t=Ue),function(n){try{var i=window.game,a=n.module;Ue=t;var s=i.scene.getScenes(!0),r=Le()(s).call(s,(function(t){return t.scene.key===e}));if(!r)return;var o=a.default,c=e+"-draft";i.scene.remove(c);var l=i.scene.add(c,o);Ue&&console.log("HotSceneObjects: ",e,l),l.events.once(Phaser.Scenes.Events.RENDER,(0,xe.D)((function(){var e=l.children.getAll();Fe(r,e),i.scene.remove(c)})),50),i.scene.run(c),i.scene.bringToTop(r),i.scene.bringToTop(i.globalScene)}catch(u){console.warn(u)}}}}};window.GameCore=Ze;console.warn("production",{Configs:_e,isDebugger:Te.Valid.isDebugger()})},666:function(e,t,n){"use strict";var i=n(20),a=n(1),s=n(18),r=n.n(s),o=n(38),c=n(472),l=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).instance=void 0,i.placementId=void 0,i.instance=null,i.placementId=n,i}(0,a.Z)(t,e),t.setGame=function(e){self.game=e};var n=t.prototype;return n.loadAsync=function(){var e=(0,i.Z)(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.status===GameCore.Ads.Status.IDLE){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,this.status=GameCore.Ads.Status.LOADING,e.next=6,this.createInstanceByType(this.type);case 6:if(this.instance=e.sent,null!==this.instance){e.next=9;break}throw new GameCore.Ads.AdError("AD_INSTANCE_NOT_INITIATED","Ad instance didn't initiated.");case 9:return e.next=11,this.instance.loadAsync();case 11:this.status=GameCore.Ads.Status.FILLED,e.next=19;break;case 14:throw e.prev=14,e.t0=e.catch(2),this.status=GameCore.Ads.Status.IDLE,this.instance=null,e.t0;case 19:case"end":return e.stop()}}),e,this,[[2,14]])})));return function(){return e.apply(this,arguments)}}(),n.showAsync=function(){var e=(0,i.Z)(r().mark((function e(){var t,n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,this.status===GameCore.Ads.Status.FILLED){e.next=3;break}throw new GameCore.Ads.AdError("AD_NOT_FILLED","Ads no fill.");case 3:if(this.status=GameCore.Ads.Status.SHOWING,null!==this.instance){e.next=6;break}throw new GameCore.Ads.AdError("AD_INSTANCE_NOT_INITIATED","Ad instance didn't initiated.");case 6:return e.next=8,this.instance.showAsync();case 8:t=this.getSceneName(),this.type===GameCore.Ads.Types.INTERSTITIAL&&(self.game.analytics.showInterstitialAd(t),self.game.analytics.event(o._.AD_INTERSTITIAL_IMPS)),this.type===GameCore.Ads.Types.REWARDED&&(self.game.analytics.showRewardedVideoAd(t),self.game.analytics.event(o._.AD_REWARDED_IMPS)),this.status=GameCore.Ads.Status.IDLE,this.instance=null,e.next=21;break;case 15:throw e.prev=15,e.t0=e.catch(0),e.t0 instanceof Object&&GameCore.Utils.Object.hasOwn(e.t0,"code")&&"ADS_NOT_LOADED"===e.t0.code?this.status=GameCore.Ads.Status.FILLED:(this.status=GameCore.Ads.Status.IDLE,this.instance=null),n=this.getSceneName(),self.game.analytics.showAdFail(this.type,n,e.t0),e.t0;case 21:return e.prev=21,window.focus(),e.finish(21);case 24:case"end":return e.stop()}}),e,this,[[0,15,21,24]])})));return function(){return e.apply(this,arguments)}}(),n.getStatus=function(){return this.status},n.createInstanceByType=function(){var e=(0,i.Z)(r().mark((function e(t){var n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=self.game.facebook,e.t0=t,e.next=e.t0===GameCore.Ads.Types.REWARDED?4:e.t0===GameCore.Ads.Types.INTERSTITIAL?7:10;break;case 4:return e.next=6,n.getRewardedVideoAsync(this.placementId);case 6:case 9:return e.abrupt("return",e.sent);case 7:return e.next=9,n.getInterstitialAdAsync(this.placementId);case 10:return e.abrupt("return",null);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.getSceneName=function(){try{var e=self.game.globalScene;return e instanceof c.Z?e.getCurrentScene().scene.getSceneName():"unknown"}catch(t){return"unknown"}},t}(GameCore.Ads.AdInstance);t.Z=l},468:function(e,t,n){"use strict";n.d(t,{U:function(){return T},v:function(){return y}});var i=n(33),a=n(20),s=n(18),r=n.n(s),o=n(70),c=n.n(o),l=n(1),u=n(227),h=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="BadRequest",i.message=t||"This request is bad",i.payload=n,i}return(0,l.Z)(t,e),t}((0,u.Z)(Error)),d=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="RequestTimeout",i.message=t||"This request is timeout",i.payload=n,i}return(0,l.Z)(t,e),t}((0,u.Z)(Error)),p=n(225),f=GameCore.Configs,g=f.AppId,E=f.Network,m=function(e){if(!e.ok)throw new h(null,{response:e})},v=function(){var e=window.game.auth.getToken();return{token:e,timeout:E.Timeout,headers:{Authorization:"Bearer "+e,"Content-Type":"application/json"}}},A=function(e,t,n,i){return(0,a.Z)(r().mark((function a(){var s,o,l,u,p;return r().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,s=e+"/apps/"+g+"/"+t,o=new AbortController,n.signal=o.signal,l=setTimeout((function(){o.abort()}),n.timeout),GameCore.Utils.Valid.isObject(i)&&(n.body=c()(i)),a.next=8,fetch(s,n);case 8:return u=a.sent,clearTimeout(l),m(u),a.next=13,u.json();case 13:if(a.t0=a.sent,a.t0){a.next=16;break}a.t0={};case 16:return p=a.t0,a.abrupt("return",p);case 20:if(a.prev=20,a.t1=a.catch(0),!(a.t1 instanceof h)){a.next=24;break}return a.abrupt("return",null);case 24:if(!(a.t1 instanceof Object&&GameCore.Utils.Object.hasOwn(a.t1,"name"))){a.next=27;break}if("AbortError"!==a.t1.name){a.next=27;break}throw new d(null);case 27:throw a.t1;case 28:case"end":return a.stop()}}),a,null,[[0,20]])})))},S=function(){var e=(0,a.Z)(r().mark((function e(t,n){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.abrupt("return",t());case 4:if(e.prev=4,e.t0=e.catch(0),!(e.t0 instanceof d&&n>0)){e.next=18;break}return e.prev=7,e.next=10,(0,p.qZ)(600);case 10:return e.next=12,S(t,n-1);case 12:return e.abrupt("return",e.sent);case 15:return e.prev=15,e.t1=e.catch(7),e.abrupt("return",{});case 18:if(!(e.t0 instanceof d)){e.next=20;break}return e.abrupt("return",{});case 20:return console.warn(e.t0),e.abrupt("return",{});case 22:case"end":return e.stop()}}),e,null,[[0,4],[7,15]])})));return function(t,n){return e.apply(this,arguments)}}(),T=function(){var e=(0,a.Z)(r().mark((function e(t,n,a,s){var o,c;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===n&&(n={}),void 0===s&&(s=E.Retries),e.prev=2,o=(0,i.Z)({},v(),n,{method:"GET"}),c=A(a,t,o),e.next=7,S(c,s);case 7:return e.abrupt("return",e.sent);case 10:return e.prev=10,e.t0=e.catch(2),console.warn(e.t0),e.abrupt("return",{});case 14:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t,n,i,a){return e.apply(this,arguments)}}(),y=function(){var e=(0,a.Z)(r().mark((function e(t,n,a,s,o){var c,l;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===a&&(a={}),void 0===o&&(o=E.Retries),e.prev=2,c=(0,i.Z)({},v(),a,{method:"POST"}),l=A(s,t,c,n),e.next=7,S(l,o);case 7:return e.abrupt("return",e.sent);case 10:return e.prev=10,e.t0=e.catch(2),console.warn(e.t0),e.abrupt("return",{});case 14:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t,n,i,a,s){return e.apply(this,arguments)}}()},226:function(e,t,n){"use strict";n.d(t,{Bv:function(){return r},DW:function(){return l},EH:function(){return s},fJ:function(){return a},kL:function(){return i},qj:function(){return o},rh:function(){return c}});var i="CONTEXT_RECEIVED",a="CONTEXT_PROCESSED",s="CONTEXT_GAME_MODE_DETECTED",r="CONTEXT_GAME_MODE_REQUESTED",o="MESSAGES_SENT_UPDATE",c="MESSAGES_SENT_REMOVE",l="SCENE_KEY_UPDATE"},229:function(e,t,n){"use strict";n.d(t,{Sb:function(){return s},W6:function(){return i},lB:function(){return r},nx:function(){return a},zV:function(){return o}});var i="share_invite",a="tournament",s="challenge_friend_match",r="matching_group_match",o="challenge_friends_message"},231:function(e,t,n){"use strict";n.d(t,{U:function(){return s}});var i=n(224),a=n(84),s=new i.Z("10","Your Friend",a.Z.AVATAR.FILE).toObject()},469:function(e,t,n){"use strict";n.d(t,{Z:function(){return A}});var i=n(33),a=n(150),s=n.n(a),r=n(461),o=r.h.sound,c=r.h.music,l=r.h.vibrate,u=r.h.speedUp,h=function(){function e(e){this.sound=void 0,this.music=void 0,this.vibrate=void 0,this.speedUp=void 0,this.language=void 0,this.theme=void 0;var t=e||{},n=t.sound,i=t.music,a=t.vibrate,s=t.speedUp;this.sound=GameCore.Utils.Valid.isBoolean(n)?n:o,this.music=GameCore.Utils.Valid.isBoolean(i)?i:c,this.vibrate=GameCore.Utils.Valid.isBoolean(a)?a:l,this.speedUp=GameCore.Utils.Valid.isBoolean(s)?s:u}return e.prototype.toObject=function(){return{sound:this.sound,music:this.music,vibrate:this.vibrate,speedUp:this.speedUp}},e}(),d=GameCore.Configs.Gameplay,p=d.StartCoins,f=d.MaximumMeleeLevel,g=d.MaximumRangedLevel,E=GameCore.Utils,m=E.Valid,v=E.Object,A=function(){function e(e){this.settings=void 0,this.gameData=void 0,this.userGuideDisplays=void 0,this.coins=void 0,this.freeCoinsLastUsedTime=void 0,this.offlineRewardLastCheck=void 0,this.validateUnitData=function(e){var t=e.split("/");if(3!==t.length)return!1;var n=[],i=t[0].split("-");if(5!==i.length)return!1;n.push.apply(n,i);var a=t[1].split("-");if(5!==a.length)return!1;n.push.apply(n,a);var s=t[2].split("-");return 5===s.length&&(n.push.apply(n,s),!n.some((function(e){if("0"===e[0])return!1;if("r"!==e[0]&&"m"!==e[0])return!0;var t=parseInt(e.substring(1));return t<1||t>11})))},this.setupDefaultData(),this.updateCoins(e),this.updateSettings(e),this.updateGameData(e),this.updateUserGuideDisplays(e),this.updateFreeCoinsLastUsedTime(e),this.updateOfflineRewardLastCheck(e)}var t=e.prototype;return t.setupDefaultData=function(){this.coins={suffix:0,baseValue:1e3*p},this.settings=(0,i.Z)({},r.h);for(var e={MELEE:{},RANGED:{}},t=1;t<=f;t++)e.MELEE[t]=0;for(var n=1;n<=g;n++)e.RANGED[n]=0;this.gameData={selectedLevel:0,playerUnitData:"0-0-0-0-0/0-0-0-0-0/0-0-m1-0-0",playerLevelProgress:0,meleeUnlockedUnitLevel:0,rangedUnlockedUnitLevel:0,unitScreenAdWatchedCount:e},this.userGuideDisplays=0,this.freeCoinsLastUsedTime=0,this.offlineRewardLastCheck=0},t.updateCoins=function(e){var t=e.coins;!1!==m.isObject(t)&&(v.hasOwn(t,"suffix")&&m.isNumber(t.suffix)&&(this.coins.suffix=t.suffix),v.hasOwn(t,"baseValue")&&m.isNumber(t.baseValue)&&(this.coins.baseValue=t.baseValue))},t.updateSettings=function(e){var t=e.settings;if(!1!==m.isObject(t)){var n=new h(t).toObject();this.settings=n}},t.updateGameData=function(e){var t=e.gameData;if(!1!==m.isObject(t)){if(v.hasOwn(t,"selectedLevel")&&m.isNumber(t.selectedLevel)&&(this.gameData.selectedLevel=t.selectedLevel),v.hasOwn(t,"playerUnitData"))if(m.isString(t.playerUnitData))this.validateUnitData(t.playerUnitData)&&(this.gameData.playerUnitData=t.playerUnitData);if(v.hasOwn(t,"playerLevelProgress")&&m.isNumber(t.playerLevelProgress)&&(this.gameData.playerLevelProgress=t.playerLevelProgress),v.hasOwn(t,"playerLevelProgress")&&m.isNumber(t.meleeUnlockedUnitLevel)&&(this.gameData.meleeUnlockedUnitLevel=t.meleeUnlockedUnitLevel),v.hasOwn(t,"rangedUnlockedUnitLevel")&&m.isNumber(t.rangedUnlockedUnitLevel)&&(this.gameData.rangedUnlockedUnitLevel=t.rangedUnlockedUnitLevel),v.hasOwn(t,"unitScreenAdWatchedCount")&&m.isObject(t.unitScreenAdWatchedCount)){var n=t.unitScreenAdWatchedCount;if(m.isObject(n.MELEE))for(var i=0,a=s()(n.MELEE);i<a.length;i++){var r=a[i],o=r[0],c=r[1],l=parseInt(o);m.isNumber(l)&&m.isNumber(c)&&(this.gameData.unitScreenAdWatchedCount.MELEE[l]=c)}if(m.isObject(n.RANGED))for(var u=0,h=s()(n.RANGED);u<h.length;u++){var d=h[u],p=d[0],f=d[1],g=parseInt(p);m.isNumber(g)&&m.isNumber(f)&&(this.gameData.unitScreenAdWatchedCount.RANGED[g]=f)}}}},t.updateUserGuideDisplays=function(e){var t=e.userGuideDisplays;!1!==m.isNumber(t)&&(this.userGuideDisplays=t)},t.updateFreeCoinsLastUsedTime=function(e){var t=e.freeCoinsLastUsedTime;!1!==m.isNumber(t)&&(this.freeCoinsLastUsedTime=t)},t.updateOfflineRewardLastCheck=function(e){var t=e.offlineRewardLastCheck;!1!==m.isNumber(t)&&(this.offlineRewardLastCheck=t)},t.toObject=function(){return{coins:this.coins,settings:this.settings,gameData:this.gameData,userGuideDisplays:this.userGuideDisplays,freeCoinsLastUsedTime:this.freeCoinsLastUsedTime,offlineRewardLastCheck:this.offlineRewardLastCheck}},t.convertToPlayerData=function(){var e=this.gameData,t=this.coins,n=t.baseValue,i=t.suffix;return{settings:this.settings,customFields:{coinBaseValue:n,coinSuffixValue:i,freeCoinsLastUsedTime:this.freeCoinsLastUsedTime,offlineRewardLastCheck:this.offlineRewardLastCheck,selectedLevel:e.selectedLevel,playerUnitData:e.playerUnitData,playerLevelProgress:e.playerLevelProgress,meleeUnlockedUnitLevel:e.meleeUnlockedUnitLevel,rangedUnlockedUnitLevel:e.rangedUnlockedUnitLevel,unitScreenAdWatchedCount:e.unitScreenAdWatchedCount},userGuideDisplays:this.userGuideDisplays}},t.convertToFacebookData=function(e){var t=e.settings,n=e.customFields,i=e.userGuideDisplays,a=n.selectedLevel,s=n.coinBaseValue,r=n.coinSuffixValue,o=n.freeCoinsLastUsedTime,c=n.offlineRewardLastCheck,l=n.playerUnitData,u=n.playerLevelProgress,h=n.meleeUnlockedUnitLevel,d=n.rangedUnlockedUnitLevel,p=n.unitScreenAdWatchedCount;return this.settings=t,this.userGuideDisplays=i,this.freeCoinsLastUsedTime=o,this.offlineRewardLastCheck=c,this.coins.suffix=r,this.coins.baseValue=s,this.gameData.selectedLevel=a,this.gameData.playerUnitData=l,this.gameData.playerLevelProgress=u,this.gameData.meleeUnlockedUnitLevel=h,this.gameData.rangedUnlockedUnitLevel=d,this.gameData.unitScreenAdWatchedCount=p,this.toObject()},e}()},39:function(e,t,n){"use strict";var i=n(124),a=function(){function e(e,t){if(this.scene=void 0,this.config=void 0,this.isStarted=void 0,this.tween=void 0,!(t.targets.length<1)){this.buildConfig(e,t);var n=this.config.targets[0].scene;n instanceof Phaser.Scene&&(this.scene=n,this.isStarted=!1,this.tween=n.tweens.create(this.config))}}var t=e.prototype;return t.buildConfig=function(e,t){this.config=(0,i.TS)(e,t)},t.play=function(){this.tween&&(this.isStarted&&this.tween.hasStarted?this.restart():(this.tween.play(!0),this.isStarted=!0))},t.restart=function(){var e;null==(e=this.tween)||e.restart()},t.stop=function(){var e;null==(e=this.tween)||e.stop()},t.remove=function(){var e;null==(e=this.tween)||e.remove()},t.next=function(e){return this.tween?(this.tween.off(Phaser.Tweens.Events.TWEEN_COMPLETE,e),this.tween.once(Phaser.Tweens.Events.TWEEN_COMPLETE,e),this.tween):null},e}();t.Z=a},489:function(e,t,n){"use strict";var i=n(5),a=n(1),s=n(39),r={targets:[],repeat:-1,yoyo:!0,duration:33,ease:Phaser.Math.Easing.Sine.InOut,props:{x:5}},o=function(e){function t(t){var n,a,s;return(s=e.call(this,r,t)||this).posX=void 0,s.handleSwitchPosition=function(){var e;s.posX=-s.posX,null==(e=s.tween)||e.updateTo("x",-s.posX)},null!=(n=s.config)&&n.props?(s.posX=s.config.props.x,null==(a=s.tween)||a.on(Phaser.Tweens.Events.TWEEN_REPEAT,s.handleSwitchPosition),s):(0,i.Z)(s)}return(0,a.Z)(t,e),t}(s.Z);t.Z=o},232:function(e,t,n){"use strict";var i=n(1),a=n(39),s={targets:[],duration:400,ease:n(473).Z,props:{scale:"-=0.1"}},r=function(e){function t(t){return e.call(this,s,t)||this}return(0,i.Z)(t,e),t}(a.Z);t.Z=r},473:function(e,t,n){"use strict";var i=n(152),a=n.n(i)()(.48,1.57,.6,.83);t.Z=a},159:function(e,t,n){"use strict";var i=n(1),a=n(39),s={targets:[],duration:600,ease:Phaser.Math.Easing.Cubic.Out,props:{alpha:{start:0,from:0,to:1}}},r=function(e){function t(t){return e.call(this,s,t)||this}return(0,i.Z)(t,e),t}(a.Z);t.Z=r},486:function(e,t,n){"use strict";var i=n(1),a=n(39),s={targets:[],props:{alpha:{duration:500,value:{start:0,from:0,to:1},ease:Phaser.Math.Easing.Cubic.Out},scale:{duration:1e3,value:{start:.8,from:.8,to:1},ease:Phaser.Math.Easing.Elastic.Out,easeParams:[.1,.45]}}},r=function(e){function t(t){var n;return(n=e.call(this,s,t)||this).baseScales=void 0,n}return(0,i.Z)(t,e),t}(a.Z);t.Z=r},113:function(e,t,n){"use strict";var i=n(1),a=n(39),s={targets:[],props:{alpha:{start:0,to:1,duration:500,ease:Phaser.Math.Easing.Cubic.Out},scale:{start:.8,to:1,duration:1e3,ease:Phaser.Math.Easing.Elastic.Out,easeParams:[.1,.45]}},delay:0},r=function(e){function t(t){return e.call(this,s,t)||this}return(0,i.Z)(t,e),t}(a.Z);t.Z=r},67:function(e,t,n){"use strict";var i=n(1),a=n(39),s={targets:[],duration:600,ease:Phaser.Math.Easing.Quadratic.Out,props:{alpha:{start:1,from:1,to:0}}},r=function(e){function t(t){return e.call(this,s,t)||this}return(0,i.Z)(t,e),t}(a.Z);t.Z=r},129:function(e,t,n){"use strict";var i=n(1),a=n(39),s={targets:[],duration:300,ease:n(473).Z,props:{scale:{from:1.2,to:1}}},r=function(e){function t(t){return e.call(this,s,t)||this}return(0,i.Z)(t,e),t}(a.Z);t.Z=r},485:function(e,t,n){"use strict";var i=n(5),a=n(1),s=n(39),r={targets:[],duration:1e3,ease:Phaser.Math.Easing.Quadratic.InOut,props:{scale:.2}},o=function(e){function t(t){var n,a;(a=e.call(this,r,t)||this).spline=void 0,a.createCounter=function(e,t){var n=a.config.onCurveUpdate,i="function"===typeof n?n:null;t.forEach((function(t,n){if(a.scene){var s=e.data[n],r=s.duration,o=s.delay,c=new Phaser.Math.Vector2;a.scene.tweens.addCounter({delay:o,duration:r,ease:Phaser.Math.Easing.Quadratic.InOut,onUpdate:function(e){a.spline.getPoint(e.getValue(),c),t.x=c.x,t.y=c.y,i&&i(t)}})}}))};var s=a.config.curve;return s?(a.spline=new Phaser.Curves.Spline(s),null==(n=a.tween)||n.on(Phaser.Tweens.Events.TWEEN_START,a.createCounter),a):(0,i.Z)(a)}return(0,a.Z)(t,e),t}(s.Z);t.Z=o},126:function(e,t){"use strict";var n=function(){function e(e,t,n){this.baseValue=void 0,this.suffix=void 0,this.suffix=t||0,this.baseValue=Math.floor(e),n||!1||(this.initValue(),this.refactorValue())}var t=e.prototype;return t.initValue=function(){if(0===this.suffix&&this.baseValue>=1e3){var e=this.baseValue.toString(),t=e.length-1;this.suffix=Math.floor(t/3);var n=t%3;this.suffix>=2&&(this.baseValue=parseInt(e.substring(0,4+n)))}else this.baseValue*=1e3},t.refactorValue=function(){return this.baseValue=Math.floor(this.baseValue),this.baseValue>=1e6?(this.baseValue=Math.floor(this.baseValue/1e3),void this.suffix++):0!==this.baseValue?this.baseValue<1e3&&this.suffix>0?(this.baseValue*=1e3,void this.suffix--):void 0:void(this.suffix=0)},t.add=function(t){if(t.baseValue<0)this.subtract(new e(-1*t.baseValue,t.suffix,!0));else if(!(this.suffix-t.suffix>=2)){if(t.suffix-this.suffix>=2)return this.baseValue=t.baseValue,void(this.suffix=t.suffix);if(this.suffix===t.suffix)this.baseValue+=t.baseValue;else{this.suffix=this.suffix>t.suffix?this.suffix:t.suffix;var n=this.suffix>t.suffix?this.baseValue:t.baseValue,i=this.suffix>t.suffix?t:this;this.baseValue=n+Math.floor(i.baseValue/1e3)}this.refactorValue()}},t.subtract=function(e){return e.suffix>this.suffix||e.baseValue>this.baseValue&&e.suffix===this.suffix?(this.baseValue=0,void(this.suffix=0)):void(this.suffix-e.suffix>=2||(this.baseValue-=Math.floor(e.baseValue/Math.pow(1e3,this.suffix-e.suffix)),this.refactorValue()))},t.multiply=function(t){if("number"===typeof t&&t<1e3)return this.baseValue*=t,void this.refactorValue();var n="number"===typeof t?new e(t):t;this.suffix+=n.suffix,this.baseValue*=Math.floor(n.baseValue/1e3),this.refactorValue()},t.divide=function(t){if("number"===typeof t&&t<1e3)return this.baseValue/=t,void this.refactorValue();var n="number"===typeof t?new e(t):t;this.suffix-=n.suffix,this.baseValue/=Math.floor(n.baseValue/1e3),this.refactorValue()},t.clone=function(){return new e(this.baseValue,this.suffix,!0)},t.biggerThan=function(e){return this.suffix>e.suffix||!(this.suffix<e.suffix)&&this.baseValue>e.baseValue},t.smallerThan=function(e){return this.suffix<e.suffix||!(this.suffix>e.suffix)&&this.baseValue<e.baseValue},t.toString=function(){return""+Math.floor(this.baseValue/1e3)+this.generateTextSuffix()},t.generateTextSuffix=function(){switch(this.suffix){case 0:return"";case 1:return"K";case 2:return"M";case 3:return"B";case 4:return"T";default:var e=this.suffix-5,t=Math.floor(e/26),n=e%26;return""+String.fromCharCode(t+65)+String.fromCharCode(n+65)}},e}();t.Z=n},58:function(e,t,n){"use strict";var i=n(57),a=n(5),s=n(1),r=n(38),o=n(232),c=n(66),l=n(25),u=n(157),h=n(86),d=function(e){function t(t,n,i,s,r,l){var u;return void 0===l&&(l=!1),(u=e.call(this,t)||this).useSound=!0,u.isClicked=!1,u.isDisable=!1,u.scaleUp=-1,u.scaleDown=-1,u.button=void 0,u.upAnimation=void 0,u.downAnimation=void 0,u.isUsePixelPerfect=!1,u.hitArea=void 0,u.hitZone=void 0,u.scaleDownPress=void 0,u.parentName=void 0,u.onceCallbacks=void 0,u.isLogEvent=void 0,u.handelObjectDestroy=function(){u.scene&&u.scene.events.off(Phaser.Scenes.Events.SLEEP,u.handleSceneSleep)},u.handleSceneSleep=function(){u.scene&&u.scene.tweens.killTweensOf((0,a.Z)(u))},u.handlePointerDown=function(){var e,t;u.isClicked||null!=(e=u.upAnimation)&&null!=(t=e.tween)&&t.isPlaying()||(u.isClicked=!0,u.runDownAnimation())},u.handleOnClick=function(e){return function(){var t,n,i,a;u.isClicked&&(null!=(t=u.upAnimation)&&null!=(n=t.tween)&&n.isPlaying()||(u.isClicked=!1,u.runUpAnimation(),null==(i=u.upAnimation)||null==(a=i.tween)||a.once(Phaser.Tweens.Events.TWEEN_COMPLETE,(function(){u.logButtonEvent(),u.processCallback(e),(0,h.ZP)(50)}))))}},u.handlePointerOut=function(){var e,t;u.isClicked&&(null!=(e=u.upAnimation)&&null!=(t=e.tween)&&t.isPlaying()||(u.isClicked=!1,u.runUpAnimation()))},u.runDownAnimation=function(){var e;-1===u.scaleDown&&(u.scaleUp=u.scale,u.scaleDown=u.scaleDownPress),u.useSound&&u.playSound(),null==(e=u.downAnimation)||e.remove(),u.downAnimation=new o.Z({targets:[(0,a.Z)(u)],duration:150,props:{scale:u.scaleDown},onUpdate:function(){u.hitZone.scale=u.scaleUp/u.scale}}),u.downAnimation.play()},u.isUsePixelPerfect=l,u.onceCallbacks=[],u.isLogEvent=!0,u.setDepth(c.Z.BUTTON),u.createButton(n,i,s,r),u.updateSize(),u.listenEvents(),u.scene.add.existing((0,a.Z)(u)),u}(0,s.Z)(t,e);var n=t.prototype;return n.listenEvents=function(){this.scene.events.on(Phaser.Scenes.Events.SLEEP,this.handleSceneSleep),this.once(Phaser.GameObjects.Events.DESTROY,this.handelObjectDestroy)},n.setOnceCallback=function(e){this.onceCallbacks.push(e)},n.processCallback=function(e){var t,n,i;null==(t=this.upAnimation)||t.stop(),null==(n=this.downAnimation)||n.stop(),null==(i=this.scene)||i.tweens.killTweensOf(this),-1!==this.scaleUp&&this.setScale(this.scaleUp),e(),this.onceCallbacks.length>0&&(this.onceCallbacks.forEach((function(e){return e()})),this.onceCallbacks=[])},n.setDisabled=function(e){if(this.isDisable!==e){var t,n;if(e)this.setAlpha(.5),null==(t=this.hitArea)||t.disableInteractive();else this.setAlpha(1),null==(n=this.hitArea)||n.setInteractive();this.isDisable=e}},n.isDisabled=function(){return this.isDisable},n.createButton=function(e,t,n,i){this.button=this.scene.add.image(0,0,e,t),n&&i&&this.button.setWorldSize(n,i),this.updateScaleDown();var a=this.button,s=a.displayWidth,r=a.displayHeight;this.hitZone=this.scene.make.zone({displayWidth:s,displayHeight:r}),this.add([this.button,this.hitZone])},n.updateSize=function(){var e=this.button,t=e.displayWidth,n=e.displayHeight,i=t/100*10,a=n/100*10,s=i<10?i:10,r=a<10?a:10;this.setSize(t+s,n+r),this.hitZone.setSize(t+s,n+r)},n.updateScaleDown=function(){this.scaleUp=this.scale,this.scaleDown=-1,this.scaleDownPress=this.scale-.1},n.playSound=function(){this.scene.audio.playSound(l.Z.BUTTON_CLICK)},n.runUpAnimation=function(){var e,t=this;-1!==this.scaleUp&&(null==(e=this.upAnimation)||e.remove(),this.upAnimation=new o.Z({targets:[this],duration:150,props:{scale:this.scaleUp},onUpdate:function(){t.hitZone.scale=t.scaleUp/t.scale}}),this.upAnimation.play())},n.addDebugData=function(){var e=this.getParentName(),t=this.name;(0,u.sw)("ui-click",e+":"+t)},n.logButtonEvent=function(){if(this.isLogEvent){var e=this.getParentName(),t=this.name;this.scene.analytics.event(r._.BUTTON_CLICK,{button_name:t,screen_name:e})}},n.disableLogEvent=function(e){this.isLogEvent=!e},n.getParentName=function(){if(this.parentName)return this.parentName;for(var e=this.parentContainer;e;){if(e instanceof GameCore.Screen){var t=e;return this.parentName=t.getScreenName(),this.parentName}e=e.parentContainer}return this.parentName=this.scene.getSceneName(),this.parentName},(0,i.Z)(t,[{key:"onClick",set:function(e){this.isUsePixelPerfect?(this.hitArea=this.button,this.hitArea.setInteractive({useHandCursor:!0,pixelPerfect:!0})):(this.hitArea=this.hitZone,this.updateSize(),this.hitArea.setInteractive({useHandCursor:!0})),this.hitArea.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,this.handlePointerDown),this.hitArea.on(Phaser.Input.Events.GAMEOBJECT_POINTER_UP,this.handleOnClick(e)),this.hitArea.on(Phaser.Input.Events.GAMEOBJECT_POINTER_OUT,this.handlePointerOut)}},{key:"onDown",set:function(e){this.hitArea.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,e)}},{key:"onOut",set:function(e){this.hitArea.on(Phaser.Input.Events.GAMEOBJECT_POINTER_OUT,e)}},{key:"isUsePixelPerFect",get:function(){return this.isUsePixelPerfect}}]),t}(Phaser.GameObjects.Container);t.Z=d},112:function(e,t,n){"use strict";var i=n(1),a=n(58),s=n(2),r=n(25),o=s.Z.DEFAULT_8_BIT,c=o.KEY,l=o.FRAME,u=function(e){function t(t){var n;return(n=e.call(this,t,c,l.BUTTON_CLOSE,31.5,31.5)||this).scene=t,n.setName("Close"),n}return(0,i.Z)(t,e),t.prototype.playSound=function(){this.scene.audio.playSound(r.Z.CLOSE_CLICK,{volume:.3})},t}(a.Z);t.Z=u},491:function(e,t,n){"use strict";var i=n(1),a=function(e){function t(t,n){var i,a=n.key,s=n.frame,r=n.width,o=n.height,c=n.usePixelPerfect;(i=e.call(this,t,a,s,r,o,c)||this).paddingZone=void 0,i.showDebugZone=void 0,i.debugZone=void 0;var l=n.paddingZone,u=void 0===l?0:l,h=n.showDebugZone,d=void 0!==h&&h;return i.paddingZone=u,i.showDebugZone=d,i}return(0,i.Z)(t,e),t.prototype.updateSize=function(){e.prototype.updateSize.call(this);var t,n=this.width,i=this.height,a=n+this.paddingZone,s=i+this.paddingZone;(this.setSize(a,s),this.hitZone.setSize(a,s),this.showDebugZone)&&(null==(t=this.debugZone)||t.destroy(),this.debugZone=this.hitZone.drawDebugBox(10699282,.5),this.add(this.debugZone))},t}(n(58).Z);t.Z=a},128:function(e,t,n){"use strict";n.d(t,{Z:function(){return d}});var i=n(5),a=n(1),s=n(2),r=n(39),o={targets:[],duration:600,ease:Phaser.Math.Easing.Linear,props:{angle:{from:0,to:360}}},c=function(e){function t(t){return e.call(this,o,t)||this}return(0,a.Z)(t,e),t}(r.Z),l=s.Z.DEFAULT_8_BIT,u=l.KEY,h=l.FRAME,d=function(e){function t(t){var n;return(n=e.call(this,t,0,0,u,h.PRELOADER)||this).anim=void 0,n.runAnimation(),n.setWorldSize(113,113),n.scene.add.existing((0,i.Z)(n)),n}(0,a.Z)(t,e);var n=t.prototype;return n.runAnimation=function(){var e;null==(e=this.anim)||e.remove(),this.anim=new c({targets:[this],repeat:-1,duration:1200}),this.anim.play()},n.setVisible=function(t){return e.prototype.setVisible.call(this,t),t?this.runAnimation():this.anim.stop(),this},t}(Phaser.GameObjects.Image)},662:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var i=n(1),a=n(34),s=n(2),r=function(e){function t(t,n){var i;(i=e.call(this,t)||this).payload=void 0,i.process=void 0,i.minProcess=void 0,i.maxProcess=void 0,i.progressBoxLeft=void 0,i.progressBoxBg=void 0,i.progressBoxRight=void 0,i.progressBarLeft=void 0,i.progressBarBg=void 0,i.progressBarRight=void 0,i.progressAnimation=void 0,i.payload=n;var a=n.width;return i.setSize(a,39),i.process=0,i.minProcess=0,i.maxProcess=1,i.createProgressBox(),i.createProgressBar(),i.createContainer(),i}(0,i.Z)(t,e);var n=t.prototype;return n.setProcess=function(e,t){void 0===t&&(t=!1),this.process=this.getCorrectValue(e),this.scene&&!t?this.runProcessAnimation(e):this.updateProcess()},n.updateProcess=function(){var e=this.progressBarBg.displayHeight,t=this.getDisplayWidthByProcess(this.process);this.progressBarBg.setWorldSize(t,e);var n=this.progressBarBg.x;this.progressBarRight.setX(n+t)},n.getCorrectValue=function(e){var t=e;return isFinite(t)||(t=0),t<this.minProcess&&(t=this.minProcess),t>this.maxProcess&&(t=this.maxProcess),t},n.getDisplayWidthByProcess=function(e){return(this.width-17)*e},n.getProcessByDisplayWidth=function(e){return e/(this.width-17)},n.runProcessAnimation=function(e){var t,n=this;null==(t=this.progressAnimation)||t.remove(),this.progressAnimation=this.scene.add.tween({targets:[this.progressBarBg],duration:1e3,ease:Phaser.Math.Easing.Quadratic.InOut,props:{displayWidth:function(){var t=n.getCorrectValue(e);return n.getDisplayWidthByProcess(t)}},onUpdate:function(){var e=n.progressBarBg,t=e.x,i=e.displayWidth;n.progressBarRight.setX(t+i)},onComplete:function(){n.updateProcess()}})},n.createProgressBox=function(){var e=this.payload,t=e.key,n=e.frames;this.progressBoxLeft=this.scene.make.image({key:t,frame:n.PROGRESS_BG_LEFT}),this.progressBoxLeft.setOrigin(0,.5),this.progressBoxLeft.setWorldSize(9,39),this.progressBoxRight=this.scene.make.image({key:t,frame:n.PROGRESS_BG_RIGHT}),this.progressBoxRight.setOrigin(0,.5),this.progressBoxRight.setWorldSize(9,39),this.progressBoxBg=this.scene.make.image({key:t,frame:n.PROGRESS_BG_MID}),this.progressBoxBg.setOrigin(0,.5),this.progressBoxBg.setWorldSize(9,39);var i=this.progressBoxBg.displayHeight,a=this.displayWidth,s=this.progressBoxLeft.displayWidth,r=this.progressBoxRight.displayWidth;this.progressBoxLeft.setWorldSize(s,i),this.progressBoxRight.setWorldSize(r,i),this.progressBoxBg.setWorldSize(a-(s+r),i),Phaser.Display.Align.In.Center(this.progressBoxBg,this,0,0),Phaser.Display.Align.In.LeftCenter(this.progressBoxLeft,this,0,0),Phaser.Display.Align.In.RightCenter(this.progressBoxRight,this,0,0)},n.createProgressBar=function(){var e=this.payload,t=e.key,n=e.frames;this.progressBarLeft=this.scene.make.image({key:t,frame:n.PROGRESS_BAR_LEFT}),this.progressBarLeft.setOrigin(0,.5),this.progressBarLeft.setWorldSize(8.5,32),this.progressBarRight=this.scene.make.image({key:t,frame:n.PROGRESS_BAR_RIGHT}),this.progressBarRight.setOrigin(0,.5),this.progressBarRight.setWorldSize(8.5,32),this.progressBarBg=this.scene.make.image({key:t,frame:n.PROGRESS_BAR_MID}),this.progressBarBg.setOrigin(0,.5),this.progressBarBg.setWorldSize(8.5,32);var i=-1.6;Phaser.Display.Align.In.LeftCenter(this.progressBarBg,this,-7,i),Phaser.Display.Align.In.LeftCenter(this.progressBarLeft,this,-2,i),Phaser.Display.Align.In.LeftCenter(this.progressBarRight,this,-2,i),this.setProcess(0,!0)},n.createContainer=function(){this.add([this.progressBoxBg,this.progressBoxLeft,this.progressBoxRight,this.progressBarBg,this.progressBarLeft,this.progressBarRight]),this.scene.add.existing(this)},t}(Phaser.GameObjects.Container),o=s.Z.DEFAULT,c=o.KEY,l=o.FRAME,u=function(e){function t(t,n){var i;return(i=e.call(this,t,{key:c,frames:l,width:n})||this).loadingText=void 0,i.createLoadingText(),i}(0,i.Z)(t,e);var n=t.prototype;return n.createLoadingText=function(){this.loadingText=this.scene.add.text(0,0,this.scene.lang.Text.LOADING+"0%",{fontFamily:a.Z.FONT_FAMILY,fontSize:"20px",color:"#ffffff",stroke:"#000000",strokeThickness:3,fixedWidth:260,align:"center"}),this.loadingText.setHighQuality(),this.loadingText.setShadow(0,12,"#000000",0,!0),this.add(this.loadingText),Phaser.Display.Align.In.Center(this.loadingText,this,0,-2)},n.updateProcess=function(){var e=this.progressBarBg.displayHeight,t=this.getDisplayWidthByProcess(this.process);this.progressBarBg.setWorldSize(t,e);var n=this.progressBarBg.x;if(this.progressBarRight.setX(n+t),this.loadingText){var i=Math.floor(100*this.getProcessByDisplayWidth(t));this.loadingText.setText(""+this.scene.lang.Text.LOADING+i+"%")}},n.runProcessAnimation=function(e){var t,n,i=this;null==(t=this.progressAnimation)||t.stop(),null==(n=this.progressAnimation)||n.remove(),this.progressAnimation=this.scene.add.tween({targets:[this.progressBarBg],duration:600,ease:Phaser.Math.Easing.Circular.InOut,props:{displayWidth:function(){var t=i.getCorrectValue(e);return i.getDisplayWidthByProcess(t)}},onUpdate:function(){var e=i.progressBarBg,t=e.x,n=e.displayWidth;i.progressBarRight.setX(t+n);var a=Math.floor(100*i.getProcessByDisplayWidth(n));i.loadingText.setText(""+i.scene.lang.Text.LOADING+a+"%")},onComplete:function(){i.updateProcess()}})},t}(r)},111:function(e,t,n){"use strict";n.d(t,{Z:function(){return p}});var i=n(33),a=n(5),s=n(1),r=n(66),o=n(2),c=function(e){function t(t){return e.call(this,{game:t,fragShader:"\nprecision mediump float;\n\nuniform sampler2D uMainSampler;\n// uniform vec2 uResolution; //khong co\nuniform float uCameraZoom;\n\nuniform vec2 iResolution;\n\nuniform vec4 lightPosition;\nuniform vec4 lightColor;\nuniform float lightRadius;\nuniform float lightAttenuation;\n\nvarying vec2 outTexCoord;\nvarying float outTintEffect;\nvarying vec4 outTint;\n\nvoid main (void)\n{\n    vec4 pos = vec4(0.2, 0.3, 1.0, 200);\n\n    // vec2 center = (lightPosition.xy + 1.0) * (iResolution.xy * 0.5);\n    // vec2 center = lightPosition.xy\n    float distToSurf = length(lightPosition.xy / uCameraZoom - gl_FragCoord.xy / uCameraZoom);\n    float radius = 1.0 - distToSurf / lightRadius;\n    /* if (distToSurf > 50.0) {\n        gl_FragColor = vec4(1.0, 1.0, 0.0, 1.0);\n        return; \n    } */\n    /* if (radius > 0.5) {\n        gl_FragColor = vec4(1.0, 1.0, 0.0, 1.0);\n        return; \n    } */\n    \n    float intensity = smoothstep(0.0, 1.0, radius * lightAttenuation);\n    /* if (intensity == 0.0) {\n        gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);\n        return;\n    } */\n\n    vec4 color = vec4(intensity, intensity, intensity, 0.0) * lightColor;\n    gl_FragColor = vec4(color.rgb * lightColor.a, color.a);\n}\n"})||this}return(0,s.Z)(t,e),t.prototype.onRender=function(e,t){this.set1f("uCameraZoom",t.zoom)},t}(Phaser.Renderer.WebGL.Pipelines.SinglePipeline);c.KEY="GlowLightPipeLine";var l=c,u=o.Z.DEFAULT_8_BIT,h=u.KEY,d=u.FRAME,p=function(e){function t(t,n){var s;return(s=e.call(this,t)||this).config=void 0,s.shaderSprite=void 0,s.isWebGl=!0,s.lightRadius=0,s.config=(0,i.Z)({background:0,bottomRightCorner:221341,rightEdge:423092,bottomEdge:83583,mainTopColorGradient:732242,mainBotColorGradient:155294,shadowHeight:7,bgCornerStrokeWidth:2,topInnerCornerStrokeWidth:4,botInnerCornerStrokeWidth:4,rightInnerCornerStrokeWidth:4,lightX:0,lightY:0},n),s.scene.game.canvas.getContext("webgl")||(s.isWebGl=!1),s.isWebGl&&!s.scene.game.renderer.pipelines.pipelines.has(l.KEY)&&s.scene.game.renderer.pipelines.add(l.KEY,new l(s.scene.game)),s.setDepth(r.Z.POPUP),s.createGraphicsPopup(),s.createShaderSprite(),s.createLightEffect(),s.updateSize(),s.scene.add.existing((0,a.Z)(s)),s}(0,s.Z)(t,e);var n=t.prototype;return n.updateSize=function(){var e=this.config,t=e.width,n=e.height;this.setSize(t,n)},n.createGraphicsPopup=function(){var e=this.config,t=e.x,n=e.y,i=e.width,a=e.height,s=e.background,r=e.bottomRightCorner,o=e.rightEdge,c=e.bottomEdge,l=e.mainBotColorGradient,u=e.mainTopColorGradient,h=e.shadowHeight,d=e.bgCornerStrokeWidth,p=e.topInnerCornerStrokeWidth,f=e.botInnerCornerStrokeWidth,g=e.rightInnerCornerStrokeWidth,E=this.scene.make.graphics({}),m=new Phaser.Geom.Rectangle(t-i/2,n-a/2,i,a);E.fillStyle(0,.3),E.fillRoundedRect(m.left,m.bottom-10,m.width,10+h,{tl:0,tr:0,bl:12,br:12}),E.fillStyle(s),E.fillRoundedRect(m.left,m.top,m.width,m.height,{tl:8,tr:8,bl:12,br:12}),E.fillStyle(r),E.fillRoundedRect(m.left+d,m.bottom-50,m.width-2*d,50-d,{tl:0,tr:0,bl:30,br:8}),E.fillStyle(o),E.fillRoundedRect(m.left+d,m.top+d,m.width-2*d,m.height-2*d-f,{tl:8,tr:8,bl:30,br:12}),E.fillStyle(c),E.fillRoundedRect(m.left+d,m.bottom-50,m.width-2*d-g,50-d,{tl:8,tr:0,bl:8,br:3}),E.fillGradientStyle(u,u,l,l),E.fillRect(m.left+d,m.top+d+p+10,m.width-2*d-g,m.height-2*d-f-p-20),E.fillStyle(u),E.fillRoundedRect(m.left+d,m.top+d+p,m.width-2*d-g,10,{tl:8,tr:8,bl:0,br:0}),E.fillStyle(l),E.fillRoundedRect(m.left+d,m.bottom-d-f-10,m.width-2*d-g,7,{tl:0,tr:0,bl:3,br:0}),this.add(E)},n.createShaderSprite=function(){var e=this.config,t=e.width,n=e.height,i=this.scene.make.image({key:h,frame:d.BLANK});i.setWorldSize(t,n),this.add(i),this.shaderSprite=i,this.shaderSprite.kill()},n.createLightEffect=function(){var e,t;if(this.isWebGl){var n=this.config,i=n.width,a=n.mainTopColorGradient;this.shaderSprite.revive(),this.shaderSprite.setPipeline(l.KEY);var s=Phaser.Display.Color.ColorToRGBA(a),r=new Phaser.Display.Color(s.r,s.g,s.b,s.a);r.lighten(90);var o=Phaser.Display.Color.ColorToRGBA(r.color),c=null==(e=this.scene.game.canvas.getContext("webgl"))?void 0:e.drawingBufferWidth,u=null==(t=this.scene.game.canvas.getContext("webgl"))?void 0:t.drawingBufferHeight;if(c&&"number"===typeof c&&u&&"number"===typeof u){this.lightRadius=i/1.2,this.recalculateLightPosition();this.shaderSprite.pipeline.set2f("iResolution",c,u),this.shaderSprite.pipeline.set4f("lightColor",o.r/255*1,o.g/255*1,o.b/255*1,.4),this.shaderSprite.pipeline.set1f("lightRadius",this.lightRadius),this.shaderSprite.pipeline.set1f("lightAttenuation",1)}}},n.turnOffLight=function(){this.shaderSprite.kill(),this.shaderSprite.resetPipeline()},n.recalculateLightPosition=function(){var e,t;if(this.isWebGl&&this.shaderSprite.active){var n=this.config,i=n.lightX,a=n.lightY,s=this.scene.gameZone,r=s.displayWidth,o=s.displayHeight,c=null==(e=this.scene.game.canvas.getContext("webgl"))?void 0:e.drawingBufferWidth,l=null==(t=this.scene.game.canvas.getContext("webgl"))?void 0:t.drawingBufferHeight;if(c&&"number"===typeof c&&l&&"number"===typeof l){var u=this.shaderSprite.getWorldPosition(),h=c*(u.x+i)/r,d=l*(o-(u.y+a))/o;this.shaderSprite.pipeline.set4f("lightPosition",h,d,1e3,this.lightRadius),this.shaderSprite.pipeline.set1f("lightRadius",this.lightRadius)}}},t}(Phaser.GameObjects.Container)},488:function(e,t,n){"use strict";n.d(t,{Z:function(){return d}});var i=n(57),a=n(1),s=n(59),r=n.n(s),o=n(91),c=n.n(o),l=n(31),u=n.n(l),h=n(652),d=(function(e){function t(t){var n;return(n=e.call(this,t,"UpdateAbleObject")||this).updateInfo=void 0,n}(0,a.Z)(t,e)}(Phaser.GameObjects.GameObject),function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).classType=void 0,i.listConfigs=void 0,i.padding=void 0,i.startObjectIndex=void 0,i.endObjectIndex=void 0,i.listObjects=void 0,i.classType=n.classType,i.listConfigs=n.listConfigs,i.padding=n.padding?n.padding:0,i.objects.classType=i.classType,i.updateConfig(i.listConfigs),i}(0,a.Z)(t,e);var n=t.prototype;return n.reset=function(){e.prototype.reset.call(this),this.killAndHideAll()},n.getChildren=function(){var e;return r()(e=this.listObjects).call(e,(function(e){return void 0!=e&&e.active}))},n.updateConfig=function(e){var t;this.reset(),this.listConfigs=e,this.listObjects=c()(t=new Array(e.length)).call(t,void 0),this.addObjectIndex(0,0);var n=this.getEndObjectIndex();this.addObjectIndex(1,n),this.startObjectIndex=this.getStartObjectIndex(),this.endObjectIndex=this.getEndObjectIndex(),this.updateMaxHeight(),this.value=this.marginTop},n.getConfig=function(){return this.listConfigs},n.killAndHideAll=function(){var e,t=this;this.listObjects instanceof Array&&u()(e=this.listObjects).call(e,(function(e){void 0!==e&&t.objects.killAndHide(e)}))},n.setItemPosition=function(e,t){var n=e.height;e.setPosition(0,n/2+(n+this.padding)*t-this.height/2)},n.updateMaxHeight=function(){return this.maxHeight=Math.max(this.listConfigs.length*(this.objHeight+this.padding)-this.padding+this.marginBottom-this.height,0)},n.updateObject=function(e){this.objects.incY(e);var t=this.getStartObjectIndex(),n=this.getEndObjectIndex();t!=this.startObjectIndex&&(t>this.startObjectIndex?this.killObjectIndex(this.startObjectIndex,t-1):this.addObjectIndex(t,this.startObjectIndex-1),this.startObjectIndex=t),n!=this.endObjectIndex&&(n<this.endObjectIndex?this.killObjectIndex(n+1,this.endObjectIndex):this.addObjectIndex(this.endObjectIndex+1,n),this.endObjectIndex=n)},n.killObjectIndex=function(e,t){for(var n=e;n<=t;n++){var i=this.listObjects[n];i&&(this.objects.killAndHide(i),this.listObjects[n]=void 0)}},n.addObjectIndex=function(e,t){for(var n=e;n<=t;n++){var i=this.padding,a=this.listConfigs;if(n>=a.length)return;var s=this.objects.getFirstDead(!0),r=s.height,o=r/2+(r+i)*n+this.value-this.height/2;s.updateInfo(a[n]),s.setPosition(0,o),s.setActive(!0),s.setVisible(!0),this.addAt(s),this.listObjects[n]=s}},n.getStartObjectIndex=function(){var e=this.objHeight,t=this.padding;return Math.max(Math.floor((0-this.value)/(e+t)),0)},n.getEndObjectIndex=function(){var e=this.objHeight,t=this.padding,n=this.listConfigs,i=e+t;return Math.min(Math.floor((this.height-this.value)/i),n.length)},(0,i.Z)(t,[{key:"objHeight",get:function(){var e=this.objects.getChildren();return 0==e.length?this.maxHeight=0:e[0].height}}]),t}(h.Z))},652:function(e,t,n){"use strict";var i=n(33),a=n(57),s=n(5),r=n(1),o=n(31),c=n.n(o),l=n(101),u=n.n(l),h=n(91),d=n.n(h),p=n(59),f=n.n(p),g=n(46),E=n.n(g),m=n(69),v=n.n(m),A=n(90),S=n.n(A),T=n(132),y=n.n(T),C=n(66),I=n(156);function R(e,t){var n="undefined"!==typeof S()&&y()(e)||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){var n;if(!e)return;if("string"===typeof e)return w(e,t);var i=E()(n=Object.prototype.toString.call(e)).call(n,8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return v()(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return w(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var _=function(e){function t(t,n){var a,r;(r=e.call(this,t)||this).config=void 0,r.isEnable=void 0,r.maxHeight=void 0,r.isScrolling=void 0,r.boundTop=void 0,r.boundBottom=void 0,r.maskGraphics=void 0,r.objects=void 0,r._value=0,r.velocity=0,r.isScrollingSmooth=void 0,r.lastScrollY=void 0,r.isScrollingBack=void 0,r.scrollingBackTo=void 0,r.lastScrollYCount=0,r.hitArea=void 0,r.onScrollEvents=[],r.update=function(e,t){r.isScrollingSmooth&&r.velocity&&r.scrollingSmooth(t),r.isScrollingBack&&r.scrollingBack(t)},r.checkReachBound=function(){return r.isReachTop()||r.isReachBottom()},r.onMouseScroll=(0,I.D)((function(e,t,n){if(r.isEnable){var i;if(r.isScrolling=!0,r.checkReachBound())return r.lastScrollY=c()(i=r.lastScrollY).call(i,(function(){return 0})),void(r.isScrolling=!1);r.stopScrollingBack(),r.startScrollSmooth(-n*r.scrollSmooth/15)}}),100,{isImmediate:!0,maxWait:100}),r.onTouchScroll=function(e){if(r.isEnable){r.velocity&&r.stopScrollSmooth(),r.stopScrollingBack(),r.isScrolling=!0;var t=r.scene.game.world.getZoomRatio(),n=e.position,i=e.prevPosition,a=(n.y-i.y)/t,s=r.height*r.maxScrollOver,o=1;if(r.lastScrollY[++r.lastScrollYCount%r.lastScrollY.length]=a,r.isReachTop()&&a>=0){var c=(s-(r.value-r.marginTop))/s;o=Math.min(o,c)}if(r.isReachBottom()&&a<=0){var l=(s-(-r.maxHeight-r.value))/s;o=Math.min(o,l)}var u=a*o,h=r.maxScrollOver*r.height;r.value+u>r.marginTop+h?r.value=r.marginTop+h:r.value+u<-r.maxHeight-h?r.value=-r.maxHeight-h:r.value+=u,r.callOnScrollEvents(r.value,u)}},r.onTouchDown=function(){r.isEnable&&(r.velocity&&r.stopScrollSmooth(),r.stopScrollingBack())},r.onTouchEnd=function(){var e,t;if(r.isReachTop()&&(r.startScrollingBack(r.marginTop),r.stopScrollSmooth()),r.isReachBottom()&&(r.startScrollingBack(-r.maxHeight),r.stopScrollSmooth()),r.isScrolling){var n=u()(e=r.lastScrollY).call(e,(function(e,t){return e+t}))/r.lastScrollY.length;r.startScrollSmooth(n*r.scrollSmooth),r.lastScrollY=c()(t=r.lastScrollY).call(t,(function(){return 0}))}},r.config=(0,i.Z)({marginTop:0,marginBottom:0,acceleration:1400,maxScrollOver:.15,scrollSmooth:40,scrollingBackRate:5},n);var o=n.width,l=n.height;return r.isEnable=!1,r.maxHeight=0,r.lastScrollY=d()(a=new Array(3)).call(a,0),r.setSize(o,l),r.createGroup(),r.createInput(),r.createEvents(),r.scene.add.existing((0,s.Z)(r)),r}(0,r.Z)(t,e);var n=t.prototype;return n.onScroll=function(e){this.onScrollEvents.push(e)},n.gotoTop=function(){this.value=this.config.marginTop},n.reset=function(){this.maxHeight=0,this.isScrolling=!1,this.isScrollingBack=!1,this.isScrollingSmooth=!1,this.gotoTop(),this.setEnable(!1)},n.createDebug=function(){var e=this.drawDebugBox(16711680,.8);console.log(null==e?void 0:e.x,null==e?void 0:e.y,null==e?void 0:e.displayWidth,null==e?void 0:e.displayHeight)},n.setEnable=function(e){this.isEnable=e,e?this.setInteractive({draggable:!0,useHandCursor:!0}):this.disableInteractive()},n.addItem=function(e){this.addAt(e),this.objects.add(e);var t=e.y+e.height+this.marginBottom-this.height/2;this.maxHeight=Math.max(this.maxHeight,t,0),this.updateObjectVisible()},n.addItems=function(e){var t=this;this.addAt(e),this.objects.addMultiple(e);var n=c()(e).call(e,(function(e){return e.y+e.height+t.marginBottom-t.height/2}));this.maxHeight=Math.max(this.maxHeight,Math.max.apply(Math,n),0),this.updateObjectVisible()},n.clearItem=function(){this.objects.clear(!0,!0),this.reset()},n.getChildren=function(){var e;return f()(e=this.objects.getChildren()).call(e,(function(e){return e.active}))},n.createBound=function(e,t,n,i){this.boundTop=this.scene.make.image({key:e,frame:t}),this.boundBottom=this.scene.make.image({key:e,frame:t}),this.boundTop.setTint(i),this.boundBottom.setTint(i),this.boundTop.setAlpha(1,1,0,0),this.boundBottom.setAlpha(0,0,1,1),this.boundTop.setDepth(C.Z.PRIORITY),this.boundBottom.setDepth(C.Z.PRIORITY);var a=this.width,s=n,r=this.getWorldPosition(),o=r.x,c=r.y;this.boundTop.setDisplaySize(a,s),this.boundBottom.setDisplaySize(a,s),this.boundTop.setY(-this.displayHeight/2+s/2+c-this.y-1),this.boundBottom.setY(this.displayHeight/2-s/2+c-this.y+1),this.boundTop.setX(o-this.x),this.boundBottom.setX(o-this.x),this.add([this.boundTop,this.boundBottom])},n.createMask=function(){var e;null==(e=this.maskGraphics)||e.destroy(),this.maskGraphics=this.scene.make.graphics({fillStyle:{color:255,alpha:1}}),this.maskGraphics.setName("MaskGraphics");var t=this.width,n=this.height;this.maskGraphics.fillRoundedRect(0-t/2,0-n/2,t,n,0),this.setMask(this.maskGraphics.createGeometryMask()),this.scene.events.off(Phaser.Scenes.Events.UPDATE,this.updateMask,this),this.scene.events.on(Phaser.Scenes.Events.UPDATE,this.updateMask,this)},n.updateMask=function(){var e=this.getWorldPosition(),t=e.x,n=e.y;this.maskGraphics.setPosition(t,n)},n.createGroup=function(){this.objects=this.scene.make.group({})},n.updateObject=function(e){this.objects.incY(e),this.updateObjectVisible()},n.updateObjectVisible=function(){for(var e=this.objects.getChildren(),t=0;t<e.length;t++){var n=e[t];n.y+n.height<-this.height/2||n.y-n.height>this.height/2?n.setVisible(!1):n.setVisible(!0)}},n.createInput=function(){this.setInteractive({draggable:!0,useHandCursor:!0}),this.on(Phaser.Input.Events.POINTER_WHEEL,this.onMouseScroll),this.on(Phaser.Input.Events.GAMEOBJECT_DRAG,this.onTouchScroll),this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,this.onTouchDown),this.scene.input.on(Phaser.Input.Events.POINTER_UP,this.onTouchEnd,this)},n.createEvents=function(){this.scene.events.on(Phaser.Scenes.Events.UPDATE,this.update)},n.callOnScrollEvents=function(e,t){for(var n,i=R(this.onScrollEvents);!(n=i()).done;){(0,n.value)(this,e,t)}},n.scrollingBack=function(e){var t=(this.scrollingBackTo-this.value)*e*this.scrollingBackRate/1e3;this.value+=t,Math.abs(this.scrollingBackTo-this.value)<.5&&(this.value=this.scrollingBackTo,this.stopScrollingBack()),this.callOnScrollEvents(this.value,t)},n.startScrollingBack=function(e){this.isScrollingBack=!0,this.scrollingBackTo=e},n.stopScrollingBack=function(){this.isScrollingBack=!1},n.scrollingSmooth=function(e){var t=this.velocity*e/1e3;this.value+=t;var n=Math.abs(this.velocity)/this.velocity;this.velocity-=n*this.acceleration*e/1e3,Math.abs(this.velocity)<this.acceleration*e/1e3&&this.stopScrollSmooth(),this.isReachTop()&&(this.startScrollingBack(this.marginTop),this.stopScrollSmooth()),this.isReachBottom()&&(this.startScrollingBack(-this.maxHeight),this.stopScrollSmooth()),this.callOnScrollEvents(this.value,t)},n.startScrollSmooth=function(e){this.isScrollingSmooth=!0,e&&(e*this.velocity>0?this.velocity+=e:this.velocity=e)},n.stopScrollSmooth=function(){this.isScrollingSmooth=!1,this.isScrolling=!1,this.velocity=0},n.isReachTop=function(){return this.value>this.marginTop},n.isReachBottom=function(){return-this.value>this.maxHeight},(0,a.Z)(t,[{key:"marginTop",get:function(){return this.config.marginTop}},{key:"marginBottom",get:function(){return this.config.marginBottom}},{key:"acceleration",get:function(){return this.config.acceleration}},{key:"maxScrollOver",get:function(){return this.config.maxScrollOver}},{key:"scrollSmooth",get:function(){return this.config.scrollSmooth}},{key:"scrollingBackRate",get:function(){return this.config.scrollingBackRate}},{key:"value",get:function(){return this._value},set:function(e){var t=e-this._value;this._value=e,this.updateObject(t)}}]),t}(Phaser.GameObjects.Container);t.Z=_},160:function(e,t,n){"use strict";var i=n(5),a=n(1),s=function(e){function t(t,n){var a;return(a=e.call(this,t)||this).payload=void 0,a.mainText=void 0,a.shadowText=void 0,a.payload=n,a.createMainText(),a.createShadowText(),a.updateSize(),a.moveDown(a.shadowText),a.scene.add.existing((0,i.Z)(a)),a}(0,a.Z)(t,e);var n=t.prototype;return n.setText=function(e){this.mainText.setText(e),this.shadowText.setText(e),this.updateSize()},n.setTintText=function(e,t,n,i){this.mainText.setTint(e,t,n,i)},n.setDropShadow=function(e,t,n,i){void 0===i&&(i=1),this.shadowText.setVisible(!0),this.shadowText.setTint(n),this.shadowText.setAlpha(i),Phaser.Display.Align.In.Center(this.shadowText,this.mainText,e,t)},n.updateSize=function(){var e=this.mainText,t=e.width,n=e.height;this.setSize(t,n)},n.createMainText=function(){var e=this.payload.origin;this.mainText=this.scene.make.bitmapText({font:this.payload.font,size:this.payload.size,origin:e||{x:.5,y:.5}}),this.add(this.mainText)},n.createShadowText=function(){var e=this.payload.origin;this.shadowText=this.scene.make.bitmapText({font:this.payload.font,size:this.payload.size,origin:e||{x:.5,y:.5},visible:!1}),this.add(this.shadowText)},n.setFontSize=function(e){this.mainText.setFontSize(e),this.shadowText.setFontSize(e),this.updateSize()},t}(Phaser.GameObjects.Container);t.Z=s},492:function(e,t,n){"use strict";var i=n(5),a=n(1),s=n(2).Z.GAMEPLAY,r=s.KEY,o=s.FRAME,c=function(e){function t(t){var n;return(n=e.call(this,t)||this).hand=void 0,n.name="TapTutorialHand",n.addHand(),n.scene.add.existing((0,i.Z)(n)),n}(0,a.Z)(t,e);var n=t.prototype;return n.addHand=function(){this.hand=this.scene.make.image({key:r,frame:o.GUIDE_HAND,origin:{x:.5,y:.5}}),this.hand.setWorldSize(65.5,55.5),this.setSize(65.5,55.5),this.add(this.hand)},n.playAnimation=function(e,t){var n,i=this;void 0===e&&(e=0),void 0===t&&(t=800);var a=1/this.scene.world.getPixelRatio();this.hand.angle=30,null==(n=this.scene)||n.tweens.add({delay:e,targets:[this.hand],ease:Phaser.Math.Easing.Cubic.Out,props:{alpha:{start:0,value:1,duration:200},scale:{duration:400,start:1.6*a,to:1.2*a},angle:{from:30,value:0,duration:400}},onComplete:function(){var e;null==(e=i.scene)||e.tweens.add({targets:[i.hand],delay:200,duration:200,ease:Phaser.Math.Easing.Cubic.Out,props:{alpha:0},onComplete:function(){i.hand.x=0,i.hand.y=0,i.hand.scale=a,i.playAnimation(t)}})}})},n.stopAnimation=function(){this.scene.tweens.killTweensOf(this.hand)},n.preDestroy=function(){this.scene.tweens.killTweensOf(this.hand)},t}(Phaser.GameObjects.Container);t.Z=c},659:function(e,t,n){"use strict";var i=n(2).Z.EFFECTS,a=i.KEY,s=i.FRAME,r={CONFETTI_HEXAGON:{KEY:"confetti-hexagon-animation",TEXTURE:a,PREFIX:s.FX_CONFETTI_HEXAGON,FRAME_RATE:8,END:5,ZERO_PAD:0},CONFETTI_STAR_X:{KEY:"confetti-star-x",TEXTURE:a,PREFIX:s.ANIMATION_STAR_X,FRAME_RATE:4,END:4,ZERO_PAD:0},CONFETTI_STAR_Y:{KEY:"confetti-star-y",TEXTURE:a,PREFIX:s.ANIMATION_STAR_Y,FRAME_RATE:4,END:4,ZERO_PAD:0},RIBBON_A:{KEY:"animation-ribbon-a",TEXTURE:a,PREFIX:s.PREFIX_ANIMATION_RIBBON_CONFETTI_A,FRAME_RATE:16,END:3,ZERO_PAD:0},RIBBON_B:{KEY:"animation-ribbon-b",TEXTURE:a,PREFIX:s.PREFIX_ANIMATION_RIBBON_CONFETTI_B,FRAME_RATE:16,END:4,ZERO_PAD:0},RIBBON_C:{KEY:"animation-ribbon-c",TEXTURE:a,PREFIX:s.PREFIX_ANIMATION_RIBBON_CONFETTI_C,FRAME_RATE:16,END:4,ZERO_PAD:0},RIBBON_D:{KEY:"animation-ribbon-d",TEXTURE:a,PREFIX:s.PREFIX_ANIMATION_RIBBON_CONFETTI_D,FRAME_RATE:16,END:4,ZERO_PAD:0}};t.Z=r},66:function(e,t){"use strict";t.Z={FIELD_BACKGROUND:0,BACKGROUND:1,FIREWORKS:5,FIELD_SQUARE:10,FIELD_SQUARE_RECT:11,MANAGER_BASE_DEPTH:20,ENCOURAGING:31,MESSAGE:33,POPUP:40,DEPTH_ON_DRAG:70,UNIT_HP_BAR:71,DMG_POPUP_NUMBER:80,BUTTON:90,ITEM:91,EFFECT:95,PRIORITY:100,TUTORIAL_OBJECT:101,DEBUG:110,ON_TOP:1e4}},34:function(e,t){"use strict";t.Z={PRIMARY:{KEY:"LilitaOne-ru",TEXTURE:"./assets/fonts/LilitaOne-ru.png",DATA:"./assets/fonts/LilitaOne-ru.xml"},SYSTEM_FAMILY_FONT:'-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",sans-serif',FONT_FAMILY:"LilitaOne"}},84:function(e,t,n){"use strict";var i=(0,n(460).t)(),a={AVATAR:{KEY:"avatar",FILE:"./assets/images/others/avatar.png",CONFIG:{}},ICON_EARTH:{KEY:"icon-earth",FILE:"./assets/images/others/icon-earth.png",CONFIG:{}},BG_DESERT:{KEY:"background_desert",FILE:"./assets/images/"+i+"x/bg_desert.jpg",CONFIG:{}},BG_ICE:{KEY:"background_ice",FILE:"./assets/images/"+i+"x/bg_ice.jpg",CONFIG:{}},BG_TREE:{KEY:"background_tree",FILE:"./assets/images/"+i+"x/bg_tree.jpg",CONFIG:{}},BG_VOLCANO:{KEY:"background_volcano",FILE:"./assets/images/"+i+"x/bg_volcano.jpg",CONFIG:{}},BG_CRYSTAL:{KEY:"background_crystal",FILE:"./assets/images/"+i+"x/bg_crystal.jpg",CONFIG:{}},BG_LANDSCAPE_DESERT:{KEY:"background_landscape_desert",FILE:"./assets/images/"+i+"x/bg_landscape_desert.jpg",CONFIG:{}},BG_LANDSCAPE_ICE:{KEY:"background_landscape_ice",FILE:"./assets/images/"+i+"x/bg_landscape_ice.jpg",CONFIG:{}},BG_LANDSCAPE_TREE:{KEY:"background_landscape_tree",FILE:"./assets/images/"+i+"x/bg_landscape_tree.jpg",CONFIG:{}},BG_LANDSCAPE_VOLCANO:{KEY:"background_landscape_volcano",FILE:"./assets/images/"+i+"x/bg_landscape_volcano.jpg",CONFIG:{}},BG_LANDSCAPE_CRYSTAL:{KEY:"background_landscape_crystal",FILE:"./assets/images/"+i+"x/bg_landscape_crystal.jpg",CONFIG:{}}};t.Z=a},2:function(e,t,n){"use strict";var i=n(33),a=(0,n(460).t)(),s={DEFAULT_8_BIT:{KEY:"default-8bit-resources",PATH:"./assets/textures/"+a+"x/",JSON:"./assets/textures/"+a+"x/default-8bit-resources.json",FRAME:{BLANK:"blank",CHALLENGE_BACK_EFFECT:"challenge-screen/back-effect",CHALLENGE_FX:"challenge-screen/fx",CHALLENGE_GLOW:"challenge-screen/glow",CHALLENGE_GRADE_BLUE:"challenge-screen/grade-blue",CHALLENGE_GRADE_RED:"challenge-screen/grade-red",CHALLENGE_ICON_ENERGY:"challenge-screen/icon-energy",CHALLENGE_SHAPE:"challenge-screen/shape",CHALLENGE_VS:"challenge-screen/vs",RESULT_SCREEN_FX_WIN:"result-screen/win-fx",RESULT_SCREEN_FX_LOSE:"result-screen/lose-fx",RESULT_SCREEN_GOLD_ICON:"result-screen/golds",RESULT_SCREEN_GREEN_BUTTON:"result-screen/green-button",RESULT_SCREEN_SINGLE_COIN_ICON:"result-screen/mini-gold",RESULT_SCREEN_LEVEL_COMPLETE_TEXT:"result-screen/level-complete",RESULT_SCREEN_CONTINUE_TEXT:"result-screen/continue",RESULT_SCREEN_WIN_TEXT:"result-screen/victory",RESULT_SCREEN_CLAIM_TEXT:"result-screen/claim",RESULT_SCREEN_EARN_TEXT:"result-screen/you-earned",RESULT_SCREEN_RIBBON_WIN:"result-screen/ribbon-green",RESULT_SCREEN_RIBBON_LOSE:"result-screen/ribbon-red",RESULT_SCREEN_YELLOW_BUTTON:"result-screen/yellow-button",RESULT_SCREEN_GREEN_BUTTON_RESULT:"result-screen/green-button-result",UNIT_UNLOCK_GLOW:"unit-unlock/glow",UNIT_UNLOCK_BG:"unit-unlock/bg",UNIT_UNLOCK_BG_1:"unit-unlock/bg-1",UNIT_UNLOCK_FRAME:"unit-unlock/frame",UNIT_UNLOCK_ICON_BATTLE:"unit-unlock/icon-battle",UNIT_UNLOCK_ICON_HEART:"unit-unlock/icon-heart",UNIT_UNLOCK_ROTATE:"unit-unlock/rotate",UNIT_REWARD_ELLIPSE_FX:"unit-reward/ellipse-fx",UNIT_REWARD_FX:"unit-reward/fx",UNIT_REWARD_GLOW:"unit-reward/glow",UNIT_REWARD_GIFT:"unit-reward/gift",UNIT_REWARD_GIFT_GLOW:"unit-reward/gift-glow",UNIT_REWARD_NO_THANKS_TEXT:"unit-reward/no-thanks-text",UNIT_REWARD_GIFT_AD:"unit-reward/gift-ad",UNIT_REWARD_PARTICLE:"unit-reward/particle",TEXT_LOADING:"loading",PRELOADER:"preloader/dual-ring",LEADERBOARD_BG_DARK:"leaderboards/bg-dark",LEADERBOARD_BG_LIGHT:"leaderboards/bg-light",LEADERBOARD_BG_LOSE:"leaderboards/bg-lose",LEADERBOARD_BG_WIN:"leaderboards/bg-win",LEADERBOARD_TAB_BG:"leaderboards/tab-bg",LEADERBOARD_TAB_LINE:"leaderboards/tab-focus",LEADERBOARD_AVATAR:"leaderboards/avatar",LEADERBOARD_RANK_GOLD:"leaderboards/rank-gold",LEADERBOARD_RANK_SILVER:"leaderboards/rank-silver",LEADERBOARD_RANK_COPPER:"leaderboards/rank-copper",LEADERBOARD_BUTTON_GREEN:"leaderboards/green-button",RIBBON_GREEN:"ribbon/green",ICON_AD:"icons/ad-icon",ICON_VIBRATION:"icons/vib",ICON_MUSIC:"icons/music",ICON_SOUND:"icons/sound",ICON_SHARE:"icons/share",ICON_BATTLE:"icons/battle",ICON_TITLE:"icons/title",ICON_ALERT:"icons/alert",ICON_BACK_TO:"icons/back-to",ICON_REPLAY:"icons/replay",ICON_QUICK_FIGHT:"icons/quick-fight",BUTTON_CLOSE:"buttons/close",BUTTON_GREEN:"buttons/green",BUTTON_GREEN_LONG:"buttons/green-long",BUTTON_RED:"buttons/red",OFFLINE_REWARD_ADS:"offline-reward/ads",OFFLINE_REWARD_CLOSE_BTN:"offline-reward/close-btn",OFFLINE_REWARD_GOLD:"offline-reward/gold",OFFLINE_REWARD_GOLDS:"offline-reward/golds",OFFLINE_REWARD_GREEN_BTN:"offline-reward/green-btn",OFFLINE_REWARD_PARTICLE_1:"offline-reward/particle-1",OFFLINE_REWARD_PARTICLE_2:"offline-reward/particle-2",OFFLINE_REWARD_RIBBON:"offline-reward/ribbon",OFFLINE_REWARD_TICKET:"offline-reward/ticket",OFFLINE_REWARD_YELLOW_BTN:"offline-reward/yellow-btn",UNIT_SCREEN_AD_BUTTON:"unit-screen/ad-button",UNIT_SCREEN_AD_COUNT_BG:"unit-screen/ad-count-bg",UNIT_SCREEN_AD_ICON:"unit-screen/ad-icon",UNIT_SCREEN_BAR:"unit-screen/bar",UNIT_SCREEN_BG:"unit-screen/bg",UNIT_SCREEN_COIN_ICON:"unit-screen/coin-icon",UNIT_SCREEN_FRAME_1:"unit-screen/frame-1",UNIT_SCREEN_FRAME_LOCKED:"unit-screen/frame-locked",UNIT_SCREEN_ICON_BATTLE:"unit-screen/icon-battle",UNIT_SCREEN_ICON_HEART:"unit-screen/icon-heart",UNIT_SCREEN_ICON_LOCK:"unit-screen/icon-lock",UNIT_SCREEN_SLIDEBAR_BG:"unit-screen/slidebar-bg",UNIT_SCREEN_TAB_BG:"unit-screen/tab-bg",UNIT_SCREEN_TAB_FOCUS:"unit-screen/tab-focus",WHEEL_ARROW:"reward-wheel/arrow",WHEEL_LUCKY_SPIN:"reward-wheel/lucky-spin"}},DEFAULT:{KEY:"default-resources",TEXTURE:"./assets/textures/"+a+"x/default-resources.png",JSON:"./assets/textures/"+a+"x/default-resources.json",FRAME:{BLANK:"blank",RIBBON_BLUE:"ribbon/blue",PROGRESS_BAR_MID:"progress/bar-mid",PROGRESS_BG_LEFT:"progress/bg-left",PROGRESS_BG_MID:"progress/bg-mid",PROGRESS_BG_RIGHT:"progress/bg-right",PROGRESS_BAR_LEFT:"progress/bar-left",PROGRESS_BAR_RIGHT:"progress/bar-right",SETTINGS_SWITCH_ON:"settings/switch-on",SETTINGS_SWITCH_OFF:"settings/switch-off",TITLE_LINE:"settings/title-line",DASHBOARD_UNITBAR_BOTTOM_BG:"dashboard/unitbar-bottom-bg"}},EFFECTS:{KEY:"effects-resources",PATH:"./assets/textures/"+a+"x/",JSON:"./assets/textures/"+a+"x/effects-resources.json",FRAME:{BLANK:"blank",FX_COMET:"comet",FX_SPARK:"spark",FX_CIRCLE:"circle",FX_CIRCLE_LIGHT:"circle-light",FX_GLOW_LIGHT:"glow-light",FX_GLOW_SMALL:"glow-small",FX_STAR_WHITE:"star-white",FX_STAR_YELLOW:"star-yellow",FX_WHITE_GLOW:"white-glow",FX_CONFETTI_SMALL_1:"confetti/small-1",FX_CONFETTI_SMALL_2:"confetti/small-2",FX_CONFETTI_SMALL_3:"confetti/small-3",FX_CONFETTI_SMALL_4:"confetti/small-4",FX_CONFETTI_HEXAGON:"confetti/hexagon-",FX_FIREWORKS_SMALL:"fireworks/small",FX_FIREWORKS_BIG_0:"fireworks/big-explosive-0",FX_FIREWORKS_BIG_1:"fireworks/big-explosive-1",FX_FIREWORKS_SOAR_LINE:"fireworks/soar-line",FX_FIREWORKS_SOAR_CIRCLE:"fireworks/soar-circle",ANIMATION_STAR_X:"star-x/star-",ANIMATION_STAR_Y:"star-y/star-",PREFIX_ANIMATION_RIBBON_CONFETTI_A:"ribbon/falling-confetti/confetti-a/confetti-a-",PREFIX_ANIMATION_RIBBON_CONFETTI_B:"ribbon/falling-confetti/confetti-b/confetti-b-",PREFIX_ANIMATION_RIBBON_CONFETTI_C:"ribbon/falling-confetti/confetti-c/confetti-c-",PREFIX_ANIMATION_RIBBON_CONFETTI_D:"ribbon/falling-confetti/confetti-d/confetti-d-"}},ANIMATION_SCENE:{KEY:"effects-resources",PATH:"./assets/textures/"+a+"x/",JSON:"./assets/textures/"+a+"x/animation-scene-resources.json",FRAME:{BLANK:"blank",COIN:"coins/coin",COIN_SMALL:"coins/coin-small",COIN_SMALL_GREY:"coins/coin-small-grey",ANIMATION_STAR_X:"star-x/star-",ANIMATION_STAR_Y:"star-y/star-",FX_SPARK_YELLOW:"yellow-spark",FX_CONFETTI_RIBBON:"ribbon/ribbon",PREFIX_ANIMATION_RIBBON_CONFETTI_A:"ribbon/falling-confetti/confetti-a/confetti-a-",PREFIX_ANIMATION_RIBBON_CONFETTI_B:"ribbon/falling-confetti/confetti-b/confetti-b-",PREFIX_ANIMATION_RIBBON_CONFETTI_C:"ribbon/falling-confetti/confetti-c/confetti-c-",PREFIX_ANIMATION_RIBBON_CONFETTI_D:"ribbon/falling-confetti/confetti-d/confetti-d-"}},GAMEPLAY:{KEY:"gameplay-resources",TEXTURE:"./assets/textures/"+a+"x/gameplay-resources.png",JSON:"./assets/textures/"+a+"x/gameplay-resources.json",FRAME:{BLANK:"blank",GUIDE_HAND:"hand-guide/hand",GUIDE_ARROW_START:"hand-guide/arrow-start",GUIDE_ARROW_END:"hand-guide/arrow-end",GUIDE_ARROW_MIDDLE:"hand-guide/arrow-middle",HP_BAR_BG:"hp-bar/bg",TOOL_RESET:"dev-tool/reset",TOOL_EDIT:"dev-tool/edit",TOOL_ATTACK:"dev-tool/attack",TOOL_UNIT:"dev-tool/unit",ROCK:"projectiles/rock",JAVELIN:"projectiles/javelin",BOOMERANG:"projectiles/boomerang",MACE:"projectiles/mace",ARROW_1:"projectiles/arrow-1",ARROW_2:"projectiles/arrow-2",BOLT_1:"projectiles/bolt-1",BOLT_2:"projectiles/bolt-2",FIRE_RING:"projectiles/fire-ring",BLUE_FIRE:"projectiles/blue-fire",GREEN_FIRE:"projectiles/level11/green-fire-1",GREEN_FIRE_PREFIX:"projectiles/level11/green-fire-",DASHBOARD_AD_ICON:"dashboard/ad-icon",DASHBOARD_FREE_GOLD:"dashboard/btn-free-gold",DASHBOARD_FREE_GOLD_OFF:"dashboard/btn-free-gold-off",DASHBOARD_FREE_GOLD_GLOW:"dashboard/btn-free-gold-glow",DASHBOARD_COINBAR_COIN:"dashboard/coin-bar-coin",DASHBOARD_COINBAR_BG:"dashboard/coin-bar-bg",DASHBOARD_MINI_COIN:"dashboard/coin-mini",DASHBOARD_UNIT_LIST:"dashboard/btn-unit-list",DASHBOARD_UNITBAR_BG:"dashboard/unitbar-bg",DASHBOARD_UNITBAR_STAMPS:"dashboard/unitbar-stamps",DASHBOARD_UNITBAR_ARCHER:"dashboard/unitbar-archer",DASHBOARD_UNITBAR_DINO:"dashboard/unitbar-dino",DASHBOARD_START_BTN:"dashboard/btn-start",DASHBOARD_SETTINGS_BTN:"dashboard/btn-settings",DASHBOARD_LEADERBOARD_BTN:"dashboard/btn-leaderboard",DASHBOARD_BATTLE_BTN:"dashboard/btn-battle",DASHBOARD_SPEED_BTN_OFF:"dashboard/btn-speed-off",DASHBOARD_SPEED_BTN_ON:"dashboard/btn-speed-on",DASHBOARD_HPBAR_BG:"dashboard/bar/bg",DASHBOARD_HPBAR_FRONT:"dashboard/bar/bg-front",DASHBOARD_HPBAR_RED_LEFT:"dashboard/bar/red-bar/bar-left",DASHBOARD_HPBAR_RED_RIGHT:"dashboard/bar/red-bar/bar-right",DASHBOARD_HPBAR_RED_MID:"dashboard/bar/red-bar/bar-mid",DASHBOARD_HPBAR_RED:"dashboard/bar/red-bar/full-bar",DASHBOARD_HPBAR_RED_HEART:"dashboard/bar/red-bar/icon-heart-red",DASHBOARD_HPBAR_BLUE_LEFT:"dashboard/bar/blue-bar/bar-left",DASHBOARD_HPBAR_BLUE_RIGHT:"dashboard/bar/blue-bar/bar-right",DASHBOARD_HPBAR_BLUE_MID:"dashboard/bar/blue-bar/bar-mid",DASHBOARD_HPBAR_BLUE:"dashboard/bar/blue-bar/full-bar",DASHBOARD_HPBAR_BLUE_HEART:"dashboard/bar/blue-bar/icon-heart-blue",DASHBOARD_BATTLE_BUTTON_GREEN:"dashboard/btn-battle-green",DASHBOARD_BATTLE_ICON:"dashboard/icon-battle",DASHBOARD_MESSAGE_ICON:"dashboard/icon-message",DASHBOARD_AVATAR_FRAME_BLUE:"dashboard/avatar-frame-blue",DASHBOARD_AVATAR_FRAME_RED:"dashboard/avatar-frame-red",DASHBOARD_VS:"dashboard/vs",DASHBOARD_UNITBAR_BG_LANDSCAPE:"dashboard/unitbar-bg-landscape",DASHBOARD_AD_ICON_LANDSCAPE:"dashboard/ad-icon-landscape",DASHBOARD_START_BTN_LANDSCAPE:"dashboard/btn-start-landscape",PURPLE_EFFECT:"effect-text/purple-effect",EFFECT_WIN_GLOW:"effect-text/win/glow",EFFECT_WIN_SHAPE_ABOVE:"effect-text/win/shape-above",EFFECT_WIN_SHAPE_BELOW:"effect-text/win/shape-below",EFFECT_LOSE_GLOW:"effect-text/lose/glow",EFFECT_LOSE_SHAPE_ABOVE:"effect-text/lose/shape-above",EFFECT_LOSE_SHAPE_BELOW:"effect-text/lose/shape-below"}},UNITS:{KEY:"units-resources",PATH:"./assets/textures/"+a+"x/",JSON:"./assets/textures/"+a+"x/units-resources.json",FRAME:{DINO_MALE_DOUX_PREFIX:"dino/male/doux/doux-",DINO_MALE_KIRA_PREFIX:"dino/male/kira/kira-",DINO_MALE_LOKI_PREFIX:"dino/male/loki/loki-",DINO_MALE_MORT_PREFIX:"dino/male/mort/mort-",DINO_MALE_NICO_PREFIX:"dino/male/nico/nico-",DINO_MALE_OLAF_PREFIX:"dino/male/olaf/olaf-",DINO_MALE_TARD_PREFIX:"dino/male/tard/tard-",DINO_MALE_VITA_PREFIX:"dino/male/vita/vita-",DINO_FEMALE_DOUX_PREFIX:"dino/female/doux/doux-",DINO_FEMALE_KIRA_PREFIX:"dino/female/kira/kira-",DINO_FEMALE_LOKI_PREFIX:"dino/female/loki/loki-",DINO_FEMALE_MORT_PREFIX:"dino/female/mort/mort-",DINO_FEMALE_NICO_PREFIX:"dino/female/nico/nico-",DINO_FEMALE_OLAF_PREFIX:"dino/female/olaf/olaf-",DINO_FEMALE_TARD_PREFIX:"dino/female/tard/tard-",DINO_FEMALE_VITA_PREFIX:"dino/female/vita/vita-",LOCKED:{MELEE:{1:"dino-locked/lv01-velociraptor",2:"dino-locked/lv02-saurolophus",3:"dino-locked/lv03-pachysaurus",4:"dino-locked/lv04-triceratops",5:"dino-locked/lv05-stegosaurus",6:"dino-locked/lv06-ankylosaurus",7:"dino-locked/lv07-baroptiloraptor",8:"dino-locked/lv08-tyrannosaurus",9:"dino-locked/lv09-dilophosaurus",10:"dino-locked/lv10-triceradonosaurus",11:"dino-locked/lv11-spinosaurus-rex"},RANGED:{1:"warriors-locked/lv01-rockthrower",2:"warriors-locked/lv02-javelineer",3:"warriors-locked/lv03-boomeranger",4:"warriors-locked/lv04-macer",5:"warriors-locked/lv05-artemis",6:"warriors-locked/lv06-william",7:"warriors-locked/lv07-blanchette",8:"warriors-locked/lv08-phantom",9:"warriors-locked/lv09-oracle",10:"warriors-locked/lv10-shaman",11:"warriors-locked/lv11-seraph"}},UNLOCKED:{MELEE:{1:"dino-unlocked/lv01-velociraptor",2:"dino-unlocked/lv02-saurolophus",3:"dino-unlocked/lv03-pachysaurus",4:"dino-unlocked/lv04-triceratops",5:"dino-unlocked/lv05-stegosaurus",6:"dino-unlocked/lv06-ankylosaurus",7:"dino-unlocked/lv07-baroptiloraptor",8:"dino-unlocked/lv08-tyrannosaurus",9:"dino-unlocked/lv09-dilophosaurus",10:"dino-unlocked/lv10-triceradonosaurus",11:"dino-unlocked/lv11-spinosaurus-rex"},RANGED:{1:"warriors-unlocked/lv01-rockthrower",2:"warriors-unlocked/lv02-javelineer",3:"warriors-unlocked/lv03-boomeranger",4:"warriors-unlocked/lv04-macer",5:"warriors-unlocked/lv05-artemis",6:"warriors-unlocked/lv06-william",7:"warriors-unlocked/lv07-blanchette",8:"warriors-unlocked/lv08-phantom",9:"warriors-unlocked/lv09-oracle",10:"warriors-unlocked/lv10-shaman",11:"warriors-unlocked/lv11-seraph"}}}},UNITS_SPRITES:{KEY:"units-sprite-resources",PATH:"./assets/textures/"+a+"x/",JSON:"./assets/textures/"+a+"x/units-sprite-resources.json",FRAME:{MELEE:{1:{MAIN_TEXTURE:"melee-1/idle/idle-00",ATTACK_PREFIX:"melee-1/attack/attack-",DIE_PREFIX:"melee-1/die/die-",IDLE_PREFIX:"melee-1/idle/idle-",RUN_PREFIX:"melee-1/run/run-"}},RANGED:{1:{MAIN_TEXTURE:"ranged-1/idle/idle-00",ATTACK_PREFIX:"ranged-1/attack/attack-",DIE_PREFIX:"ranged-1/die/die-",IDLE_PREFIX:"ranged-1/idle/idle-"}}}},UNITS_SPINES:{MELEE:{1:{KEY:"velociraptor-spine",jsonPATH:"./assets/spines/units/melee-1/velociraptor.json",atlasPATH:"./assets/spines/units/melee-1/velociraptor.atlas"},2:{KEY:"saurolophus-spine",jsonPATH:"./assets/spines/units/melee-2/saurolophus.json",atlasPATH:"./assets/spines/units/melee-2/saurolophus.atlas"},3:{KEY:"pachysaurus-spine",jsonPATH:"./assets/spines/units/melee-3/pachysaurus.json",atlasPATH:"./assets/spines/units/melee-3/pachysaurus.atlas"},4:{KEY:"triceratops-spine",jsonPATH:"./assets/spines/units/melee-4/triceratops.json",atlasPATH:"./assets/spines/units/melee-4/triceratops.atlas"},5:{KEY:"stegosaurus-spine",jsonPATH:"./assets/spines/units/melee-5/stegosaurus.json",atlasPATH:"./assets/spines/units/melee-5/stegosaurus.atlas"},6:{KEY:"ankyntrosaurus-spine",jsonPATH:"./assets/spines/units/melee-6/ankyntrosaurus.json",atlasPATH:"./assets/spines/units/melee-6/ankyntrosaurus.atlas"},7:{KEY:"baroptiloraptor-spine",jsonPATH:"./assets/spines/units/melee-7/baroptiloraptor.json",atlasPATH:"./assets/spines/units/melee-7/baroptiloraptor.atlas"},8:{KEY:"tyrannosaurus-spine",jsonPATH:"./assets/spines/units/melee-8/tyrannosaurus.json",atlasPATH:"./assets/spines/units/melee-8/tyrannosaurus.atlas"},9:{KEY:"dilophosaurus-spine",jsonPATH:"./assets/spines/units/melee-9/dilophosaurus.json",atlasPATH:"./assets/spines/units/melee-9/dilophosaurus.atlas"},10:{KEY:"triceradonosaurus-spine",jsonPATH:"./assets/spines/units/melee-10/triceradonosaurus.json",atlasPATH:"./assets/spines/units/melee-10/triceradonosaurus.atlas"},11:{KEY:"spinosaurus-rex-spine",jsonPATH:"./assets/spines/units/melee-11/spinosaurus-rex.json",atlasPATH:"./assets/spines/units/melee-11/spinosaurus-rex.atlas"}},RANGED:{1:{KEY:"rockthrower-spine",jsonPATH:"./assets/spines/units/ranged-1/rockthrower.json",atlasPATH:"./assets/spines/units/ranged-1/rockthrower.atlas"},2:{KEY:"javelineer-spine",jsonPATH:"./assets/spines/units/ranged-2/javelineer.json",atlasPATH:"./assets/spines/units/ranged-2/javelineer.atlas"},3:{KEY:"boomeranger-spine",jsonPATH:"./assets/spines/units/ranged-3/boomeranger.json",atlasPATH:"./assets/spines/units/ranged-3/boomeranger.atlas"},4:{KEY:"macer-spine",jsonPATH:"./assets/spines/units/ranged-4/macer.json",atlasPATH:"./assets/spines/units/ranged-4/macer.atlas"},5:{KEY:"artemis-spine",jsonPATH:"./assets/spines/units/ranged-5/artemis.json",atlasPATH:"./assets/spines/units/ranged-5/artemis.atlas"},6:{KEY:"william-spine",jsonPATH:"./assets/spines/units/ranged-6/william.json",atlasPATH:"./assets/spines/units/ranged-6/william.atlas"},7:{KEY:"blanchette-spine",jsonPATH:"./assets/spines/units/ranged-7/blanchette.json",atlasPATH:"./assets/spines/units/ranged-7/blanchette.atlas"},8:{KEY:"phantom-spine",jsonPATH:"./assets/spines/units/ranged-8/phantom.json",atlasPATH:"./assets/spines/units/ranged-8/phantom.atlas"},9:{KEY:"oracle-spine",jsonPATH:"./assets/spines/units/ranged-9/oracle.json",atlasPATH:"./assets/spines/units/ranged-9/oracle.atlas"},10:{KEY:"shaman-spine",jsonPATH:"./assets/spines/units/ranged-10/shaman.json",atlasPATH:"./assets/spines/units/ranged-10/shaman.atlas"},11:{KEY:"seraph-spine",jsonPATH:"./assets/spines/units/ranged-11/seraph.json",atlasPATH:"./assets/spines/units/ranged-11/seraph.atlas"}}},SPINE_EFFECTS:{FX_MERGE:{KEY:"fx-merge-spine",jsonPATH:"./assets/spines/effects/merge/fx_merge.json",atlasPATH:"./assets/spines/effects/merge/fx_merge.atlas"}}};GameCore.Utils.Valid.isDebugger()&&(s.EFFECTS.FRAME=(0,i.Z)({},s.ANIMATION_SCENE.FRAME,s.EFFECTS.FRAME)),t.Z=s},30:function(e,t,n){"use strict";n.d(t,{C:function(){return s},K:function(){return r}});var i=n(90),a=n.n(i),s={BOOT_SCENE:"BOOT_SCENE",LOAD_SCENE:"LOAD_SCENE",MAP_SCENE:"MAP_SCENE",GAME_SCENE:"GAME_SCENE",GLOBAL_SCENE:"GLOBAL_SCENE",LEVEL_BUILDER_SCENE:"LEVEL_BUILDER_SCENE",TEST_SCENE:"TEST_SCENE",ANIMATIONS_SCENE:"ANIMATIONS_SCENE"},r={RUN:a()("RUN"),SLEEP:a()("SLEEP"),SWITCH:a()("SWITCH")}},24:function(e,t,n){"use strict";n.d(t,{Ks:function(){return a},o4:function(){return i}});var i={UNITS_SCREEN:"UNITS_SCREEN",READY_SCREEN:"READY_SCREEN",NOTIFY_SCREEN:"NOTIFY_SCREEN",RESULT_SCREEN:"RESULT_SCREEN",BATTLE_SCREEN:"BATTLE_SCREEN",LOADING_SCREEN:"LOADING_SCREEN",SETTINGS_SCREEN:"SETTINGS_SCREEN",UNIT_REWARD_SCREEN:"UNIT_REWARD_SCREEN",UNIT_UNLOCK_SCREEN:"UNIT_UNLOCK_SCREEN",LEADER_BOARD_SCREEN:"LEADER_BOARD_SCREEN",BATTLE_RESULT_SCREEN:"BATTLE_RESULT_SCREEN",OFFLINE_REWARD_SCREEN:"OFFLINE_REWARD_SCREEN",CLOSEABLE_NOTIFY_SCREEN:"CLOSEABLE_NOTIFY_SCREEN",FREE_GOLD_REWARD_SCREEN:"FREE_GOLD_REWARD_SCREEN",CHALLENGE_SPLASH_SCREEN:"CHALLENGE_SPLASH_SCREEN",RESET_DATA_SCREEN:"RESET_DATA_SCREEN",START_OVER_POPUP:"START_OVER_POPUP"},a={SCREEN:200,POPUP:300,SPLASH:400,PRIORITY:999}},25:function(e,t){"use strict";t.Z={CONGRATULATION:"congratulation",DAILY_REWARD:"daily_reward",DIAMONDS_DROP:"diamonds_drop",DIAMONDS_EAT:"diamonds_eat",FIREWORKS_BIG:"fireworks_big",FIREWORKS_SOAR:"fireworks_soar",FIREWORKS_SMALL:"fireworks_small",GEM_DROP:"gem_drop",GAME_OVER_SCENE:"game_over_scene",MISSION_COMPLETED:"mission_completed",MISSION_REWARD:"mission_reward",MOVE_WRONG:"move_wrong",START_LEVEL:"start_level",POPUP_OFF:"popup_off",POPUP_SHOW:"popup_show",SCORE_COUNTER:"score_counter",START_GAME:"start_game",YOU_LOSE:"you_lose",YOU_WIN:"you_win",NEXT_ROUND_EFFECT:"next-round-effect",LOSE_SOUND:"lose-sound",THUNDER_SOUND:"thunder-sound",CLOSE_CLICK:"close-click",BUTTON_CLICK:"button-click",UNIT_DRAG_END:"drag-unit-end",UNIT_DRAG_START:"drag-unit-start",START_BATTLE:"start-battle",MELEE_ATTACK:"melee-attack",ARROW_SHOOT:"arrow-shoot",UNIT_DAMAGED:"unit-damaged",UNIT_MERGE:"unit-merge",WIN_BATTLE:"win-battle",TURN_SWITCH:"turn-switch",UNIT_UNLOCK:"unit-unlock",COIN_SPAWN_SOUND:"coin-spawn",COIN_INCREASE_REPEATEDLY_SOUND:"coin-increase-repeatedly",GIFT_CHARGE:"gift-charge",GIFT_EXPLODE:"gift-explode",GIFT_REVEAL:"gift-reveal"}},631:function(e,t,n){"use strict";var i=n(5),a=n(1),s=n(2),r=n(632),o=n(66),c=n(633),l=n(25),u=s.Z.EFFECTS,h=(u.KEY,u.FRAME,s.Z.GAMEPLAY),d=h.KEY,p=h.FRAME,f=function(e){function t(t){var n;return(n=e.call(this,t)||this).coinGroup=void 0,n.containerGroup=void 0,n.startsExplosive=void 0,n.startsExplosiveSmall=void 0,n.startsExplosiveSmallTimer=void 0,n.gravity=300,n.setVisible(!0),n.coinGroup=n.scene.add.group({defaultKey:d,defaultFrame:p.DASHBOARD_COINBAR_COIN}),n.containerGroup=n.scene.add.group({classType:Phaser.GameObjects.Container}),n.startsExplosive=new r.Z(t),n.startsExplosive.setDepth(o.Z.ON_TOP+1),n.startsExplosiveSmall=new c.Z(t),n.startsExplosiveSmall.setDepth(o.Z.ON_TOP+1),n.scene.add.existing((0,i.Z)(n)),n}(0,a.Z)(t,e);var n=t.prototype;return n.createConfigOne=function(e,t,n){var i=this,a=e/300,s=new Phaser.Math.Vector2(0,0),r=new Phaser.Math.Vector2(0,-e),o=n?-1:1,c=Phaser.Math.RND.between(-90,90),u=(c+90)/180*180*(c<0?1:(300-Math.abs(c))/300)*a,h=Phaser.Math.RND.between(20,u+20),d=new Phaser.Math.Vector2(1,0);d.setAngle(c*Math.PI/180);var p=Phaser.Math.RND.between(-Math.abs(c)-15,15-Math.abs(c)),f=h*(100-Math.abs(c))/100*a,g=Phaser.Math.RND.between(.2*f,f),E=new Phaser.Math.Vector2(1,0);E.setAngle(p*Math.PI/180);var m=o*d.x*h,v=d.y*h,A=o*E.x*g,S=E.y*g-e,T=new Phaser.Math.Vector2(m,v),y=new Phaser.Math.Vector2(A,S),C=new Phaser.Curves.CubicBezier(s,T,y,r),I=Phaser.Math.RND.between(1500+3*h,2e3+3*h),R=this.coinGroup.get(0,0);return R.revive(),R.setRotation(-t.rotation),R.setWorldSize(24,22),t.add(R),{from:0,to:1,duration:I,ease:"Sine.In",onUpdate:function(e){var t=C.getPointAt(e.getValue());R.setPosition(t.x,t.y)},onComplete:function(e){if(R.kill(),!(e.totalProgress<1)&&(i.scene.audio.playSound(l.Z.DIAMONDS_EAT),!i.startsExplosiveSmallTimer||i.startsExplosiveSmallTimer.hasDispatched)){i.startsExplosiveSmallTimer=i.scene.time.delayedCall(100,(function(){return null}));var t=R.getWorldPosition();i.startsExplosiveSmall.explode(10,t.x,t.y)}}}},n.explode=function(e,t,n,i,a){var s,r=this;if(e<=0)return[];this.startsExplosive.explode(30,t,n);var o=new Phaser.Math.Vector2(i-t,a-n),c=o.length(),l=this.containerGroup.get(t,n);l.setRotation(o.angle()+Math.PI/2),l.revive(),this.add(l);for(var u=void 0,h=0,d=[],p=0;p<e;p++){var f=this.createConfigOne(c,l,p%2===0),g=this.scene.tweens.addCounter(f);d.push(g),f.duration>h&&(h=f.duration,u=g)}var E=function(){var e,t;d.forEach((function(e){e.complete()})),null==(e=r.startsExplosive.emitters.getAt(0))||e.killAll(),null==(t=r.startsExplosiveSmall.emitters.getAt(0))||t.killAll(),l.kill()};return null==(s=u)||s.once(Phaser.Tweens.Events.TWEEN_COMPLETE,(function(){l.kill(),r.scene.events.off("sleep",E)})),this.scene.events.once("sleep",E),d},t}(Phaser.GameObjects.Container);t.Z=f},484:function(e,t,n){"use strict";var i=n(5),a=n(1),s=n(2).Z.EFFECTS,r=s.KEY,o=s.FRAME,c=function(e){function t(t){var n;return(n=e.call(this,t,r,o.FX_STAR_YELLOW)||this).emitZone=void 0,n.emitter=void 0,n.createEmitZone(),n.scene.add.existing((0,i.Z)(n)),n}(0,a.Z)(t,e);var n=t.prototype;return n.createEmitZone=function(){this.emitZone=new Phaser.Geom.Rectangle},n.createEmitters=function(){var e=1/this.scene.world.getPixelRatio();this.emitter=this.createEmitter({on:!1,frame:o.FX_COMET,emitZone:{source:this.emitZone,type:"random"},speed:20,timeScale:1,frequency:100,alpha:{start:1,end:0,ease:Phaser.Math.Easing.Expo.Out},scale:{start:2*e,end:.1*e,ease:Phaser.Math.Easing.Expo.Out},lifespan:2666})},n.run=function(e,t,n,i,a){this.stop(),this.reset(),this.emitZone.setSize(i,a),this.emitZone.setPosition(t-i/2,n-a/2),this.emitter.setQuantity(e),this.emitter.start()},n.explode=function(e,t,n){this.emitter||this.reset(),this.emitter.explode(e,t,n)},n.stop=function(){var e,t;null==(e=this.emitter)||e.killAll(),null==(t=this.emitter)||t.stop()},n.reset=function(){this.createEmitters()},t}(Phaser.GameObjects.Particles.ParticleEmitterManager);t.Z=c},658:function(e,t,n){"use strict";n.d(t,{Z:function(){return Te}});var i=n(33),a=n(5),s=n(1),r=n(2),o=n(659),c=o.Z.RIBBON_A,l=c.KEY,u=c.TEXTURE,h=c.FRAME_RATE,d=c.END,p=c.PREFIX,f=c.ZERO_PAD,g=function(e){function t(t){var n={repeat:-1,frameRate:h,frames:t.generateFrameNames(u,{prefix:p,end:d,zeroPad:f,start:1}),yoyo:!0,showOnStart:!0};return e.call(this,t,l,n)||this}return(0,s.Z)(t,e),t}(Phaser.Animations.Animation),E=o.Z.RIBBON_B,m=E.KEY,v=E.TEXTURE,A=E.FRAME_RATE,S=E.END,T=E.PREFIX,y=E.ZERO_PAD,C=function(e){function t(t){var n={repeat:-1,frameRate:A,frames:t.generateFrameNames(v,{prefix:T,end:S,zeroPad:y,start:1}),yoyo:!0,showOnStart:!0};return e.call(this,t,m,n)||this}return(0,s.Z)(t,e),t}(Phaser.Animations.Animation),I=o.Z.RIBBON_C,R=I.KEY,w=I.TEXTURE,_=I.FRAME_RATE,b=I.END,L=I.PREFIX,P=I.ZERO_PAD,O=function(e){function t(t){var n={repeat:-1,frameRate:_,frames:t.generateFrameNames(w,{prefix:L,end:b,zeroPad:P,start:1}),yoyo:!0,showOnStart:!0};return e.call(this,t,R,n)||this}return(0,s.Z)(t,e),t}(Phaser.Animations.Animation),D=o.Z.RIBBON_D,k=D.KEY,N=D.TEXTURE,B=D.FRAME_RATE,M=D.END,x=D.PREFIX,U=D.ZERO_PAD,F=function(e){function t(t){var n={repeat:-1,frameRate:B,frames:t.generateFrameNames(N,{prefix:x,end:M,zeroPad:U,start:1}),yoyo:!0,showOnStart:!0};return e.call(this,t,k,n)||this}return(0,s.Z)(t,e),t}(Phaser.Animations.Animation),Z=o.Z.CONFETTI_STAR_X,G=Z.KEY,H=Z.TEXTURE,Y=Z.FRAME_RATE,K=Z.END,V=Z.PREFIX,W=Z.ZERO_PAD,j=function(e){function t(t){var n={repeat:-1,frameRate:Y,frames:t.generateFrameNames(H,{prefix:V,end:K,zeroPad:W,start:1}),yoyo:!0,showOnStart:!0};return e.call(this,t,G,n)||this}return(0,s.Z)(t,e),t}(Phaser.Animations.Animation),z=o.Z.CONFETTI_STAR_Y,X=z.KEY,q=z.TEXTURE,Q=z.FRAME_RATE,J=z.END,$=z.PREFIX,ee=z.ZERO_PAD,te=function(e){function t(t){var n={repeat:-1,frameRate:Q,frames:t.generateFrameNames(q,{prefix:$,end:J,zeroPad:ee,start:1}),showOnStart:!0};return e.call(this,t,X,n)||this}return(0,s.Z)(t,e),t}(Phaser.Animations.Animation),ne=n(31),ie=n.n(ne),ae=n(91),se=n.n(ae),re=n(46),oe=n.n(re),ce=n(69),le=n.n(ce),ue=n(90),he=n.n(ue),de=n(132),pe=n.n(de);function fe(e,t){var n="undefined"!==typeof he()&&pe()(e)||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){var n;if(!e)return;if("string"===typeof e)return ge(e,t);var i=oe()(n=Object.prototype.toString.call(e)).call(n,8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return le()(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return ge(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ge(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var Ee=function(e){function t(t){var n,i,a;return(a=e.call(this,t)||this).scene=void 0,a.ribbon=void 0,a.graphics=void 0,a.colorUse=void 0,a.lastChange=void 0,a.currentFrame=void 0,a.isYoyo=void 0,a.isGravityChanged=void 0,a.points=void 0,a.scene=t.manager.scene,a.points=ie()(n=se()(i=new Array(10)).call(i,null)).call(n,(function(){return{x:0,y:0}})),a.isYoyo=!1,a.isGravityChanged=!1,a.lastChange=0,a.currentFrame=-1,a.createGraphics(),a.randomRibbonUsedWhenFall(),a}(0,s.Z)(t,e);var n=t.prototype;return n.randomRibbonUsedWhenFall=function(){switch(Phaser.Math.Between(0,3)){case 0:default:this.ribbon=this.scene.anims.get(o.Z.RIBBON_A.KEY);break;case 1:this.ribbon=this.scene.anims.get(o.Z.RIBBON_B.KEY);break;case 2:this.ribbon=this.scene.anims.get(o.Z.RIBBON_C.KEY);break;case 3:this.ribbon=this.scene.anims.get(o.Z.RIBBON_D.KEY)}},n.setRibbonPosition=function(e,t){var n;ie()(n=this.points).call(n,(function(n){n.x=e,n.y=t}))},n.createGraphics=function(){var e=[8443204,2928867,12013036,16376097,15285798];this.colorUse=e[Phaser.Math.Between(0,e.length-1)],this.graphics=this.scene.add.graphics({lineStyle:{width:3,color:this.colorUse}});var t=this.emitter.manager,n=t.x,i=t.y,a=t.depth;this.graphics.setDepth(a),this.graphics.setPosition(n,i)},n.update=function(t,n,i){var a=e.prototype.update.call(this,t,n,i);return this.updateFrames(t),this.updatePoints(),this.updateGraphics(),this.updateGravity(),this.updateVelocity(),this.updateColor(),a},n.updateFrames=function(e){this.lastChange+=e,this.lastChange>=this.ribbon.msPerFrame&&(this.isYoyo?this.currentFrame--:this.currentFrame++,this.currentFrame<0&&(this.isYoyo=!1,this.currentFrame=1),this.currentFrame>=this.ribbon.frames.length&&(this.isYoyo=!0,this.currentFrame-=1),this.frame=this.ribbon.frames[this.currentFrame].frame,this.lastChange-=this.ribbon.msPerFrame)},n.updatePoints=function(){this.graphics.visible&&(this.points.shift(),this.points.push({x:this.x,y:this.y}))},n.updateGraphics=function(){if(this.graphics.visible){for(var e,t=fe(this.points);!(e=t()).done;){if(0===e.value.y)return}this.graphics.clear(),this.graphics.strokePoints(this.points)}},n.updateGravity=function(){this.lifeCurrent>this.life-2e3||this.isGravityChanged||(this.isGravityChanged=!0,this.graphics.destroy(),this.emitter.setVisible(!0),this.emitter.setGravityY(45))},n.updateVelocity=function(){this.graphics.visible&&(this.lifeCurrent>this.life-1800?this.velocityX+=Phaser.Math.Between(-12,12):this.velocityX>0?this.velocityX+=Phaser.Math.Between(-10,6):this.velocityX+=Phaser.Math.Between(-6,10))},n.updateColor=function(){this.graphics.visible||(this.tint=this.colorUse)},t}(Phaser.GameObjects.Particles.Particle),me=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.isYoyo=void 0,n.isGravityChanged=void 0,n.lastChange=void 0,n.currentFrame=void 0,n.star=void 0,n.starX=void 0,n.starY=void 0,n.isYoyo=!1,n.isGravityChanged=!1,n.lastChange=0,n.currentFrame=-1,n.scene=t.manager.scene,n.starX=n.scene.anims.get(o.Z.CONFETTI_STAR_X.KEY),n.starY=n.scene.anims.get(o.Z.CONFETTI_STAR_Y.KEY),n.star=n.starX,n}(0,s.Z)(t,e);var n=t.prototype;return n.update=function(t,n,i){var a=e.prototype.update.call(this,t,n,i);return this.updateGravity(),this.updateVelocity(),this.updateFrameRate(),this.updateFrames(t),a},n.updateGravity=function(){this.lifeCurrent>this.life-2e3||this.isGravityChanged||(this.isGravityChanged=!0,this.emitter.setGravityY(15),this.emitter.setSpeedX(0))},n.updateVelocity=function(){this.lifeCurrent>this.life-2e3||(this.velocityX>0?this.velocityX+=Phaser.Math.Between(-6,3):this.velocityX+=Phaser.Math.Between(-3,6))},n.updateFrames=function(e){if(this.lastChange+=e,this.lastChange>=this.star.msPerFrame){var t=Phaser.Math.RND.between(0,1);this.star=t>0?this.starX:this.starY,this.isYoyo?this.currentFrame--:this.currentFrame++,this.currentFrame<0&&(this.isYoyo=!1,this.currentFrame=1,this.emitter.setAlpha(1)),this.currentFrame>=this.star.frames.length&&(this.isYoyo=!0,this.currentFrame-=1,this.emitter.setAlpha(.8)),this.frame=this.star.frames[this.currentFrame].frame,this.lastChange-=this.star.msPerFrame}},n.updateFrameRate=function(){this.lifeCurrent<this.life-2e3?this.star.msPerFrame=150:this.star.msPerFrame=Phaser.Math.RND.between(300,600)},t}(Phaser.GameObjects.Particles.Particle),ve=r.Z.EFFECTS,Ae=ve.KEY,Se=ve.FRAME,Te=function(e){function t(t){var n;return(n=e.call(this,t,Ae,Se.BLANK)||this).emitterConfetti=void 0,n.emitterRibbons=void 0,n.ribbonConfig=void 0,n.confettiConfig=void 0,n.width=void 0,n.height=void 0,n.emitterRibbons=[],n.emitterConfetti=[],n.createConfigs(),n.createAnimations(),n.scene.add.existing((0,a.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.createConfigs=function(){var e=1/this.scene.world.getPixelRatio();this.ribbonConfig={on:!1,visible:!1,timeScale:1.5,frame:Se.BLANK,particleBringToTop:!0,speedY:{min:-480,max:-560},gravityY:290,lifespan:{min:4e3,max:6e3},rotate:{start:0,end:1800,random:!0},scale:{min:.6*e,max:e},particleClass:Ee},this.confettiConfig={on:!1,delay:200,timeScale:2,tint:[8443204,2928867,12013036,16376097,15285798],particleBringToTop:!0,frame:Se.PREFIX_ANIMATION_RIBBON_CONFETTI_A+"1",speedY:{min:-460,max:-580},gravityY:280,lifespan:{min:5e3,max:8e3},rotate:{start:0,end:1080},scale:{min:.6*e,max:e},particleClass:me}},n.createAnimations=function(){if(!this.scene.anims.get(o.Z.CONFETTI_STAR_X.KEY)){var e=new j(this.scene.anims);this.scene.anims.add(o.Z.CONFETTI_STAR_X.KEY,e)}if(!this.scene.anims.get(o.Z.CONFETTI_STAR_Y.KEY)){var t=new te(this.scene.anims);this.scene.anims.add(o.Z.CONFETTI_STAR_Y.KEY,t)}if(!this.scene.anims.get(o.Z.RIBBON_A.KEY)){var n=new g(this.scene.anims);this.scene.anims.add(o.Z.RIBBON_A.KEY,n)}if(!this.scene.anims.get(o.Z.RIBBON_B.KEY)){var i=new C(this.scene.anims);this.scene.anims.add(o.Z.RIBBON_B.KEY,i)}if(!this.scene.anims.get(o.Z.RIBBON_C.KEY)){var a=new O(this.scene.anims);this.scene.anims.add(o.Z.RIBBON_C.KEY,a)}if(!this.scene.anims.get(o.Z.RIBBON_D.KEY)){var s=new F(this.scene.anims);this.scene.anims.add(o.Z.RIBBON_D.KEY,s)}},n.run=function(e,t,n,i){this.setPosition(e,t),this.width=n,this.height=i,this.createEmitters(),this.emitterConfetti.forEach((function(e){e.emitParticle(25)})),this.emitterRibbons.forEach((function(e){e.emitParticle(20)}))},n.stop=function(){this.emitterConfetti.forEach((function(e){e.killAll()})),this.emitterRibbons.forEach((function(e){e.killAll()})),this.kill()},n.createEmitters=function(){this.emitterRibbons=[],this.emitterConfetti=[],this.createConfettiLeftEmitter(),this.createConfettiRightEmitter(),this.createRibbonLeftEmitter(),this.createRibbonRightEmitter()},n.createConfettiLeftEmitter=function(){var e=(0,i.Z)({},this.confettiConfig,{speedX:{min:5,max:90}}),t=this.createEmitter(e);this.emitterConfetti.push(t)},n.createConfettiRightEmitter=function(){var e=this.width,t=(0,i.Z)({},this.confettiConfig,{x:e,speedX:{min:-5,max:-90}}),n=this.createEmitter(t);this.emitterConfetti.push(n)},n.createRibbonLeftEmitter=function(){var e=(0,i.Z)({},this.ribbonConfig,{speedX:{min:20,max:80},emitCallback:function(e){e.setRibbonPosition(0,0)}}),t=this.createEmitter(e);this.emitterRibbons.push(t)},n.createRibbonRightEmitter=function(){var e=this.width,t=(0,i.Z)({},this.ribbonConfig,{x:e,speedX:{min:-20,max:-80},emitCallback:function(t){t.setRibbonPosition(e,0)}}),n=this.createEmitter(t);this.emitterRibbons.push(n)},n.killAllParticles=function(){var e=this;this.emitterConfetti.forEach((function(t){t.forEachAlive((function(e){e.lifeCurrent=0}),e)})),this.emitterRibbons.forEach((function(t){t.forEachAlive((function(e){e.lifeCurrent=0}),e)}))},t}(Phaser.GameObjects.Particles.ParticleEmitterManager)},490:function(e,t,n){"use strict";var i=n(5),a=n(1),s=function(e){function t(t,n){var a;return(a=e.call(this,t)||this).payload=void 0,a.payload=n,a.createGraphics(),a.scene.add.existing((0,i.Z)(a)),a}(0,a.Z)(t,e);var n=t.prototype;return n.createGraphics=function(){for(var e=this.payload.lineNumber,t=void 0===e?16:e,n=0;n<t;n++){var i=this.drawCardinalTriangle(),a=Phaser.Math.DegToRad(n*(360/t));i.setPosition(0,0),i.setRotation(a),this.scene.add.existing(i),this.add(i)}},n.drawCardinalTriangle=function(){var e=this.payload,t=e.color,n=e.radius,i=e.width,a=Phaser.Math.Between(n.min,n.max),s=new Phaser.GameObjects.Graphics(this.scene);s.clear();var r=[{x:0,y:0}],o=Phaser.Math.Between(i.min,i.max),c=Phaser.Math.DegToRad(o),l={x:a,y:a*Math.tan(c)};r.push(l);var u={x:a,y:a*Math.tan(c)*-1};r.push(u),s.lineStyle(1,16777215,0),s.beginPath(),s.moveTo(r[0].x,r[0].y);for(var h=1;h<r.length;h++)s.lineTo(r[h].x,r[h].y);return s.closePath(),s.strokePath(),s.fillGradientStyle(t,t,t,t,0,1,0,1),s.fillPath(),s},t}(Phaser.GameObjects.Container);t.Z=s},483:function(e,t,n){"use strict";var i=n(5),a=n(1),s=n(2).Z.EFFECTS,r=s.KEY,o=s.FRAME,c=function(e){function t(t){var n;return(n=e.call(this,t,r,o.FX_SPARK)||this).deathZone=void 0,n.emitter=void 0,n.createDeathZone(),n.createEmitters(),n.setActive(!1),n.setVisible(!1),n.scene.add.existing((0,i.Z)(n)),n}(0,a.Z)(t,e);var n=t.prototype;return n.createDeathZone=function(){this.deathZone=new Phaser.Geom.Circle},n.createEmitters=function(){var e=1/this.scene.world.getPixelRatio();this.emitter=this.createEmitter({on:!1,frame:o.FX_SPARK,speed:{min:10,max:1200},scale:{start:1.33*e,end:0},alpha:{start:1,end:0,ease:Phaser.Math.Easing.Expo.Out},deathZone:{source:this.deathZone,type:"onLeave"},lifespan:3e3})},n.explode=function(e,t,n,i){this.setActive(!0),this.setVisible(!0),this.deathZone.radius=i,this.deathZone.setPosition(t,n),this.emitter.explode(e,t,n)},n.stop=function(){this.emitter.forEachAlive((function(e){e.lifeCurrent=0}),this)},t}(Phaser.GameObjects.Particles.ParticleEmitterManager);t.Z=c},634:function(e,t,n){"use strict";var i=n(5),a=n(1),s=n(2),r=n(635),o=s.Z.EFFECTS,c=o.KEY,l=o.FRAME,u=function(e){function t(t){var n;return(n=e.call(this,t,c,l.FX_STAR_YELLOW)||this).emitZone=void 0,n.emitter=void 0,n.createEmitZone(),n.createEmitters(),n.scene.add.existing((0,i.Z)(n)),n}(0,a.Z)(t,e);var n=t.prototype;return n.createEmitZone=function(){this.emitZone=new Phaser.Geom.Rectangle},n.createEmitters=function(){var e=1/this.scene.world.getPixelRatio();this.emitter=this.createEmitter({frame:l.FX_STAR_YELLOW,emitZone:{source:this.emitZone,type:"random"},deathZone:{source:this.emitZone,type:"onLeave"},frequency:200,speedX:{min:-1,max:1},speedY:{min:-9,max:-13},lifespan:{min:1e3,max:1500},scale:{min:.01,max:.015},emitCallback:function(t){t.setScale({min:e/4,max:e})},particleClass:r.Z})},n.run=function(e,t,n,i,a){this.stop(),this.emitZone.setSize(i,a),this.emitZone.setPosition(t-i/2,n-a/2),this.emitter.setQuantity(e),this.emitter.start()},n.stop=function(){var e,t;null==(e=this.emitter)||e.killAll(),null==(t=this.emitter)||t.stop()},t}(Phaser.GameObjects.Particles.ParticleEmitterManager);t.Z=u},656:function(e,t,n){"use strict";var i=n(5),a=n(1),s=n(2).Z.EFFECTS,r=s.KEY,o=s.FRAME,c=function(e){function t(t){var n;return(n=e.call(this,t,r,o.FX_STAR_YELLOW)||this).emitZone=void 0,n.emitter=void 0,n.createEmitZone(),n.scene.add.existing((0,i.Z)(n)),n}(0,a.Z)(t,e);var n=t.prototype;return n.createEmitZone=function(){this.emitZone=new Phaser.Geom.Rectangle},n.createEmitters=function(){var e=1/this.scene.world.getPixelRatio();this.emitter=this.createEmitter({on:!1,frame:o.FX_STAR_YELLOW,emitZone:{source:this.emitZone,type:"random"},timeScale:1,frequency:100,alpha:{start:1,end:0,ease:Phaser.Math.Easing.Expo.Out},scale:{start:1*e,end:0,ease:Phaser.Math.Easing.Expo.Out},lifespan:{min:1500,max:3e3}})},n.run=function(e,t,n,i,a,s){void 0===s&&(s=100),this.stop(),this.reset(),this.emitZone.setSize(i,a),this.emitZone.setPosition(t-i/2,n-a/2),this.emitter.setQuantity(e),this.emitter.setFrequency(s),this.emitter.start()},n.stop=function(){var e,t;null==(e=this.emitter)||e.killAll(),null==(t=this.emitter)||t.stop()},n.reset=function(){this.createEmitters()},t}(Phaser.GameObjects.Particles.ParticleEmitterManager);t.Z=c},665:function(e,t,n){"use strict";var i=n(5),a=n(1),s=n(2).Z.EFFECTS,r=s.KEY,o=s.FRAME,c=function(e){function t(t){var n;return(n=e.call(this,t,r,o.FX_COMET)||this).emitZone=void 0,n.emitter=void 0,n.createEmitZone(),n.createEmitters(),n.scene.add.existing((0,i.Z)(n)),n}(0,a.Z)(t,e);var n=t.prototype;return n.createEmitZone=function(){this.emitZone=new Phaser.Geom.Rectangle},n.createEmitters=function(){var e=1/this.scene.world.getPixelRatio();this.emitter=this.createEmitter({on:!1,frame:o.FX_COMET,emitZone:{source:this.emitZone,type:"random"},deathZone:{source:this.emitZone,type:"onLeave"},timeScale:1,frequency:150,speedY:{min:-20,max:-60},alpha:{start:1,end:0,ease:Phaser.Math.Easing.Cubic.Out},scale:{start:1*e,end:0,ease:Phaser.Math.Easing.Cubic.Out},lifespan:{min:1500,max:2500}})},n.run=function(e,t,n,i,a){this.stop(),this.emitZone.setSize(i,a),this.emitZone.setPosition(t-i/2,n-a/2),this.emitter.setQuantity(e),this.emitter.start()},n.stop=function(){var e,t;null==(e=this.emitter)||e.killAll(),null==(t=this.emitter)||t.stop()},t}(Phaser.GameObjects.Particles.ParticleEmitterManager);t.Z=c},632:function(e,t,n){"use strict";var i=n(5),a=n(1),s=n(2).Z.EFFECTS,r=s.KEY,o=s.FRAME,c=function(e){function t(t){var n;return(n=e.call(this,t,r,o.FX_STAR_YELLOW)||this).emitter=void 0,n.scene=t,n.createEmitters(),n.setActive(!1),n.setVisible(!1),n.scene.add.existing((0,i.Z)(n)),n}(0,a.Z)(t,e);var n=t.prototype;return n.createEmitters=function(){var e=1/this.scene.world.getPixelRatio();this.emitter=this.createEmitter({on:!1,frame:o.FX_STAR_YELLOW,alpha:{start:1,end:.8},speed:{min:50,max:150},scale:{start:.4*e,end:1*e},lifespan:{min:600,max:1500}})},n.explode=function(e,t,n){this.setActive(!0),this.setVisible(!0),this.emitter.explode(e,t,n)},t}(Phaser.GameObjects.Particles.ParticleEmitterManager);t.Z=c},633:function(e,t,n){"use strict";var i=n(5),a=n(1),s=n(2).Z.EFFECTS,r=s.KEY,o=s.FRAME,c=function(e){function t(t){var n;return(n=e.call(this,t,r,o.FX_COMET)||this).emitter=void 0,n.scene=t,n.createEmitters(),n.setActive(!1),n.setVisible(!1),n.scene.add.existing((0,i.Z)(n)),n}(0,a.Z)(t,e);var n=t.prototype;return n.createEmitters=function(){var e=1/this.scene.world.getPixelRatio();this.emitter=this.createEmitter({on:!1,frame:o.FX_COMET,alpha:{start:1,end:.8},speed:{min:40,max:80},scale:{start:.4*e,end:.7*e},lifespan:{min:400,max:600}})},n.explode=function(e,t,n){this.revive(),this.emitter.explode(e,t,n)},t}(Phaser.GameObjects.Particles.ParticleEmitterManager);t.Z=c},635:function(e,t,n){"use strict";var i=n(1),a=function(e){function t(t){var n;return(n=e.call(this,t)||this).scale=void 0,n}(0,i.Z)(t,e);var n=t.prototype;return n.update=function(t,n,i){var a=e.prototype.update.call(this,t,n,i);return this.updateScale(),this.updateVelocity(),a},n.setScale=function(e){this.scale=Phaser.Math.FloatBetween(e.min,e.max)},n.easeInCubic=function(e){return e*e*e},n.updateScale=function(){var e=this.easeInCubic(1-this.lifeT);this.scaleX=this.scale*Math.sin(e*Math.PI),this.scaleY=this.scale*Math.sin(e*Math.PI)},n.updateVelocity=function(){this.velocityX+=2*Math.random()-1},t}(Phaser.GameObjects.Particles.Particle);t.Z=a},475:function(e,t,n){"use strict";var i=n(5),a=n(1),s=n(2).Z.GAMEPLAY,r=s.KEY,o=s.FRAME,c=function(e){function t(t,n){var a;return(a=e.call(this,t)||this).bg=void 0,a.frame=void 0,a.defaultHp=void 0,a.currentHp=void 0,a.color=void 0,a.hpLength=void 0,a.hpHeight=void 0,a.defaultHp=100,a.currentHp=100,a.hpLength=30,a.hpHeight=4,a.color=n,a.createHealthBar(),a.scene.add.existing((0,i.Z)(a)),a}(0,a.Z)(t,e);var n=t.prototype;return n.createHealthBar=function(){var e=this.scene.make.image({key:r,frame:o.HP_BAR_BG}),t=this.hpLength+1,n=this.hpHeight+1;e.setOrigin(0,.5),e.setWorldSize(t,n),e.setX(-t/2),this.add(e),this.bg=e;var i=this.scene.make.image({key:r,frame:o.HP_BAR_BG});i.setOrigin(0,.5),i.setWorldSize(this.hpLength,this.hpHeight),i.setX(-this.hpLength/2),this.add(i),this.frame=i},n.setInitHp=function(e){this.defaultHp=e,this.currentHp=e,this.updateFrameUI()},n.getCurrentHp=function(){return this.currentHp},n.updateCurrentHpUI=function(e){e<0&&(e=0),this.currentHp=e,this.updateFrameUI()},n.updateHpUIByMinus=function(e){this.currentHp-=e,this.currentHp<0&&(this.currentHp=0),this.updateFrameUI()},n.updateFrameUI=function(){this.frame.setWorldSize(this.currentHp/this.defaultHp*this.hpLength,this.hpHeight),this.frame.setTintFill(this.color)},n.changeHpColor=function(e){var t=e?39423:15466524;this.frame.setTintFill(t),this.color=t},t}(Phaser.GameObjects.Container);t.Z=c},109:function(e,t,n){"use strict";n.d(t,{Al:function(){return d},Of:function(){return h},Tz:function(){return u},VA:function(){return p}});var i=n(2),a=i.Z.UNITS_SPRITES,s=a.KEY,r=a.FRAME,o=i.Z.GAMEPLAY,c=o.KEY,l=o.FRAME,u={END:2,START:0,EVENT:5,DISPOSE:3,COMPLETE:4,INTERRUPT:1},h={MELEE:{RUN:"run",DIE:"die",IDLE:"idle",ATTACK:"attack",CUSTOM_EVENTS:{FINISHED_ATTACKING:"finished_attacking"}},RANGED:{DIE:"die",IDLE:"idle",ATTACK:"attack",ATTACK_ABOVE:"attack_above",ATTACK_BELOW:"attack_below",CUSTOM_EVENTS:{FINISHED_ATTACKING:"finished_attacking"}}},d={GREEN_FIRE:{KEY:"confetti-hexagon-animation",TEXTURE:c,PREFIX:l.GREEN_FIRE_PREFIX,FRAME_RATE:30,START:1,END:3,ZERO_PAD:0}},p={MELEE:{1:{ATTACK:{KEY:"velociraptor-attack",TEXTURE:s,PREFIX:r.MELEE[1].ATTACK_PREFIX,FRAME_RATE:30,EVENT_FRAME:9,START:0,END:20,ZERO_PAD:2},DIE:{KEY:"velociraptor-die",TEXTURE:s,PREFIX:r.MELEE[1].DIE_PREFIX,FRAME_RATE:20,START:0,END:19,ZERO_PAD:2},IDLE:{KEY:"velociraptor-idle",TEXTURE:s,PREFIX:r.MELEE[1].IDLE_PREFIX,FRAME_RATE:30,START:0,END:39,ZERO_PAD:2},RUN:{KEY:"velociraptor-move",TEXTURE:s,PREFIX:r.MELEE[1].RUN_PREFIX,FRAME_RATE:40,START:0,END:20,ZERO_PAD:2}}},RANGED:{1:{ATTACK_ABOVE:{KEY:"rockthrower-attack",TEXTURE:s,PREFIX:r.RANGED[1].ATTACK_PREFIX,FRAME_RATE:30,EVENT_FRAME:16,START:0,END:29,ZERO_PAD:2},ATTACK_BELOW:{KEY:"rockthrower-attack",TEXTURE:s,PREFIX:r.RANGED[1].ATTACK_PREFIX,FRAME_RATE:30,EVENT_FRAME:16,START:0,END:29,ZERO_PAD:2},DIE:{KEY:"rockthrower-die",TEXTURE:s,PREFIX:r.RANGED[1].DIE_PREFIX,FRAME_RATE:24,START:0,END:23,ZERO_PAD:2},IDLE:{KEY:"rockthrower-idle",TEXTURE:s,PREFIX:r.RANGED[1].IDLE_PREFIX,FRAME_RATE:24,START:0,END:23,ZERO_PAD:2}}},ALIEN:{1:{ATTACK:{KEY:"velociraptor-attack",TEXTURE:s,PREFIX:r.MELEE[1].ATTACK_PREFIX,FRAME_RATE:30,START:0,END:29,ZERO_PAD:2},DIE:{KEY:"velociraptor-die",TEXTURE:s,PREFIX:r.MELEE[1].DIE_PREFIX,FRAME_RATE:20,START:0,END:19,ZERO_PAD:2},IDLE:{KEY:"velociraptor-idle",TEXTURE:s,PREFIX:r.MELEE[1].IDLE_PREFIX,FRAME_RATE:40,START:0,END:39,ZERO_PAD:2},RUN:{KEY:"velociraptor-move",TEXTURE:s,PREFIX:r.MELEE[1].RUN_PREFIX,FRAME_RATE:25,START:0,END:24,ZERO_PAD:2}}}}},85:function(e,t){"use strict";t.Z={NORMAL:"NORMAL",BATTLE:"BATTLE",TUTORIAL:"TUTORIAL"}},65:function(e,t){"use strict";t.Z={COIN_SUFFIX:"coinSuffixValue",COIN_BASE_VALUE:"coinBaseValue",PLAYER_UNIT_DATA:"playerUnitData",LEVEL_PROGRESS:"playerLevelProgress",MELEE_UNLOCKED:"meleeUnlockedUnitLevel",RANGED_UNLOCKED:"rangedUnlockedUnitLevel",FREE_GOLD_LAST_USED:"freeCoinsLastUsedTime",SELECTED_LEVEL:"selectedLevel",UNIT_SCREEN_AD_WATCHED_COUNT:"unitScreenAdWatchedCount"}},17:function(e,t){"use strict";t.Z={MELEE_UNIT_TYPE:"melee",RANGED_UNIT_TYPE:"ranged",ALIEN_UNIT_TYPE:"alien",MELEE_ATTACK_RANGE:40,MELEE_MOVEMENT_SPEED:100,MELEE_ATTACK_INTERVAL:800,RANGED_ATTACK_INTERVAL:1100,RANGED_PROJECTILE_SPEED:600,BASE_UNIT_COIN:2,UNIT_COIN_SCALE:1.6,COINS_PER_ATTACK:1,ATTACK_COIN_SCALE:1.6,MULTIPLY_REWARD_ROUND:6,MULTIPLY_REWARD_BATTLE:2,UNIT_SIZE_SCALE:1,UNIT_PRICE_CUSTOM_MODIFIER:[[1,1],[3,5],[10,2],[25,1.5],[40,1.5]],ATTACK_CUSTOM_MODIFIER:[[1,1],[9,2],[30,1.2]],AD_WATCH_REQUIREMENT:[0,1,2,3,4,5,7,9,12,15,20],BUYING_UNIT_LEVEL:[1,51,151,251]}},234:function(e,t){"use strict";t.Z={PREPARE:"prepare",READY:"ready",MOVING_TO_TARGET:"movingToTarget",PREPARE_TO_ATTACK:"prepareToAttack",ATTACKING:"attacking",FINISHED_ATTACKING:"finishedAttacking",KILLED:"killed"}},681:function(e,t){"use strict";var n=function(){function e(e){this.scene=void 0,this.numOfPlayerSpawnedUnits=void 0,this.resourcePool=void 0,this.scene=e,this.resourcePool=new Phaser.GameObjects.Group(this.scene,{runChildUpdate:!1})}var t=e.prototype;return t.init=function(){this.numOfPlayerSpawnedUnits=0},t.returnToPool=function(e){this.resourcePool.add(e)},t.getPlayerSpawnedUnitsCount=function(){return this.numOfPlayerSpawnedUnits},t.setSpawnedUnits=function(e){this.numOfPlayerSpawnedUnits=e},e}();t.Z=n},636:function(e,t,n){"use strict";n.d(t,{Z:function(){return Ee}});var i=n(1),a=n(114),s=n.n(a),r=n(680),o=n(161),c=n(17),l=n(234),u=n(109),h=n(477),d=n(41),p=n.n(d),f=n(25),g=n(476),E=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=e.call.apply(e,p()(t=[this]).call(t,a))||this).handleAttacked=function(){if(!n.unit.isKilled()){var e=n.unit.attackController.getAttackTarget();e&&(e.isKilled()?n.unit.display.addAnimEventListener(Phaser.Animations.Events.ANIMATION_COMPLETE,n.handleFinishedAttacking):(e.takeDamage(n.unit),e.attackController.notifyTargetAttacked(n.unit)))}},n.handleFinishedAttacking=function(){n.unit.setStatus(l.Z.FINISHED_ATTACKING)},n}return(0,i.Z)(t,e),t.prototype.execute=function(){var e=this.payload,t=e.spriteAnimKey,n=e.spineAnimKey,i=e.status;this.unit.setStatus(i),this.unit.display.play(t,n,!1),this.unit.display.setAnimationTimeScale(1),this.unit.display.addAnimEventListener(u.Of.MELEE.CUSTOM_EVENTS.FINISHED_ATTACKING,this.handleAttacked),this.unit.scene.audio.playSound(f.Z.MELEE_ATTACK,{volume:.5,detune:-1e3*Math.random()});var a=this.unit.attackController.getAttackTarget();a&&this.unit.display.setFlipX(a.x<=this.unit.x)},t}(g.Z),m=E,v=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=e.call.apply(e,p()(t=[this]).call(t,a))||this).handleAnimationComplete=function(){n.unit.effectController.runDieEffect()},n}return(0,i.Z)(t,e),t.prototype.execute=function(){var e,t=this.payload,n=t.spriteAnimKey,i=t.spineAnimKey,a=t.status;this.unit.setStatus(a),null==(e=this.unit.attackEvent)||e.remove(),this.unit.uiController.killHpBar(),this.unit.depthController.setDepthOnDeath(),this.unit.effectController.stopDamageEffect(),this.unit.display.play(n,i,!1,!0),this.unit.display.setAnimationTimeScale(1),this.unit.display.addAnimEventListener(Phaser.Animations.Events.ANIMATION_COMPLETE,this.handleAnimationComplete)},t}(g.Z),A=v,S=function(e){function t(){return e.apply(this,arguments)||this}return(0,i.Z)(t,e),t.prototype.execute=function(){var e=this.payload,t=e.spriteAnimKey,n=e.spineAnimKey,i=e.status,a=this.unit.attackController.getAttackTarget();a&&(this.unit.isDepthDirty=!0,this.unit.getStatus()!==i&&(this.unit.setStatus(i),this.unit.display.play(t,n,!0),this.unit.display.setAnimationTimeScale(.5+Math.random())),this.unit.display.setFlipX(a.x<this.unit.x))},t}(g.Z),T=S,y=function(e){function t(){return e.apply(this,arguments)||this}return(0,i.Z)(t,e),t.prototype.execute=function(){var e=this.payload,t=e.spriteAnimKey,n=e.spineAnimKey,i=e.status;this.unit.revive(),this.unit.setStatus(i),this.unit.isDepthDirty=!0,this.unit.uiController.killHpBar(),this.unit.effectController.stopDieEffect(),this.unit.display.setFlipX(!1),this.unit.display.play(t,n,!0,!0),this.unit.display.setAnimationTimeScale(.5+Math.random()),this.unit.attackController.reset()},t}(g.Z),C=y,I=function(e){function t(){return e.apply(this,arguments)||this}return(0,i.Z)(t,e),t.prototype.execute=function(){var e=this.payload,t=e.spriteAnimKey,n=e.spineAnimKey,i=e.status;this.unit.setStatus(i),this.unit.uiController.reviveHpBar(),this.unit.display.play(t,n,!0,!0),this.unit.display.setAnimationTimeScale(.5+Math.random())},t}(g.Z),R=I,w=function(e){function t(){return e.apply(this,arguments)||this}(0,i.Z)(t,e);var n=t.prototype;return n.addAttackCommand=function(){this.attackCommand=new m(this.unit,{status:l.Z.ATTACKING,spriteAnimKey:this.getSpriteAnimKeyByUnitLevel("ATTACK"),spineAnimKey:this.getSpineAnimKeyByUnitLevel("ATTACK")})},n.addReadyCommand=function(){this.readyCommand=new R(this.unit,{status:l.Z.READY,spriteAnimKey:this.getSpriteAnimKeyByUnitLevel("IDLE"),spineAnimKey:this.getSpineAnimKeyByUnitLevel("IDLE")})},n.addMoveCommand=function(){this.moveCommand=new T(this.unit,{status:l.Z.MOVING_TO_TARGET,spriteAnimKey:this.getSpriteAnimKeyByUnitLevel("RUN"),spineAnimKey:this.getSpineAnimKeyByUnitLevel("RUN")})},n.addDieCommand=function(){this.dieCommand=new A(this.unit,{status:l.Z.KILLED,spriteAnimKey:this.getSpriteAnimKeyByUnitLevel("DIE"),spineAnimKey:this.getSpineAnimKeyByUnitLevel("DIE")})},n.addPrepareCommand=function(){this.prepareCommand=new C(this.unit,{status:l.Z.PREPARE,spriteAnimKey:this.getSpriteAnimKeyByUnitLevel("IDLE"),spineAnimKey:this.getSpineAnimKeyByUnitLevel("IDLE")})},n.getSpriteAnimKeyByUnitLevel=function(e){try{var t=this.unit,n=t.level,i=(t.scene,t.unitType,n);return i>=2&&(i=1),u.VA.MELEE[i][e].KEY}catch(a){return console.warn(a),u.VA.ALIEN[1].IDLE.KEY}},n.getSpineAnimKeyByUnitLevel=function(e){var t=u.Of.MELEE[e];if(!t)throw new Error("Can't find spine animation "+e);return t},t}(h.Z),_=w,b=GameCore.Configs.Gameplay.Powers.SpeedUp.modifier,L=function(e){function t(t,n,i,a,s,r){var o;(o=e.call(this,t,n,i,a,s,r)||this).movementSpeed=void 0,o.savedApproachXOffset=void 0,o.savedApproachYOffset=void 0,o.unitType=c.Z.MELEE_UNIT_TYPE,o.movementSpeed=c.Z.MELEE_MOVEMENT_SPEED,o.attackInterval=c.Z.MELEE_ATTACK_INTERVAL;var l=o.display.getSpineAnimationAttackingTime();return o.attackInterval<l&&(o.attackInterval=l),o.savedApproachXOffset=null,o.savedApproachYOffset=null,o}(0,i.Z)(t,e);var n=t.prototype;return n.createActions=function(){this.actions=new _(this)},n.moveToAttackPosition=function(e){if(!this.isKilled()){var t=this.attackController.getAttackTarget();if(t&&(null==t||!t.isKilled())){var n=t.requestAttackPosition(this);n&&(this.isDepthDirty=!0,this.executeMovement(e,n.location))}}},n.executeMovement=function(e,t){var n=this.x,i=this.y,a=this.scene.powerManager.isGameSpeedUp()?this.movementSpeed*b:this.movementSpeed,s=a/1e3*e,r=Phaser.Math.Distance.Between(n,i,t.x,t.y),o=t.x-n,c=t.y-i,u=0!==o?o/r*a/1e3*e:0,h=0!==c?c/r*a/1e3*e:0;if(Phaser.Math.Distance.Between(n+u,i+h,t.x,t.y)<=s)return this.setPosition(n+u,i+h),this.setStatus(l.Z.PREPARE_TO_ATTACK),void this.attackController.moveAttackSpotMelee(t.x-n,t.y-i);this.display.setFlipX(u<0),this.setPosition(n+u,i+h),this.attackController.moveAttackSpotMelee(u,h)},n.moveToTarget=function(e){this.moveToAttackPosition(e)},n.determineCounteringEnemy=function(){var e,t,n,i=this.attackController,a=i.beingAttackedByMelee,s=i.beingAttackedByRanged,r=this.attackController.getAttackTarget();if(null!=(e=r)&&e.isKilled()&&(r=null),a&&!a.isKilled())return this.attackController.setAttackTarget(a),null==(t=r)||t.attackController.resetAttackSpotOfUnit(this),!0;if(s&&!s.isKilled()&&Phaser.Math.Distance.Between(this.x,this.y,s.x,s.y)<(r?Phaser.Math.Distance.Between(this.x,this.y,r.x,r.y):1e4))return this.attackController.setAttackTarget(s),null==(n=r)||n.attackController.resetAttackSpotOfUnit(this),!0;return!1},n.setUnitData=function(t){e.prototype.setUnitData.call(this,t),this.unitType=c.Z.MELEE_UNIT_TYPE},n.update=function(t,n){if(e.prototype.update.call(this,t,n),!this.isKilled()&&this.scene.stateManager.isInPlayingState()){var i=this.attackController.getAttackTarget();if(this.isReady())return i&&!i.isKilled()||this.findTarget(),void(i&&this.actions.move());if(this.isMovingToTarget()){var a=this.determineCounteringEnemy();if(this.moveToTarget(n),a)return;return null!=i&&i.isKilled()?(this.attackController.resetAttackTarget(),void this.actions.ready()):void 0}if(this.isPreparingToAttack())return null!=i&&i.isKilled()?void this.actions.ready():void this.attack();this.isFinishedAttacking()&&(this.savedApproachXOffset=null,this.savedApproachYOffset=null,this.actions.ready())}},t}(o.Z),P=n(87),O=n.n(P),D=n(2),k=D.Z.UNITS_SPINES.MELEE[10].KEY,N=GameCore.Configs.UnitsConfig.MELEE.listLevelsUseSprite,B=function(e){function t(t,n,i){return e.call(this,t,0,0,n,i,{spine:{key:k,spineConfig:{animation:u.Of.MELEE.IDLE,loop:!0}},useSpine:!O()(N).call(N,i.level)})||this}return(0,i.Z)(t,e),t}(L),M=D.Z.UNITS_SPINES.MELEE[11].KEY,x=GameCore.Configs.UnitsConfig.MELEE.listLevelsUseSprite,U=function(e){function t(t,n,i){return e.call(this,t,0,0,n,i,{spine:{key:M,spineConfig:{animation:u.Of.MELEE.IDLE,loop:!0}},useSpine:!O()(x).call(x,i.level)})||this}return(0,i.Z)(t,e),t}(L),F=D.Z.UNITS_SPRITES,Z=F.KEY,G=F.FRAME,H=D.Z.UNITS_SPINES.MELEE[1].KEY,Y=GameCore.Configs.UnitsConfig.MELEE.listLevelsUseSprite,K=function(e){function t(t,n,i){return e.call(this,t,0,0,n,i,{spine:{key:H,spineConfig:{animation:u.Of.MELEE.IDLE,loop:!0}},sprite:{key:Z,frame:G.MELEE[1].MAIN_TEXTURE,displayWidth:86.5,displayHeight:68},useSpine:!O()(Y).call(Y,i.level)})||this}return(0,i.Z)(t,e),t}(L),V=D.Z.UNITS_SPINES.MELEE[2].KEY,W=GameCore.Configs.UnitsConfig.MELEE.listLevelsUseSprite,j=function(e){function t(t,n,i){var a;return(a=e.call(this,t,0,0,n,i,{spine:{key:V,spineConfig:{animation:u.Of.MELEE.IDLE,loop:!0}},useSpine:!O()(W).call(W,i.level)})||this).updatePositionHpBar(),a}return(0,i.Z)(t,e),t}(L),z=D.Z.UNITS_SPINES.MELEE[3].KEY,X=GameCore.Configs.UnitsConfig.MELEE.listLevelsUseSprite,q=function(e){function t(t,n,i){var a;return(a=e.call(this,t,0,0,n,i,{spine:{key:z,spineConfig:{animation:u.Of.MELEE.IDLE,loop:!0}},useSpine:!O()(X).call(X,i.level)})||this).updatePositionHpBar(),a}return(0,i.Z)(t,e),t}(L),Q=D.Z.UNITS_SPINES.MELEE[4].KEY,J=GameCore.Configs.UnitsConfig.MELEE.listLevelsUseSprite,$=function(e){function t(t,n,i){var a;return(a=e.call(this,t,0,0,n,i,{spine:{key:Q,spineConfig:{animation:u.Of.MELEE.IDLE,loop:!0}},useSpine:!O()(J).call(J,i.level)})||this).updatePositionHpBar(),a}return(0,i.Z)(t,e),t}(L),ee=D.Z.UNITS_SPINES.MELEE[5].KEY,te=GameCore.Configs.UnitsConfig.MELEE.listLevelsUseSprite,ne=function(e){function t(t,n,i){var a;return(a=e.call(this,t,0,0,n,i,{spine:{key:ee,spineConfig:{animation:u.Of.MELEE.IDLE,loop:!0}},useSpine:!O()(te).call(te,i.level)})||this).updatePositionHpBar(),a}return(0,i.Z)(t,e),t}(L),ie=D.Z.UNITS_SPINES.MELEE[6].KEY,ae=GameCore.Configs.UnitsConfig.MELEE.listLevelsUseSprite,se=function(e){function t(t,n,i){var a;return(a=e.call(this,t,0,0,n,i,{spine:{key:ie,spineConfig:{animation:u.Of.MELEE.IDLE,loop:!0}},useSpine:!O()(ae).call(ae,i.level)})||this).updatePositionHpBar(),a}return(0,i.Z)(t,e),t}(L),re=D.Z.UNITS_SPINES.MELEE[7].KEY,oe=GameCore.Configs.UnitsConfig.MELEE.listLevelsUseSprite,ce=function(e){function t(t,n,i){return e.call(this,t,0,0,n,i,{spine:{key:re,spineConfig:{animation:u.Of.MELEE.IDLE,loop:!0}},useSpine:!O()(oe).call(oe,i.level)})||this}return(0,i.Z)(t,e),t}(L),le=D.Z.UNITS_SPINES.MELEE[8].KEY,ue=GameCore.Configs.UnitsConfig.MELEE.listLevelsUseSprite,he=function(e){function t(t,n,i){return e.call(this,t,0,0,n,i,{spine:{key:le,spineConfig:{animation:u.Of.MELEE.IDLE,loop:!0}},useSpine:!O()(ue).call(ue,i.level)})||this}return(0,i.Z)(t,e),t}(L),de=D.Z.UNITS_SPINES.MELEE[9].KEY,pe=GameCore.Configs.UnitsConfig.MELEE.listLevelsUseSprite,fe=function(e){function t(t,n,i){return e.call(this,t,0,0,n,i,{spine:{key:de,spineConfig:{animation:u.Of.MELEE.IDLE,loop:!0}},useSpine:!O()(pe).call(pe,i.level)})||this}return(0,i.Z)(t,e),t}(L),ge=function(e){function t(){return e.apply(this,arguments)||this}(0,i.Z)(t,e);var n=t.prototype;return n.requestUnitByLevel=function(e,t,n){void 0===n&&(n=!1);var i=this.getUnitFromResourcePoolByLevel(e);return i?(t&&!n&&(this.numOfPlayerSpawnedUnits+=Math.pow(2,e-1)),i.reuseUnitFromPool(t),this.scene.add.existing(i),i):i=this.createUnitByLevel(e,t,n)},n.requestUnitById=function(e,t,n){void 0===n&&(n=!1);var i=this.getUnitFromResourcePoolById(e);return i?(t&&!n&&(this.numOfPlayerSpawnedUnits+=Math.pow(2,i.level-1)),i.reuseUnitFromPool(t),this.scene.add.existing(i),i):i=this.createUnitById(e,t,n)},n.createUnitByLevel=function(e,t,n){var i;void 0===n&&(n=!1);var a=this.getUnitDataByLevel(e);switch(a||this.scene.rollbar.sendException(new Error("No unit data found for melee level "+e)),e){case 1:i=new K(this.scene,t,a);break;case 2:i=new j(this.scene,t,a);break;case 3:i=new q(this.scene,t,a);break;case 4:i=new $(this.scene,t,a);break;case 5:i=new ne(this.scene,t,a);break;case 6:i=new se(this.scene,t,a);break;case 7:i=new ce(this.scene,t,a);break;case 8:i=new he(this.scene,t,a);break;case 9:i=new fe(this.scene,t,a);break;case 10:i=new B(this.scene,t,a);break;case 11:i=new U(this.scene,t,a);break;default:return new r.Z(this.scene,t)}return t&&!n&&(this.numOfPlayerSpawnedUnits+=Math.pow(2,e-1)),i},n.createUnitById=function(e,t,n){var i;void 0===n&&(n=!1);var a=this.getUnitDataById(e);if(!a)return new r.Z(this.scene,t);switch(e){case"velociraptor":i=new K(this.scene,t,a);break;case"saurolophus":i=new j(this.scene,t,a);break;case"pachysaurus":i=new q(this.scene,t,a);break;case"triceratops":i=new $(this.scene,t,a);break;case"stegosaurus":i=new ne(this.scene,t,a);break;case"ankylosaurus":i=new se(this.scene,t,a);break;case"baroptiloraptor":i=new ce(this.scene,t,a);break;case"tyrannosaurus":i=new he(this.scene,t,a);break;case"dilophosaurus":i=new fe(this.scene,t,a);break;case"triceradonosaurus":i=new B(this.scene,t,a);break;case"spinosaurus-rex":i=new U(this.scene,t,a);break;default:return new r.Z(this.scene,t)}return t&&!n&&(this.numOfPlayerSpawnedUnits+=Math.pow(2,a.level-1)),i},n.getUnitDataByLevel=function(e){return this.scene.cache.json.get("unitData").melee[e-1]},n.getUnitDataById=function(e){var t,n=this.scene.cache.json.get("unitData");return s()(t=n.melee).call(t,(function(t){return t.id===e}))},n.getUnitFromResourcePoolByLevel=function(e){var t=this.resourcePool.getChildren(),n=s()(t).call(t,(function(t){return t instanceof L&&t.level===e}));if(n instanceof o.Z)return this.resourcePool.remove(n),n},n.getUnitFromResourcePoolById=function(e){var t=this.resourcePool.getChildren(),n=s()(t).call(t,(function(t){return t instanceof L&&t.originalUnitData.id===e}));if(n instanceof o.Z)return this.resourcePool.remove(n),n},t}(n(681).Z),Ee=ge},637:function(e,t,n){"use strict";n.d(t,{Z:function(){return we}});var i=n(1),a=n(114),s=n.n(a),r=n(680),o=n(161),c=n(5),l=n(109),u=n(40),h=n(638),d=n(639),p=n(640),f=n(641),g=n(642),E=n(643),m=n(644),v=n(645),A=n(646),S=n(647),T=n(648),y=function(){function e(e){this.unit=void 0,this.scene=void 0,this.unit=e,this.scene=e.scene}return e.prototype.createProjectile=function(e){var t,n=e.level,i=e.speed,a=e.target,s={attacker:this.unit,target:a,speed:i};switch(n){case 1:t=new h.Z(this.unit.scene,s);break;case 2:t=new d.Z(this.unit.scene,s);break;case 3:t=new p.Z(this.unit.scene,s);break;case 4:t=new f.Z(this.unit.scene,s);break;case 5:t=new g.Z(this.unit.scene,s);break;case 6:t=new E.Z(this.unit.scene,s);break;case 7:t=new m.Z(this.unit.scene,s);break;case 8:t=new v.Z(this.unit.scene,s);break;case 9:t=new A.Z(this.unit.scene,s);break;case 10:t=new S.Z(this.unit.scene,s);break;case 11:t=new T.Z(this.unit.scene,s);break;default:t=new u.Z(this.unit.scene,s)}this.scene.unitManager.rangedProjectiles.add(t)},e}(),C=n(17),I=n(234),R=n(476),w=n(477),_=n(25),b=function(e){function t(t,n){var i;return(i=e.call(this,t,{spineAnimKey:n.spineAboveAnimKey,spriteAnimKey:n.spriteAboveAnimKey,status:n.status})||this).unit=void 0,i.spriteBelowAnimKey=void 0,i.spineBelowAnimKey=void 0,i.handleAttacked=function(){if(!i.unit.isKilled()){var e=i.unit.attackController.getAttackTarget();e&&(e.isKilled()&&i.unit.display.addAnimEventListener(Phaser.Animations.Events.ANIMATION_COMPLETE,i.handleFinishedAttacking),i.unit.projectileController.createProjectile({level:i.unit.level,target:e}),i.unit.scene.audio.playSound(_.Z.ARROW_SHOOT,{volume:.5,detune:-1e3*Math.random()}))}},i.handleFinishedAttacking=function(){i.unit.setStatus(I.Z.FINISHED_ATTACKING)},i.spriteBelowAnimKey=n.spriteBelowAnimKey,i.spineBelowAnimKey=n.spineBelowAnimKey,i.unit=t,i}return(0,i.Z)(t,e),t.prototype.execute=function(){var e=this.payload,t=e.spriteAnimKey,n=e.spineAnimKey,i=e.status,a=this.unit.attackController.getAttackTarget();a?(this.unit.setStatus(i),this.unit.display.setAnimationTimeScale(1),this.unit.y>a.y?this.unit.display.play(this.spriteBelowAnimKey,this.spineBelowAnimKey,!1):this.unit.display.play(t,n,!1),this.unit.display.addAnimEventListener(l.Of.RANGED.CUSTOM_EVENTS.FINISHED_ATTACKING,this.handleAttacked),this.unit.display.setFlipX(a.x<=this.unit.x)):this.unit.setStatus(I.Z.FINISHED_ATTACKING)},t}(R.Z),L=n(41),P=n.n(L),O=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=e.call.apply(e,P()(t=[this]).call(t,a))||this).handleAnimationComplete=function(){n.unit.effectController.runDieEffect()},n}return(0,i.Z)(t,e),t.prototype.execute=function(){var e,t=this.payload,n=t.spriteAnimKey,i=t.spineAnimKey,a=t.status;this.unit.setStatus(a),null==(e=this.unit.attackEvent)||e.remove(),this.unit.uiController.killHpBar(),this.unit.depthController.setDepthOnDeath(),this.unit.effectController.stopDamageEffect(),this.unit.display.setAnimationTimeScale(1),this.unit.display.play(n,i,!1,!0),this.unit.display.addAnimEventListener(Phaser.Animations.Events.ANIMATION_COMPLETE,this.handleAnimationComplete)},t}(R.Z),D=O,k=function(e){function t(){return e.apply(this,arguments)||this}return(0,i.Z)(t,e),t.prototype.execute=function(){var e=this.payload,t=e.spriteAnimKey,n=e.spineAnimKey,i=e.status;this.unit.revive(),this.unit.setStatus(i),this.unit.isDepthDirty=!0,this.unit.uiController.killHpBar(),this.unit.effectController.stopDieEffect(),this.unit.display.setFlipX(!1),this.unit.display.play(t,n,!0,!0),this.unit.display.setAnimationTimeScale(.5+Math.random()),this.unit.attackController.reset()},t}(R.Z),N=k,B=function(e){function t(){return e.apply(this,arguments)||this}return(0,i.Z)(t,e),t.prototype.execute=function(){var e=this.payload,t=e.spriteAnimKey,n=e.spineAnimKey,i=e.status;this.unit.setStatus(i),this.unit.uiController.reviveHpBar(),this.unit.display.play(t,n,!0,!0),this.unit.display.setAnimationTimeScale(.5+Math.random())},t}(R.Z),M=B,x=(l.Of.RANGED,function(e){function t(t){var n;return(n=e.call(this,t)||this).unit=void 0,n.unit=t,n}(0,i.Z)(t,e);var n=t.prototype;return n.addAttackCommand=function(){this.attackCommand=new b(this.unit,{status:I.Z.ATTACKING,spriteAboveAnimKey:this.getSpriteAnimKeyByUnitLevel("ATTACK_ABOVE"),spriteBelowAnimKey:this.getSpriteAnimKeyByUnitLevel("ATTACK_BELOW"),spineAboveAnimKey:this.getSpineAnimKeyByUnitLevel("ATTACK_ABOVE"),spineBelowAnimKey:this.getSpineAnimKeyByUnitLevel("ATTACK_BELOW")})},n.addReadyCommand=function(){this.readyCommand=new M(this.unit,{status:I.Z.READY,spriteAnimKey:this.getSpriteAnimKeyByUnitLevel("IDLE"),spineAnimKey:this.getSpineAnimKeyByUnitLevel("IDLE")})},n.addMoveCommand=function(){this.moveCommand=new R.Z(this.unit,{status:I.Z.MOVING_TO_TARGET,spriteAnimKey:this.getSpriteAnimKeyByUnitLevel("IDLE"),spineAnimKey:this.getSpineAnimKeyByUnitLevel("IDLE")})},n.addDieCommand=function(){this.dieCommand=new D(this.unit,{status:I.Z.KILLED,spriteAnimKey:this.getSpriteAnimKeyByUnitLevel("DIE"),spineAnimKey:this.getSpineAnimKeyByUnitLevel("DIE")})},n.addPrepareCommand=function(){this.prepareCommand=new N(this.unit,{status:I.Z.PREPARE,spriteAnimKey:this.getSpriteAnimKeyByUnitLevel("IDLE"),spineAnimKey:this.getSpineAnimKeyByUnitLevel("IDLE")})},n.resetRangedAttackAnimation=function(){this.addAttackCommand()},n.getSpriteAnimKeyByUnitLevel=function(e){try{var t=this.unit,n=t.level,i=(t.scene,t.unitType,n);return i>=2&&(i=1),l.VA.RANGED[i][e].KEY}catch(a){return console.warn(a),l.VA.ALIEN[1].IDLE.KEY}},n.getSpineAnimKeyByUnitLevel=function(e){var t=l.Of.RANGED[e];if(!t)throw new Error("Can't find spine animation "+e);return t},t}(w.Z)),U=l.Of.RANGED.CUSTOM_EVENTS.FINISHED_ATTACKING,F=function(e){function t(t,n,i,a,s,r){var o;(o=e.call(this,t,n,i,a,s,r)||this).projectileColor=void 0,o.projectileSpeed=void 0,o.projectileController=void 0,o.projectileController=new y((0,c.Z)(o)),o.unitType=C.Z.RANGED_UNIT_TYPE,o.attackInterval=C.Z.RANGED_ATTACK_INTERVAL;var l=o.display.getSpineAnimationAttackingTime();return o.attackInterval<l&&(o.attackInterval=l),o.projectileSpeed=C.Z.RANGED_PROJECTILE_SPEED,o}(0,i.Z)(t,e);var n=t.prototype;return n.createActions=function(){this.actions=new x(this)},n.determineCounteringEnemy=function(){var e,t=this.attackController,n=t.beingAttackedByMelee,i=t.beingAttackedByRanged,a=this.attackController.getAttackTarget();return null!=(e=a)&&e.isKilled()&&(a=null),n&&!n.isKilled()?(this.attackController.setAttackTarget(n),!0):!(!i||i.isKilled())&&(this.attackController.setAttackTarget(i),!0)},n.setUnitData=function(t){e.prototype.setUnitData.call(this,t),this.unitType=C.Z.RANGED_UNIT_TYPE},n.update=function(t,n){if(e.prototype.update.call(this,t,n),!this.isKilled()&&this.scene.stateManager.isInPlayingState()){var i=this.attackController.getAttackTarget();if(this.isReady())return this.determineCounteringEnemy()||i&&!i.isKilled()||this.findTarget(),void(i&&this.setStatus(I.Z.PREPARE_TO_ATTACK));if(this.isPreparingToAttack())return null!=i&&i.isKilled()?void this.actions.ready():void this.attack();this.isAttacking()&&null!=i&&i.isKilled()&&3!==this.display.getAnimationTimeScale()&&(this.display.setAnimationTimeScale(3),this.display.changeCurrentSpriteEventTime(U)),this.isFinishedAttacking()&&this.actions.ready()}},n.reuseUnitFromPool=function(t){e.prototype.reuseUnitFromPool.call(this,t);var n=this.actions;n instanceof x&&n.resetRangedAttackAnimation()},t}(o.Z),Z=n(87),G=n.n(Z),H=n(2),Y=H.Z.UNITS_SPINES.RANGED[10].KEY,K=GameCore.Configs.UnitsConfig.RANGED.listLevelsUseSprite,V=function(e){function t(t,n,i){return e.call(this,t,0,0,n,i,{spine:{key:Y,spineConfig:{animation:l.Of.RANGED.IDLE,loop:!0}},useSpine:!G()(K).call(K,i.level)})||this}return(0,i.Z)(t,e),t}(F),W=H.Z.UNITS_SPINES.RANGED[11].KEY,j=GameCore.Configs.UnitsConfig.RANGED.listLevelsUseSprite,z=function(e){function t(t,n,i){return e.call(this,t,0,0,n,i,{spine:{key:W,spineConfig:{animation:l.Of.RANGED.IDLE,loop:!0}},useSpine:!G()(j).call(j,i.level)})||this}return(0,i.Z)(t,e),t}(F),X=H.Z.UNITS_SPRITES,q=X.KEY,Q=X.FRAME,J=H.Z.UNITS_SPINES.RANGED[1].KEY,$=GameCore.Configs.UnitsConfig.RANGED.listLevelsUseSprite,ee=function(e){function t(t,n,i){return e.call(this,t,0,0,n,i,{spine:{key:J,spineConfig:{animation:l.Of.RANGED.IDLE,loop:!0}},sprite:{key:q,frame:Q.RANGED[1].MAIN_TEXTURE,displayWidth:55,displayHeight:73},useSpine:!G()($).call($,i.level)})||this}return(0,i.Z)(t,e),t}(F),te=H.Z.UNITS_SPINES.RANGED[2].KEY,ne=GameCore.Configs.UnitsConfig.RANGED.listLevelsUseSprite,ie=function(e){function t(t,n,i){return e.call(this,t,0,0,n,i,{spine:{key:te,spineConfig:{animation:l.Of.RANGED.IDLE,loop:!0}},useSpine:!G()(ne).call(ne,i.level)})||this}return(0,i.Z)(t,e),t}(F),ae=H.Z.UNITS_SPINES.RANGED[3].KEY,se=GameCore.Configs.UnitsConfig.RANGED.listLevelsUseSprite,re=function(e){function t(t,n,i){return e.call(this,t,0,0,n,i,{spine:{key:ae,spineConfig:{animation:l.Of.RANGED.IDLE,loop:!0}},useSpine:!G()(se).call(se,i.level)})||this}return(0,i.Z)(t,e),t}(F),oe=H.Z.UNITS_SPINES.RANGED[4].KEY,ce=GameCore.Configs.UnitsConfig.RANGED.listLevelsUseSprite,le=function(e){function t(t,n,i){return e.call(this,t,0,0,n,i,{spine:{key:oe,spineConfig:{animation:l.Of.RANGED.IDLE,loop:!0}},useSpine:!G()(ce).call(ce,i.level)})||this}return(0,i.Z)(t,e),t}(F),ue=H.Z.UNITS_SPINES.RANGED[5].KEY,he=GameCore.Configs.UnitsConfig.RANGED.listLevelsUseSprite,de=function(e){function t(t,n,i){return e.call(this,t,0,0,n,i,{spine:{key:ue,spineConfig:{animation:l.Of.RANGED.IDLE,loop:!0}},useSpine:!G()(he).call(he,i.level)})||this}return(0,i.Z)(t,e),t}(F),pe=H.Z.UNITS_SPINES.RANGED[6].KEY,fe=GameCore.Configs.UnitsConfig.RANGED.listLevelsUseSprite,ge=function(e){function t(t,n,i){return e.call(this,t,0,0,n,i,{spine:{key:pe,spineConfig:{animation:l.Of.RANGED.IDLE,loop:!0}},useSpine:!G()(fe).call(fe,i.level)})||this}return(0,i.Z)(t,e),t}(F),Ee=H.Z.UNITS_SPINES.RANGED[7].KEY,me=GameCore.Configs.UnitsConfig.RANGED.listLevelsUseSprite,ve=function(e){function t(t,n,i){return e.call(this,t,0,0,n,i,{spine:{key:Ee,spineConfig:{animation:l.Of.RANGED.IDLE,loop:!0}},useSpine:!G()(me).call(me,i.level)})||this}return(0,i.Z)(t,e),t}(F),Ae=H.Z.UNITS_SPINES.RANGED[8].KEY,Se=GameCore.Configs.UnitsConfig.RANGED.listLevelsUseSprite,Te=function(e){function t(t,n,i){return e.call(this,t,0,0,n,i,{spine:{key:Ae,spineConfig:{animation:l.Of.RANGED.IDLE,loop:!0}},useSpine:!G()(Se).call(Se,i.level)})||this}return(0,i.Z)(t,e),t}(F),ye=H.Z.UNITS_SPINES.RANGED[9].KEY,Ce=GameCore.Configs.UnitsConfig.RANGED.listLevelsUseSprite,Ie=function(e){function t(t,n,i){return e.call(this,t,0,0,n,i,{spine:{key:ye,spineConfig:{animation:l.Of.RANGED.IDLE,loop:!0}},useSpine:!G()(Ce).call(Ce,i.level)})||this}return(0,i.Z)(t,e),t}(F),Re=function(e){function t(){return e.apply(this,arguments)||this}(0,i.Z)(t,e);var n=t.prototype;return n.requestUnitByLevel=function(e,t,n){void 0===n&&(n=!1);var i=this.getUnitFromResourcePoolByLevel(e);return i?(t&&!n&&(this.numOfPlayerSpawnedUnits+=Math.pow(2,e-1)),i.reuseUnitFromPool(t),this.scene.add.existing(i),i):i=this.createUnitByLevel(e,t,n)},n.requestUnitById=function(e,t,n){void 0===n&&(n=!1);var i=this.getUnitFromResourcePoolById(e);return i?(t&&!n&&(this.numOfPlayerSpawnedUnits+=Math.pow(2,i.level-1)),i.reuseUnitFromPool(t),this.scene.add.existing(i),i):i=this.createUnitById(e,t,n)},n.createUnitByLevel=function(e,t,n){var i;void 0===n&&(n=!1);var a=this.getUnitDataByLevel(e);switch(a||this.scene.rollbar.sendException(new Error("No unit data found for ranged level "+e)),e){case 1:i=new ee(this.scene,t,a);break;case 2:i=new ie(this.scene,t,a);break;case 3:i=new re(this.scene,t,a);break;case 4:i=new le(this.scene,t,a);break;case 5:i=new de(this.scene,t,a);break;case 6:i=new ge(this.scene,t,a);break;case 7:i=new ve(this.scene,t,a);break;case 8:i=new Te(this.scene,t,a);break;case 9:i=new Ie(this.scene,t,a);break;case 10:i=new V(this.scene,t,a);break;case 11:i=new z(this.scene,t,a);break;default:return new r.Z(this.scene,t)}return t&&!n&&(this.numOfPlayerSpawnedUnits+=Math.pow(2,e-1)),i},n.createUnitById=function(e,t,n){var i;void 0===n&&(n=!1);var a=this.getUnitDataById(e);if(!a)return new r.Z(this.scene,t);switch(e){case"rockthrower":i=new ee(this.scene,t,a);break;case"javelineer":i=new ie(this.scene,t,a);break;case"boomeranger":i=new re(this.scene,t,a);break;case"macer":i=new le(this.scene,t,a);break;case"artemis":i=new de(this.scene,t,a);break;case"william":i=new ge(this.scene,t,a);break;case"blanchette":i=new ve(this.scene,t,a);break;case"phantom":i=new Te(this.scene,t,a);break;case"oracle":i=new Ie(this.scene,t,a);break;case"shaman":i=new V(this.scene,t,a);break;case"seraph":i=new z(this.scene,t,a);break;default:return new r.Z(this.scene,t)}return t&&!n&&(this.numOfPlayerSpawnedUnits+=Math.pow(2,a.level-1)),i},n.getUnitDataByLevel=function(e){return this.scene.cache.json.get("unitData").ranged[e-1]},n.getUnitDataById=function(e){var t,n=this.scene.cache.json.get("unitData");return s()(t=n.ranged).call(t,(function(t){return t.id===e}))},n.getUnitFromResourcePoolByLevel=function(e){var t=this.resourcePool.getChildren(),n=s()(t).call(t,(function(t){return t instanceof F&&t.level===e}));if(n instanceof o.Z)return this.resourcePool.remove(n),n},n.getUnitFromResourcePoolById=function(e){var t=this.resourcePool.getChildren(),n=s()(t).call(t,(function(t){return t instanceof F&&t.originalUnitData.id===e}));if(n instanceof o.Z)return this.resourcePool.remove(n),n},t}(n(681).Z),we=Re},680:function(e,t,n){"use strict";var i=n(1),a=n(2),s=n(109),r=n(161),o=a.Z.UNITS_SPRITES,c=o.KEY,l=o.FRAME,u=a.Z.UNITS_SPINES.MELEE[1].KEY,h=function(e){function t(t,n){var i;return(i=e.call(this,t,0,0,n,{level:100,id:"alien",name:"Warlock",health:1,damage:1,attackSpeed:1},{spine:{key:u,spineConfig:{animation:s.Of.MELEE.IDLE,loop:!0}},sprite:{key:c,frame:l.MELEE[1].MAIN_TEXTURE,displayWidth:86.5,displayHeight:68},useSpine:!0})||this).level=1,i.unitName="Alien Lv.100",i.attackPower=1,i.setDefaultHp(999999),i}(0,i.Z)(t,e);var n=t.prototype;return n.createActions=function(){throw new Error("Method not implemented.")},n.findTarget=function(){throw new Error("Method not implemented.")},t}(r.Z);t.Z=h},161:function(e,t,n){"use strict";n.d(t,{Z:function(){return K}});var i=n(57),a=n(5),s=n(1),r=n(234),o=n(114),c=n.n(o),l=n(59),u=n.n(l),h=n(101),d=n.n(h),p=n(17),f=function(){function e(e){this.unit=void 0,this.attackSpots=void 0,this.attackTarget=void 0,this.beingAttackedByMelee=void 0,this.beingAttackedByRanged=void 0,this.attackSpotPairings=void 0,this.unit=e,this.attackSpots=[],this.attackSpotPairings=[]}var t=e.prototype;return t.reset=function(){this.resetAttackSpots(),this.resetAttackTarget(),this.beingAttackedByMelee=null,this.beingAttackedByRanged=null},t.createAttackSpots=function(){for(var e=this.unit,t=e.x,n=e.y,i=p.Z.MELEE_ATTACK_RANGE,a=0;a<=8;a++)if(0===a){var s=new Phaser.Math.Vector2(t+i,n),r=new Phaser.Math.Vector2(t-i,n);this.attackSpots.push({location:s,occupiedUnit:null}),this.attackSpots.push({location:r,occupiedUnit:null});var o=this.attackSpots.length-1;this.attackSpotPairings.push({a:o-1,b:o})}else{var c=Phaser.Math.DegToRad(20*a/4),l=new Phaser.Math.Vector2(t+i*Math.cos(c),n+i*Math.sin(c)),u=new Phaser.Math.Vector2(t-i*Math.cos(c),n+i*Math.sin(c)),h=new Phaser.Math.Vector2(t+i*Math.cos(c),n-i*Math.sin(c)),d=new Phaser.Math.Vector2(t-i*Math.cos(c),n-i*Math.sin(c));this.attackSpots.push({location:l,occupiedUnit:null}),this.attackSpots.push({location:u,occupiedUnit:null}),this.attackSpots.push({location:h,occupiedUnit:null}),this.attackSpots.push({location:d,occupiedUnit:null});var f=this.attackSpots.length-1;this.attackSpotPairings.push({a:f-3,b:f}),this.attackSpotPairings.push({a:f-2,b:f-1})}},t.assignAttackingUnit=function(e){var t,n,i=this;if(this.attackTarget===e){var a,s=-1;if(c()(a=e.attackController.attackSpots).call(a,(function(e,t){return e.occupiedUnit===i.unit&&-1===s&&(s=t,!0)})),-1!==s){var r,o=c()(r=this.attackSpotPairings).call(r,(function(e){return e.a===s||e.b===s}));if(o){var l=o.a===s?o.b:o.a;return this.attackSpots[l]}}}var h=u()(t=this.attackSpots).call(t,(function(t){var a=null===t.occupiedUnit||t.occupiedUnit===e,s=!0;t.occupiedUnit===e&&(n=t);var r=i.unit.scene.gameZone;return i.unit.x<r.displayWidth/5&&(s=t.location.x>i.unit.x),i.unit.x>r.displayWidth-r.displayWidth/5&&(s=t.location.x<i.unit.x),a&&s}));if(0===h.length)return null;var p=e.x,f=e.y,g=d()(h).call(h,(function(e,t){var n=t.location,i=n.x,a=n.y,s=e.location,r=s.x,o=s.y;return Math.sqrt(Math.pow(i-p,2)+Math.pow(a-f,2))<Math.sqrt(Math.pow(r-p,2)+Math.pow(o-f,2))?t:e}),h[0]);return n&&n!==g&&(n.occupiedUnit=null),g.occupiedUnit=e,g},t.clearAttackingUnit=function(e){this.attackSpots.forEach((function(t){t.occupiedUnit===e&&(t.occupiedUnit=null)}))},t.moveAttackSpotMelee=function(e,t){this.attackSpots.forEach((function(n){var i=n.location,a=i.x,s=i.y;n.location.set(a+e,s+t)}))},t.checkForInvalidOccupiedUnits=function(){this.attackSpots.forEach((function(e){e.occupiedUnit&&e.occupiedUnit.isKilled()&&(e.occupiedUnit=null)}))},t.resetAttackSpots=function(){this.attackSpots=[],this.createAttackSpots()},t.resetAttackSpotOfUnit=function(e){this.attackSpots.forEach((function(t){t.occupiedUnit===e&&(t.occupiedUnit=null)}))},t.getAttackTarget=function(){return this.attackTarget},t.setAttackTarget=function(e){this.attackTarget=e},t.notifyTargetAttacked=function(e){e.unitType===p.Z.MELEE_UNIT_TYPE?this.beingAttackedByMelee=e:e.unitType===p.Z.RANGED_UNIT_TYPE&&(this.beingAttackedByRanged=e)},t.resetAttackTarget=function(){this.attackTarget=null},e}(),g=n(66),E=g.Z.MANAGER_BASE_DEPTH,m=function(){function e(e){this.unit=void 0,this.scene=void 0,this.unit=e,this.scene=e.scene}var t=e.prototype;return t.calculateDepth=function(){var e=this.unit,t=e.y,n=e.currentLocation,i=void 0===n?null:n,a=t+this.scene.fieldManager.firstHightLineZone.height/4,s=0;i&&this.unit.isInPrepareMode()&&(s=i.colId);var r=this.scene.fieldManager.fieldBackground,o=r.getTopLeft().y,c=r.displayHeight/100,l=-s;return E+.4*(Math.floor((a-o)/c)+l)},t.setDepthOnDeath=function(){this.unit.isDepthDirty=!1;var e=this.calculateDepth()-.2;this.unit.setDepth(e)},t.getProjectileDepth=function(){return E+41},e}(),v=m,A=n(89),S=n.n(A),T=function(){function e(e){this.unit=void 0,this.scene=void 0,this.unit=e,this.scene=e.scene}var t=e.prototype;return t.getAttackTarget=function(){switch(this.unit.unitType){case p.Z.MELEE_UNIT_TYPE:return this.getAttackTargetForMeleeUnit();case p.Z.RANGED_UNIT_TYPE:return this.getAttackTargetForRangedUnit();default:return null}},t.getAttackTargetForMeleeUnit=function(){var e,t=this.unit,n=t.x,i=t.y,a=t.isPlayer;if(this.unit.isKilled())return null;var s=this.scene.unitManager,r=s.enemyUnits,o=s.playerUnits,c=a?r:o,l=u()(e=c.getChildren()).call(e,(function(e){return e instanceof K&&!e.isKilled()}));switch(l.length){case 0:return null;case 1:return l[0]}for(var h=1e4,d=S()(l).call(l,(function(e,t){var a=e.x,s=e.y,r=t.x,o=t.y,c=Math.sqrt(Math.pow(a-n,2)+Math.pow(s-i,2)),l=Math.sqrt(Math.pow(r-n,2)+Math.pow(o-i,2));return h=Math.min(h,c),h=Math.min(h,l),c-l})),p=[d[0]],f=1;f<d.length;f++){var g=d[f],E=g.x,m=g.y;if(Math.sqrt(Math.pow(E-n,2)+Math.pow(m-i,2))!==h)break;p.push(g)}if(1===p.length)return p[0];for(var v=p[0].currentHp,A=S()(p).call(p,(function(e,t){return v=Math.min(v,e.currentHp),v=Math.min(v,t.currentHp),e.currentHp-t.currentHp})),T=[A[0]],y=1;y<A.length;y++){var C=A[y];if(C.currentHp!==v)break;T.push(C)}return 1===T.length?T[0]:S()(T).call(T,(function(e,t){return t.attackPower-e.attackPower}))[0]},t.getAttackTargetForRangedUnit=function(){var e,t=this.unit,n=t.x,i=t.y,a=t.isPlayer;if(this.unit.isKilled())return null;var s=this.scene.unitManager,r=s.enemyUnits,o=s.playerUnits,c=a?r:o,l=u()(e=c.getChildren()).call(e,(function(e){return e instanceof K&&!e.isKilled()}));switch(l.length){case 0:return null;case 1:return l[0]}for(var h=1e4,d=S()(l).call(l,(function(e,t){var a=e.x,s=e.y,r=t.x,o=t.y,c=Math.sqrt(Math.pow(a-n,2)+Math.pow(s-i,2)),l=Math.sqrt(Math.pow(r-n,2)+Math.pow(o-i,2));return h=Math.min(h,c),h=Math.min(h,l),c-l})),p=[d[0]],f=1;f<d.length;f++){var g=d[f],E=g.x,m=g.y;if(Math.sqrt(Math.pow(E-n,2)+Math.pow(m-i,2))!==h)break;p.push(g)}if(1===p.length)return p[0];for(var v=p[0].currentHp,A=S()(p).call(p,(function(e,t){return v=Math.min(v,e.currentHp),v=Math.min(v,t.currentHp),e.currentHp-t.currentHp})),T=[A[0]],y=1;y<A.length;y++){var C=A[y];if(C.currentHp!==v)break;T.push(C)}return 1===T.length?T[0]:S()(T).call(T,(function(e,t){return e.attackPower-t.attackPower}))[0]},e}(),y=function(){function e(e){this.unit=void 0,this.scene=void 0,this.tween=void 0,this.unit=e,this.scene=e.scene}var t=e.prototype;return t.createTween=function(){var e,t=this;null==(e=this.tween)||e.remove(),this.tween=this.scene.tweens.addCounter({from:0,to:100,duration:200,onStart:function(){t.unit.display.clearTint()},onUpdate:function(e){var n=e.getValue(),i=Math.floor(2.55*n),a=Math.floor(2.55*n),s=Phaser.Display.Color.GetColor(255,a,i);t.unit.display.setTint(s)},onComplete:function(){t.unit.display.clearTint()}})},t.run=function(){this.createTween()},t.stop=function(){var e;null==(e=this.tween)||e.remove(),this.unit.display.clearTint()},e}(),C=n(41),I=n.n(C),R=n(126),w=n(152),_=n.n(w)()(0,1.9,.42,1.9),b=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=e.call.apply(e,I()(t=[this]).call(t,a))||this).handleShowEffect=function(){n.createFloatingText(n.currentTotalNumber),n.scene.coin.plusCoins(n.currentTotalNumber.baseValue,n.currentTotalNumber.suffix);var e=n.scene.coin.getCurrentCoins();n.scene.layoutManager.objects.coinBar.setCoins(e),n.currentTotalNumber=new R.Z(0)},n}return(0,s.Z)(t,e),t.prototype.getText=function(e){return"$"+e.toString()},t}(function(){function e(e){var t=this;this.unit=void 0,this.scene=void 0,this.currentTotalNumber=void 0,this.handleShowEffect=function(){t.createFloatingText(t.currentTotalNumber),t.currentTotalNumber=new R.Z(0)},this.unit=e,this.scene=e.scene,this.currentTotalNumber=new R.Z(0)}var t=e.prototype;return t.increaseNumberStack=function(e){0===this.currentTotalNumber.baseValue&&this.scene.time.delayedCall(150,this.handleShowEffect),this.currentTotalNumber.add(e)},t.createFloatingText=function(e){var t=this,n=this.getText(e),i=this.scene.effectManger.getTextEffectObject();i.revive(),i.setText(n),i.setFontSize(14),i.setPosition(this.unit.x,this.unit.y),this.scene.add.tween({targets:i,props:{alpha:{from:0,duration:100,ease:Phaser.Math.Easing.Expo.Out,to:1}},onComplete:function(){var e=t.unit.display.displayHeight;i.setTint(16753920);var n=t.unit.display.isSpine()?t.unit.y-e/2:t.unit.y,a=Phaser.Math.Between(-1,1)<0?t.unit.x-50:t.unit.x+50;t.scene.add.tween({targets:i,props:{alpha:{from:1,duration:300,ease:Phaser.Math.Easing.Expo.Out,to:0,delay:700},x:{from:t.unit.x,duration:1e3,ease:Phaser.Math.Easing.Linear,to:a},y:{from:n,duration:1e3,ease:_,to:n-15}},onComplete:function(){i.setAlpha(1),i.kill()}})}})},t.getText=function(e){return""+e.toString()},e}()),L=b,P=function(){function e(e){this.unit=void 0,this.scene=void 0,this.tween=void 0,this.unit=e,this.scene=e.scene}var t=e.prototype;return t.createTween=function(){var e,t=this;if(null==(e=this.tween)||e.remove(),this.unit.isKilled()){var n=this.unit.getCurrentDisplay();n&&(this.tween=this.scene.tweens.add({targets:[n],delay:200,duration:300,ease:Phaser.Math.Easing.Quintic.InOut,props:{alpha:{start:1,from:1,to:0}},onStart:function(){t.unit.active||t.stop()},onComplete:function(){t.unit.kill()}}))}},t.play=function(){this.createTween()},t.stop=function(){var e;null==(e=this.tween)||e.remove();var t=this.unit.getCurrentDisplay();this.scene.tweens.killTweensOf(t),t.setAlpha(1),this.unit.revive()},e}(),O=function(){function e(e){this.unit=void 0,this.coinsEffect=void 0,this.damagedEffect=void 0,this.dieEffect=void 0,this.unit=e,this.createCoinsEffect(),this.createDamagedEffect(),this.createDieEffect()}var t=e.prototype;return t.createCoinsEffect=function(){this.coinsEffect=new L(this.unit)},t.createDamagedEffect=function(){this.damagedEffect=new y(this.unit)},t.createDieEffect=function(){this.dieEffect=new P(this.unit)},t.runDamagedEffect=function(){this.damagedEffect.run()},t.stopDamageEffect=function(){this.damagedEffect.stop()},t.runDieEffect=function(){this.dieEffect.play()},t.stopDieEffect=function(){this.dieEffect.stop()},t.increaseCoinEffectStack=function(e){this.coinsEffect.increaseNumberStack(e)},e}(),D=n(475),k=function(){function e(e){this.unit=void 0,this.hpBar=void 0,this.spineOffset=void 0,this.unit=e,this.createHpBar()}var t=e.prototype;return t.createHpBar=function(){var e=this.unit,t=e.scene,n=e.isPlayer?39423:15466524;this.hpBar=new D.Z(t,n),this.updatePositionHpBar(),this.hpBar.setDepth(g.Z.UNIT_HP_BAR)},t.destroyHpBar=function(){this.hpBar.destroy()},t.updatePositionHpBar=function(){this.spineOffset||(this.spineOffset=this.unit.display.displayHeight-20);var e=this.unit.getWorldPosition(),t=e.x,n=e.y;this.hpBar.setPosition(t,n-this.spineOffset)},t.setInitHp=function(e){this.hpBar.setInitHp(e)},t.updateCurrentHpUI=function(e){this.hpBar.updateCurrentHpUI(e)},t.reviveHpBar=function(){this.hpBar.revive()},t.killHpBar=function(){this.hpBar.kill()},t.changeHpColor=function(e){this.hpBar.changeHpColor(e)},t.update=function(){this.updatePositionHpBar()},e}(),N=n(33),B=n(109),M=p.Z.UNIT_SIZE_SCALE,x=GameCore.Configs.Gameplay.Powers.SpeedUp.modifier,U={end:function(){},start:function(){},event:function(e,t){},dispose:function(){},complete:function(){},interrupt:function(){}},F=function(e){function t(t,n){var i;return(i=e.call(this,t.scene)||this).scene=void 0,i.unit=void 0,i.config=void 0,i.spine=void 0,i.spineScale=void 0,i.isUseSpine=void 0,i.sprite=void 0,i.spriteEvent=void 0,i.isFlipX=void 0,i.unit=t,i.scene=t.scene,i.config=n,i.isUseSpine=n.useSpine,i.isFlipX=!1,i.initDisplay(),i.scaleDisplay(),i.y+=20,i}(0,s.Z)(t,e);var n=t.prototype;return n.initDisplay=function(){var e=this.config,t=e.spine,n=e.sprite;e.useSpine?(this.createSpine(t.key,t.spineConfig),this.spine.setVisible(!0),this.spine.setActive(!0)):n&&(this.createSprite(n.key,n.frame,n.displayWidth,n.displayHeight),this.sprite.revive())},n.scaleDisplay=function(){if(this.spine){var e=this.spine,t=e.displayWidth,n=e.displayHeight;this.setSize(t,n)}else if(this.sprite){var i=this.sprite,a=i.displayWidth,s=i.displayHeight;this.setSize(a,s)}},n.createSprite=function(e,t,n,i){this.sprite=this.scene.add.sprite(0,0,e,t),this.sprite.setOrigin(.5,1),this.sprite.setDisplaySize(n*M,i*M),this.add(this.sprite),this.sprite.kill()},n.createSpine=function(e,t,n){(void 0===n&&(n=!1),this.spine=this.scene.add.spine(0,0,e,t.animation,t.loop),this.setSpineScale(.5*M,.5*M),this.spine.setName(e),this.add(this.spine),n)&&this.scene.spineManager.addSpines([this.unit]);this.spine.setVisible(!1),this.spine.setActive(!1)},n.setSpineScale=function(e,t){this.spine&&(this.spine.scaleX===e&&this.spine.scaleY===t||(this.spineScale=t,this.spine.setScale(e,t)))},n.getSpineScale=function(){return this.spineScale},n.isSpine=function(){return this.isUseSpine},n.getCurrentDisplay=function(){return this.isUseSpine?this.spine:this.sprite},n.getSpineDisplay=function(){return this.spine},n.getSpriteDisplay=function(){return this.sprite},n.play=function(e,t,n,i,a){if(void 0===n&&(n=!1),void 0===i&&(i=!0),void 0===a&&(a=!0),this.setUseSpine(a),this.isUseSpine)this.spine.play(t,n,i);else{var s=this.sprite.visible;this.sprite.play({key:e,repeat:n?-1:0},i),this.sprite.setVisible(s)}},n.setUseSpine=function(e){if(this.isUseSpine!==e){if(this.isUseSpine=e,e){if(!this.spine){var t=this.config.spine,n=t.key,i=t.spineConfig;this.createSpine(n,i,!0)}}else if(!this.sprite&&this.config.sprite){var a=this.config.sprite,s=a.key,r=a.frame,o=a.displayWidth,c=a.displayHeight;this.createSprite(s,r,o,c)}var l;if(e)this.sprite.removeAllListeners(),null==(l=this.spriteEvent)||l.remove();else this.spine.state.clearListeners();this.setFlipX(this.isFlipX),e?(this.spine.setVisible(!0),this.spine.setActive(!0),this.sprite.kill()):(this.spine.setVisible(!1),this.spine.setActive(!1),this.sprite.revive())}},n.setAnimationTimeScale=function(e){var t=this.unit.scene.powerManager.isGameSpeedUp()?x:1;this.isUseSpine?this.spine.timeScale=e*t:this.sprite.anims.timeScale=e*t},n.getAnimationTimeScale=function(){return this.isUseSpine?this.spine.timeScale:this.sprite.anims.timeScale},n.setFlipX=function(e){if(this.isUseSpine){if(e&&this.spine.scaleX<0)return;if(!e&&this.spine.scaleX>0)return;this.setSpineScale(e?-this.spineScale:this.spineScale,this.spineScale)}else this.sprite.setFlipX(e);this.isFlipX=e},n.isFaceLeft=function(){return this.isUseSpine?this.spine.scaleX<0:this.sprite.flipX},n.setTint=function(e){try{this.isUseSpine?this.spine.setColor(e):this.sprite.setTint(e)}catch(t){console.warn(t)}},n.clearTint=function(){try{this.spine&&this.spine.setColor(),this.sprite&&this.sprite.clearTint()}catch(e){console.warn(e)}},n.getSpineAnimationAttackingTime=function(){if(!this.spine)return 0;var e,t=this.unit,n=t.unitType,i=t.isPlayer,a=B.Of.MELEE,s=B.Of.RANGED;switch(n){case p.Z.MELEE_UNIT_TYPE:e=this.spine.findAnimation(a.ATTACK);break;case p.Z.RANGED_UNIT_TYPE:(e=this.spine.findAnimation(i?s.ATTACK_BELOW:s.ATTACK_ABOVE))||(e=this.spine.findAnimation(s.ATTACK));break;default:return 0}return 1e3*e.duration},n.addAnimEventListener=function(e,t,n){if(void 0===n&&(n=!0),this.isUseSpine){n&&this.spine.state.clearListeners();var i=this.getEventNameForSpine(e);this.addSpineEventListener(i,t)}else{var a=this.getEventNameForSprite(e);if("string"===typeof a)n&&this.sprite.off(a),this.sprite.on(a,t);else{var s;if(!n)return;var r=this.sprite.anims,o=r.timeScale,c=r.msPerFrame;null==(s=this.spriteEvent)||s.remove();var l=a*c/o;this.spriteEvent=this.scene.time.delayedCall(l,t)}}},n.changeCurrentSpriteEventTime=function(e){return!this.isUseSpine&&(!!this.spriteEvent&&(this.spriteEvent.timeScale=3,!0))},n.getEventNameForSprite=function(e){var t=B.Tz.START,n=B.Tz.DISPOSE,i=B.Tz.INTERRUPT,a=Phaser.Animations.Events,s=a.ANIMATION_COMPLETE,r=a.ANIMATION_START,o=a.ANIMATION_STOP,c=this.unit,l=c.unitType,u=c.level;switch(e){case n:case i:return o;case t:return r;case B.Of[l.toUpperCase()].CUSTOM_EVENTS.FINISHED_ATTACKING:var h=B.VA[l.toUpperCase()][u].ATTACK.EVENT_FRAME;return h||(h=0),h;default:return s}},n.getEventNameForSpine=function(e){var t=Phaser.Animations.Events,n=t.ANIMATION_COMPLETE,i=t.ANIMATION_START,a=t.ANIMATION_STOP;switch(e){case i:return B.Tz.START;case a:return B.Tz.DISPOSE;case n:return B.Tz.COMPLETE;default:return e}},n.addSpineEventListener=function(e,t){var n=this,i=(0,N.Z)({},U);switch(e){case B.Tz.END:i.end=function(){t()};break;case B.Tz.START:i.start=function(){t()};break;case B.Tz.EVENT:i.event=function(){t()};break;case B.Tz.DISPOSE:i.dispose=function(){t()};break;case B.Tz.COMPLETE:i.complete=function(){n.spine.state.removeListener(i),t()};break;case B.Tz.INTERRUPT:i.interrupt=function(){t()};break;default:i.event=function(n,i){i.data.name===e&&t()}}this.spine.state.addListener(i)},t}(Phaser.GameObjects.Container),Z=n(25),G=n(86),H=g.Z.DEPTH_ON_DRAG,Y=function(e){function t(t,n,i,s,r,o){var c;return(c=e.call(this,t,n,i)||this).isDebug=!1,c.scene=void 0,c.display=void 0,c.dragZone=void 0,c.attackEvent=void 0,c.status=void 0,c.unitName=void 0,c.level=void 0,c.actions=void 0,c.hp=void 0,c.attackPower=void 0,c.attackInterval=void 0,c.unitType=void 0,c.uiController=void 0,c.depthController=void 0,c.attackController=void 0,c.targetController=void 0,c.effectController=void 0,c.currentLocation=void 0,c.isPlayer=void 0,c.lastDragPosition=void 0,c.lastWorldPosition=void 0,c.originalUnitData=void 0,c.isDepthDirty=void 0,c.isPositionDirty=void 0,c.attack=function(){try{if(c.canbeAttacked(),!c.isPreparingToAttack()&&!c.isAttacking())return;c.actions.attack();var e=c.attackController.getAttackTarget();if(!e)throw new Error("No attack target");if(e.isKilled())throw new Error("Attack target is killed");var t=c.scene.powerManager.isGameSpeedUp()?.5:1;c.attackEvent=c.scene.time.delayedCall(c.attackInterval*t,c.attack)}catch(i){var n;null==(n=c.attackEvent)||n.destroy(),c.actions.ready()}},c.onDragStart=function(){var e=c.scene.fieldManager.firstHightLineZone;e.revive(),e.setPosition(c.x,c.y),c.lastDragPosition=new Phaser.Math.Vector2(c.x,c.y),c.setDepthOnDrag(),c.scene.spineManager.bringToTopOnDrag((0,a.Z)(c)),c.scene.audio.playSound(Z.Z.UNIT_DRAG_START)},c.onDragEnd=function(){var e=c.scene,t=e.unitManager,n=e.fieldManager,i=n.firstHightLineZone,s=n.secondHightLineZone;i.kill(),s.kill(),c.isDepthDirty=!0;var r=n.getSquareBasedOnPosition(c.lastDragPosition.x,c.lastDragPosition.y);if(!r||r===c.currentLocation)return c.assignUnitToSquare(c.currentLocation.rowId,c.currentLocation.colId,c.isPlayer),t.resetAttackSpots((0,a.Z)(c)),void c.scene.audio.playSound(Z.Z.UNIT_DRAG_END);var o=t.getUnitBasedOnPosition(r.rowId,r.colId);if(!o)return c.assignUnitToSquare(r.rowId,r.colId,c.isPlayer),t.resetAttackSpots((0,a.Z)(c)),void c.scene.audio.playSound(Z.Z.UNIT_DRAG_END);var l=o.unitType===c.unitType,u=o.level===c.level;if(!l||!u)return c.swapUnitPosition(o),c.isDepthDirty=!0,o.isDepthDirty=!0,void c.scene.audio.playSound(Z.Z.UNIT_DRAG_END);t.mergeUnits((0,a.Z)(c),o)?c.currentLocation&&c.currentLocation.setTaken(!1):(c.assignUnitToSquare(c.currentLocation.rowId,c.currentLocation.colId,c.isPlayer),c.scene.audio.playSound(Z.Z.UNIT_DRAG_END))},c.onDrag=function(e){var t=e.worldX,n=e.worldY,i=e.wasTouch,a=c.scene.fieldManager.firstHightLineZone.height,s=i?.8*a:a/4,r=i?.55*a:0;c.setPosition(t,n-s),c.lastDragPosition.x=t,c.lastDragPosition.y=n-r;var o=c.scene.fieldManager.getSquareBasedOnPosition(c.lastDragPosition.x,c.lastDragPosition.y),l=c.scene.fieldManager.secondHightLineZone;if(o&&o!==c.currentLocation){l.revive(),l.setPosition(o.x,o.y),l.isStroked=!1;var u=c.scene.unitManager.getUnitBasedOnPosition(o.rowId,o.colId);u&&u.unitName===c.unitName&&(l.isStroked=!0)}else l.kill()},c.scene=t,c.createDragZone(),c.createDisplay(o),c.hp=0,c.level=0,c.attackPower=0,c.isDepthDirty=!1,c.isPositionDirty=!0,c.unitType="base",c.isPlayer=s,c.uiController=new k((0,a.Z)(c)),c.depthController=new v((0,a.Z)(c)),c.attackController=new f((0,a.Z)(c)),c.targetController=new T((0,a.Z)(c)),c.effectController=new O((0,a.Z)(c)),c.setUnitData(r),c.isPlayer&&c.addEventListener(),c.createActions(),c.actions.prepare(),c.scene.add.existing((0,a.Z)(c)),c}(0,s.Z)(t,e);var n=t.prototype;return n.createDisplay=function(e){this.display=new F(this,e),this.add(this.display)},n.createDragZone=function(){var e=this.scene.fieldManager;if(e){var t=e.getPlayerPlacementSquare(1,1).areaRect,n=t.displayWidth,i=t.displayHeight;this.dragZone=this.scene.add.zone(0,0,n,i),this.add(this.dragZone)}},n.addEventListener=function(){this.dragZone.setInteractive({draggable:!0,useHandCursor:!0}),this.dragZone.on(Phaser.Input.Events.GAMEOBJECT_DRAG_START,this.onDragStart),this.dragZone.on(Phaser.Input.Events.GAMEOBJECT_DRAG_END,this.onDragEnd),this.dragZone.on(Phaser.Input.Events.GAMEOBJECT_DRAG,this.onDrag)},n.addOnceEvent=function(e,t){this.dragZone.once(e,t)},n.removeOnceEvent=function(e,t){this.dragZone.off(e,t)},n.updatePositionHpBar=function(){this.uiController.updatePositionHpBar()},n.removeEventListener=function(){this.dragZone.off(Phaser.Input.Events.GAMEOBJECT_DRAG_START,this.onDragStart),this.dragZone.off(Phaser.Input.Events.GAMEOBJECT_DRAG_END,this.onDragEnd),this.dragZone.off(Phaser.Input.Events.GAMEOBJECT_DRAG,this.onDrag),this.dragZone.disableInteractive()},n.startEventListener=function(){this.removeEventListener(),this.addEventListener()},n.setDefaultHp=function(e){var t=window.clientInformation||{},n=t.playerIsCheater,i=t.opponentIsCheater,a=e;this.level>1&&(n&&this.isPlayer&&(a/=2),i&&!this.isPlayer&&(a/=2)),this.hp=a,this.uiController.setInitHp(a)},n.canbeAttacked=function(){if(this.isFinishedAttacking())throw new Error("Unit is finished attacking");if(this.isKilled())throw new Error("Unit is killed");var e=this.attackController.getAttackTarget();if(!e||null!=e&&e.isKilled())throw new Error("No attack target")},n.modifyCurrentAttackEvent=function(){if(this.attackEvent&&1!==this.attackEvent.getProgress()&&!this.isKilled()){var e=this.attackEvent.getRemaining();if(0!==e){var t=this.scene.powerManager.isGameSpeedUp()?.5:2;this.attackEvent.reset({delay:e*t,callback:this.attack})}}},n.takeDamage=function(e){if(!(this.hp<=0)){var t=this.scene,n=t.coinManager,i=t.uiManager;if(!this.isPlayer){var a=n.getAttackCoinByUnit(e,this);n.addCoinsByAttack(a),this.effectController.increaseCoinEffectStack(a)}var s=this.hp,r=this.getCorrectAttackPower(e);this.hp-=r,this.hp<0&&(this.hp=0),this.uiController.updateCurrentHpUI(this.hp),i.setTotalHpBar(s-this.hp,this.isPlayer),this.scene.audio.playSound(Z.Z.UNIT_DAMAGED,{volume:.2+.8*Math.random()}),(0,G.ZP)(50),this.hp<=0?this.actions.die():this.effectController.runDamagedEffect()}},n.getCorrectAttackPower=function(e){var t=window.clientInformation||{},n=t.playerIsCheater,i=t.opponentIsCheater,a=e.attackPower;return n&&this.level>1&&(this.isPlayer?a*=1*e.level:a/=2*this.level),i&&(this.isPlayer?a/=10*this.level:a*=20*e.level),a},n.getLastDragPos=function(){return this.lastDragPosition},n.dragUnitOnto=function(e,t){var n=this.scene,i=n.unitManager,a=n.fieldManager;this.isDepthDirty=!0;var s=a.getSquareBasedOnIndex(e,t);if(!s||s===this.currentLocation)return this.assignUnitToSquare(this.currentLocation.rowId,this.currentLocation.colId,this.isPlayer),void i.resetAttackSpots(this);var r=i.getUnitBasedOnPosition(s.rowId,s.colId);if(!r)return this.assignUnitToSquare(s.rowId,s.colId,this.isPlayer),void i.resetAttackSpots(this);var o=r.unitType===this.unitType,c=r.level===this.level;if(!o||!c)return this.swapUnitPosition(r),this.isDepthDirty=!0,void(r.isDepthDirty=!0);i.mergeUnits(this,r)?this.currentLocation&&this.currentLocation.setTaken(!1):this.assignUnitToSquare(this.currentLocation.rowId,this.currentLocation.colId,this.isPlayer)},n.findTarget=function(){if(!this.isKilled()){var e=this.targetController.getAttackTarget();e&&this.attackController.setAttackTarget(e)}},n.setUnitData=function(e){var t=e.health,n=e.attackSpeed,i=e.damage,a=e.name,s=e.level;this.setDefaultHp(t),this.attackInterval=n,this.attackPower=i,this.unitName=a,this.level=s,this.originalUnitData=e},n.assignUnitToSquare=function(e,t,n){0!==e||0!==t||this.isPlayer||(this.isDebug=!0,console.log("%c turn on debug for: row "+e+" col "+t+" isPlayer "+n,"font-size:12px;background-color: #9E9689;color:#fff;"));var i=this.scene.fieldManager,a=n?i.getPlayerPlacementSquare(e,t):i.getEnemyPlacementSquare(e,t);this.currentLocation&&this.currentLocation.setTaken(!1),this.setPosition(a.x,a.y),a.setTaken(!0),this.currentLocation=a,this.attackController.resetAttackSpots()},n.spawnUnitOnSquare=function(e,t,n){var i=this.scene.fieldManager,a=n?i.getPlayerPlacementSquare(e,t):i.getEnemyPlacementSquare(e,t);this.setPosition(a.x,a.y),a.setTaken(!0),this.currentLocation=a,this.attackController.resetAttackSpots()},n.swapUnitPosition=function(e){var t=e.currentLocation,n=this.currentLocation;e.setPosition(n.x,n.y),this.setPosition(t.x,t.y);var i=this.scene.unitManager;i.resetAttackSpots(this),i.resetAttackSpots(e),e.currentLocation=n,this.currentLocation=t},n.setDepthOnDrag=function(){this.setDepth(H)},n.calcDepth=function(){if(!this.isKilled()){var e=this.depthController.calculateDepth();e&&this.depth!==e&&this.setDepth(e)}},n.requestAttackPosition=function(e){return this.attackController.assignAttackingUnit(e)},n.getCurrentDisplay=function(){return this.display.getCurrentDisplay()},n.getSpineDisplay=function(){return this.display.getSpineDisplay()},n.reuseUnitOnReady=function(){this.setActive(!0),this.isDepthDirty=!0,this.assignUnitToSquare(this.currentLocation.rowId,this.currentLocation.colId,this.isPlayer),this.setDefaultHp(this.originalUnitData.health),this.uiController.updateCurrentHpUI(this.hp),this.actions.prepare(),this.setVisible(!0)},n.reuseUnitFromPool=function(e){this.setActive(!0),this.isDepthDirty=!0,this.isPlayer!==e&&(this.uiController.changeHpColor(e),this.isPlayer=e),this.uiController.reviveHpBar();var t=this.getSpineDisplay();e?this.startEventListener():this.removeEventListener(),this.setDefaultHp(this.originalUnitData.health),this.uiController.updateCurrentHpUI(this.hp),this.actions.prepare(),t&&t.setVisible(!0),this.setVisible(!0)},n.handleRemoveFromScene=function(){var e;this.uiController.killHpBar(),this.attackController.resetAttackSpots(),this.effectController.stopDamageEffect(),this.effectController.stopDieEffect(),this.removeEventListener(),this.setStatus(r.Z.KILLED),null==(e=this.attackEvent)||e.remove(),this.currentLocation&&this.currentLocation.setTaken(!1);var t=this.getSpineDisplay();t&&(this.scene.spineManager.removeSpine(this),t.setVisible(!1));this.kill()},n.setStatus=function(e){this.status=e},n.getStatus=function(){return this.status},n.getWorldPosition=function(){return this.isPositionDirty=!1,this.lastWorldPosition=e.prototype.getWorldPosition.call(this),this.lastWorldPosition},n.setPosition=function(t,n,i,a){return e.prototype.setPosition.call(this,t,n,i,a),this.isPositionDirty=!0,this},n.isInPrepareMode=function(){return this.status===r.Z.PREPARE},n.isReady=function(){return this.status===r.Z.READY},n.isMovingToTarget=function(){return this.status===r.Z.MOVING_TO_TARGET},n.isPreparingToAttack=function(){return this.status===r.Z.PREPARE_TO_ATTACK},n.isAttacking=function(){return this.status===r.Z.ATTACKING},n.isKilled=function(){return this.status===r.Z.KILLED},n.isFinishedAttacking=function(){return this.status===r.Z.FINISHED_ATTACKING},n.update=function(e,t){this.isDepthDirty&&(this.calcDepth(),this.isDepthDirty=!1),this.scene.stateManager.isInPlayingState()&&this.uiController.update()},(0,i.Z)(t,[{key:"currentHp",get:function(){return this.hp}}]),t}(Phaser.GameObjects.Container),K=Y},477:function(e,t){"use strict";var n=function(){function e(e){this.unit=void 0,this.dieCommand=void 0,this.moveCommand=void 0,this.readyCommand=void 0,this.attackCommand=void 0,this.prepareCommand=void 0,this.unit=e,this.addDieCommand(),this.addMoveCommand(),this.addReadyCommand(),this.addAttackCommand(),this.addPrepareCommand()}var t=e.prototype;return t.prepare=function(){this.prepareCommand.execute()},t.ready=function(){this.unit.isKilled()||this.readyCommand.execute()},t.move=function(){this.unit.isKilled()||this.moveCommand.execute()},t.attack=function(){this.unit.isKilled()||this.attackCommand.execute()},t.die=function(){this.unit.isKilled()||this.dieCommand.execute()},e}();t.Z=n},476:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var i=n(1),a=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).payload=void 0,i.payload=n,i}return(0,i.Z)(t,e),t.prototype.execute=function(){var e=this.payload,t=e.spriteAnimKey,n=e.spineAnimKey,i=e.status;this.unit.setStatus(i),this.unit.display.play(t,n,!0,!0),this.unit.display.setAnimationTimeScale(.5+Math.random())},t}((function(e){this.unit=void 0,this.unit=e}))},40:function(e,t,n){"use strict";var i=n(5),a=n(1),s=n(2),r=n(17),o=s.Z.GAMEPLAY,c=o.KEY,l=o.FRAME,u=GameCore.Configs.Gameplay.Powers.SpeedUp.modifier,h=function(e){function t(t,n){var a,s=n.attacker,o=n.target,u=n.speed,h=n.frame,d=h||l.BLANK;(a=e.call(this,t,s.x,s.y,c,d)||this).scene=void 0,a.target=void 0,a.attacker=void 0,a.speed=void 0,a.heightOffset=void 0,a.upwardDirectionOffset=void 0,a.downwardDirectionOffset=void 0,a.setDisplaySize(5,5),a.scene=t,a.speed=u||r.Z.RANGED_PROJECTILE_SPEED,a.target=o,a.attacker=s,a.heightOffset=0;var p=a.target.display;p instanceof Phaser.GameObjects.Sprite||(a.heightOffset=.4*p.displayHeight),a.rotation=Phaser.Math.Angle.Between(a.x,a.y,o.x,o.y-a.heightOffset);var f=a.attacker.depthController;return a.setDepth(f.getProjectileDepth()),a.scene.add.existing((0,i.Z)(a)),a}return(0,a.Z)(t,e),t.prototype.update=function(e,t){var n=this.scene.powerManager.isGameSpeedUp()?this.speed*u:this.speed,i=n/1e3*t,a=Phaser.Math.Distance.Between(this.x,this.y,this.target.x,this.target.y-this.heightOffset);if(a<i)return this.target.takeDamage(this.attacker),void this.scene.unitManager.rangedProjectiles.remove(this,!0);var s=(this.target.x-this.x)/a*n/1e3*t,r=(this.target.y-this.heightOffset-this.y)/a*n/1e3*t;this.setPosition(this.x+s,this.y+r)},t}(Phaser.GameObjects.Sprite);t.Z=h},647:function(e,t,n){"use strict";var i=n(1),a=n(2),s=n(17),r=n(40),o=a.Z.GAMEPLAY.FRAME,c=s.Z.UNIT_SIZE_SCALE,l=function(e){function t(t,n){var i;n.frame=o.BLUE_FIRE,(i=e.call(this,t,n)||this).setOrigin(1,.5);var a=c;i.setDisplaySize(70.5*a,33.5*a),i.upwardDirectionOffset=new Phaser.Math.Vector2(40,-60),i.downwardDirectionOffset=new Phaser.Math.Vector2(50,35);var s=i.downwardDirectionOffset.x,r=i.downwardDirectionOffset.y;i.attacker.y>i.target.y&&(s=i.upwardDirectionOffset.x,r=i.upwardDirectionOffset.y),i.attacker.display.isFaceLeft()&&(s=-s);var l=i.attacker.x+s,u=i.attacker.y+r;i.rotation=Phaser.Math.Angle.Between(l,u,i.target.x,i.target.y-i.heightOffset);var h=i.displayWidth*Math.cos(i.rotation),d=i.displayWidth*Math.sin(i.rotation);return i.setPosition(l+h,u+d),i}return(0,i.Z)(t,e),t}(r.Z);t.Z=l},648:function(e,t,n){"use strict";var i=n(1),a=n(2),s=n(109),r=n(17),o=n(40),c=a.Z.GAMEPLAY.FRAME,l=r.Z.UNIT_SIZE_SCALE,u=function(e){function t(t,n){var i;n.frame=c.GREEN_FIRE,(i=e.call(this,t,n)||this).setOrigin(1,.5);var a=l;i.setDisplaySize(50*a,50*a),i.upwardDirectionOffset=new Phaser.Math.Vector2(30,-70),i.downwardDirectionOffset=new Phaser.Math.Vector2(40,0);var r=i.downwardDirectionOffset.x,o=i.downwardDirectionOffset.y;return i.attacker.y>i.target.y&&(r=i.upwardDirectionOffset.x,o=i.upwardDirectionOffset.y),i.attacker.display.isFaceLeft()&&(r=-r),i.setPosition(i.attacker.x+r,i.attacker.y+o),i.scene.animationManager.addLevel11ProjectileAnimation(),i.play(s.Al.GREEN_FIRE.KEY,!0),i}return(0,i.Z)(t,e),t}(o.Z);t.Z=u},638:function(e,t,n){"use strict";var i=n(1),a=n(2),s=n(17),r=n(40),o=a.Z.GAMEPLAY.FRAME,c=s.Z.UNIT_SIZE_SCALE,l=function(e){function t(t,n){var i;n.frame=o.ROCK,(i=e.call(this,t,n)||this).setOrigin(.5,.5);var a=c;i.setDisplaySize(7.5*a,6.5*a),i.upwardDirectionOffset=new Phaser.Math.Vector2(0,-10),i.downwardDirectionOffset=new Phaser.Math.Vector2(0,-10);var s=i.downwardDirectionOffset.x,r=i.downwardDirectionOffset.y;return i.attacker.y>i.target.y&&(s=i.upwardDirectionOffset.x,r=i.upwardDirectionOffset.y),i.setPosition(i.attacker.x+s,i.attacker.y+r),i}return(0,i.Z)(t,e),t}(r.Z);t.Z=l},639:function(e,t,n){"use strict";var i=n(1),a=n(2),s=n(17),r=n(40),o=a.Z.GAMEPLAY.FRAME,c=s.Z.UNIT_SIZE_SCALE,l=function(e){function t(t,n){var i;n.frame=o.JAVELIN,(i=e.call(this,t,n)||this).setOrigin(1,.5);var a=c;i.setDisplaySize(67*a,3.5*a),i.upwardDirectionOffset=new Phaser.Math.Vector2(0,-20),i.downwardDirectionOffset=new Phaser.Math.Vector2(10,0);var s=i.downwardDirectionOffset.x,r=i.downwardDirectionOffset.y;i.attacker.y>i.target.y&&(s=i.upwardDirectionOffset.x,r=i.upwardDirectionOffset.y),i.attacker.display.isFaceLeft()&&(s=-s);var l=i.attacker.x+s,u=i.attacker.y+r;i.rotation=Phaser.Math.Angle.Between(l,u,i.target.x,i.target.y-i.heightOffset);var h=i.displayWidth*Math.cos(i.rotation),d=i.displayWidth*Math.sin(i.rotation);return i.setPosition(l+h,u+d),i}return(0,i.Z)(t,e),t}(r.Z);t.Z=l},640:function(e,t,n){"use strict";var i=n(1),a=n(2),s=n(17),r=n(40),o=a.Z.GAMEPLAY.FRAME,c=s.Z.UNIT_SIZE_SCALE,l=function(e){function t(t,n){var i;n.frame=o.BOOMERANG,(i=e.call(this,t,n)||this).isGoToLeft=void 0,i.setOrigin(.5,.5);var a=c;i.setDisplaySize(12*a,27.5*a),i.upwardDirectionOffset=new Phaser.Math.Vector2(0,-20),i.downwardDirectionOffset=new Phaser.Math.Vector2(0,-20);var s=i.downwardDirectionOffset.x,r=i.downwardDirectionOffset.y;return i.attacker.y>i.target.y&&(s=i.upwardDirectionOffset.x,r=i.upwardDirectionOffset.y),i.setPosition(i.attacker.x+s,i.attacker.y+r),i.isGoToLeft=i.attacker.display.isFaceLeft(),i}return(0,i.Z)(t,e),t.prototype.update=function(t,n){this.isGoToLeft?this.angle-=1.5*n:this.angle+=1.5*n,e.prototype.update.call(this,t,n)},t}(r.Z);t.Z=l},641:function(e,t,n){"use strict";var i=n(1),a=n(2),s=n(17),r=n(40),o=a.Z.GAMEPLAY.FRAME,c=s.Z.UNIT_SIZE_SCALE,l=function(e){function t(t,n){var i;n.frame=o.MACE,(i=e.call(this,t,n)||this).isGoToLeft=void 0,i.setOrigin(.4,.4);var a=c;i.setDisplaySize(36.5*a,14.5*a),i.upwardDirectionOffset=new Phaser.Math.Vector2(20,-40),i.downwardDirectionOffset=new Phaser.Math.Vector2(10,0);var s=i.downwardDirectionOffset.x,r=i.downwardDirectionOffset.y;return i.attacker.y>i.target.y&&(s=i.upwardDirectionOffset.x,r=i.upwardDirectionOffset.y),i.attacker.display.isFaceLeft()&&(s=-s),i.setPosition(i.attacker.x+s,i.attacker.y+r),i.isGoToLeft=i.attacker.display.isFaceLeft(),i}return(0,i.Z)(t,e),t.prototype.update=function(t,n){this.isGoToLeft?this.angle-=.9*n:this.angle+=.9*n,e.prototype.update.call(this,t,n)},t}(r.Z);t.Z=l},642:function(e,t,n){"use strict";var i=n(1),a=n(2),s=n(17),r=n(40),o=a.Z.GAMEPLAY.FRAME,c=s.Z.UNIT_SIZE_SCALE,l=function(e){function t(t,n){var i;n.frame=o.ARROW_1,(i=e.call(this,t,n)||this).setOrigin(1,.5);var a=c;i.setDisplaySize(38.5*a,10*a),i.upwardDirectionOffset=new Phaser.Math.Vector2(5,-10),i.downwardDirectionOffset=new Phaser.Math.Vector2(5,-8);var s=i.downwardDirectionOffset.x,r=i.downwardDirectionOffset.y;i.attacker.y>i.target.y&&(s=i.upwardDirectionOffset.x,r=i.upwardDirectionOffset.y),i.attacker.display.isFaceLeft()&&(s=-s);var l=i.attacker.x+s,u=i.attacker.y+r;i.rotation=Phaser.Math.Angle.Between(l,u,i.target.x,i.target.y-i.heightOffset);var h=i.displayWidth*Math.cos(i.rotation),d=i.displayWidth*Math.sin(i.rotation);return i.setPosition(l+h,u+d),i}return(0,i.Z)(t,e),t}(r.Z);t.Z=l},643:function(e,t,n){"use strict";var i=n(1),a=n(2),s=n(17),r=n(40),o=a.Z.GAMEPLAY.FRAME,c=s.Z.UNIT_SIZE_SCALE,l=function(e){function t(t,n){var i;n.frame=o.ARROW_2,(i=e.call(this,t,n)||this).setOrigin(1,.5);var a=c;i.setDisplaySize(37*a,11*a),i.upwardDirectionOffset=new Phaser.Math.Vector2(15,-15),i.downwardDirectionOffset=new Phaser.Math.Vector2(15,-15);var s=i.downwardDirectionOffset.x,r=i.downwardDirectionOffset.y;i.attacker.y>i.target.y&&(s=i.upwardDirectionOffset.x,r=i.upwardDirectionOffset.y),i.attacker.display.isFaceLeft()&&(s=-s);var l=i.attacker.x+s,u=i.attacker.y+r;i.rotation=Phaser.Math.Angle.Between(l,u,i.target.x,i.target.y-i.heightOffset);var h=i.displayWidth*Math.cos(i.rotation),d=i.displayWidth*Math.sin(i.rotation);return i.setPosition(l+h,u+d),i}return(0,i.Z)(t,e),t}(r.Z);t.Z=l},644:function(e,t,n){"use strict";var i=n(1),a=n(2),s=n(17),r=n(40),o=a.Z.GAMEPLAY.FRAME,c=s.Z.UNIT_SIZE_SCALE,l=function(e){function t(t,n){var i;n.frame=o.BOLT_1,(i=e.call(this,t,n)||this).setOrigin(1,.5);var a=c;i.setDisplaySize(38*a,6*a),i.upwardDirectionOffset=new Phaser.Math.Vector2(20,-30),i.downwardDirectionOffset=new Phaser.Math.Vector2(20,12);var s=i.downwardDirectionOffset.x,r=i.downwardDirectionOffset.y;i.attacker.y>i.target.y&&(s=i.upwardDirectionOffset.x,r=i.upwardDirectionOffset.y),i.attacker.display.isFaceLeft()&&(s=-s);var l=i.attacker.x+s,u=i.attacker.y+r;i.rotation=Phaser.Math.Angle.Between(l,u,i.target.x,i.target.y-i.heightOffset);var h=i.displayWidth*Math.cos(i.rotation),d=i.displayWidth*Math.sin(i.rotation);return i.setPosition(l+h,u+d),i}return(0,i.Z)(t,e),t}(r.Z);t.Z=l},645:function(e,t,n){"use strict";var i=n(1),a=n(2),s=n(17),r=n(40),o=a.Z.GAMEPLAY.FRAME,c=s.Z.UNIT_SIZE_SCALE,l=function(e){function t(t,n){var i;n.frame=o.BOLT_2,(i=e.call(this,t,n)||this).setOrigin(1,.5);var a=c;i.setDisplaySize(46*a,9.5*a),i.upwardDirectionOffset=new Phaser.Math.Vector2(20,-40),i.downwardDirectionOffset=new Phaser.Math.Vector2(20,10);var s=i.downwardDirectionOffset.x,r=i.downwardDirectionOffset.y;i.attacker.y>i.target.y&&(s=i.upwardDirectionOffset.x,r=i.upwardDirectionOffset.y),i.attacker.display.isFaceLeft()&&(s=-s);var l=i.attacker.x+s,u=i.attacker.y+r;i.rotation=Phaser.Math.Angle.Between(l,u,i.target.x,i.target.y-i.heightOffset);var h=i.displayWidth*Math.cos(i.rotation),d=i.displayWidth*Math.sin(i.rotation);return i.setPosition(l+h,u+d),i}return(0,i.Z)(t,e),t}(r.Z);t.Z=l},646:function(e,t,n){"use strict";var i=n(1),a=n(2),s=n(17),r=n(40),o=a.Z.GAMEPLAY.FRAME,c=s.Z.UNIT_SIZE_SCALE,l=function(e){function t(t,n){var i;n.frame=o.FIRE_RING,(i=e.call(this,t,n)||this).isGoToLeft=void 0,i.setOrigin(.5,.5);var a=c;i.setDisplaySize(34.5*a,36*a),i.upwardDirectionOffset=new Phaser.Math.Vector2(20,-40),i.downwardDirectionOffset=new Phaser.Math.Vector2(20,0);var s=i.downwardDirectionOffset.x,r=i.downwardDirectionOffset.y;return i.attacker.y>i.target.y&&(s=i.upwardDirectionOffset.x,r=i.upwardDirectionOffset.y),i.attacker.display.isFaceLeft()&&(s=-s),i.setPosition(i.attacker.x+s,i.attacker.y+r),i.isGoToLeft=i.attacker.display.isFaceLeft(),i}return(0,i.Z)(t,e),t.prototype.update=function(t,n){this.isGoToLeft?this.angle-=.9*n:this.angle+=.9*n,e.prototype.update.call(this,t,n)},t}(r.Z);t.Z=l},110:function(e,t){"use strict";t.Z=function(e){this.scene=void 0,this.scene=e}},482:function(e,t,n){"use strict";var i=n(20),a=n(1),s=n(18),r=n.n(s),o=n(38),c=n(24),l=n(25),u=n(85),h=n(110),d=n(130),p=n(131),f=GameCore.Configs.Gameplay.DelayFinishGame,g=function(e){function t(t){var n,i=(n=e.call(this,t)||this).scene,a=i.gameMode,s=i.levelManager,r=i.tutorialManager;i.powerManager.forceReturnToNormalSpeed();var o=s.getCurrentLevelId(),c=o>=1598;a!==u.Z.NORMAL||c||(s.updateHighestCurrentLevel(),n.scene.updateLevelToLeaderboard(o)),a===u.Z.BATTLE&&n.scene.game.battle.finishBattle("win"),c||(n.scene.audio.playSound(l.Z.WIN_BATTLE),n.scene.effectManger.playResultWinAnimation());var h=n.scene.getPlayedTimeSeconds();return n.scene.analytics.levelComplete(o,n.scene.gameMode,h),n.scene.ads.hideBannerAdAsync(),n.scene.isBannerAdShowed=!1,r.isRunning()?n.handleTutorialCase():n.openResultScreen(),n}(0,a.Z)(t,e);var n=t.prototype;return n.openResultScreen=function(){var e=this,t=this.scene,n=t.audio,a=t.screenManager,s=t.coinManager,o=t.gameMode,l=t.levelManager,u=s.getRewardCoinsByAttackCoins(),h=l.currentLevelId>=1598?0:f;this.scene.time.delayedCall(h,(0,i.Z)(r().mark((function t(){var i,s,l,h,d;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.scene.stopManager(),i=e.scene.game,s=i.globalScene,l=i.lang,!e.scene.game.ads.canbeShowInterstitialAd()){t.next=21;break}return h=null,t.prev=4,n.muteAll(),e.scene.scene.pause(),h=e.scene.game.globalScene.time.delayedCall(200,(function(){s.screen.open(c.o4.NOTIFY_SCREEN,{message:l.Text.LOADING_ADS,duration:0,loading:!0})})),t.next=10,e.scene.game.ads.showInterstitialAdAsync();case 10:t.next=15;break;case 12:t.prev=12,t.t0=t.catch(4),console.info("\ud83d\ude80 > showInterstitialAdAsync",t.t0);case 15:return t.prev=15,n.unmuteAll(),e.scene.game.ads.preloadInterstitialAdAsync().catch((function(){})),null==(d=h)||d.remove(),s.screen.close(c.o4.NOTIFY_SCREEN),t.finish(15);case 21:a.showResultScreen("win",o,u);case 22:case"end":return t.stop()}}),t,null,[[4,12,15,21]])}))))},n.handleTutorialCase=function(){var e=this,t=this.scene,n=t.levelManager,a=t.coinManager,s=t.screenManager,c=t.gameMode;1===n.getCurrentLevelId()&&this.scene.analytics.event(o._.TUTORIAL_STEP,{step:5});var l=a.getRewardCoinsByAttackCoins();this.scene.time.delayedCall(f,(0,i.Z)(r().mark((function t(){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.scene.stopManager(),s.showResultScreen("win",c,l);case 2:case"end":return t.stop()}}),t)}))))},n.ready=function(){},n.play=function(){},n.levelFail=function(){},n.levelComplete=function(){},n.levelLoading=function(){var e=new d.Z(this.scene);this.scene.stateManager.changeStateTo(e)},n.quit=function(){var e=new p.Z(this.scene);this.scene.stateManager.changeStateTo(e)},n.update=function(){},t}(h.Z);t.Z=g},481:function(e,t,n){"use strict";var i=n(20),a=n(1),s=n(18),r=n.n(s),o=n(24),c=n(25),l=n(85),u=n(110),h=n(130),d=n(131),p=n(162),f=GameCore.Configs.Gameplay.DelayFinishGame,g=function(e){function t(t){var n,i=(n=e.call(this,t)||this).scene,a=i.gameMode,s=i.levelManager,r=i.tutorialManager;i.powerManager.forceReturnToNormalSpeed(),a===l.Z.BATTLE&&n.scene.game.battle.finishBattle("lose"),n.scene.audio.playSound(c.Z.LOSE_SOUND);var o=n.scene.getPlayedTimeSeconds(),u=s.getCurrentLevelId();return n.scene.analytics.levelFail(u,n.scene.gameMode,o),n.scene.effectManger.playResultLoseAnimation(),n.scene.ads.hideBannerAdAsync(),n.scene.isBannerAdShowed=!1,r.isRunning()?n.handleTutorialCase():n.openResultScreen(),n}(0,a.Z)(t,e);var n=t.prototype;return n.openResultScreen=function(){var e=this,t=this.scene,n=t.screenManager,a=t.gameMode,s=t.audio,c=this.scene.coinManager.getTotalCoinsByAttack();this.scene.time.delayedCall(f,(0,i.Z)(r().mark((function t(){var i,l,u,h,d;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.scene.stopManager(),i=e.scene.game,l=i.globalScene,u=i.lang,!e.scene.game.ads.canbeShowInterstitialAd()){t.next=21;break}return h=null,t.prev=4,s.muteAll(),e.scene.scene.pause(),h=e.scene.game.globalScene.time.delayedCall(200,(function(){l.screen.open(o.o4.NOTIFY_SCREEN,{message:u.Text.LOADING_ADS,duration:0,loading:!0})})),t.next=10,e.scene.game.ads.showInterstitialAdAsync();case 10:t.next=15;break;case 12:t.prev=12,t.t0=t.catch(4),console.info("\ud83d\ude80 > showInterstitialAdAsync",t.t0);case 15:return t.prev=15,s.unmuteAll(),e.scene.game.ads.preloadInterstitialAdAsync().catch((function(){})),null==(d=h)||d.remove(),l.screen.close(o.o4.NOTIFY_SCREEN),t.finish(15);case 21:n.showResultScreen("lose",a,c);case 22:case"end":return t.stop()}}),t,null,[[4,12,15,21]])}))))},n.handleTutorialCase=function(){var e=this,t=this.scene,n=t.levelManager,a=t.screenManager,s=t.coinManager,o=t.gameMode,c=n.getCurrentLevelId(),l=s.getTotalCoinsByAttack(),u=1===c?1.5*f:f;this.scene.time.delayedCall(u,(0,i.Z)(r().mark((function t(){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.scene.stopManager(),1!==c){t.next=5;break}return e.scene.coin.plusCoins(l.baseValue,l.suffix),e.scene.prepareRound(),t.abrupt("return");case 5:a.showResultScreen("lose",o,l);case 6:case"end":return t.stop()}}),t)}))))},n.ready=function(){var e=new p.Z(this.scene);this.scene.stateManager.changeStateTo(e)},n.play=function(){},n.levelFail=function(){},n.levelComplete=function(){},n.levelLoading=function(){var e=new h.Z(this.scene);this.scene.stateManager.changeStateTo(e)},n.quit=function(){var e=new d.Z(this.scene);this.scene.stateManager.changeStateTo(e)},n.update=function(){},t}(u.Z);t.Z=g},130:function(e,t,n){"use strict";var i=n(20),a=n(1),s=n(18),r=n.n(s),o=n(30),c=n(24),l=n(471),u=n(85),h=n(65),d=n(110),p=n(131),f=n(162),g=h.Z.LEVEL_PROGRESS,E=h.Z.PLAYER_UNIT_DATA,m=function(e){function t(t){var n;return(n=e.call(this,t)||this).isRequesting=!1,n.handleLoadComplete=function(){n.scene.prepareRound();var e=n.scene.scene.get(o.C.LOAD_SCENE);e.scene.sleep(),e.lazyLoadResource()},n.run(),n}(0,a.Z)(t,e);var n=t.prototype;return n.run=function(){var e=(0,i.Z)(r().mark((function e(){var t,n,i,a,s,h,d,p,f;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.scene,n=t.uiManager,i=t.screenManager,a=t.layoutManager,this.scene.initGameMode(),a.layout.alignUI(),n.showUIForLevelLoadingState(),this.autoUpgradeUnitData(),s=this.getCurrentLevel(),console.info("\ud83d\ude80 > currentLevel",s),!(s>1)){e.next=24;break}return h=this.scene.gameMode===u.Z.BATTLE,e.next=11,this.scene.isChallengeMode();case 11:if(d=e.sent,h||!d){e.next=24;break}return e.t0=this.scene.storage,e.next=16,(0,l.ec)();case 16:return e.t1=e.sent,e.next=19,e.t0.dispatch.call(e.t0,e.t1);case 19:if(this.scene.initGameMode(),this.scene.gameMode!==u.Z.BATTLE){e.next=24;break}return this.scene.quit(),this.scene.restartScene(),e.abrupt("return");case 24:this.loadLevelsJson(),this.scene.gameMode===u.Z.BATTLE&&((p=this.scene.game.globalScene).screen.close(c.o4.LEADER_BOARD_SCREEN),p.screen.close(c.o4.BATTLE_SCREEN),this.loadOpponentUnits()),this.isRequesting?(i.showLoadingScreen(),(f=this.scene.scene.get(o.C.LOAD_SCENE)).scene.wake(),f.load.once(Phaser.Loader.Events.COMPLETE,this.handleLoadComplete),f.load.start()):this.scene.time.delayedCall(0,this.handleLoadComplete);case 27:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.autoUpgradeUnitData=function(){var e=this.scene.player.getCustomData(E);if(e&&"string"===typeof e){var t=this.scene.scene.get(o.C.LOAD_SCENE).upgradePlayerUnits(e);t!==e&&this.scene.player.setCustomData(E,t)}},n.loadOpponentUnits=function(){var e=this.scene.game.battle.getOpponentInfo();if(e){var t=e.unitData;console.info("\ud83d\ude80 > OpponentUnitData",t);var n=this.scene.scene.get(o.C.LOAD_SCENE);this.isRequesting=!0,n.loadUnits("spine",t)}},n.getCurrentLevel=function(){var e=this.scene.player.getCustomData(g),t=GameCore.Utils.Valid.isNumber(e)?e:1;return t>0?t:0},n.loadLevelsJson=function(){var e=this.getCurrentLevel();this.loadLevelJsonByLevel(e),this.reloadNextLevelJson(e)},n.reloadNextLevelJson=function(e){var t=e+1;t%100===0&&this.loadLevelJsonByLevel(t,!1)},n.loadLevelJsonByLevel=function(e,t){void 0===t&&(t=!0);var n=this.getJsonKey(e);this.scene.cache.json.exists(n)||(t&&(this.isRequesting=!0),this.scene.scene.get(o.C.LOAD_SCENE).load.json(n,"assets/json/"+n+".json"))},n.getJsonKey=function(e){var t=100*Math.floor(e/100)+1,n=t+99;return"levels-"+(1e4+t).toString().substring(1)+"-"+(1e4+n).toString().substring(1)},n.ready=function(){var e=new f.Z(this.scene);this.scene.stateManager.changeStateTo(e)},n.play=function(){},n.levelFail=function(){},n.levelComplete=function(){},n.levelLoading=function(){},n.quit=function(){var e=new p.Z(this.scene);this.scene.stateManager.changeStateTo(e)},n.update=function(){},t}(d.Z);t.Z=m},480:function(e,t,n){"use strict";var i=n(1),a=n(110),s=n(482),r=n(481),o=n(131),c=n(162),l=function(e){function t(t){var n;(n=e.call(this,t)||this).isLevelOver=void 0,n.isLevelOver=!1;var i=n.scene,a=i.fieldManager,s=i.unitManager,r=i.uiManager,o=i.spineManager,c=i.tutorialManager,l=i.effectManger,u=i.powerManager;return n.scene.accessibilityManager.stop(),a.hidePlacementSquares(),o.sortSpineContainerByName(),l.stopRewardCurveAnimation(),s.savePlayerUnits(),s.setReadyAllUnits(),s.runChildUpdateGroups(!0),s.disableDragOnPlayerUnits(),r.showUIForPlayingState(),u.checkForSpeedSetting(),!1!==n.scene.isBannerAdShowed||c.isRunning()||(n.scene.isBannerAdShowed=!0,n.scene.ads.showBannerAdAsync().catch((function(e){console.warn("\ud83d\ude80 > showBannerAdAsync",e)}))),n.scene.audio.setMusicVolume(.04,1e3),n}(0,i.Z)(t,e);var n=t.prototype;return n.ready=function(){var e=new c.Z(this.scene);this.scene.stateManager.changeStateTo(e)},n.play=function(){},n.levelFail=function(){var e=new r.Z(this.scene);this.scene.stateManager.changeStateTo(e)},n.levelComplete=function(){var e=new s.Z(this.scene);this.scene.stateManager.changeStateTo(e)},n.levelLoading=function(){},n.quit=function(){var e=new o.Z(this.scene);this.scene.stateManager.changeStateTo(e)},n.update=function(){if(!this.isLevelOver){var e=this.scene,t=e.uiManager,n=e.spineManager,i=t.getCurrentEnemyHp()<=0,a=t.getCurrentPlayerHp()<=0;return i?(this.scene.gameOver("win"),void(this.isLevelOver=!0)):a&&!i?(this.scene.gameOver("lose"),void(this.isLevelOver=!0)):void n.update(!1)}},t}(a.Z);t.Z=l},131:function(e,t,n){"use strict";var i=n(1),a=n(110),s=n(130),r=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene.stopManager(),n.scene.audio.setMusicVolume(0,3e3),n}(0,i.Z)(t,e);var n=t.prototype;return n.ready=function(){},n.play=function(){},n.levelComplete=function(){},n.levelFail=function(){},n.levelLoading=function(){var e=new s.Z(this.scene);this.scene.stateManager.changeStateTo(e)},n.quit=function(){},n.update=function(){},t}(a.Z);t.Z=r},162:function(e,t,n){"use strict";var i=n(1),a=n(41),s=n.n(a),r=n(47),o=n.n(r),c=n(231),l=n(478),u=n(127),h=n(85),d=n(110),p=n(130),f=n(480),g=n(131),E=function(e){function t(t){var n,i,a=(i=e.call(this,t)||this).scene,r=a.uiManager,o=a.unitManager,c=a.coinManager,u=a.spineManager,d=a.levelManager,p=a.screenManager,f=a.tutorialManager,g=a.difficultyManager,E=a.powerManager;i.scene.initManager(),i.scene.startManager();var m=i.scene.world.isGameWorldSmallerRatio(.575)||i.scene.gameMode===h.Z.BATTLE;GameCore.Utils.Device.isDesktop()||!m||f.isRunning()?i.scene.isBannerAdShowed=!1:(i.scene.isBannerAdShowed=!0,i.scene.ads.showBannerAdAsync().catch((function(e){console.warn("\ud83d\ude80 > showBannerAdAsync",e)})));var v=o.getPlayerUnits(),A=o.getEnemyUnits();u.addSpines(s()(n=[]).call(n,A,v)),o.enableDragOnPlayerUnits(),o.runChildUpdateGroups(!0);var S=d.getCurrentLevelId(),T=d.getModifierLevel(),y=d.getPlayerLevel();return console.log("\ud83e\udd16 ? currentLevelId",S),console.log("\ud83e\udd16 ? modifierLevel",T),console.log("\ud83e\udd16 ? playerLevel",y),c.setUnitModifier(y),c.setAttackModifier(T),g.updateCustomUnitModifierByLevel(y),g.updateCustomAttackModifierByLevel(T),i.scene.storage.dispatch((0,l.MN)()),p.closeLoadingScreen(),i.scene.gameMode===h.Z.BATTLE?(o.hideAllUnits(),i.scene.time.delayedCall(450,(function(){p.showChallengeSplashScreen(),r.showUIForReadyState(),i.scene.updateUI()}))):(i.scene.audio.setMusicVolume(.4,3e3),r.showUIForReadyState(),i.scene.updateUI()),f.showTutorial(),E.syncSpeedSetting(),i.logLevelStart(),i}(0,i.Z)(t,e);var n=t.prototype;return n.logLevelStart=function(){var e=this.scene,t=e.battle,n=e.storage,i=e.levelManager,a=this.scene.gameMode===h.Z.BATTLE,s=this.scene.isContextChallenge(),r=i.getCurrentLevelId();if(a&&s){var l,d=t.getOpponentInfo(),p=n.getState(),f=(0,u.fw)(p).entryPointData||{},g=f.playerId,E=f.opponentId,m=void 0===E?c.U.playerId:E,v=o()(l=[m,g]).call(l,null==d?void 0:d.playerId)>-1;if(console.info("\ud83d\ude80 > isOwnerContext",v),v)return void this.scene.analytics.levelStart(r,"CHALLENGE")}this.scene.analytics.levelStart(r,this.scene.gameMode)},n.ready=function(){},n.play=function(){var e=new f.Z(this.scene);this.scene.stateManager.changeStateTo(e)},n.levelFail=function(){},n.levelComplete=function(){},n.levelLoading=function(){if(this.scene.levelManager.isInLevelBuilderLevel()){var e=new p.Z(this.scene);this.scene.stateManager.changeStateTo(e)}},n.quit=function(){var e=new g.Z(this.scene);this.scene.stateManager.changeStateTo(e)},n.update=function(){this.scene.spineManager.update(!0)},t}(d.Z);t.Z=E},474:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});var i=n(1),a=n(38),s=function(e){function t(t,n,i){var a;return(a=e.call(this,t,0,0,n,i)||this).setOrigin(0,0),a}return(0,i.Z)(t,e),t}(Phaser.GameObjects.Zone),r=function(e){function t(){var t;return(t=e.call(this,{visible:!1})||this).unsubscribeList=void 0,t.gameZone=void 0,t.background=void 0,t.handleOpenScene=function(){t.logPageviewOnOpen(),t.logEventOpen()},t.removeStateChange=function(){t.unsubscribeList.forEach((function(e){return e()}))},t}(0,i.Z)(t,e);var n=t.prototype;return n.create=function(){this.events.on("wake",this.handleOpenScene),this.events.on("resume",this.handleOpenScene),this.events.on("create",this.handleOpenScene),this.scaleGame(),this.createGameZone()},n.scaleGame=function(){var e=this.getCamera("main"),t=this.world.getZoomRatio(),n=this.world.getWorldSize(),i=n.width,a=n.height;e.setZoom(t),e.centerOn(i/2,a/2)},n.createGameZone=function(){var e=this.world.getWorldSize(),t=e.width,n=e.height;this.gameZone=new s(this,t,n)},n.getCamera=function(e){return"main"===e?this.cameras.main:this.cameras.getCamera(e)},n.createMask=function(e){void 0===e&&(e=1),this.getCamera("main").setBackgroundColor("rgba(0, 0, 0, "+e+")")},n.fontSize=function(e){return e/1},n.createBackground=function(e,t,n,i){this.background?(this.background.setTexture(e),t&&this.background.setFrame(t)):this.background=this.make.image({key:e,frame:t}),this.background.setName(e);var a=this.gameZone,s=a.displayWidth,r=a.displayHeight;this.background.setDisplaySize(s,r),GameCore.Utils.Valid.isNumber(n)&&this.background.setAlpha(n),GameCore.Utils.Valid.isNumber(i)&&this.background.setTint(i),Phaser.Display.Align.In.Center(this.background,this.gameZone)},n.handleStateChange=function(e){var t=this;this.unsubscribeList=[],e.forEach((function(e){var n=e.selector,i=e.callback,a=t.storage.watch(n,i);t.unsubscribeList.push(a)})),this.events.once("sleep",this.removeStateChange),this.events.once("destroy",this.removeStateChange),this.events.once("shutdown",this.removeStateChange)},n.logPageviewOnOpen=function(){this.analytics.pageview(this.scene.key)},n.logEventOpen=function(){this.analytics.event(a._.SCREEN_OPEN,{screen_name:this.getSceneName()})},n.getSceneName=function(){return GameCore.Utils.String.toUpperCamelCase(this.scene.key.toLowerCase())},t}(Phaser.Scene)},68:function(e,t,n){"use strict";n.d(t,{Z:function(){return Rr}});var i=n(20),a=n(1),s=n(18),r=n.n(s),o=n(41),c=n.n(o),l=n(85),u=n(5),h=n(2),d=n(66),p=h.Z.GAMEPLAY,f=p.KEY,g=p.FRAME,E=function(e){function t(t){var n;return(n=e.call(this,t)||this).arrowStart=void 0,n.arrowEnd=void 0,n.arrowMiddle=void 0,n.expandTween=void 0,n.name="AdjustableArrow",n.addArrowStart(),n.addArrowEnd(),n.addArrowMiddle(),n.setDepth(d.Z.EFFECT),n.scene.add.existing((0,u.Z)(n)),n}(0,a.Z)(t,e);var n=t.prototype;return n.addArrowStart=function(){this.arrowStart=this.scene.make.image({key:f,frame:g.GUIDE_ARROW_START,origin:{x:0,y:.5}}),this.arrowStart.setWorldSize(20,26),this.add(this.arrowStart)},n.addArrowEnd=function(){this.arrowEnd=this.scene.make.image({key:f,frame:g.GUIDE_ARROW_END,origin:{x:1,y:.5}}),this.arrowEnd.setWorldSize(4,13),this.add(this.arrowEnd)},n.addArrowMiddle=function(){this.arrowMiddle=this.scene.make.image({key:f,frame:g.GUIDE_ARROW_MIDDLE,origin:{x:.5,y:.5}}),this.arrowMiddle.setWorldSize(1,13),this.add(this.arrowMiddle)},n.changeArrowLength=function(e){var t=e-this.arrowStart.width-this.arrowEnd.width;this.arrowMiddle.setWorldSize(t,this.arrowMiddle.height),this.arrowEnd.setPosition(-t/2,0),this.arrowStart.setPosition(t/2,0)},n.runArrowExpandTween=function(e,t,n){var i=this,a=n-this.arrowStart.width-this.arrowEnd.width;this.arrowEnd.setPosition(-a/2,0),this.arrowStart.setPosition(-a/2,0),this.arrowMiddle.setWorldSize(0,this.arrowMiddle.height),this.expandTween=this.scene.tweens.addCounter({from:0,to:100,duration:e,completeDelay:t,ease:Phaser.Math.Easing.Cubic.Out,onUpdate:function(e){var t=e.getValue(),n=a*t/100;i.arrowMiddle.setWorldSize(n,i.arrowMiddle.height);var s=-a/2+n/2;i.arrowMiddle.setPosition(s,0);var r=-a/2+n;i.arrowStart.setPosition(r,0)},onComplete:function(){i.setAlpha(0)},onStop:function(){i.setAlpha(0)}})},n.killExpandTween=function(){var e;null==(e=this.expandTween)||e.stop()},t}(Phaser.GameObjects.Container),m=E,v=h.Z.GAMEPLAY,A=v.KEY,S=v.FRAME,T=function(e){function t(t){var n;return(n=e.call(this,t)||this).hand=void 0,n.arrow=void 0,n.toGlobalX=0,n.toGlobalY=0,n.name="DragTutorialHand",n.addHand(),n.addArrow(),n.bringToTop(n.hand),n.scene.add.existing((0,u.Z)(n)),n}(0,a.Z)(t,e);var n=t.prototype;return n.addHand=function(){this.hand=this.scene.make.image({key:A,frame:S.GUIDE_HAND,origin:{x:0,y:0}}),this.hand.setWorldSize(65.5,55.5),this.add(this.hand)},n.addArrow=function(){this.arrow=new m(this.scene),this.arrow.setAlpha(0)},n.setTarget=function(e,t){this.toGlobalX=e,this.toGlobalY=t},n.playAnimation=function(e,t){var n,i,a=this;void 0===e&&(e=0),void 0===t&&(t=800);var s=1/this.scene.world.getPixelRatio();this.hand.angle=0;var r=this.toGlobalX-this.x,o=this.toGlobalY-this.y,c=this.x+r/2,l=this.y+o/2,u=.8*Math.sqrt(r*r+o*o);this.arrow.setPosition(c,l),this.arrow.rotation=Math.atan2(o,r),this.arrow.setAlpha(0),this.arrow.killExpandTween(),this.hand.setPosition(0,0),this.hand.setAlpha(1),null==(n=this.scene)||n.tweens.add({delay:e,targets:this.arrow,ease:Phaser.Math.Easing.Cubic.Out,onStart:function(){a.arrow.runArrowExpandTween(1200,200,u)},props:{alpha:{start:0,value:.5,duration:200}}}),null==(i=this.scene)||i.tweens.add({delay:e,targets:[this.hand],ease:Phaser.Math.Easing.Cubic.Out,props:{alpha:{start:0,value:1,duration:200},x:{from:0,to:r,duration:1200},y:{from:0,to:o,duration:1200}},onComplete:function(){var n;null==(n=a.scene)||n.tweens.add({targets:[a.hand],delay:200,duration:200,completeDelay:200,ease:Phaser.Math.Easing.Cubic.Out,props:{alpha:0},onComplete:function(){a.hand.x=0,a.hand.y=0,a.hand.scale=s,a.playAnimation(e,t)}})}})},n.stopAnimation=function(){this.scene.tweens.killTweensOf(this.hand),this.scene.tweens.killTweensOf(this.arrow)},n.kill=function(){this.arrow.kill(),e.prototype.kill.call(this)},n.revive=function(){this.arrow.revive(),e.prototype.revive.call(this)},n.destroy=function(t){this.arrow.destroy(t),e.prototype.destroy.call(this,t)},n.preDestroy=function(){this.scene.tweens.killTweensOf(this.hand),this.scene.tweens.killTweensOf(this.arrow)},t}(Phaser.GameObjects.Container),y=T,C={STATUS:{READY:"ready",RUNNING:"running",STOPPED:"stopped"}},I=C.STATUS,R=function(){function e(e){this.state=void 0,this.scene=void 0,this.scene=e}var t=e.prototype;return t.init=function(){this.setState(I.READY)},t.start=function(){this.isRunning()||this.setState(I.RUNNING)},t.stop=function(){this.isRunning()&&this.setState(I.STOPPED)},t.setState=function(e){this.state=e},t.isReady=function(){return this.state===I.READY},t.isRunning=function(){return this.state===I.RUNNING},t.isStopped=function(){return this.state===I.STOPPED},e}(),w=R,_=GameCore.Configs.Gameplay.HintWaitTime,b=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.hand=void 0,n.autoTimeEvent=void 0,n.isDragging=!1,n.handleAutomaticallyHint=function(){var e=n.scene.unitManager.getSameCoupleUnits();e?(n.hand.stopAnimation(),n.hand.revive(),n.hand.setPosition(e.unit1.x,e.unit1.y),n.hand.setTarget(e.unit2.x,e.unit2.y),n.hand.playAnimation(500)):n.startAutoHint()},n.handlePlayerDragging=function(){n.isDragging||(n.isDragging=!0,n.stopAutoHint())},n.handlePlayerEndDrag=function(){n.isDragging=!1,n.startAutoHint()},n.handlePlayerInteract=function(){n.stopAutoHint(),n.isDragging||n.startAutoHint()},n.scene=t,n.createHand(),n}(0,a.Z)(t,e);var n=t.prototype;return n.init=function(){e.prototype.init.call(this)},n.start=function(){this.isRunning()||(e.prototype.start.call(this),this.listenEvent(),this.startAutoHint())},n.stop=function(){this.isRunning()&&(e.prototype.stop.call(this),this.isDragging=!1,this.stopListenEvent(),this.stopAutoHint())},n.createHand=function(){this.hand=new y(this.scene),this.hand.kill(),this.hand.setDepth(d.Z.PRIORITY)},n.startAutoHint=function(){this.autoTimeEvent=this.scene.time.delayedCall(_,this.handleAutomaticallyHint)},n.listenEvent=function(){this.scene.input.on(Phaser.Input.Events.POINTER_DOWN,this.handlePlayerInteract),this.scene.input.on(Phaser.Input.Events.DRAG_START,this.handlePlayerDragging),this.scene.input.on(Phaser.Input.Events.DRAG_END,this.handlePlayerEndDrag)},n.stopListenEvent=function(){this.scene.input.off(Phaser.Input.Events.POINTER_DOWN,this.handlePlayerInteract),this.scene.input.off(Phaser.Input.Events.DRAG_START,this.handlePlayerDragging),this.scene.input.off(Phaser.Input.Events.DRAG_END,this.handlePlayerEndDrag)},n.stopAutoHint=function(){var e;this.hand.kill(),this.hand.stopAnimation(),null==(e=this.autoTimeEvent)||e.remove()},t}(w),L=b,P=n(109),O=P.VA.ALIEN[1].ATTACK,D=O.KEY,k=O.TEXTURE,N=O.FRAME_RATE,B=O.START,M=O.END,x=O.PREFIX,U=O.ZERO_PAD,F=function(e){function t(t){var n={repeat:-1,frameRate:N,frames:t.generateFrameNames(k,{prefix:x,start:B,end:M,zeroPad:U}),showOnStart:!0,hideOnComplete:!0,skipMissedFrames:!0};return e.call(this,t,D,n)||this}return(0,a.Z)(t,e),t}(Phaser.Animations.Animation),Z=F,G=P.VA.ALIEN[1].DIE,H=G.KEY,Y=G.TEXTURE,K=G.FRAME_RATE,V=G.START,W=G.END,j=G.PREFIX,z=G.ZERO_PAD,X=function(e){function t(t){var n={repeat:0,frameRate:K,frames:t.generateFrameNames(Y,{prefix:j,start:V,end:W,zeroPad:z}),showOnStart:!0,hideOnComplete:!1,skipMissedFrames:!0};return e.call(this,t,H,n)||this}return(0,a.Z)(t,e),t}(Phaser.Animations.Animation),q=X,Q=P.VA.ALIEN[1].IDLE,J=Q.KEY,$=Q.TEXTURE,ee=Q.FRAME_RATE,te=Q.START,ne=Q.END,ie=Q.PREFIX,ae=Q.ZERO_PAD,se=function(e){function t(t){var n={repeat:-1,frameRate:ee,frames:t.generateFrameNames($,{prefix:ie,start:te,end:ne,zeroPad:ae}),showOnStart:!0,hideOnComplete:!0,skipMissedFrames:!0};return e.call(this,t,J,n)||this}return(0,a.Z)(t,e),t}(Phaser.Animations.Animation),re=se,oe=P.VA.ALIEN[1].RUN,ce=oe.KEY,le=oe.TEXTURE,ue=oe.FRAME_RATE,he=oe.START,de=oe.END,pe=oe.PREFIX,fe=oe.ZERO_PAD,ge=function(e){function t(t){var n={repeat:-1,frameRate:ue,frames:t.generateFrameNames(le,{prefix:pe,start:he,end:de,zeroPad:fe}),showOnStart:!0,hideOnComplete:!0,skipMissedFrames:!0};return e.call(this,t,ce,n)||this}return(0,a.Z)(t,e),t}(Phaser.Animations.Animation),Ee=ge,me=P.VA.MELEE[1].ATTACK,ve=me.KEY,Ae=me.TEXTURE,Se=me.FRAME_RATE,Te=me.START,ye=me.END,Ce=me.PREFIX,Ie=me.ZERO_PAD,Re=function(e){function t(t){var n={repeat:-1,frameRate:Se,frames:t.generateFrameNames(Ae,{prefix:Ce,start:Te,end:ye,zeroPad:Ie}),showOnStart:!0,hideOnComplete:!1,skipMissedFrames:!0};return e.call(this,t,ve,n)||this}return(0,a.Z)(t,e),t}(Phaser.Animations.Animation),we=Re,_e=P.VA.MELEE[1].DIE,be=_e.KEY,Le=_e.TEXTURE,Pe=_e.FRAME_RATE,Oe=_e.START,De=_e.END,ke=_e.PREFIX,Ne=_e.ZERO_PAD,Be=function(e){function t(t){var n={repeat:0,frameRate:Pe,frames:t.generateFrameNames(Le,{prefix:ke,start:Oe,end:De,zeroPad:Ne}),showOnStart:!0,hideOnComplete:!1,skipMissedFrames:!0};return e.call(this,t,be,n)||this}return(0,a.Z)(t,e),t}(Phaser.Animations.Animation),Me=Be,xe=P.VA.MELEE[1].IDLE,Ue=xe.KEY,Fe=xe.TEXTURE,Ze=xe.FRAME_RATE,Ge=xe.START,He=xe.END,Ye=xe.PREFIX,Ke=xe.ZERO_PAD,Ve=function(e){function t(t){var n={repeat:-1,frameRate:Ze,frames:t.generateFrameNames(Fe,{prefix:Ye,start:Ge,end:He,zeroPad:Ke}),showOnStart:!0,hideOnComplete:!0,skipMissedFrames:!0};return e.call(this,t,Ue,n)||this}return(0,a.Z)(t,e),t}(Phaser.Animations.Animation),We=Ve,je=P.VA.MELEE[1].RUN,ze=je.KEY,Xe=je.TEXTURE,qe=je.FRAME_RATE,Qe=je.START,Je=je.END,$e=je.PREFIX,et=je.ZERO_PAD,tt=function(e){function t(t){var n={repeat:-1,frameRate:qe,frames:t.generateFrameNames(Xe,{prefix:$e,start:Qe,end:Je,zeroPad:et}),showOnStart:!0,hideOnComplete:!0,skipMissedFrames:!0};return e.call(this,t,ze,n)||this}return(0,a.Z)(t,e),t}(Phaser.Animations.Animation),nt=tt,it=P.Al.GREEN_FIRE,at=it.KEY,st=it.TEXTURE,rt=it.FRAME_RATE,ot=it.START,ct=it.END,lt=it.PREFIX,ut=it.ZERO_PAD,ht=function(e){function t(t){var n={repeat:-1,frameRate:rt,frames:t.generateFrameNames(st,{prefix:lt,start:ot,end:ct,zeroPad:ut}),showOnStart:!0,hideOnComplete:!1,skipMissedFrames:!0};return e.call(this,t,at,n)||this}return(0,a.Z)(t,e),t}(Phaser.Animations.Animation),dt=ht,pt=P.VA.RANGED[1].ATTACK_ABOVE,ft=pt.KEY,gt=pt.TEXTURE,Et=pt.FRAME_RATE,mt=pt.START,vt=pt.END,At=pt.PREFIX,St=pt.ZERO_PAD,Tt=function(e){function t(t){var n={repeat:-1,frameRate:Et,frames:t.generateFrameNames(gt,{prefix:At,start:mt,end:vt,zeroPad:St}),showOnStart:!0,hideOnComplete:!1,skipMissedFrames:!0};return e.call(this,t,ft,n)||this}return(0,a.Z)(t,e),t}(Phaser.Animations.Animation),yt=Tt,Ct=P.VA.RANGED[1].DIE,It=Ct.KEY,Rt=Ct.TEXTURE,wt=Ct.FRAME_RATE,_t=Ct.START,bt=Ct.END,Lt=Ct.PREFIX,Pt=Ct.ZERO_PAD,Ot=function(e){function t(t){var n={repeat:0,frameRate:wt,frames:t.generateFrameNames(Rt,{prefix:Lt,start:_t,end:bt,zeroPad:Pt}),showOnStart:!0,hideOnComplete:!1,skipMissedFrames:!0};return e.call(this,t,It,n)||this}return(0,a.Z)(t,e),t}(Phaser.Animations.Animation),Dt=Ot,kt=P.VA.RANGED[1].IDLE,Nt=kt.KEY,Bt=kt.TEXTURE,Mt=kt.FRAME_RATE,xt=kt.START,Ut=kt.END,Ft=kt.PREFIX,Zt=kt.ZERO_PAD,Gt=function(e){function t(t){var n={repeat:-1,frameRate:Mt,frames:t.generateFrameNames(Bt,{prefix:Ft,start:xt,end:Ut,zeroPad:Zt}),showOnStart:!0,hideOnComplete:!0,skipMissedFrames:!0};return e.call(this,t,Nt,n)||this}return(0,a.Z)(t,e),t}(Phaser.Animations.Animation),Ht=Gt,Yt=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.scene=t,n}(0,a.Z)(t,e);var n=t.prototype;return n.addLevel11ProjectileAnimation=function(){if(!this.scene.anims.exists(P.Al.GREEN_FIRE.KEY)){var e=new dt(this.scene.anims);this.scene.anims.add(P.Al.GREEN_FIRE.KEY,e)}},n.addAlienAnimation=function(){var e=P.VA.ALIEN[1],t=e.ATTACK,n=e.DIE,i=e.IDLE;if(!this.scene.anims.exists(i.KEY)){var a=new re(this.scene.anims);this.scene.anims.add(i.KEY,a)}if(!this.scene.anims.exists(t.KEY)){var s=new Ee(this.scene.anims);this.scene.anims.add(t.KEY,s)}if(!this.scene.anims.exists(i.KEY)){var r=new Z(this.scene.anims);this.scene.anims.add(i.KEY,r)}if(!this.scene.anims.exists(n.KEY)){var o=new q(this.scene.anims);this.scene.anims.add(n.KEY,o)}},n.addMeleeLevel1Animation=function(){var e=P.VA.MELEE[1],t=e.ATTACK,n=e.DIE,i=e.IDLE,a=e.RUN;if(!this.scene.anims.exists(t.KEY)){var s=new we(this.scene.anims);this.scene.anims.add(t.KEY,s)}if(!this.scene.anims.exists(n.KEY)){var r=new Me(this.scene.anims);this.scene.anims.add(n.KEY,r)}if(!this.scene.anims.exists(i.KEY)){var o=new We(this.scene.anims);this.scene.anims.add(i.KEY,o)}if(!this.scene.anims.exists(a.KEY)){var c=new nt(this.scene.anims);this.scene.anims.add(a.KEY,c)}},n.addRangedLevel1Animation=function(){var e=P.VA.RANGED[1],t=e.ATTACK_ABOVE,n=e.DIE,i=e.IDLE;if(!this.scene.anims.exists(t.KEY)){var a=new yt(this.scene.anims);this.scene.anims.add(t.KEY,a)}if(!this.scene.anims.exists(n.KEY)){var s=new Dt(this.scene.anims);this.scene.anims.add(n.KEY,s)}if(!this.scene.anims.exists(i.KEY)){var r=new Ht(this.scene.anims);this.scene.anims.add(i.KEY,r)}},n.checkIfAnimationIsAdded=function(e){return this.scene.anims.exists(e)},n.addMeleeUnitAnimationBasedOnLevel=function(e){if(1===e)this.addMeleeLevel1Animation();else this.addAlienAnimation()},n.addRangedUnitAnimationBasedOnLevel=function(e){if(1===e)this.addRangedLevel1Animation();else this.addAlienAnimation()},t}(w),Kt=Yt,Vt=n(126),Wt=n(17),jt=Wt.Z.MULTIPLY_REWARD_ROUND,zt=Wt.Z.UNIT_COIN_SCALE,Xt=Wt.Z.BASE_UNIT_COIN,qt=Wt.Z.COINS_PER_ATTACK,Qt=Wt.Z.ATTACK_COIN_SCALE,Jt=Wt.Z.MULTIPLY_REWARD_BATTLE,$t=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.unitModifier=void 0,n.currentUnitModifier=void 0,n.attackModifier=void 0,n.currentAttackModifier=void 0,n.totalCoinsByAttack=void 0,n.scene=t,n.initModifier(),n}(0,a.Z)(t,e);var n=t.prototype;return n.initModifier=function(){this.unitModifier=new Vt.Z(1),this.attackModifier=new Vt.Z(1),this.currentUnitModifier=new Vt.Z(1)},n.init=function(){e.prototype.init.call(this),this.totalCoinsByAttack=new Vt.Z(0)},n.getUnitPrice=function(e){var t=e||0,n=new Vt.Z(Xt),i=n.clone();return i.multiply(t),i.multiply(this.unitModifier),i.biggerThan(n)?i:n},n.getAttackCoinByUnit=function(e,t){var n=.75*(e.level-1)+qt,i=this.attackModifier.clone();i.multiply(n);var a=t.currentHp,s=e.attackPower;return a<s&&(i.multiply(a),i.divide(s)),i.biggerThan(new Vt.Z(1))?i:new Vt.Z(1)},n.setUnitModifier=function(e,t){if(void 0===t&&(t=1),e<=50){var n=Math.pow(zt,e);this.currentUnitModifier=new Vt.Z(1),this.currentUnitModifier.multiply(n)}else{var i=Math.pow(zt,50),a=Math.floor(e/50),s=e%50;this.currentUnitModifier=new Vt.Z(1);for(var r=0;r<a;r++)this.currentUnitModifier.multiply(i);var o=Math.pow(zt,s);this.currentUnitModifier.multiply(o)}this.currentUnitModifier.multiply(t),this.unitModifier=this.currentUnitModifier},n.getUnitModifier=function(){return this.unitModifier},n.setAttackModifier=function(e,t){if(void 0===t&&(t=1),e<=50){var n=Math.pow(Qt,e);this.currentAttackModifier=new Vt.Z(1),this.currentAttackModifier.multiply(n)}else{var i=Math.pow(Qt,50),a=Math.floor(e/50),s=e%50;this.currentAttackModifier=new Vt.Z(1);for(var r=0;r<a;r++)console.log("Attack modifier: ",this.attackModifier.toString()),this.currentAttackModifier.multiply(i),this.currentAttackModifier.multiply(1.5),console.log("Attack modifier: ",this.attackModifier.toString());var o=Math.pow(Qt,s);this.currentAttackModifier.multiply(o)}this.currentAttackModifier.multiply(t),this.attackModifier=this.currentAttackModifier},n.getAttackModifier=function(){return this.attackModifier},n.addCoinsByAttack=function(e){this.totalCoinsByAttack.add(e)},n.getTotalCoinsByAttack=function(){return this.totalCoinsByAttack.clone()},n.getRewardCoinsByAttackCoins=function(){var e=this.scene.gameMode,t=this.totalCoinsByAttack.clone();return t.multiply(jt),e===l.Z.BATTLE&&t.multiply(Jt),t},t}(w),en=$t,tn=n(150),nn=n.n(tn),an=n(124),sn=function(e){try{var t=localStorage.getItem(e);return null===t?null:GameCore.Utils.Json.decode(t)}catch(n){return null}},rn=function(e,t){try{var n=sn(e),i={};GameCore.Utils.Valid.isObject(n)&&(i=n);var a=GameCore.Utils.Json.clone(t);if(!GameCore.Utils.Valid.isObject(a))return!1;var s=GameCore.Utils.Object.clear(a),r=(0,an.TS)(i,s),o=GameCore.Utils.Json.encode(r);return localStorage.setItem(e,o),!0}catch(c){return!1}},on=Wt.Z.UNIT_PRICE_CUSTOM_MODIFIER,cn=Wt.Z.ATTACK_CUSTOM_MODIFIER,ln=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.currentGameMode=void 0,n.unitLevelsUpdated=void 0,n.customUnitModifier=void 0,n.attackLevelsUpdated=void 0,n.customAttackModifier=void 0,n.scene=t,n.intData(),n}(0,a.Z)(t,e);var n=t.prototype;return n.intData=function(){this.currentGameMode=l.Z.NORMAL,this.unitLevelsUpdated=[!1],this.customUnitModifier=0,this.attackLevelsUpdated=[!1],this.customAttackModifier=0,GameCore.Utils.Valid.isDebugger()&&localStorage.clear(),this.initDataToolDev()},n.init=function(){var e=this.scene.levelManager;(this.scene.gameMode!==this.currentGameMode||e.isInLevelBuilderLevel())&&(this.currentGameMode=this.scene.gameMode,this.unitLevelsUpdated=[!1],this.customUnitModifier=0,this.attackLevelsUpdated=[!1],this.customAttackModifier=0)},n.initDataToolDev=function(){if(GameCore.Utils.Valid.isDebugger()){if(!sn("DevCustomUnitMod")){var e={};on.forEach((function(t){e[t[0]]=t[1]})),rn("DevCustomUnitMod",e)}if(!sn("DevCustomAttackMod")){var t={};cn.forEach((function(e){t[e[0]]=e[1]})),rn("DevCustomAttackMod",t)}}},n.addCustomUnitModifier=function(e){this.customUnitModifier+=e},n.updateCustomUnitModifierByLevel=function(e){if(!this.updateCustomUnitModSuccessByDevTool(e)){for(var t=0;t<on.length;t++){var n=on[t],i=n[0],a=n[1];if(i>e)break;this.unitLevelsUpdated[i]||(this.addCustomUnitModifier(a),this.unitLevelsUpdated[i]=!0)}this.scene.coinManager.setUnitModifier(e,this.customUnitModifier)}},n.updateCustomUnitModSuccessByDevTool=function(e){if(!GameCore.Utils.Valid.isDebugger())return!1;var t=sn("DevCustomUnitMod");if(!GameCore.Utils.Valid.isObject(t))return!1;for(var n=0,i=0,a=nn()(t);i<a.length;i++){var s=a[i],r=s[0],o=s[1],c=parseInt(r),l=o;if(c>e)break;c===e&&(n=l),this.unitLevelsUpdated[c]||(this.addCustomUnitModifier(l),this.unitLevelsUpdated[c]=!0)}var u=this.scene,h=u.coinManager,d=u.devToolManager;return h.setUnitModifier(e,this.customUnitModifier),d.setCurrentUnitModText(n,h.getUnitModifier()),!0},n.editCurrentLevelUnitMod=function(e){var t=this.scene.levelManager.getCurrentLevelId(),n=sn("DevCustomUnitMod");if(GameCore.Utils.Valid.isObject(n)){var i,a=n[t];this.customUnitModifier=this.customUnitModifier-a+e,rn("DevCustomUnitMod",((i={})[t]=e,i))}else{var s;this.addCustomUnitModifier(e),this.unitLevelsUpdated[t]=!0,rn("DevCustomUnitMod",((s={})[t]=e,s))}var r=this.scene.coinManager;return r.setUnitModifier(t,this.customUnitModifier),r.getUnitModifier()},n.addCustomAttackModifier=function(e){this.customAttackModifier+=e},n.updateCustomAttackModifierByLevel=function(e){if(!this.updateCustomAttackModSuccessByDevTool(e)){for(var t=0;t<cn.length;t++){var n=cn[t],i=n[0],a=n[1];if(i>e)break;this.attackLevelsUpdated[i]||(this.addCustomAttackModifier(a),this.attackLevelsUpdated[i]=!0)}this.scene.coinManager.setAttackModifier(e,this.customAttackModifier)}},n.updateCustomAttackModSuccessByDevTool=function(e){if(!GameCore.Utils.Valid.isDebugger())return!1;var t=sn("DevCustomAttackMod");if(!GameCore.Utils.Valid.isObject(t))return!1;for(var n=0,i=0,a=nn()(t);i<a.length;i++){var s=a[i],r=s[0],o=s[1],c=parseInt(r),l=o;if(c>e)break;c===e&&(n=l),this.attackLevelsUpdated[c]||(this.addCustomAttackModifier(l),this.attackLevelsUpdated[c]=!0)}var u=this.scene,h=u.coinManager,d=u.devToolManager;return h.setAttackModifier(e,this.customAttackModifier),d.setCurrentAttackModText(n,h.getAttackModifier()),!0},n.editCurrentLevelAttackMod=function(e){var t=this.scene.levelManager.getCurrentLevelId(),n=sn("DevCustomAttackMod");if(GameCore.Utils.Valid.isObject(n)){var i,a=n[t];this.customAttackModifier=this.customAttackModifier-a+e,rn("DevCustomAttackMod",((i={})[t]=e,i))}else{var s;this.addCustomAttackModifier(e),this.attackLevelsUpdated[t]=!0,rn("DevCustomAttackMod",((s={})[t]=e,s))}var r=this.scene.coinManager;return r.setAttackModifier(t,this.customAttackModifier),r.getAttackModifier()},t}(w),un=ln,hn=n(486),dn=n(485),pn=n(34),fn=n(25),gn=n(484),En=n(483),mn=h.Z.SPINE_EFFECTS.FX_MERGE,vn=h.Z.GAMEPLAY,An=vn.KEY,Sn=vn.FRAME,Tn=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.textObjects=void 0,n.activeTextObjects=void 0,n.mergeEffect=void 0,n.curveAnimation=void 0,n.rewardUnitCurveAnimation=void 0,n.sample=void 0,n.starTail=void 0,n.fullTextTween=void 0,n.resultWinAnimation=void 0,n.resultLoseAnimation=void 0,n.sparkExplosive=void 0,n.runSparksExplosive=function(e,t){var i=n.scene;n.sparkExplosive=new En.Z(i),n.sparkExplosive.setDepth(d.Z.EFFECT),n.sparkExplosive.explode(100,e,t,50)},n.scene=t,n.createMergeEffect(),n.createTextObjects(),n.createCurveAnimation(),n.createFullText(),n.createResultWinEffect(),n.createResultLoseEffect(),n}(0,a.Z)(t,e);var n=t.prototype;return n.stop=function(){this.isRunning()&&(e.prototype.stop.call(this),this.stopMergeEffect(),this.stopTextEffect(),this.resetFullFloatText())},n.playMergeEffect=function(e){var t=e.getWorldPosition(),n=t.x,i=t.y;this.mergeEffect.setActive(!0),this.mergeEffect.setVisible(!0),this.mergeEffect.setPosition(n,i);var a=this.mergeEffect.getAnimationList();this.mergeEffect.play(a[0],!1,!1),this.scene.audio.playSound(fn.Z.UNIT_MERGE,{volume:.5})},n.createMergeEffect=function(){this.mergeEffect=this.scene.add.spine(0,0,mn.KEY,"animation"),this.mergeEffect.setName("MergeEffect"),this.mergeEffect.setDepth(d.Z.EFFECT),this.mergeEffect.setScale(.5,.5),this.mergeEffect.setActive(!1),this.mergeEffect.setVisible(!1)},n.stopMergeEffect=function(){this.mergeEffect.setActive(!1),this.mergeEffect.setVisible(!1)},n.createTextObjects=function(){this.textObjects=this.scene.add.group({runChildUpdate:!1}),this.activeTextObjects=this.scene.add.group({runChildUpdate:!1})},n.getTextEffectObject=function(){var e=this.textObjects.getMatching("active",!1)[0];return e||this.createTextEffect()},n.createTextEffect=function(){var e=this.scene.make.bitmapText({font:pn.Z.PRIMARY.KEY,size:this.scene.fontSize(18),origin:{x:.5,y:.5}});return e.setDepth(d.Z.DMG_POPUP_NUMBER),this.textObjects.add(e),e},n.hideAllTextEffects=function(){var e=this;this.textObjects.getChildren().forEach((function(t){t instanceof Phaser.GameObjects.BitmapText&&t.active&&t.visible&&(e.activeTextObjects.add(t),t.kill())}))},n.showAllTextEffects=function(){this.activeTextObjects.getChildren().forEach((function(e){e instanceof Phaser.GameObjects.BitmapText&&e.revive()})),this.activeTextObjects.clear()},n.stopTextEffect=function(){var e=this;this.textObjects.getChildren().forEach((function(t){t instanceof Phaser.GameObjects.Text&&(t.kill(),t.setAlpha(1),e.scene.tweens.killTweensOf(t))}))},n.createCurveAnimation=function(){this.sample=this.scene.make.image({key:An,frame:Sn.BLANK}),this.sample.setVisible(!1);var e=new gn.Z(this.scene);e.setDepth(d.Z.EFFECT),this.starTail=e},n.runCurveAnimation=function(e,t,n,i){var a=this,s={x:e,y:t},r={x:n,y:i};this.curveAnimation=new dn.Z({targets:[this.sample],delay:this.scene.tweens.stagger(80,{}),duration:1e3,curve:[[s.x,s.y],[s.x-Phaser.Math.RND.between(-100,100),s.y+Phaser.Math.RND.between(-140,-100)],[r.x,r.y]],onComplete:function(){a.runSparksExplosive(n,i)},onCurveUpdate:function(e){var t=e.x+Phaser.Math.RND.between(-16,16),n=e.y+Phaser.Math.RND.between(-16,16);a.starTail.explode(1,t,n)}}),this.curveAnimation.play()},n.runCurveAnimationRewardUnit=function(e,t,n,i,a){var s=this,r={x:e,y:t},o={x:n.x,y:n.y},c=a||1;this.rewardUnitCurveAnimation=new dn.Z({targets:[this.sample],delay:this.scene.tweens.stagger(80,{}),duration:1e3,curve:[[r.x,r.y],[r.x-Phaser.Math.RND.between(-100,100),r.y+Phaser.Math.RND.between(-140,-100)],[o.x,o.y]],onComplete:function(){s.runSparksExplosive(o.x,o.y);var e=s.scene.unitManager;"MELEE"===i&&e.createPlayerMelee(n.rowId,n.colId,c),"RANGED"===i&&e.createPlayerArcher(n.rowId,n.colId,c),s.scene.updateUI()},onStop:function(){var e=s.scene.unitManager;"MELEE"===i&&e.createPlayerMelee(n.rowId,n.colId,c),"RANGED"===i&&e.createPlayerArcher(n.rowId,n.colId,c),s.scene.updateUI()},onCurveUpdate:function(e){var t=e.x+Phaser.Math.RND.between(-16,16),n=e.y+Phaser.Math.RND.between(-16,16);s.isRewardCurveAnimationRunning()&&s.starTail.explode(1,t,n)}}),this.rewardUnitCurveAnimation.play()},n.createFullText=function(){var e=this,t=this.scene.add.container(0,0);t.setDepth(d.Z.EFFECT);var n=this.scene.make.image({key:An,frame:Sn.PURPLE_EFFECT});n.setOrigin(.5,.5),n.setWorldSize(263.5,79.5),t.add(n);var i=this.scene.make.text({text:this.scene.lang.Text.FULL,style:{fontSize:"25px",color:"#FFFFFF",fontFamily:pn.Z.FONT_FAMILY}});i.setHighQuality(),Phaser.Display.Align.In.Center(i,n,-3,-5),t.add(i),t.kill(),Phaser.Display.Align.In.Center(t,this.scene.gameZone,0,30),this.fullTextTween=new hn.Z({targets:[t],onStart:function(){t.revive()},onComplete:function(){e.scene.tweens.add({targets:[t],duration:300,delay:200,alpha:0})}})},n.playFullFloatText=function(){this.fullTextTween.play()},n.resetFullFloatText=function(){this.fullTextTween.stop()},n.createResultWinEffect=function(){var e=this,t=this.scene.add.container(0,0);t.setDepth(d.Z.EFFECT);var n=this.scene.make.image({key:An,frame:Sn.EFFECT_WIN_GLOW});n.setWorldSize(276.5,58.5),t.add(n);var i=this.scene.make.text({text:this.scene.lang.Text.WIN,style:{fontSize:"25px",color:"#FFFFFF",fontFamily:pn.Z.FONT_FAMILY}});i.setHighQuality(),Phaser.Display.Align.In.Center(i,n),t.add(i);var a=this.scene.make.image({key:An,frame:Sn.EFFECT_WIN_SHAPE_ABOVE});a.setWorldSize(87.5,18.5),t.add(a),Phaser.Display.Align.In.TopCenter(a,n,0,5);var s=this.scene.make.image({key:An,frame:Sn.EFFECT_WIN_SHAPE_BELOW});s.setWorldSize(147,23.5),t.add(s),Phaser.Display.Align.In.BottomCenter(s,n,0,8),t.kill(),this.scene.world.isLandscape()?Phaser.Display.Align.In.Center(t,this.scene.gameZone,0,-20):Phaser.Display.Align.In.Center(t,this.scene.gameZone,0,-80),this.resultWinAnimation=this.scene.tweens.add({paused:!0,targets:[t],onActive:function(){t.revive(),t.setAlpha(1),t.setScale(1),n.setAlpha(0),i.setAlpha(0),a.setAlpha(0),s.setAlpha(0),e.scene.add.tween({targets:[n,i],duration:400,alpha:{start:0,to:1},ease:Phaser.Math.Easing.Quadratic.In}),e.scene.add.tween({targets:[a,s],duration:300,alpha:{start:0,to:1}}),e.scene.add.tween({targets:[a],duration:300,delay:200,y:{start:-10,to:-25},ease:Phaser.Math.Easing.Cubic.InOut}),e.scene.add.tween({targets:[s],duration:300,delay:200,y:{start:10,to:25},ease:Phaser.Math.Easing.Cubic.InOut}),e.scene.add.tween({targets:[t],duration:600,delay:1e3,scale:{from:1,to:1.2},ease:Phaser.Math.Easing.Cubic.InOut}),e.scene.tweens.add({targets:[t],duration:300,delay:1300,alpha:0})}})},n.playResultWinAnimation=function(){this.resultWinAnimation.play()},n.createResultLoseEffect=function(){var e=this,t=this.scene.add.container(0,0);t.setDepth(d.Z.EFFECT);var n=this.scene.make.image({key:An,frame:Sn.EFFECT_LOSE_GLOW});n.setWorldSize(253.5,55),t.add(n);var i=this.scene.make.text({text:this.scene.lang.Text.LOSE,style:{fontSize:"25px",color:"#FFFFFF",fontFamily:pn.Z.FONT_FAMILY}});i.setHighQuality(),Phaser.Display.Align.In.Center(i,n),t.add(i);var a=this.scene.make.image({key:An,frame:Sn.EFFECT_LOSE_SHAPE_ABOVE});a.setWorldSize(86,22.5),t.add(a),Phaser.Display.Align.In.TopCenter(a,n,0,5);var s=this.scene.make.image({key:An,frame:Sn.EFFECT_LOSE_SHAPE_BELOW});s.setWorldSize(126.5,25.5),t.add(s),Phaser.Display.Align.In.BottomCenter(s,n,0,8),t.kill(),this.scene.world.isLandscape()?Phaser.Display.Align.In.Center(t,this.scene.gameZone,0,-20):Phaser.Display.Align.In.Center(t,this.scene.gameZone,0,-80),this.resultLoseAnimation=this.scene.tweens.add({paused:!0,targets:[t],onActive:function(){t.revive(),t.setAlpha(1),t.setScale(1),n.setAlpha(0),i.setAlpha(0),a.setAlpha(0),s.setAlpha(0),e.scene.add.tween({targets:[n,i],duration:400,alpha:{start:0,to:1},ease:Phaser.Math.Easing.Quadratic.In}),e.scene.add.tween({targets:[a,s],duration:300,alpha:{start:0,to:1}}),e.scene.add.tween({targets:[a],duration:300,delay:200,y:{start:-10,to:-25},ease:Phaser.Math.Easing.Cubic.InOut}),e.scene.add.tween({targets:[s],duration:300,delay:200,y:{start:10,to:25},ease:Phaser.Math.Easing.Cubic.InOut}),e.scene.add.tween({targets:[t],duration:600,delay:1e3,scale:{from:1,to:.8},ease:Phaser.Math.Easing.Cubic.InOut}),e.scene.tweens.add({targets:[t],duration:300,delay:1300,alpha:0})}})},n.playResultLoseAnimation=function(){this.resultLoseAnimation.play()},n.isRewardCurveAnimationRunning=function(){return!!this.rewardUnitCurveAnimation&&(!!this.rewardUnitCurveAnimation.tween&&(this.rewardUnitCurveAnimation&&this.rewardUnitCurveAnimation.tween.isPlaying()))},n.stopRewardCurveAnimation=function(){var e,t;this.isRewardCurveAnimationRunning()&&(this.rewardUnitCurveAnimation.stop(),null==(e=this.starTail)||e.stop(),null==(t=this.sparkExplosive)||t.stop())},t}(w),yn=Tn,Cn=n(88),In=n.n(Cn),Rn=n(59),wn=n.n(Rn),_n=n(84),bn=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t,n,i)||this).placementArea=void 0,s.areaRect=void 0,s.scene=void 0,s.rowId=void 0,s.colId=void 0,s.isTaken=void 0,s.scene=t,s.createAreaRect(a),s.createPlacementArea(a),s.addEventListener(),s.scene.add.existing((0,u.Z)(s)),s.setDepth(d.Z.FIELD_SQUARE),s}(0,a.Z)(t,e);var n=t.prototype;return n.createPlacementArea=function(e){this.placementArea=this.scene.add.zone(0,0,e,e),this.add(this.placementArea)},n.createAreaRect=function(e){this.areaRect=this.scene.add.rectangle(0,0,e,e,16368767,1),this.add(this.areaRect),this.areaRect.setDepth(d.Z.FIELD_SQUARE_RECT)},n.updateAreaRect=function(e){this.areaRect.setFillStyle(e)},n.setSquarePosition=function(e,t){this.rowId=e,this.colId=t,this.isTaken=!1},n.setTaken=function(e){this.isTaken=e},n.addEventListener=function(){var e=this;this.placementArea.setInteractive({useHandCursor:!0}),this.placementArea.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,(function(){console.log(e.rowId,e.colId)}))},t}(Phaser.GameObjects.Container),Ln=bn,Pn=[{KEY_PORTRAIT:_n.Z.BG_TREE.KEY,KEY_LANDSCAPE:_n.Z.BG_LANDSCAPE_TREE.KEY,BG_EXTENSION_COLOR:8102725,SQUARE_COLOR:11452994,SQUARE_HIGHT_LIGHT_COLOR:9692964,SQUARE_HIGHT_LIGHT_BORDER_COLOR:14089889},{KEY_PORTRAIT:_n.Z.BG_DESERT.KEY,KEY_LANDSCAPE:_n.Z.BG_LANDSCAPE_DESERT.KEY,BG_EXTENSION_COLOR:16761714,SQUARE_COLOR:16368767,SQUARE_HIGHT_LIGHT_COLOR:16766227,SQUARE_HIGHT_LIGHT_BORDER_COLOR:16773290},{KEY_PORTRAIT:_n.Z.BG_ICE.KEY,KEY_LANDSCAPE:_n.Z.BG_LANDSCAPE_ICE.KEY,BG_EXTENSION_COLOR:15330021,SQUARE_COLOR:13952244,SQUARE_HIGHT_LIGHT_COLOR:6402815,SQUARE_HIGHT_LIGHT_BORDER_COLOR:16777215},{KEY_PORTRAIT:_n.Z.BG_CRYSTAL.KEY,KEY_LANDSCAPE:_n.Z.BG_LANDSCAPE_CRYSTAL.KEY,BG_EXTENSION_COLOR:3224690,SQUARE_COLOR:5792413,SQUARE_HIGHT_LIGHT_COLOR:6195962,SQUARE_HIGHT_LIGHT_BORDER_COLOR:11848191},{KEY_PORTRAIT:_n.Z.BG_VOLCANO.KEY,KEY_LANDSCAPE:_n.Z.BG_LANDSCAPE_VOLCANO.KEY,BG_EXTENSION_COLOR:13383207,SQUARE_COLOR:7886462,SQUARE_HIGHT_LIGHT_COLOR:12016072,SQUARE_HIGHT_LIGHT_BORDER_COLOR:15310583}],On=Pn,Dn=n(65),kn=C.STATUS,Nn=Dn.Z.LEVEL_PROGRESS,Bn={x:30.5,y:158},Mn={x:30.5,y:-246},xn=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.fieldBackground=void 0,n.playerPlacementSquares=void 0,n.enemyPlacementSquares=void 0,n.firstHightLineZone=void 0,n.secondHightLineZone=void 0,n.fieldBackgroundExtension=void 0,n.scene=t,n.enemyPlacementSquares=[],n.playerPlacementSquares=[],n.scene.world.isUsingLandscapeBackground()&&(Bn.x=323,Bn.y=55,Mn.x=323,Mn.y=-77),n.createBattlefield(),n.createHightLineZone(),n}(0,a.Z)(t,e);var n=t.prototype;return n.init=function(){e.prototype.init.call(this),this.updateField(),this.resetPlacementSquareStatus()},n.start=function(){this.isRunning()||(this.showPlacementSquares(),this.setState(kn.RUNNING))},n.updateField=function(){var e=this.getCurrentLevel(),t=this.getBgData(e);this.scene.world.isUsingLandscapeBackground()?this.updateBackgroundElement(t):(this.updateFieldBackground(t),this.updatePlacementSquares(t),this.updateHightLightSquares(t))},n.getCurrentLevel=function(){var e=this.scene.levelManager.currentLevelData,t=void 0===e?null:e,n=t?t.level_id:1;if(!t){var i=this.scene.player.getCustomData(Nn);i&&(n=i>0?i+1:1)}return n},n.getBgData=function(e){var t=Math.floor(e/10)%In()(On).length,n=On[t],i=this.scene.world.isUsingLandscapeBackground()?n.KEY_LANDSCAPE:n.KEY_PORTRAIT;return this.scene.textures.exists(i)?n:On[0]},n.updateFieldBackground=function(e){var t=this.scene.world.isUsingLandscapeBackground()?e.KEY_LANDSCAPE:e.KEY_PORTRAIT;this.fieldBackground.setTexture(t),this.fieldBackgroundExtension.setFillStyle(e.BG_EXTENSION_COLOR)},n.updatePlacementSquares=function(e){this.playerPlacementSquares.forEach((function(t){t.updateAreaRect(e.SQUARE_COLOR)})),this.enemyPlacementSquares.forEach((function(t){t.updateAreaRect(e.SQUARE_COLOR)}))},n.updateHightLightSquares=function(e){this.firstHightLineZone.setFillStyle(e.SQUARE_HIGHT_LIGHT_COLOR),this.firstHightLineZone.setStrokeStyle(2,e.SQUARE_HIGHT_LIGHT_BORDER_COLOR),this.secondHightLineZone.setFillStyle(e.SQUARE_HIGHT_LIGHT_COLOR),this.secondHightLineZone.setStrokeStyle(2,e.SQUARE_HIGHT_LIGHT_BORDER_COLOR)},n.createHightLineZone=function(){var e=this.fieldBackground,t=e.displayWidth,n=e.scale*this.scene.world.getPixelRatio(),i=Bn.x*n,a=(Bn.y,t-2*i);this.firstHightLineZone=this.scene.add.rectangle(0,0,a/5,a/5,16777215,1),this.firstHightLineZone.setStrokeStyle(2,16776960),this.firstHightLineZone.setDepth(d.Z.FIELD_SQUARE_RECT),this.firstHightLineZone.kill(),this.secondHightLineZone=this.scene.add.rectangle(0,0,a/5,a/5,16777215,1),this.secondHightLineZone.setStrokeStyle(2,16776960),this.secondHightLineZone.setDepth(d.Z.FIELD_SQUARE),this.secondHightLineZone.kill()},n.createBattlefield=function(){var e=this.getCurrentLevel(),t=this.getBgData(e);this.createFieldBackground(t),this.createPlacementSquares(t)},n.createFieldBackground=function(e){var t=this.scene.world.isUsingLandscapeBackground()?e.KEY_LANDSCAPE:e.KEY_PORTRAIT;this.createBackground(t),this.handleBackgroundTopOffset(),this.createBackgroundExtension(e.BG_EXTENSION_COLOR)},n.createBackground=function(e){var t=this.scene.gameZone.displayWidth;this.fieldBackground=this.scene.make.image({key:e}),this.fieldBackground.setOrigin(0,1),this.fieldBackground.setScale(t/this.fieldBackground.width),this.fieldBackground.setDepth(d.Z.FIELD_BACKGROUND)},n.handleBackgroundTopOffset=function(){var e=this.scene.gameZone.displayHeight,t=50-(Bn.y-(this.fieldBackground.displayHeight-e));if(t<0&&(t=0),this.scene.world.isUsingLandscapeBackground())return this.fieldBackground.setOrigin(.275,0),void this.fieldBackground.setWorldSize(960,540);this.fieldBackground.setPosition(0,e+t)},n.createBackgroundExtension=function(e){var t=this.scene.gameZone,n=t.displayWidth,i=t.displayHeight,a=this.fieldBackground.getBottomLeft();this.fieldBackgroundExtension=this.scene.add.rectangle(a.x,a.y,n,i,e),this.fieldBackgroundExtension.setOrigin(0,0)},n.createPlacementSquares=function(e){this.createPlayerPlacementSquares(e.SQUARE_COLOR),this.createEnemyPlacementSquares(e.SQUARE_COLOR)},n.createEnemyPlacementSquares=function(e){var t=this.fieldBackground,n=t.displayWidth,i=t.scaleX,a=t.scaleY,s=i*this.scene.world.getPixelRatio(),r=a*this.scene.world.getPixelRatio(),o={x:Bn.x*s,y:Bn.y*s},c={x:Bn.x*r,y:Bn.y*r},l=o.y,u=c.y,h=n-2*o.x,d=n-2*c.x,p=h<d?h:d,f=h<d?o.x:c.x,g=Math.abs(l)<Math.abs(u)?l:u,E=this.fieldBackground.getTopLeft();E.x+=f,E.y+=g;for(var m=1,v=0;v<3;v++)for(var A=0;A<5;A++){var S=new Ln(this.scene,E.x+A*p/5+p/10,E.y+v*p/5+p/10,p/5);S.updateAreaRect(e),S.setSquarePosition(v+1,A+1),S.setAlpha(m),m=1===m?0:1,this.enemyPlacementSquares.push(S)}},n.createPlayerPlacementSquares=function(e){var t=this.fieldBackground,n=t.displayWidth,i=t.scaleX,a=t.scaleY,s=i*this.scene.world.getPixelRatio(),r=a*this.scene.world.getPixelRatio(),o={x:Mn.x*s,y:Mn.y*s},c={x:Mn.x*r,y:Mn.y*r},l=o.y,u=c.y,h=n-2*o.x,d=n-2*c.x,p=h<d?h:d,f=h<d?o.x:c.x,g=Math.abs(l)<Math.abs(u)?l:u,E=this.fieldBackground.getBottomLeft();E.x+=f,E.y+=g;for(var m=1,v=0;v<3;v++)for(var A=0;A<5;A++){var S=new Ln(this.scene,E.x+A*p/5+p/10,E.y-v*p/5-p/10,p/5);S.updateAreaRect(e),S.setSquarePosition(3-v,A+1),S.setAlpha(m),m=1===m?0:1,this.playerPlacementSquares.push(S)}},n.hidePlacementSquares=function(){this.playerPlacementSquares.forEach((function(e){return e.kill()})),this.enemyPlacementSquares.forEach((function(e){return e.kill()}))},n.showPlacementSquares=function(){this.playerPlacementSquares.forEach((function(e){return e.revive()})),this.enemyPlacementSquares.forEach((function(e){return e.revive()}))},n.getPlayerPlacementSquare=function(e,t){var n;return wn()(n=this.playerPlacementSquares).call(n,(function(n){return n.rowId===e&&n.colId===t}))[0]},n.getEnemyPlacementSquare=function(e,t){var n;return wn()(n=this.enemyPlacementSquares).call(n,(function(n){return n.rowId===e&&n.colId===t}))[0]},n.getSquareBasedOnPosition=function(e,t){for(var n=0;n<this.playerPlacementSquares.length;n++){var i=this.playerPlacementSquares[n];if(i.placementArea.getBounds().contains(e,t))return i}return null},n.getSquareBasedOnIndex=function(e,t){for(var n=0;n<this.playerPlacementSquares.length;n++){var i=this.playerPlacementSquares[n];if(i.rowId===e&&i.colId===t)return i}return null},n.tryGettingAvailablePlacement=function(e,t){var n=this.getSquareBasedOnIndex(e,t);return n&&!n.isTaken?n:null},n.getAvailablePlacement=function(){for(var e=null,t=0;t<this.playerPlacementSquares.length;t++){var n=this.playerPlacementSquares[t];if(!n.isTaken)return e=n}return e},n.resetPlacementSquareStatus=function(){this.playerPlacementSquares.forEach((function(e){return e.isTaken=!1}))},n.getRemainingAvailablePlacement=function(){var e;return wn()(e=this.playerPlacementSquares).call(e,(function(e){return!e.isTaken})).length},n.updateBackgroundElement=function(e){var t=this;if(this.scene.world.isUsingLandscapeBackground()){var n=document.getElementById("background-image");if(n){var i=this.scene.player.getCustomData(Nn);if("number"!==typeof i||i<0)n.src=_n.Z.BG_LANDSCAPE_TREE.FILE;else{var a=_n.Z.BG_LANDSCAPE_TREE.FILE;switch(Math.floor((i+1)/10)%5){case 0:a=_n.Z.BG_LANDSCAPE_TREE.FILE;break;case 1:a=_n.Z.BG_LANDSCAPE_DESERT.FILE;break;case 2:a=_n.Z.BG_LANDSCAPE_ICE.FILE;break;case 3:a=_n.Z.BG_LANDSCAPE_CRYSTAL.FILE;break;case 4:a=_n.Z.BG_LANDSCAPE_VOLCANO.FILE}n.onload=function(){t.updateFieldBackground(e),t.updatePlacementSquares(e),t.updateHightLightSquares(e),n.onload=function(){}},n.src=a}}}},n.isLandscapeBackground=function(){return this.scene.world.getScreenRatio()>.796},t}(w),Un=xn,Fn=n(208),Zn=n.n(Fn),Gn=C.STATUS,Hn=Wt.Z.MELEE_UNIT_TYPE,Yn=Wt.Z.RANGED_UNIT_TYPE,Kn=Dn.Z.LEVEL_PROGRESS,Vn=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.playerLevel=void 0,n.currentLevelId=void 0,n.currentLevelData=void 0,n.enemyData=void 0,n.playerData=void 0,n.scene=t,n}(0,a.Z)(t,e);var n=t.prototype;return n.init=function(){var e=this.scene.gameMode;this.enemyData=[],e===l.Z.NORMAL&&(this.updatePlayerLevel(),this.loadLevel()),e===l.Z.BATTLE&&(this.createBattleOpponentData(),this.setBattleOpponentLevel())},n.start=function(){this.isRunning()||this.setState(Gn.RUNNING)},n.setCurrentLevelId=function(e){this.currentLevelId=e},n.updatePlayerLevel=function(){var e=this.scene.player.getCustomData(Kn),t=e&&GameCore.Utils.Valid.isNumber(e)&&e>0;this.playerLevel=t?e:0},n.loadLevel=function(){try{if(this.scene.game.cache.json.exists("level-builder-json"))return void this.loadLevelBuilderLevel();this.setCurrentLevelId(this.playerLevel?this.playerLevel+1:1),console.log("\ud83e\udd16 ? this.playerLevel",this.playerLevel);var e=this.playerLevel?this.playerLevel:0,t=100*Math.floor(e/100)+1,n=t+99,i=(1e4+t).toString().substring(1),a=(1e4+n).toString().substring(1),s=this.scene.cache.json.get("levels-"+i+"-"+a),r=this.currentLevelId-t;r>=s.levels.length&&this.setCurrentLevelId(s.levels.length-1),this.currentLevelData=s.levels[r],console.log(this.currentLevelData),this.createEnemyData()}catch(o){console.warn(o)}},n.createEnemyData=function(){var e=this;this.currentLevelData.enemy_row1.split("-").forEach((function(t,n){if("0"!==t){var i="m"===t.charAt(0)?Hn:Yn,a=parseInt(t.substring(1)),s=n+1;e.enemyData.push({type:i,level:a,positionRow:1,positionColumn:s})}})),this.currentLevelData.enemy_row2.split("-").forEach((function(t,n){if("0"!==t){var i="m"===t.charAt(0)?Hn:Yn,a=parseInt(t.substring(1)),s=n+1;e.enemyData.push({type:i,level:a,positionRow:2,positionColumn:s})}})),this.currentLevelData.enemy_row3.split("-").forEach((function(t,n){if("0"!==t){var i="m"===t.charAt(0)?Hn:Yn,a=parseInt(t.substring(1)),s=n+1;e.enemyData.push({type:i,level:a,positionRow:3,positionColumn:s})}}))},n.createBattleOpponentData=function(){var e,t=this,n=this.scene.game.battle.getOpponentInfo();if(console.log(n),n){var i=n.unitData;this.enemyData=[],Zn()(e=i.split("/")).call(e).forEach((function(e,n){e.split("-").forEach((function(e,i){if("0"!==e){var a="m"===e.charAt(0)?Hn:Yn,s=parseInt(e.substring(1)),r=n+1,o=i+1;t.enemyData.push({type:a,level:s,positionRow:r,positionColumn:o})}}))}))}},n.setBattleOpponentLevel=function(){var e=this.scene.game.battle.getOpponentInfo();if(e){var t=e.playerLevel;this.currentLevelId=t}else this.currentLevelId=1},n.loadLevelBuilderLevel=function(){var e=this.scene.cache.json.get("level-builder-json");this.currentLevelId=e.level_id;try{this.currentLevelData=e}catch(t){console.log(t)}this.createData()},n.createData=function(){this.createEnemyData(),this.createPlayerData()},n.createPlayerData=function(){var e=this;this.playerData=[];var t=this.currentLevelData;if(t){var n=new Vt.Z(t.coins.baseValue,t.coins.suffix,!0);this.scene.coin.receiveCoins(n.baseValue,n.suffix),t.player_row1.split("-").forEach((function(t,n){if("0"!==t){var i="m"===t.charAt(0)?Hn:Yn,a=parseInt(t.substring(1)),s=n+1;e.playerData.push({type:i,level:a,positionRow:1,positionColumn:s})}})),t.player_row2.split("-").forEach((function(t,n){if("0"!==t){var i="m"===t.charAt(0)?Hn:Yn,a=parseInt(t.substring(1)),s=n+1;e.playerData.push({type:i,level:a,positionRow:2,positionColumn:s})}})),t.player_row3.split("-").forEach((function(t,n){if("0"!==t){var i="m"===t.charAt(0)?Hn:Yn,a=parseInt(t.substring(1)),s=n+1;e.playerData.push({type:i,level:a,positionRow:3,positionColumn:s})}}))}},n.isInLevelBuilderLevel=function(){return this.scene.gameMode===l.Z.NORMAL&&GameCore.Utils.Object.hasOwn(this.currentLevelData,"player_row1")},n.updateHighestCurrentLevel=function(){this.isInLevelBuilderLevel()||this.playerLevel<this.currentLevelId&&this.scene.player.setCustomData(Kn,this.currentLevelId)},n.getCurrentLevelId=function(){return this.currentLevelId},n.getModifierLevel=function(){var e=this.scene.gameMode;if(e===l.Z.NORMAL)return this.currentLevelId;if(e===l.Z.BATTLE){var t=this.scene.player.getCustomData(Kn);return GameCore.Utils.Valid.isNumber(t)?Math.min(this.currentLevelId,t+1):1}throw new Error("Case not implemented.")},n.getPlayerLevel=function(){if(this.isInLevelBuilderLevel())return this.currentLevelId;var e=this.scene.player.getCustomData(Kn);return GameCore.Utils.Valid.isNumber(e)?e+1:1},n.loadAllLevels=function(){var e=this;this.scene.cache.json.get("levels").levels.forEach((function(t,n){e.currentLevelData=t,console.log(n),e.createEnemyData()}))},t}(w),Wn=Vn,jn=n(163),zn=n.n(jn),Xn={FREE_COINS:{ID:"free-coins"},SPEED_UP:{ID:"speed-up"}},qn=C.STATUS,Qn=GameCore.Configs.Gameplay.Powers.FreeCoins.enable,Jn=GameCore.Configs.Gameplay.Powers.SpeedUp.enable,$n=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.items={},n.readyStateItems={},n.playingStateItems={},n.itemActive=void 0,n.isSpeedUp=void 0,n.activeItem=function(e){n.isRunning()&&n.items[e]&&(n.deactivateItems(),n.itemActive=e,n.items[e].activeItem())},n.deactivateItem=function(e){n.items[e]&&(n.itemActive="",n.items[e].deactivateItem())},n.scene=t,n.isSpeedUp=!1,n.createItems(),n}(0,a.Z)(t,e);var n=t.prototype;return n.init=function(){this.setState(qn.READY),this.deactivateItems(),this.scene.layoutManager.objects.freeCoinsItem.startCountdown()},n.stop=function(){this.isRunning()&&(this.deactivateItems(),this.setState(qn.STOPPED))},n.deactivateItems=function(){for(var e in this.items)this.deactivateItem(e)},n.createItems=function(){this.createFreeCoinsButton(),this.createSpeedUpButton()},n.createFreeCoinsButton=function(){if(Qn){var e=this.scene.layoutManager.objects;this.items[Xn.FREE_COINS.ID]=e.freeCoinsItem}},n.createSpeedUpButton=function(){if(Jn){var e=this.scene.layoutManager.objects;this.items[Xn.SPEED_UP.ID]=e.speedUpItem}},n.getAllItems=function(){return zn()(this.items)},n.getItemsForReadyState=function(){return zn()(this.readyStateItems)},n.getItemsForPlayingState=function(){return zn()(this.playingStateItems)},n.isGameSpeedUp=function(){return this.isSpeedUp||!1},n.forceReturnToNormalSpeed=function(){this.scene.unitManager.resetSpeedAllUnits()},n.checkForSpeedSetting=function(){var e=this.scene.layoutManager.objects,t=!!this.scene.player.getPlayerSetting("speedUp");e.speedUpItem.visible&&(t?this.scene.unitManager.speedUpAllUnits():this.scene.unitManager.resetSpeedAllUnits())},n.syncSpeedSetting=function(){var e=this.scene.layoutManager.objects,t=!!this.scene.player.getPlayerSetting("speedUp");e.speedUpItem.visible&&(t?e.speedUpItem.speedUpGameplay():e.speedUpItem.returnToNormalSpeed())},t}(w),ei=$n,ti=n(89),ni=n.n(ti),ii=Wt.Z.UNIT_SIZE_SCALE,ai=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.isDirtyDepth=void 0,n.spineUnits=[],n.spineContainer=void 0,n.scene=t,n.isDirtyDepth=!1,n.spineUnits=[],n.spineContainer=n.scene.add.spineContainer(0,0),n.spineContainer.setDepth(d.Z.MANAGER_BASE_DEPTH),n}(0,a.Z)(t,e);var n=t.prototype;return n.init=function(){e.prototype.init.call(this),this.spineUnits=[],this.spineContainer.removeAll()},n.update=function(e){var t=this;this.isRunning()&&(this.spineUnits.forEach((function(e){var n=e.getSpineDisplay();if(n){n.depth!==e.depth&&(n.setDepth(e.depth),t.isDirtyDepth=!0);var i=e.getWorldPosition(),a=i.x,s=i.y;n.setPosition(a,s+25)}})),e&&this.isDirtyDepth&&this.sortSpineContainerByDepth())},n.sortSpineContainerByDepth=function(){var e;ni()(e=this.spineContainer).call(e,"depth",(function(e,t){return e.depth-t.depth}))},n.sortSpineContainerByName=function(){var e;ni()(e=this.spineContainer).call(e,"name",(function(e,t){return e.name.localeCompare(t.name)}))},n.sortSpineContainerByLevel=function(){var e;ni()(e=this.spineContainer).call(e,"level",(function(e,t){return e.level-t.level}))},n.addSpines=function(e){var t=this;this.isRunning()&&e.forEach((function(e){if(!t.spineUnits.some((function(t){return t===e}))){var n=e.getSpineDisplay();n&&(n instanceof Phaser.GameObjects.Sprite||(n.level=e.level,e.display.setSpineScale(.5*ii,.5*ii),t.spineUnits.push(e),t.spineContainer.add(n)))}}))},n.removeSpine=function(e){var t,n=e.getSpineDisplay();n&&(this.spineUnits=wn()(t=this.spineUnits).call(t,(function(t){return t!==e})),this.spineContainer.remove(n,!1))},n.bringToTopOnDrag=function(e){var t=e.getSpineDisplay();t&&this.spineContainer.bringToTop(t)},n.hideAllSpines=function(){this.spineContainer.setActive(!1),this.spineContainer.setVisible(!1)},n.showAllSpines=function(){this.spineContainer.setActive(!0),this.spineContainer.setVisible(!0)},t}(w),si=ai,ri=n(482),oi=n(481),ci=n(130),li=n(480),ui=n(162),hi=function(){function e(e){this.scene=void 0,this.currentState=void 0,this.scene=e}var t=e.prototype;return t.init=function(){this.currentState||(this.currentState=new ci.Z(this.scene)),this.currentState.levelLoading()},t.changeStateTo=function(e){this.currentState=e},t.isInReadyState=function(){return this.currentState instanceof ui.Z},t.isInPlayingState=function(){return this.currentState instanceof li.Z},t.isInLevelLoadingState=function(){return this.currentState instanceof ci.Z},t.isInLevelFailState=function(){return this.currentState instanceof oi.Z},t.isInLevelCompleteState=function(){return this.currentState instanceof ri.Z},t.ready=function(){this.currentState.ready()},t.play=function(){this.currentState.play()},t.levelFail=function(){this.currentState.levelFail()},t.levelComplete=function(){this.currentState.levelComplete()},t.levelLoading=function(){this.currentState.levelLoading()},t.quit=function(){this.currentState.quit()},t.update=function(){this.currentState.update()},e}(),di=hi,pi=n(241),fi=n.n(pi),gi=n(206),Ei=n.n(gi),mi=n(67),vi=n(467),Ai=n(38),Si=function(e){function t(t,n,i,a,s,r){var o;return(o=e.call(this,t)||this).scene=void 0,o.id=void 0,o.isActive=void 0,o.isDisabled=void 0,o.zone=void 0,o.icon=void 0,o.parentName=void 0,o.activeItem=function(){!0!==o.isActive&&(!0!==o.isDisabled&&(o.isActive=!0,o.icon.setTint(2927998),o.scene.powerManager.isStopped()||(o.scene.audio.playSound(fn.Z.BUTTON_CLICK),o.activeLogic())))},o.deactivateItem=function(){!1!==o.isActive&&(o.isActive=!1,o.icon.setTint(3487029),o.scene.powerManager.isStopped()||o.deactivateLogic())},o.handleOnClick=function(){o.logItemEvent(),o.scene.powerManager.activeItem(o.id)},o.id=n,o.scene=t,o.createIcon(i,a,s,r),o.setSize(s,r),o.createInput(),o.setDepth(d.Z.ITEM),o.scene.add.existing((0,u.Z)(o)),o}(0,a.Z)(t,e);var n=t.prototype;return n.enableItem=function(){!1!==this.isDisabled&&(this.icon.setAlpha(1),this.isDisabled=!1)},n.disableItem=function(){!0!==this.isDisabled&&(this.deactivateItem(),this.icon.setAlpha(.4),this.isDisabled=!0)},n.createIcon=function(e,t,n,i){this.icon=this.scene.make.image({key:e,frame:t},!1),this.icon.setWorldSize(n,i),this.add(this.icon)},n.createInput=function(){var e=this.icon,t=e.displayWidth,n=e.displayHeight;this.zone=this.scene.make.zone({width:t,height:n}),this.add(this.zone),Phaser.Display.Align.In.Center(this.zone,this.icon),this.zone.setInteractive({useHandCursor:!0}),this.zone.on(Phaser.Input.Events.GAMEOBJECT_POINTER_UP,this.handleOnClick)},n.logItemEvent=function(){var e=this.getParentName(),t=this.name;this.scene.analytics.event(Ai._.BUTTON_CLICK,{button_name:t,screen_name:e}),this.scene.game.analytics.event(Ai._.USE_ITEM,{active:!this.isActive,item_name:this.id})},n.getParentName=function(){if(this.parentName)return this.parentName;for(var e=this.parentContainer;e;){if(e instanceof GameCore.Screen){var t=e;return this.parentName=t.getScreenName(),this.parentName}e=e.parentContainer}return this.parentName=this.scene.getSceneName(),this.parentName},t}(Phaser.GameObjects.Container),Ti=Si,yi=h.Z.GAMEPLAY,Ci=yi.KEY,Ii=yi.FRAME,Ri=Xn.SPEED_UP.ID,wi=function(e){function t(t){var n;return(n=e.call(this,t,Ri,Ci,Ii.DASHBOARD_SPEED_BTN_OFF,34,38.5)||this).scene=void 0,n.isSpeedUp=void 0,n.speedText=void 0,n.glowSpinTween=void 0,n.whiteGlow=void 0,n.activeItem=function(){!0!==n.isActive&&(!0!==n.isDisabled&&(n.isActive=!0,n.scene.powerManager.isStopped()||(n.scene.audio.playSound(fn.Z.BUTTON_CLICK),n.activeLogic())))},n.deactivateItem=function(){!1!==n.isActive&&(n.isActive=!1,n.scene.powerManager.isStopped()||n.deactivateLogic())},n.scene=t,n.isSpeedUp=!1,n.setName("SpeedUpItem"),n.createSpeedText(),n}(0,a.Z)(t,e);var n=t.prototype;return n.enableItem=function(){!1!==this.isDisabled&&(this.isDisabled=!1,this.zone.setInteractive())},n.activeLogic=function(){var e=this.scene.stateManager;(e.isInPlayingState()||e.isInReadyState())&&(this.isSpeedUp?this.returnToNormalSpeed():this.speedUpGameplay())},n.disableItem=function(){!0!==this.isDisabled&&(this.zone.disableInteractive(),this.isDisabled=!0)},n.deactivateLogic=function(){},n.speedUpGameplay=function(){this.icon.setTexture(Ci,Ii.DASHBOARD_SPEED_BTN_ON),this.isSpeedUp=!0,this.scene.player.setSetting("speedUp",!0),this.scene.stateManager.isInPlayingState()&&this.scene.unitManager.speedUpAllUnits()},n.returnToNormalSpeed=function(){this.icon.setTexture(Ci,Ii.DASHBOARD_SPEED_BTN_OFF),this.isSpeedUp=!1,this.scene.player.setSetting("speedUp",!1),this.scene.stateManager.isInPlayingState()&&this.scene.unitManager.resetSpeedAllUnits()},n.createSpeedText=function(){var e=this.scene.lang.getCurrentLanguage(),t=10;if(!this.scene.world.isLandscape())switch(e){case"ru":case"ja":t=7;break;case"pt":case"es":case"it":t=9}this.speedText=this.scene.make.bitmapText({font:pn.Z.PRIMARY.KEY,size:this.scene.fontSize(t),origin:{x:.5,y:1},text:this.scene.lang.Text.SPEED}),this.add(this.speedText),this.bringToTop(this.speedText);var n=this.scene.world.isLandscape()?12:-5;Phaser.Display.Align.In.BottomCenter(this.speedText,this.icon,0,n)},n.logItemEvent=function(){var e=this.getParentName(),t=this.name;this.scene.analytics.event(Ai._.BUTTON_CLICK,{button_name:t,screen_name:e}),this.scene.game.analytics.event(Ai._.USE_ITEM,{value:this.isSpeedUp?"off":"on",item_name:this.id})},t}(Ti),_i=wi,bi=GameCore.Configs.Gameplay,Li=bi.MaximumMeleeLevel,Pi=bi.MaximumRangedLevel,Oi=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.hideUIAnimation=void 0,n.updateUIData=function(){n.updateCoinBar(),n.updateUnitBarUI(),n.updateTotalHpBar()},n.updateWhenReceivedCoin=function(e){var t=n.scene,i=t.tutorialManager;t.layoutManager.objects.coinBar.setCoins(e),i.isRunning()?i.reupdateGuideUI():n.updateUnitBarUI()},n.startFight=function(){if(!n.hideUIAnimation){var e,t=n.scene.layoutManager.objects,i=n.getAllPowerItems(),a=c()(e=[]).call(e,i,[t.unitBar,t.levelBar,t.startButton,t.showUnitButton,t.battleLevelBar,t.leaderboardButton]),s=fi()(i).call(i,(function(e){return e instanceof _i}));-1!==s&&Ei()(a).call(a,s,1),n.hideUIAnimation=new mi.Z({targets:a,duration:300,onActive:function(){n.scene.input.enabled=!1},ease:Phaser.Math.Easing.Circular.Out,onComplete:function(){a.forEach((function(e){return e.setAlpha(1)})),i.forEach((function(e){e instanceof _i||e.disableItem()})),n.scene.startRound(),n.scene.input.enabled=!0}})}n.hideUIAnimation.play()},n.scene=t,n.initUILogic(),n}(0,a.Z)(t,e);var n=t.prototype;return n.start=function(){this.isRunning()||(e.prototype.start.call(this),this.updateUIData())},n.initUILogic=function(){var e=this.scene,t=e.layoutManager,n=e.screenManager,i=e.devToolManager,a=t.objects;a.startButton.onClick=this.startFight,a.showUnitButton.onClick=n.showUnitsScreen,a.settingsButton.onClick=n.showSettingsScreen,a.leaderboardButton.onClick=n.showLeaderboardScreen,GameCore.Utils.Valid.isDebugger()&&(a.resetLevelButton.onClick=this.scene.resetLevel,a.selectLevelButton.onClick=i.handleShowLoadMapInput,a.currentUnitModButton.onClick=i.handleShowModUnitInput,a.currentAttackModButton.onClick=i.handleShowModAttackInput),this.scene.coin.events.on(vi.Z.RECEIVED,this.updateWhenReceivedCoin)},n.updateCoinBar=function(){var e=this.scene,t=e.coin,n=e.layoutManager.objects,i=t.getCurrentCoins();i instanceof Vt.Z&&n.coinBar.setCoins(i)},n.updateUnitBarUI=function(){var e=this.scene,t=e.coin,n=e.unitManager,i=e.coinManager,a=e.layoutManager,s=t.getCurrentCoins();if(s instanceof Vt.Z){var r=a.objects,o=n.getPlayerMeleeSpawnedUnitsCount(),c=i.getUnitPrice(o);r.unitBar.setMeleePrice(c);var l=s.toString(),u=c.toString();r.unitBar.enableMeleeBlock();var h=c.biggerThan(s)&&l!==u;r.unitBar.setMeleeAdsMode(h);var d=n.getPlayerRangedSpawnedUnitsCount(),p=i.getUnitPrice(d);r.unitBar.setRangedPrice(p);var f=p.toString();r.unitBar.enableRangedBlock();var g=p.biggerThan(s)&&l!==f;r.unitBar.setRangedAdsMode(g),this.handleLastSquareCase()}},n.handleLastSquareCase=function(){var e=this.scene,t=e.fieldManager,n=e.unitManager,i=e.layoutManager;if(1===t.getRemainingAvailablePlacement()){var a=i.objects,s=n.getLowestLevelPlayerMeleeUnit(),r=n.getLowestLevelPlayerRangedUnit();s===Li&&r!==Pi&&a.unitBar.disableMeleeBlock(),r===Pi&&s!==Li&&a.unitBar.disableRangedBlock()}},n.updateTotalHpBar=function(){var e=this.scene.layoutManager.objects;e.totalHpBar.setAlpha(1),e.totalHpBar.updateCurrentHp()},n.setTotalHpBar=function(e,t){var n=this.scene.layoutManager.objects;t?n.totalHpBar.updatePlayerHpUIByMinus(e):n.totalHpBar.updateEnemyHpUIByMinus(e)},n.getCurrentEnemyHp=function(){return this.scene.layoutManager.objects.totalHpBar.getCurrentEnemyHp()},n.getCurrentPlayerHp=function(){return this.scene.layoutManager.objects.totalHpBar.getCurrentPlayerHp()},n.getAllPowerItems=function(){return this.scene.powerManager.getAllItems()},n.disableUnitBlocks=function(){this.scene.layoutManager.objects.unitBar.disableUnitBlocks()},n.disableAdsUnitBlocks=function(){this.scene.layoutManager.objects.unitBar.disableAdsForBlocks()},n.enableStartButton=function(){this.scene.layoutManager.objects.startButton.setDisabled(!1)},n.isStartButtonDisabled=function(){return this.scene.layoutManager.objects.startButton.isDisabled()},n.runUnitBtnAnim=function(){this.scene.layoutManager.objects.showUnitButton.runAnimation()},n.getUnitBtnPos=function(){var e=this.scene.layoutManager.objects;return new Phaser.Math.Vector2(e.showUnitButton.x,e.showUnitButton.y)},n.showUIForLevelLoadingState=function(){var e=this.scene.layoutManager.groups;e.allUI.killGroup(),e.levelLoadingStateUI.reviveGroup()},n.showUIForReadyState=function(){var e=this.scene,t=e.gameMode,n=e.gameZone,i=this.scene,a=i.levelManager,s=i.layoutManager,r=s.groups,o=s.objects;if(r.allUI.killGroup(),t===l.Z.NORMAL){var c=a.getCurrentLevelId();o.levelBar.setLevel(c),r.normalPlayingStateUI.killGroup(),r.normalReadyStateUI.reviveGroup()}if(t===l.Z.BATTLE){var u=this.scene.battle.getPlayerInfo(),h=this.scene.battle.getOpponentInfo();u&&h&&o.battleLevelBar.updateData(u,h),r.battlePlayingStateUI.killGroup(),r.battleReadyStateUI.reviveGroup(),o.startButton.setX(n.width/2)}this.updateUIData()},n.showUIForPlayingState=function(){var e=this.scene,t=e.gameMode,n=e.layoutManager.groups;t===l.Z.NORMAL&&(n.normalReadyStateUI.killGroup(),n.normalPlayingStateUI.reviveGroup()),t===l.Z.BATTLE&&(n.battleReadyStateUI.killGroup(),n.battlePlayingStateUI.reviveGroup()),this.scene.tutorialManager.isRunning()&&this.scene.layoutManager.objects.speedUpItem.kill(),this.updateUIData()},n.showUIForGuide1=function(){var e=this.scene.layoutManager,t=e.groups,n=e.objects;t.allUI.killGroup(),t.guideStateUI.reviveGroup(),n.unitBar.kill()},n.showUIForGuide2=function(e){var t=this.scene.layoutManager,n=t.groups,i=t.objects;i.unitBar.killBg(),1===e?(n.allUI.killGroup(),n.guideStateUI.reviveGroup(),i.startButton.kill(),this.updateCoinBar(),this.updateUnitBarUI(),i.unitBar.killMeleeBlock(),i.unitBar.setDepth(d.Z.TUTORIAL_OBJECT)):2===e?(i.unitBar.reviveMeleeBlock(),i.unitBar.kill(),i.unitBar.setDepth(d.Z.BUTTON)):3===e&&(n.allUI.killGroup(),n.guideStateUI.reviveGroup(),i.unitBar.kill(),i.startButton.revive())},n.showUIForGuidePrevent=function(){var e=this.scene.layoutManager,t=e.groups,n=e.objects;t.allUI.killGroup(),t.guideStateUI.reviveGroup(),n.unitBar.kill()},n.showUIForGuide3=function(e){var t=this.scene.layoutManager,n=t.groups,i=t.objects;if(i.unitBar.killBg(),1===e)this.scene.accessibilityManager.stop(),n.allUI.killGroup(),n.guideStateUI.reviveGroup(),i.startButton.kill(),this.updateCoinBar(),this.updateUnitBarUI(),i.unitBar.killRangedBlock(),i.unitBar.setDepth(d.Z.TUTORIAL_OBJECT);else if(2===e){this.scene.accessibilityManager.stop(),n.allUI.killGroup(),n.guideStateUI.reviveGroup(),i.startButton.kill(),i.showUnitButton.revive(),i.unitBar.reviveRangedBlock(),i.unitBar.kill(),i.unitBar.setDepth(d.Z.BUTTON)}else 3===e&&(n.allUI.killGroup(),n.guideStateUI.reviveGroup(),i.unitBar.kill(),i.startButton.revive(),i.showUnitButton.revive())},n.addOnceCallbackForMeleeBlock=function(e){this.scene.layoutManager.objects.unitBar.addOnceClickEventForMeleeBlock(e)},n.addOnceCallbackForRangedBlock=function(e){this.scene.layoutManager.objects.unitBar.addOnceClickEventForRangedBlock(e)},n.addOnceCallbackForStartBtn=function(e){this.scene.layoutManager.objects.startButton.setOnceCallback(e)},n.getMeleeBlockWorldPosition=function(){var e=this.getMeleeBlockConfig();return{x:e.worldX,y:e.worldY}},n.getRangedBlockWorldPosition=function(){var e=this.getRangedBlockConfig();return{x:e.worldX,y:e.worldY}},n.getMeleeBlockConfig=function(){return this.scene.layoutManager.objects.unitBar.getMeleeBlockConfig()},n.getRangedBlockConfig=function(){return this.scene.layoutManager.objects.unitBar.getRangedBlockConfig()},n.getStartBtnWorldPosition=function(){return this.scene.layoutManager.objects.startButton.getWorldPosition()},t}(w),Di=Oi,ki=n(239),Ni=n.n(ki),Bi=n(69),Mi=n.n(Bi),xi=n(101),Ui=n.n(xi),Fi=n(227),Zi=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="NoUnitFound",i.message=t||"No Unit Found",i.payload=n,i}return(0,a.Z)(t,e),t}((0,Fi.Z)(Error)),Gi=n(86),Hi=n(636),Yi=n(637),Ki=n(161),Vi=C.STATUS,Wi=Wt.Z.MELEE_UNIT_TYPE,ji=Wt.Z.RANGED_UNIT_TYPE,zi=Wt.Z.ALIEN_UNIT_TYPE,Xi=GameCore.Configs.Gameplay,qi=Xi.MaximumMeleeLevel,Qi=Xi.MaximumRangedLevel,Ji=Dn.Z.MELEE_UNLOCKED,$i=Dn.Z.RANGED_UNLOCKED,ea=Dn.Z.PLAYER_UNIT_DATA,ta=GameCore.Configs.Gameplay.Powers.SpeedUp.modifier,na=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.meleeSpawnPool=void 0,n.rangedSpawnPool=void 0,n.playerUnits=void 0,n.enemyUnits=void 0,n.rangedProjectiles=void 0,n.latestUnitMergePayload=void 0,n.scene=t,n.createFactories(),n.createUnitGroups(),n}(0,a.Z)(t,e);var n=t.prototype;return n.init=function(){e.prototype.init.call(this),this.initSpawnPools(),this.emptyEnemyUnits(),this.emptyPlayerUnits(),this.emptyProjectiles()},n.start=function(){this.isRunning()||(this.createEnemyUnits(),this.createPlayerUnitsNormal(),this.calculatePlayerTotalUnitsUsed(),this.setState(Vi.RUNNING))},n.stop=function(){this.isRunning()&&(this.stopDieEffectOfAllUnits(),this.setReadyAllUnits(),this.removeAttackEventsOfAllUnits(),this.hideAllUnits(),this.disableDragOnPlayerUnits(),this.runChildUpdateGroups(!1),this.setState(Vi.STOPPED))},n.createFactories=function(){this.meleeSpawnPool=new Hi.Z(this.scene),this.rangedSpawnPool=new Yi.Z(this.scene)},n.createUnitGroups=function(){this.enemyUnits=this.scene.add.group(),this.playerUnits=this.scene.add.group(),this.rangedProjectiles=this.scene.add.group()},n.runChildUpdateGroups=function(e){this.enemyUnits.runChildUpdate=e,this.playerUnits.runChildUpdate=e,this.rangedProjectiles.runChildUpdate=e},n.initSpawnPools=function(){this.meleeSpawnPool.init(),this.rangedSpawnPool.init()},n.emptyEnemyUnits=function(){var e=this;this.enemyUnits.getChildren().forEach((function(t){if(t instanceof Ki.Z){t.handleRemoveFromScene();var n=t.unitType;n===Wi&&e.meleeSpawnPool.returnToPool(t),n===ji&&e.rangedSpawnPool.returnToPool(t)}})),this.enemyUnits.clear(!0,!1)},n.emptyPlayerUnits=function(){var e=this;this.playerUnits.getChildren().forEach((function(t){if(t instanceof Ki.Z){t.handleRemoveFromScene();var n=t.unitType;n===Wi&&e.meleeSpawnPool.returnToPool(t),n===ji&&e.rangedSpawnPool.returnToPool(t)}})),this.playerUnits.clear(!0,!1)},n.emptyProjectiles=function(){this.rangedProjectiles.clear(!0,!0)},n.getPlayerUnits=function(){return this.playerUnits.getChildren()},n.getEnemyUnits=function(){return this.enemyUnits.getChildren()},n.getTotalPlayerUnitsHp=function(){var e=0;return this.playerUnits.getChildren().forEach((function(t){t instanceof Ki.Z&&(e+=t.currentHp)})),e},n.getTotalEnemyUnitsHp=function(){var e=0;return this.enemyUnits.getChildren().forEach((function(t){t instanceof Ki.Z&&(e+=t.currentHp)})),e},n.getPlayerMeleeSpawnedUnitsCount=function(){return this.meleeSpawnPool.getPlayerSpawnedUnitsCount()},n.getPlayerRangedSpawnedUnitsCount=function(){return this.rangedSpawnPool.getPlayerSpawnedUnitsCount()},n.createPlayerArcher=function(e,t,n){if(void 0===n&&(n=1),this.isRunning()){var i=this.scene,a=i.fieldManager,s=i.spineManager,r=1===a.getRemainingAvailablePlacement(),o=this.checkIfBoardCanBeMerged(),c=this.getLowestLevelPlayerRangedUnit(),l=r&&!o&&c>n?c:n,u=this.createUnit({level:l,isPlayer:!0,unitType:ji});u.spawnUnitOnSquare(e,t,!0),s.addSpines([u]),this.resetAttackSpots(u),this.playerUnits.add(u)}},n.createPlayerMelee=function(e,t,n){if(void 0===n&&(n=1),this.isRunning()){var i=this.scene,a=i.fieldManager,s=i.spineManager,r=1===a.getRemainingAvailablePlacement(),o=this.checkIfBoardCanBeMerged(),c=this.getLowestLevelPlayerMeleeUnit(),l=r&&!o&&c>n?c:n,u=this.createUnit({level:l,isPlayer:!0,unitType:Wi});u.spawnUnitOnSquare(e,t,!0),s.addSpines([u]),this.resetAttackSpots(u),this.playerUnits.add(u)}},n.createEnemyUnits=function(){var e=this;this.scene.levelManager.enemyData.forEach((function(t){var n=e.createUnit({level:t.level,isPlayer:!1,unitType:"melee"===t.type?Wi:ji});n.spawnUnitOnSquare(t.positionRow,t.positionColumn,!1),n.actions.prepare(),e.resetAttackSpots(n),e.enemyUnits.add(n)}))},n.createPlayerUnitsNormal=function(){0===this.playerUnits.getLength()?this.loadPlayerUnits():this.reusePlayerUnits();var e=this.scene.uiManager;this.playerUnits.getLength()>0&&e.enableStartButton()},n.createPlayerUnitsLevelBuilder=function(){var e=this;this.scene.levelManager.playerData.forEach((function(t){var n=e.createUnit({level:t.level,isPlayer:!0,unitType:"melee"===t.type?Wi:ji});n.spawnUnitOnSquare(t.positionRow,t.positionColumn,!0),e.resetAttackSpots(n),e.playerUnits.add(n)}))},n.stopDieEffectOfAllUnits=function(){this.enemyUnits.getChildren().forEach((function(e){e instanceof Ki.Z&&e.effectController.stopDieEffect()})),this.playerUnits.getChildren().forEach((function(e){e instanceof Ki.Z&&e.effectController.stopDieEffect()}))},n.setReadyAllUnits=function(){var e=this.playerUnits.getChildren();ni()(e).call(e,(function(e,t){if(!(e instanceof Ki.Z)||!(t instanceof Ki.Z))throw new Zi;var n=e.currentLocation,i=n.rowId,a=n.colId,s=t.currentLocation,r=s.rowId,o=s.colId;return i===r?a-o:i-r})),e.forEach((function(e){if(!(e instanceof Ki.Z))throw new Zi;e.isDepthDirty=!0,e.actions.ready()}));var t=this.enemyUnits.getChildren();ni()(t).call(t,(function(e,t){if(!(e instanceof Ki.Z)||!(t instanceof Ki.Z))throw new Zi;var n=e.currentLocation,i=n.rowId,a=n.colId,s=t.currentLocation,r=s.rowId,o=s.colId;return i===r?a-o:r-i})),t.forEach((function(e){if(!(e instanceof Ki.Z))throw new Zi;e.isDepthDirty=!0,e.actions.ready()}))},n.removeAttackEventsOfAllUnits=function(){this.enemyUnits.getChildren().forEach((function(e){var t;e instanceof Ki.Z&&(null==(t=e.attackEvent)||t.remove())})),this.playerUnits.getChildren().forEach((function(e){var t;e instanceof Ki.Z&&(null==(t=e.attackEvent)||t.remove())}))},n.getUnitBasedOnPosition=function(e,t){var n=null;return this.playerUnits.getChildren().forEach((function(i){if(!(i instanceof Ki.Z))throw new Zi;i.currentLocation.rowId===e&&i.currentLocation.colId===t&&(n=i)})),n},n.mergeUnits=function(e,t){var n=this.scene.effectManger,i=e.level+1,a=e.unitType,s=t.currentLocation;if(i>(a===Wi?qi:Qi))return!1;var r=this.createUnit({level:i,unitType:a,isPlayer:!0,isMerged:!0});if(!r)return this.scene.rollbar.sendException(new Error("newUnit is null")),!1;n.playMergeEffect(t),(0,Gi.ZP)(50),e.handleRemoveFromScene(),t.handleRemoveFromScene(),a===Wi&&(this.meleeSpawnPool.returnToPool(e),this.meleeSpawnPool.returnToPool(t),this.playerUnits.remove(e,!0,!1),this.playerUnits.remove(t,!0,!1)),a===ji&&(this.rangedSpawnPool.returnToPool(e),this.rangedSpawnPool.returnToPool(t),this.playerUnits.remove(e,!0,!1),this.playerUnits.remove(t,!0,!1)),this.latestUnitMergePayload={type:a,level:i},r.spawnUnitOnSquare(s.rowId,s.colId,!0),this.playerUnits.add(r),this.resetAttackSpots(r);var o=this.scene,c=o.uiManager,l=o.screenManager;return o.spineManager.addSpines([r]),c.updateUIData(),this.savePlayerUnits(),this.checkIfNewUnitIsUnlocked(i,a)&&(this.disableDragOnPlayerUnits(),this.scene.time.delayedCall(400,l.showUnitUnlockScreen)),!0},n.checkIfNewUnitIsUnlocked=function(e,t){if(t===Wt.Z.MELEE_UNIT_TYPE){var n=Ji,i=this.scene.player.getCustomData(n);if(!i||"number"!==typeof i)return this.scene.player.setCustomData(n,e),!0;if(e>i)return this.scene.player.setCustomData(n,e),!0}if(t===Wt.Z.RANGED_UNIT_TYPE){var a=$i,s=this.scene.player.getCustomData(a);if(!s||"number"!==typeof s)return this.scene.player.setCustomData(a,e),!0;if(e>s)return this.scene.player.setCustomData(a,e),!0}return!1},n.reusePlayerUnits=function(){var e=this;this.playerUnits.getChildren().forEach((function(t){if(!(t instanceof Ki.Z))throw new Zi;t.reuseUnitOnReady(),e.resetAttackSpots(t)}))},n.loadPlayerUnits=function(){var e=this,t=this.scene.player.getCustomData(ea);(console.log(t),t&&"string"===typeof t)&&t.split("/").forEach((function(t,n){t.split("-").forEach((function(t,i){if("0"!==t){var a=zi;if("m"===t[0]?a=Wi:"r"===t[0]&&(a=ji),a!==zi){var s=e.createUnit({level:parseInt(t.substring(1)),isPlayer:!0,unitType:"m"===t[0]?Wi:ji});s.spawnUnitOnSquare(n+1,i+1,!0),e.resetAttackSpots(s),e.playerUnits.add(s)}}}))}))},n.checkIfBoardCanBeMerged=function(){var e=this.playerUnits.getChildren(),t=new(Ni()),n=new(Ni());e.forEach((function(e){if(e instanceof Ki.Z){var i=e.level;switch(e.unitType){case Wi:var a=t.get(i);a?t.set(i,a+1):t.set(i,1);break;case ji:var s=n.get(i);s?n.set(i,s+1):n.set(i,1)}}}));var i=Mi()(t,(function(e){return{key:e[0],value:e[1]}})).some((function(e){var t=e.key;return e.value>1&&t+1<=qi})),a=Mi()(n,(function(e){return{key:e[0],value:e[1]}})).some((function(e){var t=e.key;return e.value>1&&t+1<=Qi}));return i||a},n.createUnit=function(e){var t=e.id,n=e.level,i=e.unitType,a=e.isPlayer,s=e.isMerged;t||n||this.scene.rollbar.sendException(new Error("Unit id and level is not defined"));var r=this.scene.fieldManager.fieldBackground.scale*this.scene.world.getPixelRatio();switch(i){case Wt.Z.MELEE_UNIT_TYPE:if(t){var o=this.meleeSpawnPool.requestUnitById(t,a,s);return o.setScale(r),o}if(n){var c=this.meleeSpawnPool.requestUnitByLevel(n,a,s);return c.setScale(r),c}return this.meleeSpawnPool.requestUnitByLevel(-1,a,s);case Wt.Z.RANGED_UNIT_TYPE:if(t){var l=this.rangedSpawnPool.requestUnitById(t,a,s);return l.setScale(r),l}if(n){var u=this.rangedSpawnPool.requestUnitByLevel(n,a,s);return u.setScale(r),u}return this.rangedSpawnPool.requestUnitByLevel(-1,a,s);default:return this.meleeSpawnPool.requestUnitByLevel(-1,a,s)}},n.preparePlayerUnits=function(){this.playerUnits.getChildren().forEach((function(e){if(!(e instanceof Ki.Z))throw new Zi;e.actions.prepare()}))},n.enableDragOnPlayerUnits=function(){this.playerUnits.getChildren().forEach((function(e){e instanceof Ki.Z&&e.startEventListener()}))},n.disableDragOnPlayerUnits=function(){this.playerUnits.getChildren().forEach((function(e){e instanceof Ki.Z&&e.removeEventListener()}))},n.serializePlayerUnitData=function(){var e=this.playerUnits.getChildren();ni()(e).call(e,(function(e,t){if(!(e instanceof Ki.Z)||!(t instanceof Ki.Z))throw new Zi;var n=e.currentLocation,i=n.rowId,a=n.colId,s=t.currentLocation,r=s.rowId,o=s.colId;return i===r?a-o:i-r}));for(var t="",n=0,i=0;i<3;i++){for(var a="",s=0;s<5;s++){var r=n>=e.length?null:e[n];if(r instanceof Ki.Z){var o=r.currentLocation,c=o.rowId,l=o.colId;if(c===i+1&&l===s+1)a+=this.createUnitDataForSaving(r),n++;else a+="0"}else a+="0";4!==s&&(a+="-")}t+=a,2!==i&&(t+="/")}return t},n.createUnitDataForSaving=function(e){if(!e)return"0";var t=e.unitType,n=e.level;return""+(t===Wi?"m":"r")+n},n.savePlayerUnits=function(){this.scene.levelManager.isInLevelBuilderLevel()||this.scene.updateUnitData()},n.calculatePlayerTotalUnitsUsed=function(){var e=this.playerUnits.getChildren(),t=0,n=0;e.forEach((function(e){if(!(e instanceof Ki.Z))throw new Zi;if(e.unitType===Wi){var i=Math.pow(2,e.level-1);t+=i}if(e.unitType===ji){var a=Math.pow(2,e.level-1);n+=a}})),this.meleeSpawnPool.setSpawnedUnits(t),this.rangedSpawnPool.setSpawnedUnits(n)},n.getLowestLevelPlayerMeleeUnit=function(){var e=this.playerUnits.getChildren(),t=wn()(e).call(e,(function(e){if(!(e instanceof Ki.Z))throw new Zi;return e.unitType===Wi}));return 0===t.length?1:Ui()(t).call(t,(function(e,t){if(!(t instanceof Ki.Z))throw new Zi;return e&&e instanceof Ki.Z?t.level<e.level?t:e:t})).level},n.getLowestLevelPlayerRangedUnit=function(){var e=this.playerUnits.getChildren(),t=wn()(e).call(e,(function(e){if(!(e instanceof Ki.Z))throw new Zi;return e.unitType===ji}));return 0===t.length?1:Ui()(t).call(t,(function(e,t){if(!(t instanceof Ki.Z))throw new Zi;return e&&e instanceof Ki.Z?t.level<e.level?t:e:t})).level},n.getUnitDataForUnlockingScreen=function(){var e=this.latestUnitMergePayload,t=e.level;return e.type===Wt.Z.MELEE_UNIT_TYPE?this.meleeSpawnPool.getUnitDataByLevel(t):this.rangedSpawnPool.getUnitDataByLevel(t)},n.resetAttackSpots=function(e){e.attackController.resetAttackSpots()},n.hideAllUnits=function(){this.enemyUnits.children.each((function(e){e instanceof Ki.Z&&(e.kill(),e.uiController.killHpBar())})),this.playerUnits.children.each((function(e){e instanceof Ki.Z&&(e.kill(),e.uiController.killHpBar())}))},n.hideAllProjectiles=function(){this.rangedProjectiles.killGroup()},n.showAllProjectiles=function(){this.rangedProjectiles.reviveGroup()},n.showAllAliveUnits=function(){this.enemyUnits.children.each((function(e){e instanceof Ki.Z&&(e.isKilled()||e.revive())})),this.playerUnits.children.each((function(e){e instanceof Ki.Z&&(e.isKilled()||e.revive())}))},n.showAllHpBarUnits=function(){this.enemyUnits.children.each((function(e){e instanceof Ki.Z&&(e.isKilled()||e.uiController.reviveHpBar())})),this.playerUnits.children.each((function(e){e instanceof Ki.Z&&(e.isKilled()||e.uiController.reviveHpBar())}))},n.getSameCoupleUnits=function(){for(var e=new(Ni()),t=this.playerUnits.getChildren(),n=0;n<t.length;n++){var i=t[n];if(!(i instanceof Ki.Z))throw new Zi;var a=i.level,s=i.unitType;if(!(s===Wt.Z.MELEE_UNIT_TYPE&&a>=qi)&&!(s===Wt.Z.RANGED_UNIT_TYPE&&a>=Qi)){var r=""+a+s,o=e.get(r);if(o)return{unit1:o,unit2:i};e.set(r,i)}}return null},n.getFirstMeleeUnit=function(){for(var e=this.playerUnits.getChildren(),t=0;t<e.length;t++){var n=e[t];if(!(n instanceof Ki.Z))throw new Zi;if(n.unitType===Wt.Z.MELEE_UNIT_TYPE)return n}return null},n.getFirstRangedUnit=function(){for(var e=this.playerUnits.getChildren(),t=0;t<e.length;t++){var n=e[t];if(!(n instanceof Ki.Z))throw new Zi;if(n.unitType===Wt.Z.RANGED_UNIT_TYPE)return n}return null},n.speedUpAllUnits=function(){this.scene.powerManager.isSpeedUp=!0,this.enemyUnits.children.each((function(e){e instanceof Ki.Z&&(e.display.setAnimationTimeScale(ta),e.modifyCurrentAttackEvent())})),this.playerUnits.children.each((function(e){e instanceof Ki.Z&&(e.display.setAnimationTimeScale(ta),e.modifyCurrentAttackEvent())}))},n.resetSpeedAllUnits=function(){this.scene.powerManager.isSpeedUp=!1,this.enemyUnits.children.each((function(e){e instanceof Ki.Z&&(e.display.setAnimationTimeScale(1),e.modifyCurrentAttackEvent())})),this.playerUnits.children.each((function(e){e instanceof Ki.Z&&(e.display.setAnimationTimeScale(1),e.modifyCurrentAttackEvent())}))},t}(w),ia=(n(47),n(487)),aa=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="NewScoreIsBad",i.message=t||"The new score is bad",i.payload=n,i}return(0,a.Z)(t,e),t}((0,Fi.Z)(Error)),sa=n(157),ra=n(466),oa=function(e,t){return function(n){try{var i=window.game.player,a=i.getPlayerId();(0,ia.aV)(a,e,t).catch((function(e){console.warn("setScoreAsync",e)}));var s=i.getPlayerData(),r=s.score,o=void 0===r?0:r,c=s.level;o<e&&i.setBestScore(e);var l={score:e,level:c};n(function(e,t){return{type:ra.HV,payload:{playerId:e,stats:t}}}(a,l)),n(function(e){return{type:ra.DP,payload:{stats:e}}}(l))}catch(u){if(u instanceof aa)return;(0,sa.tO)(u)}}},ca=n(228),la=n(492),ua="GuideOne",ha="GuideTwo",da="GuidePrevent",pa="GuideThree",fa=function(){function e(e){var t=this;this.manager=void 0,this.startGuide=function(){var e=t.manager.scene.uiManager;t.manager.scene.time.delayedCall(500,(function(){t.manager.scene.analytics.event(Ai._.TUTORIAL_STEP,{step:1})})),e.showUIForGuide1();var n=e.getStartBtnWorldPosition();t.showTapHand(n.x,n.y),e.addOnceCallbackForStartBtn(t.closeTutorial)},this.closeTutorial=function(){t.manager.stopTutorial()},this.manager=e}var t=e.prototype;return t.setup=function(){this.startGuide()},t.showTapHand=function(e,t){var n=this.manager.tapHand;n.setDepth(d.Z.ON_TOP),n.setPosition(e+n.width/2,t+n.height/2),n.revive(),n.stopAnimation(),n.playAnimation(300)},e}(),ga=fa,Ea=function(){function e(e){var t=this;this.manager=void 0,this.currentStep=void 0,this.targetUnit1=void 0,this.targetUnit2=void 0,this.wrongUnit=void 0,this.startGuide=function(){var e=t.manager.scene,n=e.uiManager,i=e.unitManager.getPlayerUnits(),a=i.length,s=!1;if(i.forEach((function(e){2===e.level&&(s=!0)})),2===a&&s)t.showStep3();else if(a>=3)t.handleOnClick();else{t.currentStep=1,t.manager.scene.giveEnoughCoins("MELEE"),n.showUIForGuide3(1);var r=n.getMeleeBlockConfig();t.createHighlightItem(r),t.showTapHand(r.worldX,r.worldY),t.manager.scene.analytics.event(Ai._.TUTORIAL_STEP,{step:6}),n.addOnceCallbackForMeleeBlock(t.handleOnClick),t.manager.scene.input.setTopOnly(!0)}},this.handleOnClick=function(){var e=t.manager.scene,n=e.uiManager,i=e.unitManager;t.currentStep=2,t.manager.scene.input.setTopOnly(!1),t.manager.background.kill(),t.manager.scene.game.globalScene.requestBackgroundMaskUpdate("TutorialManager",0),n.showUIForGuide3(2),t.manager.tapHand.stopAnimation(),t.manager.tapHand.kill(),t.manager.scene.analytics.event(Ai._.TUTORIAL_STEP,{step:7});var a=i.getSameCoupleUnits(),s=i.getFirstRangedUnit();a&&s?(t.targetUnit1=a.unit2,t.targetUnit2=a.unit1,t.wrongUnit=s,t.createHint()):t.showStep3()},this.handleOnDragEnd=function(){if(t.manager.hand.kill(),t.targetUnit1.removeOnceEvent(Phaser.Input.Events.GAMEOBJECT_DRAG_END,t.handleOnDragEnd),t.targetUnit2.removeOnceEvent(Phaser.Input.Events.GAMEOBJECT_DRAG_END,t.handleOnDragEnd),t.wrongUnit.removeOnceEvent(Phaser.Input.Events.GAMEOBJECT_DRAG_END,t.handleOnDragEnd),t.targetUnit1.isKilled()||t.targetUnit2.isKilled())return t.manager.scene.analytics.event(Ai._.TUTORIAL_STEP,{step:8}),void t.showStep3();t.createHint()},this.closeTutorial=function(){t.manager.scene.analytics.event(Ai._.TUTORIAL_STEP,{step:10}),t.manager.scene.time.delayedCall(500,(function(){t.manager.scene.analytics.event(Ai._.TUTORIAL_COMPLETE),t.manager.scene.player.incUserGuideDisplays()})),t.currentStep=0,t.manager.stopTutorial()},this.manager=e,this.currentStep=0}var t=e.prototype;return t.setup=function(){this.startGuide()},t.createHighlightItem=function(e){var t=e.worldX,n=e.worldY,i=e.width,a=e.height;this.manager.createMask(t-i/2-20,n-a/2-20,i+40,a+40)},t.createHint=function(){var e=this.targetUnit1.getWorldPosition(),t=e.x,n=e.y,i=this.targetUnit2.getWorldPosition(),a=i.x,s=i.y;this.createHandAt(t,n,a,s),this.createEvents()},t.createEvents=function(){this.targetUnit1.addOnceEvent(Phaser.Input.Events.GAMEOBJECT_DRAG_END,this.handleOnDragEnd),this.targetUnit2.addOnceEvent(Phaser.Input.Events.GAMEOBJECT_DRAG_END,this.handleOnDragEnd),this.wrongUnit.addOnceEvent(Phaser.Input.Events.GAMEOBJECT_DRAG_END,this.handleOnDragEnd)},t.createHandAt=function(e,t,n,i){this.manager.hand.setDepth(d.Z.ON_TOP),this.manager.hand.setPosition(e,t),this.manager.hand.revive(),this.manager.hand.setTarget(n,i),this.manager.hand.stopAnimation(),this.manager.hand.playAnimation(300)},t.showStep3=function(){var e=this.manager.scene.uiManager;this.currentStep=3,e.showUIForGuide3(3);var t=e.getStartBtnWorldPosition();this.showTapHand(t.x,t.y),this.manager.scene.analytics.event(Ai._.TUTORIAL_STEP,{step:9}),e.addOnceCallbackForStartBtn(this.closeTutorial)},t.showTapHand=function(e,t){var n=this.manager.tapHand;n.setDepth(d.Z.ON_TOP),n.setPosition(e+n.width/2,t+n.height/2),n.revive(),n.stopAnimation(),n.playAnimation(300)},t.reupdateUI=function(){var e=this.manager.scene.uiManager;0!==this.currentStep&&e.showUIForGuide3(this.currentStep)},e}(),ma=Ea,va=function(){function e(e){var t=this;this.manager=void 0,this.currentStep=void 0,this.guideUnit=void 0,this.targetSquare=void 0,this.startGuide=function(){var e=t.manager.scene,n=e.uiManager;if(2!==e.unitManager.getPlayerUnits().length){t.currentStep=1,t.manager.scene.giveEnoughCoins("RANGED"),n.showUIForGuide2(1);var i=n.getRangedBlockConfig();t.createHighlightItem(i),t.showTapHand(i.worldX,i.worldY),t.manager.scene.analytics.event(Ai._.TUTORIAL_STEP,{step:2}),n.addOnceCallbackForRangedBlock(t.handleOnClickRangedBlock),t.manager.scene.input.setTopOnly(!0)}else t.showStep3()},this.handleOnClickRangedBlock=function(){var e=t.manager.scene,n=e.uiManager,i=e.unitManager,a=e.fieldManager;t.currentStep=2,t.manager.scene.input.setTopOnly(!1),t.manager.background.kill(),t.manager.scene.game.globalScene.requestBackgroundMaskUpdate("TutorialManager",0),n.showUIForGuide2(2),t.manager.tapHand.stopAnimation(),t.manager.tapHand.kill(),t.manager.scene.analytics.event(Ai._.TUTORIAL_STEP,{step:3});var s=i.getFirstMeleeUnit(),r=a.getSquareBasedOnIndex(1,3);if(!r||!s)throw new Error("Guide fail due to target square or unit null");t.guideUnit=s,t.targetSquare=r,t.guideUnit.currentLocation!==t.targetSquare?t.createHint():t.showStep3()},this.handleOnDragEnd=function(){var e=t.manager.scene.unitManager;t.manager.hand.kill(),e.getPlayerUnits().forEach((function(e){e.removeOnceEvent(Phaser.Input.Events.GAMEOBJECT_DRAG_END,t.handleOnDragEnd)}));var n=t.guideUnit.getLastDragPos();n&&(n.y<268||n.y>458||n.x<29||n.x>346)&&t.guideUnit.dragUnitOnto(1,3),t.showStep3()},this.closeTutorial=function(){t.currentStep=0,t.manager.stopTutorial()},this.manager=e,this.currentStep=0}var t=e.prototype;return t.setup=function(){this.startGuide()},t.createHighlightItem=function(e){var t=e.worldX,n=e.worldY,i=e.width,a=e.height;this.manager.createMask(t-i/2-20,n-a/2-20,i+40,a+40)},t.showStep3=function(){var e=this.manager.scene.uiManager;this.currentStep=3,e.showUIForGuide2(3);var t=e.getStartBtnWorldPosition();this.showTapHand(t.x,t.y),this.manager.scene.analytics.event(Ai._.TUTORIAL_STEP,{step:4}),e.addOnceCallbackForStartBtn(this.closeTutorial)},t.createHint=function(){var e=this,t=this.manager.scene.unitManager,n=this.guideUnit.getWorldPosition(),i=n.x,a=n.y,s=this.targetSquare.getWorldPosition(),r=s.x,o=s.y;this.createHandAt(i,a,r,o),t.getPlayerUnits().forEach((function(t){t.addOnceEvent(Phaser.Input.Events.GAMEOBJECT_DRAG_END,e.handleOnDragEnd)}))},t.createHandAt=function(e,t,n,i){this.manager.hand.setDepth(d.Z.ON_TOP),this.manager.hand.setPosition(e,t),this.manager.hand.revive(),this.manager.hand.setTarget(n,i),this.manager.hand.stopAnimation(),this.manager.hand.playAnimation(300)},t.showTapHand=function(e,t){var n=this.manager.tapHand;n.setDepth(d.Z.ON_TOP),n.setPosition(e+n.width/2,t+n.height/2),n.revive(),n.stopAnimation(),n.playAnimation(300)},t.reupdateUI=function(){var e=this.manager.scene.uiManager;0!==this.currentStep&&e.showUIForGuide2(this.currentStep)},e}(),Aa=va,Sa=function(){function e(e){var t=this;this.manager=void 0,this.startGuide=function(){var e=t.manager.scene.uiManager;e.showUIForGuidePrevent();var n=e.getStartBtnWorldPosition();t.showTapHand(n.x,n.y),e.addOnceCallbackForStartBtn(t.closeTutorial)},this.closeTutorial=function(){t.manager.stopTutorial()},this.manager=e}var t=e.prototype;return t.setup=function(){this.startGuide()},t.showTapHand=function(e,t){var n=this.manager.tapHand;n.setDepth(d.Z.ON_TOP),n.setPosition(e+n.width/2,t+n.height/2),n.revive(),n.stopAnimation(),n.playAnimation(300)},t.reupdateUI=function(){this.manager.scene.uiManager.showUIForGuidePrevent()},e}(),Ta=Sa,ya=C.STATUS,Ca=GameCore.Configs.Tutorial,Ia=h.Z.DEFAULT,Ra=Ia.KEY,wa=Ia.FRAME,_a=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.tutorialId=void 0,n.lastTutorialId=void 0,n.tutorialsDisplayed=void 0,n.isAnalyticFirstSent=!0,n.hand=void 0,n.tapHand=void 0,n.background=void 0,n.maskGraphics=void 0,n.tutOne=void 0,n.tutTwo=void 0,n.tutPrevent=void 0,n.tutThree=void 0,n.startTutorial=function(e){if(!n.isRunning())return!1;if(n.isNothingToDisplay())return n.stop(),!1;if(n.hasDisplayedEnough(e))return!1;switch(n.background.kill(),n.scene.game.globalScene.requestBackgroundMaskUpdate("TutorialManager",0),e){case ua:n.tutOne=new ga((0,u.Z)(n)),n.tutOne.setup();break;case ha:n.tutTwo=new Aa((0,u.Z)(n)),n.tutTwo.setup();break;case da:n.tutPrevent=new Ta((0,u.Z)(n)),n.tutPrevent.setup();break;case pa:n.tutThree=new ma((0,u.Z)(n)),n.tutThree.setup();break;default:return!1}return!!n.isRunning()&&(n.tutorialId=e,n.lastTutorialId=e,n.tutorialsDisplayed.push(n.tutorialId),!0)},n.scene=t,n.createHand(),n.createTapHand(),n.createBackground(),n.initTutorialData(),n}(0,a.Z)(t,e);var n=t.prototype;return n.getLastTutorialId=function(){return this.lastTutorialId},n.initTutorialData=function(){this.tutorialId="",this.lastTutorialId="",this.tutorialsDisplayed=[]},n.init=function(){this.hand.kill(),this.tapHand.kill(),this.background.kill(),this.setState(ya.READY)},n.start=function(){this.isRunning()||(this.isNothingToDisplay()?this.scene.game.globalScene.requestBackgroundMaskUpdate("TutorialManager",0):this.setState(ya.RUNNING))},n.stop=function(){this.isRunning()&&(this.scene.tweens.killTweensOf([this.hand,this.tapHand,this.background]),this.scene.game.globalScene.requestBackgroundMaskUpdate("TutorialManager",0),this.setState(ya.STOPPED))},n.displayCount=function(e){var t;return wn()(t=this.tutorialsDisplayed).call(t,(function(t){return t===e})).length},n.hasDisplayedEnough=function(e){if(!Object.prototype.hasOwnProperty.call(Ca.NumberOfTutorial,e))return!0;var t=Ca.NumberOfTutorial[e];return!GameCore.Utils.Valid.isNumber(t)||-1!==t&&this.displayCount(e)>=t},n.isNothingToDisplay=function(){var e,t=this,n=this.scene.levelManager.getCurrentLevelId();return this.scene.gameMode===l.Z.BATTLE||(n>=3||wn()(e=In()(Ca.NumberOfTutorial)).call(e,(function(e){return!t.hasDisplayedEnough(e)})).length<1)},n.showTutorial=function(){if(this.isRunning()){this.isAnalyticFirstSent&&(this.scene.analytics.event(Ai._.TUTORIAL_BEGIN),this.isAnalyticFirstSent=!1);var e=this.scene.unitManager,t=this.scene.levelManager.getCurrentLevelId();if(1===t){if(1===e.getPlayerUnits().length&&!this.hasDisplayedEnough(ua))return void this.startTutorial(ua);if(!this.hasDisplayedEnough(ha))return void this.startTutorial(ha);this.startTutorial(da)}else 2===t&&this.startTutorial(pa)}},n.reupdateGuideUI=function(){""!==this.tutorialId&&(this.tutorialId===ha?this.tutTwo.reupdateUI():this.tutorialId===da?this.tutPrevent.reupdateUI():this.tutorialId===pa&&this.tutThree.reupdateUI())},n.stopTutorial=function(){this.tutorialId="",this.hand.kill(),this.tapHand.kill(),this.background.kill(),this.scene.game.globalScene.requestBackgroundMaskUpdate("TutorialManager",0)},n.createHand=function(){this.hand=new y(this.scene),this.hand.kill(),this.hand.setDepth(d.Z.PRIORITY)},n.createTapHand=function(){this.tapHand=new la.Z(this.scene),this.tapHand.kill(),this.tapHand.setDepth(d.Z.PRIORITY)},n.createBackground=function(){this.background=this.scene.make.image({key:Ra,frame:wa.BLANK}),this.background.setInteractive({}),this.scene.input.setTopOnly(!1),this.background.setTint(0),this.background.setAlpha(.8),this.scene.game.globalScene.requestBackgroundMaskUpdate("TutorialManager",.8),this.background.setDepth(d.Z.PRIORITY);var e=this.scene.gameZone,t=e.displayWidth+100,n=e.displayHeight+100;this.background.setDisplaySize(t,n),Phaser.Display.Align.In.Center(this.background,this.scene.gameZone)},n.createMask=function(e,t,n,i,a){var s;void 0===a&&(a=10),null==(s=this.maskGraphics)||s.destroy(),this.maskGraphics=this.scene.make.graphics({fillStyle:{color:16711680,alpha:1}}),this.maskGraphics.setName("MaskGraphics"),this.maskGraphics.fillRoundedRect(e,t,n,i,a),this.background.setActive(!0),this.background.setVisible(!0),this.background.clearMask(!0),this.background.setMask(this.maskGraphics.createGeometryMask()),this.background.mask.invertAlpha=!0,this.runShowMaskAnimation()},n.createMultiMask=function(e){var t,n=this;null==(t=this.maskGraphics)||t.destroy(),this.maskGraphics=this.scene.make.graphics({fillStyle:{color:16711680,alpha:1}}),this.maskGraphics.setName("MaskGraphics"),e.forEach((function(e){n.maskGraphics.fillRoundedRect(e.x,e.y,e.width,e.height,e.radius)})),this.background.setVisible(!0),this.background.setActive(!0),this.background.clearMask(!0),this.background.setMask(this.maskGraphics.createGeometryMask()),this.background.mask.invertAlpha=!0,this.runShowMaskAnimation()},n.runShowMaskAnimation=function(){var e=this,t=[this.background];this.background.setAlpha(0),this.scene.game.globalScene.requestBackgroundMaskUpdate("TutorialManager",0),this.scene.tweens.killTweensOf(t),this.scene.tweens.add({targets:t,duration:300,ease:Phaser.Math.Easing.Quadratic.Out,props:{alpha:{from:0,to:.8}},onUpdate:function(t,n){e.scene.game.globalScene.requestBackgroundMaskUpdate("TutorialManager",n.alpha)}})},t}(w),ba=n(474),La=n(469),Pa=n(127),Oa=n(230),Da=n(158),ka=n(156),Na=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.guideStateUI=void 0,n.battleReadyStateUI=void 0,n.normalReadyStateUI=void 0,n.levelLoadingStateUI=void 0,n.battlePlayingStateUI=void 0,n.normalPlayingStateUI=void 0,n.scene=t,n}(0,a.Z)(t,e);var n=t.prototype;return n.setUIObjects=function(t){e.prototype.setUIObjects.call(this,t),this.updateDepthGroups(),this.addUIObjectsToGroups()},n.alignUI=function(){this.alignMainUI(),this.alignItems(),this.alignDevTools()},n.alignMainUI=function(){if(null!==this.objects){var e=this.scene,t=e.gameZone,n=e.fieldManager,i=this.objects,a=i.coinBar,s=i.levelBar,r=i.battleLevelBar,o=i.showUnitButton,c=i.settingsButton,l=i.leaderboardButton,u=i.unitBar,h=i.totalHpBar,d=i.startButton;Phaser.Display.Align.In.TopRight(a,t,-60,-25),Phaser.Display.Align.In.TopCenter(s,t,0,-22),Phaser.Display.Align.In.TopCenter(r,t,10,-27),Phaser.Display.Align.In.TopLeft(o,t,-5,-45),Phaser.Display.Align.In.TopLeft(c,t,-5,-2),Phaser.Display.Align.In.TopLeft(l,t,-45,-2);var p=n.fieldBackground,f=p.y,g=p.displayHeight,E=p.scaleY,m=this.scene.world.getPixelRatio(),v=t.width/2;this.scene.world.isLandscape()||u.createStampsBanner(),u.reviveBg(),u.x=v,h.x=v,d.x=v;var A=f-g/2;h.y=A;if(u.y=A+255*E*m,u.isBgHigherBottom()){var S=u.getGapFromContainerCenterToBottomBg();u.y=this.scene.gameZone.displayHeight-S}d.y=u.y-72}},n.alignItems=function(){if(null!==this.objects){var e=this.scene.gameZone,t=this.objects,n=t.freeCoinsItem,i=t.speedUpItem,a=t.startButton;i.setScale(1.3),Phaser.Display.Align.In.TopRight(n,e,-15,-45),Phaser.Display.Align.In.RightCenter(i,a,80,0)}},n.alignDevTools=function(){if(null!==this.objects&&GameCore.Utils.Valid.isDebugger()){var e=this.scene.gameZone,t=this.objects,n=t.selectLevelButton,i=t.resetLevelButton,a=t.currentUnitModButton,s=t.currentAttackModButton;Phaser.Display.Align.In.BottomRight(n,e,0,-80),Phaser.Display.Align.In.BottomRight(i,e,-50,-80),Phaser.Display.Align.In.BottomLeft(a,e,0,-150),Phaser.Display.Align.In.BottomLeft(s,e,0,-100)}},n.createGroups=function(){e.prototype.createGroups.call(this),this.guideStateUI=this.scene.add.group(),this.battleReadyStateUI=this.scene.add.group(),this.normalReadyStateUI=this.scene.add.group(),this.levelLoadingStateUI=this.scene.add.group(),this.battlePlayingStateUI=this.scene.add.group(),this.normalPlayingStateUI=this.scene.add.group(),this.groups.guideStateUI=this.guideStateUI,this.groups.battleReadyStateUI=this.battleReadyStateUI,this.groups.normalReadyStateUI=this.normalReadyStateUI,this.groups.levelLoadingStateUI=this.levelLoadingStateUI,this.groups.battlePlayingStateUI=this.battlePlayingStateUI,this.groups.normalPlayingStateUI=this.normalPlayingStateUI},n.updateDepthGroups=function(){this.allUI.setDepth(d.Z.BUTTON),this.groups.guideStateUI.setDepth(d.Z.BUTTON),this.groups.levelLoadingStateUI.setDepth(d.Z.BUTTON),this.groups.normalReadyStateUI.setDepth(d.Z.BUTTON),this.groups.battleReadyStateUI.setDepth(d.Z.BUTTON),this.groups.normalPlayingStateUI.setDepth(d.Z.BUTTON),this.groups.battlePlayingStateUI.setDepth(d.Z.BUTTON)},n.addUIObjectsToGroups=function(){null!==this.objects&&(this.addObjectForGuideState(),this.addObjectsToLoadingState(),this.addObjectsForReadyState(),this.addObjectsForPlayingState())},n.addObjectForGuideState=function(){null!==this.objects&&this.groups.guideStateUI.addMultiple([this.objects.unitBar,this.objects.coinBar,this.objects.levelBar,this.objects.totalHpBar,this.objects.startButton,this.objects.settingsButton])},n.addObjectsToLoadingState=function(){null!==this.objects&&this.groups.levelLoadingStateUI.addMultiple([this.objects.coinBar,this.objects.totalHpBar,this.objects.freeCoinsItem,this.objects.showUnitButton,this.objects.settingsButton,this.objects.leaderboardButton])},n.addObjectsForReadyState=function(){null!==this.objects&&(this.groups.normalReadyStateUI.addMultiple([this.objects.coinBar,this.objects.unitBar,this.objects.levelBar,this.objects.totalHpBar,this.objects.startButton,this.objects.speedUpItem,this.objects.freeCoinsItem,this.objects.showUnitButton,this.objects.settingsButton,this.objects.leaderboardButton]),GameCore.Utils.Valid.isDebugger()&&this.groups.normalReadyStateUI.addMultiple([this.objects.resetLevelButton,this.objects.selectLevelButton,this.objects.currentUnitModButton,this.objects.currentAttackModButton]),this.groups.battleReadyStateUI.addMultiple([this.objects.coinBar,this.objects.totalHpBar,this.objects.startButton,this.objects.speedUpItem,this.objects.freeCoinsItem,this.objects.battleLevelBar,this.objects.showUnitButton,this.objects.settingsButton,this.objects.leaderboardButton]))},n.addObjectsForPlayingState=function(){null!==this.objects&&(this.groups.normalPlayingStateUI.addMultiple([this.objects.coinBar,this.objects.totalHpBar,this.objects.speedUpItem,this.objects.settingsButton]),this.groups.battlePlayingStateUI.addMultiple([this.objects.coinBar,this.objects.totalHpBar,this.objects.speedUpItem,this.objects.settingsButton]))},t}(function(){function e(e){this.scene=void 0,this.objects=void 0,this.allUI=void 0,this.groups=void 0,this.scene=e,this.objects=null,this.createGroups()}var t=e.prototype;return t.setUIObjects=function(e){this.objects=e,this.allUI.addMultiple(this.objects.getAll())},t.createGroups=function(){this.groups={},this.allUI=this.scene.add.group(),this.groups.allUI=this.allUI},e}()),Ba=function(e){function t(t){var n;(n=e.call(this,t)||this).uiZone=void 0;var i=n.scene.gameZone;return n.uiZone=n.scene.add.zone(0,0,400,i.height),Phaser.Display.Align.In.Center(n.uiZone,i),n}(0,a.Z)(t,e);var n=t.prototype;return n.alignUI=function(){e.prototype.alignUI.call(this)},n.alignMainUI=function(){if(null!==this.objects){var e=this.objects,t=e.coinBar,n=e.levelBar,i=e.showUnitButton,a=e.settingsButton,s=e.leaderboardButton,r=e.unitBar,o=e.startButton,c=e.totalHpBar,l=this.scene.tutorialManager;t.setScale(.75),Phaser.Display.Align.In.TopRight(t,this.uiZone,-80,-18),n.setScale(.75),Phaser.Display.Align.In.TopCenter(n,this.uiZone,0,-18),a.setScale(.75),Phaser.Display.Align.In.TopLeft(a,this.uiZone,-40,3),i.setScale(.75),s.setScale(.75),Phaser.Actions.GridAlign([s,i],{height:3,cellHeight:45,y:60,x:this.uiZone.width-10}),r.changeToDesktopFrame(),Phaser.Display.Align.In.BottomCenter(r,this.uiZone,-90,-30),o.changeToDesktopFrame(),l.isNothingToDisplay()?Phaser.Display.Align.In.BottomCenter(o,this.uiZone,55,-7):Phaser.Display.Align.In.BottomCenter(o,this.uiZone,0,-7),c.playerHpBar.setScale(.75),c.playerHpBar.setPosition(190,125),c.enemyHpBar.setScale(.75),c.enemyHpBar.setPosition(-190,-160),Phaser.Display.Align.In.Center(c,this.uiZone,0,0)}},n.alignItems=function(){if(null!==this.objects){var e=this.objects,t=e.freeCoinsItem,n=e.speedUpItem,i=e.startButton,a=e.showUnitButton;n.setScale(.75),t.setScale(.75),Phaser.Display.Align.In.RightCenter(t,i,t.width,-2),Phaser.Display.Align.In.BottomCenter(n,a,0,42)}},n.alignDevTools=function(){if(null!==this.objects&&GameCore.Utils.Valid.isDebugger()){var e=this.objects,t=e.selectLevelButton,n=e.resetLevelButton,i=e.currentUnitModButton,a=e.currentAttackModButton;Phaser.Display.Align.In.LeftCenter(t,this.uiZone,150,-50),Phaser.Display.Align.In.LeftCenter(n,this.uiZone,150,10),Phaser.Display.Align.In.LeftCenter(i,this.uiZone,150,60),Phaser.Display.Align.In.LeftCenter(a,this.uiZone,150,120)}},t}(Na),Ma=n(58),xa=n(39),Ua={targets:[],repeat:3,duration:33,ease:Phaser.Math.Easing.Linear,props:{angle:5},yoyo:!0},Fa=function(e){function t(t){var n,i,a;return(a=e.call(this,Ua,t)||this).targetAngle=void 0,a.shakeAmount=void 0,a.handleSwitchPosition=function(){var e;a.shakeAmount*=-.7,null==(e=a.tween)||e.updateTo("angle",a.targetAngle+a.shakeAmount)},null!=(n=a.config)&&n.props?(a.targetAngle=a.config.targets[0].angle,a.shakeAmount=a.config.props.angle-a.targetAngle,null==(i=a.tween)||i.on(Phaser.Tweens.Events.TWEEN_REPEAT,a.handleSwitchPosition),a):(0,u.Z)(a)}return(0,a.Z)(t,e),t}(xa.Z),Za=function(e){function t(t,n,i,a,s){var r;return(r=e.call(this,t,n,i,a,s)||this).shakeAnim=void 0,r}(0,a.Z)(t,e);var n=t.prototype;return n.createShakeAnim=function(){var e;null==(e=this.shakeAnim)||e.remove(),this.shakeAnim=new Fa({targets:[this],repeat:6,duration:50,ease:Phaser.Math.Easing.Cubic.Out,props:{angle:-20}})},n.runAnimation=function(){this.createShakeAnim(),this.shakeAnim.play(),(0,Gi.ZP)(50)},n.stopAnimation=function(){this.shakeAnim&&this.shakeAnim.remove(),this.angle=0},t}(Ma.Z),Ga={targets:[],yoyo:!0,repeat:-1,duration:120,ease:Phaser.Math.Easing.Circular.Out,props:{scale:{from:1,to:1.3}}},Ha=function(e){function t(t){return e.call(this,Ga,t)||this}return(0,a.Z)(t,e),t}(xa.Z),Ya=n(232),Ka=n(160),Va=h.Z.GAMEPLAY,Wa=Va.KEY,ja=Va.FRAME,za=function(e){function t(t){var n;return(n=e.call(this,t,Wa,ja.DASHBOARD_START_BTN,159,63)||this).heartAnim=void 0,n.text=void 0,n.setName("StartFight"),n.createText(),n.runHeartAnimation(),n}(0,a.Z)(t,e);var n=t.prototype;return n.createText=function(){var e=22,t=-6;switch(this.scene.lang.getCurrentLanguage()){case"pt":case"es":case"ja":case"de":case"id":e=20;break;case"tr":e=20,t=-8;break;case"it":e=18}var n=new Ka.Z(this.scene,{font:pn.Z.PRIMARY.KEY,size:this.scene.fontSize(e)});n.setText(this.scene.lang.Text.START_FIGHT),n.setDropShadow(0,2.5,0),this.add(n),Phaser.Display.Align.In.Center(n,this,0,t),this.text=n},n.changeToDesktopFrame=function(){var e=15;switch(this.scene.lang.getCurrentLanguage()){case"pt":case"ja":case"de":case"id":case"tr":e=13;break;case"es":case"it":e=12}this.button.setFrame(ja.DASHBOARD_START_BTN_LANDSCAPE),this.updateSize(),this.text.setFontSize(this.scene.fontSize(e)),this.text.setX(15);var t=this.scene.make.image({key:Wa,frame:ja.DASHBOARD_BATTLE_ICON});t.setWorldSize(26.5,23.5),t.setPosition(-45,-3),this.add(t)},n.runHeartAnimation=function(){var e;null==(e=this.heartAnim)||e.remove(),this.heartAnim=new Ha({targets:[this],duration:180,ease:Phaser.Math.Easing.Sine.InOut,props:{scale:{from:1,to:.95}}}),this.heartAnim.play()},n.setDisabled=function(t){var n;(e.prototype.setDisabled.call(this,t),t)?null==(n=this.heartAnim)||n.stop():this.runHeartAnimation()},n.runUpAnimation=function(){var e,t,n,i=this;-1!==this.scaleUp&&(null==(e=this.upAnimation)||e.remove(),this.upAnimation=new Ya.Z({targets:[this],duration:150,props:{scale:this.scaleUp},onStart:function(){var e;i.scene.input.enabled=!1,null==(e=i.heartAnim)||e.stop()},onUpdate:function(){i.hitZone.scale=1/i.scale}}),null==(t=this.upAnimation)||null==(n=t.tween)||n.once(Phaser.Tweens.Events.TWEEN_COMPLETE,(function(){i.scene.input.enabled=!0,i.runHeartAnimation()})),this.upAnimation.play())},t}(Ma.Z),Xa=function(e){function t(t){return e.call(this,t)||this}return(0,a.Z)(t,e),t.prototype.createConfigOne=function(e,t,n){var i=this,a=e/300,s=new Phaser.Math.Vector2(0,0),r=new Phaser.Math.Vector2(0,-e),o=n?-1:1,c=Phaser.Math.RND.between(-90,90),l=(c+90)/180*180*(c<0?1:(300-Math.abs(c))/300)*a,u=Phaser.Math.RND.between(20,l+20),h=new Phaser.Math.Vector2(1,0);h.setAngle(c*Math.PI/180);var d=Phaser.Math.RND.between(-Math.abs(c)-15,15-Math.abs(c)),p=u*(100-Math.abs(c))/100*a,f=Phaser.Math.RND.between(.2*p,p),g=new Phaser.Math.Vector2(1,0);g.setAngle(d*Math.PI/180);var E=o*h.x*u,m=h.y*u,v=o*g.x*f,A=g.y*f-e,S=new Phaser.Math.Vector2(E,m),T=new Phaser.Math.Vector2(v,A),y=new Phaser.Curves.CubicBezier(s,S,T,r),C=Phaser.Math.RND.between(750+3*u,1e3+3*u),I=this.coinGroup.get(0,0);return I.revive(),I.setRotation(-t.rotation),I.setWorldSize(24,22),t.add(I),{from:0,to:1,duration:C,ease:"Sine.In",onUpdate:function(e){var t=y.getPointAt(e.getValue());I.setPosition(t.x,t.y)},onComplete:function(e){if(I.kill(),!(e.totalProgress<1)&&(i.scene.audio.playSound(fn.Z.DIAMONDS_EAT),!i.startsExplosiveSmallTimer||i.startsExplosiveSmallTimer.hasDispatched)){i.startsExplosiveSmallTimer=i.scene.time.delayedCall(100,(function(){return null}));var t=I.getWorldPosition();i.startsExplosiveSmall.explode(10,t.x,t.y)}}}},t}(n(631).Z),qa=Xa,Qa=n(634),Ja=h.Z.GAMEPLAY,$a=Ja.KEY,es=Ja.FRAME,ts=Xn.FREE_COINS.ID,ns=GameCore.Configs.Gameplay.Powers.FreeCoins.duration,is=Dn.Z.FREE_GOLD_LAST_USED,as=function(e){function t(t){var n;return(n=e.call(this,t,ts,$a,es.DASHBOARD_FREE_GOLD,47,50)||this).scene=void 0,n.lastUsedTime=void 0,n.collectText=void 0,n.remainingTimeText=void 0,n.glowEffect=void 0,n.timer=void 0,n.moveTween=void 0,n.sparkleEffect=void 0,n.remainingTime=void 0,n.activeItem=function(){!0!==n.isActive&&(!0!==n.isDisabled&&(n.isActive=!0,n.scene.powerManager.isStopped()||(n.scene.audio.playSound(fn.Z.BUTTON_CLICK),n.activeLogic())))},n.deactivateItem=function(){!1!==n.isActive&&(n.isActive=!1,n.scene.powerManager.isStopped()||n.deactivateLogic())},n.rewardCoins=function(){var e=Date.now();n.scene.player.setCustomData(is,e),n.lastUsedTime=e;var t=n.scene,i=t.unitManager,a=t.coinManager,s=t.layoutManager,r=i.getPlayerMeleeSpawnedUnitsCount(),o=i.getPlayerRangedSpawnedUnitsCount(),c=a.getUnitPrice(r),l=a.getUnitPrice(o),u=Math.floor(2*Math.random()+3),h=l.biggerThan(c)?l:c;h.multiply(u);var p=new qa(n.scene),f=s.objects.coinBar,g=f.x,E=f.y;p.setDepth(d.Z.ON_TOP),p.explode(10,n.x,n.y,g,E).forEach((function(e){e.once(Phaser.Tweens.Events.TWEEN_COMPLETE,(function(){var e=h.clone();e.divide(10),n.scene.coin.plusCoins(e.baseValue,e.suffix),n.scene.updateUI()}))})),n.scene.time.delayedCall(600,(function(){n.scene.audio.playSound(fn.Z.COIN_INCREASE_REPEATEDLY_SOUND)})),n.disableItem(),n.startCountdown()},n.scene=t,n.setName("FreeCoinsItem"),n.createGlowEffect(),n.createCollectText(),n.createRemainingTimeText(),n.createSparkleEffect(),n}(0,a.Z)(t,e);var n=t.prototype;return n.playSound=function(){this.scene.audio.playSound(fn.Z.COIN_SPAWN_SOUND)},n.createRemainingTimeText=function(){this.remainingTimeText=this.scene.make.bitmapText({font:pn.Z.PRIMARY.KEY,size:this.scene.fontSize(13),origin:{x:.5,y:1}}),this.remainingTimeText.setVisible(!1),this.add(this.remainingTimeText),this.bringToTop(this.remainingTimeText),Phaser.Display.Align.In.BottomCenter(this.remainingTimeText,this.icon,0,-5)},n.createCollectText=function(){var e=11;switch(this.scene.lang.getCurrentLanguage()){case"es":case"pt":e=10;break;case"de":case"it":e=9}this.collectText=this.scene.make.bitmapText({font:pn.Z.PRIMARY.KEY,size:this.scene.fontSize(e),origin:{x:.5,y:1},text:this.scene.lang.Text.COLLECT}),this.collectText.setVisible(!1),this.add(this.collectText),this.bringToTop(this.collectText),Phaser.Display.Align.In.BottomCenter(this.collectText,this.icon,0,-5)},n.createGlowEffect=function(){this.glowEffect=this.scene.add.image(0,0,$a,es.DASHBOARD_FREE_GOLD_GLOW),this.glowEffect.setOrigin(.5,.5),this.glowEffect.setVisible(!1),this.glowEffect.setWorldSize(107.5,104.8),this.add(this.glowEffect),this.moveDown(this.glowEffect),this.moveUp(this.icon),Phaser.Display.Align.In.Center(this.glowEffect,this,1,0)},n.createSparkleEffect=function(){this.sparkleEffect=new Qa.Z(this.scene),this.sparkleEffect.setDepth(d.Z.ON_TOP)},n.enableItem=function(){this.visible&&!1!==this.isDisabled&&(this.isDisabled=!1,this.zone.setInteractive(),this.setAvailable(!0))},n.activeLogic=function(){this.rewardCoins()},n.disableItem=function(){!0!==this.isDisabled&&(this.zone.disableInteractive(),this.setAvailable(!1),this.isDisabled=!0)},n.deactivateLogic=function(){this.stopTimer()},n.startCountdown=function(){this.stopTimer(),this.initRemainingWaitTime(),0!=this.remainingTime?this.startTimer():this.enableItem()},n.startTimer=function(){var e=this;this.setRemainingTime(this.remainingTime),this.disableItem(),this.timer=this.scene.time.addEvent({delay:1e3,callback:function(){e.remainingTime<1e3?(e.remainingTime=0,e.setRemainingTime(0),e.enableItem(),e.stopTimer()):(e.remainingTime-=1e3,e.setRemainingTime(e.remainingTime),e.disableItem())},loop:!0})},n.stopTimer=function(){var e;null==(e=this.timer)||e.remove()},n.initRemainingWaitTime=function(){if(!this.lastUsedTime){var e=this.scene.player.getCustomData(is);this.lastUsedTime="number"===typeof e?e:-1}if(this.lastUsedTime<0)this.remainingTime=0;else{var t=Date.now(),n=ns-(t-this.lastUsedTime);this.remainingTime=n>0?n:0}},n.setAvailable=function(e){this.collectText.setVisible(e),this.remainingTimeText.setVisible(!e),this.glowEffect.setVisible(e),this.icon.setFrame(e?es.DASHBOARD_FREE_GOLD:es.DASHBOARD_FREE_GOLD_OFF),e?(this.setVisible(!0),this.runMoveTween()):(this.stopMoveTween(),this.sparkleEffect.stop())},n.setRemainingTime=function(e){var t=Math.floor(e/1e3),n=Math.floor(t/60),i=t%60,a=i<10?"0"+i:i.toString();this.remainingTimeText.setText(n+":"+a)},n.runMoveTween=function(){var e=this;this.stopMoveTween();var t=0,n=0,i=-2;this.moveTween=this.scene.tweens.add({targets:[this],duration:500,repeat:-1,ease:Phaser.Math.Easing.Sine.InOut,props:{y:"-=2"},onStart:function(){t=e.x,n=e.y},onStop:function(){e.setPosition(t,n)},onRepeat:function(){i=-i,e.moveTween.updateTo("y",n+i,!0),e.moveTween.data[0].duration=1e3}})},n.stopMoveTween=function(){var e,t;null==(e=this.moveTween)||e.stop(),null==(t=this.moveTween)||t.remove()},n.setVisible=function(t){return t||this.sparkleEffect.stop(),t&&this.remainingTime<1e3&&this.sparkleEffect.run(1,this.x,this.y-2.5,this.width,this.height+5),e.prototype.setVisible.call(this,t)},t}(Ti),ss=function(e){function t(t){var n;return(n=e.call(this,t,{size:38})||this).handleLoadComplete=function(e){if(n.scene){var t=n.payload.id;if(t&&t===e){var i=t,a=n.scene.textures.get(i);a&&a.key===i?n.setPhoto(a.key):n.setPhoto(_n.Z.AVATAR.KEY)}}},n.avtFrame.kill(),n}return(0,a.Z)(t,e),t}(n(233).Z),rs=h.Z.GAMEPLAY,os=rs.KEY,cs=rs.FRAME,ls=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).bg=void 0,i.avatar=void 0,i.level=void 0,i.setName("PlayerCard"),i.createAvatar(),i.createFrame(n),i.updateSize(),i.createLevelText(),i.scene.add.existing((0,u.Z)(i)),i}(0,a.Z)(t,e);var n=t.prototype;return n.updateData=function(e){var t=e.playerId,n=e.playerPhoto,i=e.playerLevel;this.level.setText("Lv. "+i),this.avatar.loadPhoto(t,n)},n.createFrame=function(e){var t=e?cs.DASHBOARD_AVATAR_FRAME_BLUE:cs.DASHBOARD_AVATAR_FRAME_RED,n=this.scene.make.image({key:os,frame:t});n.setName("bg"),n.setWorldSize(35.5,48.5),this.add(n),this.bg=n},n.updateSize=function(){this.setSize(this.bg.displayWidth,this.bg.displayHeight)},n.createAvatar=function(){var e=new ss(this.scene);e.setName("avatar"),e.setPosition(0,-4),this.add(e),this.avatar=e},n.createLevelText=function(){var e=this.scene.make.bitmapText({font:pn.Z.PRIMARY.KEY,size:this.scene.fontSize(8),text:"Lv. 1",origin:{x:.5,y:.5}});e.setPosition(0,14),this.add(e),this.level=e},t}(Phaser.GameObjects.Container),us=h.Z.GAMEPLAY,hs=us.KEY,ds=us.FRAME,ps=function(e){function t(t){var n;return(n=e.call(this,t)||this).playerFrame=void 0,n.opponentFrame=void 0,n.VS=void 0,n.createPlayerFrame(),n.createOpponentFrame(),n.createVS(),n.setDepth(d.Z.BUTTON),n.scene.add.existing((0,u.Z)(n)),n}(0,a.Z)(t,e);var n=t.prototype;return n.createPlayerFrame=function(){this.playerFrame=new ls(this.scene,!0),this.playerFrame.setName("playerFrame"),this.add(this.playerFrame),this.playerFrame.setPosition(28,0)},n.createOpponentFrame=function(){this.opponentFrame=new ls(this.scene,!1),this.opponentFrame.setName("opponentFrame"),this.add(this.opponentFrame),this.opponentFrame.setPosition(-28,0)},n.createVS=function(){this.VS=this.scene.make.image({key:hs,frame:ds.DASHBOARD_VS}),this.VS.setWorldSize(17,14),this.VS.setName("VS"),this.add(this.VS)},n.updateData=function(e,t){e&&this.playerFrame.updateData(e),t&&this.opponentFrame.updateData(t)},n.changeToDesktopFrame=function(){this.playerFrame.setPosition(200/this.scale,60/this.scale),this.opponentFrame.setPosition(-200/this.scale,-225/this.scale),this.VS.kill()},t}(Phaser.GameObjects.Container),fs=h.Z.GAMEPLAY,gs=fs.KEY,Es=fs.FRAME,ms=function(e){function t(t){var n;return(n=e.call(this,t)||this).bar=void 0,n.coinText=void 0,n.createBar(),n.createText(),n.createCoinIcon(),n.setDepth(d.Z.BUTTON),n.scene.add.existing((0,u.Z)(n)),n}(0,a.Z)(t,e);var n=t.prototype;return n.createBar=function(){this.bar=this.scene.make.image({key:gs,frame:Es.DASHBOARD_COINBAR_BG}),this.bar.setWorldSize(75,24.5),this.add(this.bar)},n.createCoinIcon=function(){var e=this.scene.make.image({key:gs,frame:Es.DASHBOARD_COINBAR_COIN});this.add(e),e.setWorldSize(30.5,31.5),Phaser.Display.Align.In.RightCenter(e,this,55,0)},n.createText=function(){var e=-10,t=17;if("tr"===this.scene.lang.getCurrentLanguage())t=19,e=-14;this.coinText=this.scene.make.bitmapText({font:pn.Z.PRIMARY.KEY,size:this.scene.fontSize(t),origin:{x:.5,y:0}}),this.add(this.coinText),Phaser.Display.Align.In.Center(this.coinText,this.bar,-5,e)},n.setCoins=function(e){this.coinText.setText(""+e.toString())},t}(Phaser.GameObjects.Container),vs=function(e){function t(t){var n;return(n=e.call(this,t)||this).text=void 0,n.createText(),n.setDepth(d.Z.BUTTON),n.scene.add.existing((0,u.Z)(n)),n}(0,a.Z)(t,e);var n=t.prototype;return n.createText=function(){this.text=new Ka.Z(this.scene,{font:pn.Z.PRIMARY.KEY,size:this.scene.fontSize(20)}),this.text.setText(""),this.text.setDropShadow(0,1.5,0),this.add(this.text)},n.setLevel=function(e){this.text.setText(this.scene.lang.Text.LEVEL+" "+e)},t}(Phaser.GameObjects.Container),As=n(475),Ss=h.Z.GAMEPLAY,Ts=Ss.KEY,ys=Ss.FRAME,Cs=function(e){function t(t){var n;return(n=e.call(this,t,0)||this).front=void 0,n.iconImage=void 0,n.updateHealthBar(),n.setFrameSize(94.5,11.5),n.createIconImage(),n}(0,a.Z)(t,e);var n=t.prototype;return n.updateHealthBar=function(){this.bg.setTexture(Ts),this.bg.setFrame(ys.DASHBOARD_HPBAR_BG),this.frame.setTexture(Ts),this.frame.setFrame(ys.DASHBOARD_HPBAR_RED),this.frame.setOrigin(1,.5),this.frame.setX(0);var e=this.scene.make.image({key:Ts,frame:ys.DASHBOARD_HPBAR_FRONT});e.setOrigin(0,.5),e.setWorldSize(this.hpLength,this.hpHeight),e.setX(-this.hpLength/2),this.add(e),this.front=e},n.createIconImage=function(){this.iconImage=this.scene.add.image(0,0,Ts,ys.DASHBOARD_HPBAR_RED_HEART),this.iconImage.setWorldSize(20,19),this.iconImage.setX(-this.hpLength/2-this.iconImage.displayWidth/2+8),this.iconImage.setAngle(90),this.add(this.iconImage)},n.setFrameSize=function(e,t){this.hpLength=e,this.hpHeight=t,this.bg.setWorldSize(this.hpLength,this.hpHeight),this.bg.setX(-this.hpLength/2),this.front.setWorldSize(this.hpLength,this.hpHeight),this.front.setX(-this.hpLength/2),this.updateFrameUI(),this.frame.setX((2-this.hpLength)/2)},n.updateFrameUI=function(){this.frame.setWorldSize(this.currentHp/this.defaultHp*(2-this.hpLength),this.hpHeight-1)},t}(As.Z),Is=h.Z.GAMEPLAY.FRAME,Rs=function(e){function t(){return e.apply(this,arguments)||this}(0,a.Z)(t,e);var n=t.prototype;return n.updateHealthBar=function(){e.prototype.updateHealthBar.call(this),this.frame.setFrame(Is.DASHBOARD_HPBAR_BLUE)},n.createIconImage=function(){e.prototype.createIconImage.call(this),this.iconImage.setFrame(Is.DASHBOARD_HPBAR_BLUE_HEART)},t}(Cs),ws=Rs,_s=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.playerHpBar=void 0,n.enemyHpBar=void 0,n.scene=t,n.setDepth(d.Z.BUTTON),n.createPlayerHpBar(),n.createEnemyHpBar(),n.setSize(300,200),n.init(),n.scene.add.existing((0,u.Z)(n)),n}(0,a.Z)(t,e);var n=t.prototype;return n.init=function(){this.enemyHpBar.setInitHp(1),this.playerHpBar.setInitHp(1)},n.createPlayerHpBar=function(){this.playerHpBar=new ws(this.scene),this.playerHpBar.setAngle(-90),this.playerHpBar.setPosition(175,50),this.add(this.playerHpBar)},n.createEnemyHpBar=function(){this.enemyHpBar=new Cs(this.scene),this.enemyHpBar.setAngle(-90),this.enemyHpBar.setPosition(-175,-160),this.add(this.enemyHpBar)},n.updateCurrentHp=function(){this.updateCurrentEnemyHp(),this.updateCurrentPlayerHp()},n.updateCurrentPlayerHp=function(){var e=this.scene.unitManager.getTotalPlayerUnitsHp();this.playerHpBar.setInitHp(e)},n.updatePlayerHpUIByMinus=function(e){this.playerHpBar.updateHpUIByMinus(e)},n.getCurrentPlayerHp=function(){return this.playerHpBar.getCurrentHp()},n.updateCurrentEnemyHp=function(){var e=this.scene.unitManager.getTotalEnemyUnitsHp();this.enemyHpBar.setInitHp(e)},n.updateEnemyHpUIByMinus=function(e){this.enemyHpBar.updateHpUIByMinus(e)},n.getCurrentEnemyHp=function(){return this.enemyHpBar.getCurrentHp()},t}(Phaser.GameObjects.Container),bs=n(57),Ls=h.Z.GAMEPLAY,Ps=Ls.KEY,Os=Ls.FRAME,Ds=function(e){function t(t,n,i){var a;return(a=e.call(this,t)||this).isDisable=!1,a.block=void 0,a.clickZone=void 0,a.adsBanner=void 0,a.unitImage=void 0,a.priceText=void 0,a.coinIcon=void 0,a.stampText=void 0,a.adsMode=!1,a.parentName=void 0,a.createBlock(),a.createZone(),a.updateSize(),a.createUnitImage(n),a.createPriceText(i),a.createMiniCoinIcon(),a.createAdsBanner(),a}(0,a.Z)(t,e);var n=t.prototype;return n.updateSize=function(){var e=this.block,t=e.displayWidth,n=e.displayHeight;this.setSize(t,n)},n.createBlock=function(){this.block=this.scene.add.image(0,0,Ps,Os.DASHBOARD_UNITBAR_BG),this.block.setWorldSize(71,77),this.add(this.block)},n.createZone=function(){var e=this.block.displayWidth,t=this.scene.world.isLandscape()?0:39/1.7,n=this.block.displayHeight+t,i=.5-t/n/2;this.clickZone=this.scene.add.zone(0,0,e,n),this.clickZone.setOrigin(.5,i),this.add(this.clickZone)},n.getStampTextFontSize=function(){switch(this.scene.lang.getCurrentLanguage()){case"pt":case"es":case"ja":case"zh":case"fr":case"id":case"de":case"it":return 12;case"tr":return 14;default:return 16}},n.getAdsTextFontSize=function(){switch(this.scene.lang.getCurrentLanguage()){case"pt":case"es":case"tr":case"ja":case"zh":case"fr":case"id":case"it":return 12;default:return 11}},n.createStampsBanner=function(){if(!this.stampText){var e=this.scene.make.container({}),t=this.scene.make.image({key:Ps,frame:Os.DASHBOARD_UNITBAR_STAMPS});t.setWorldSize(64,39),e.setSize(64,39),e.add(t);var n=new Ka.Z(this.scene,{font:pn.Z.PRIMARY.KEY,size:this.scene.fontSize(this.getStampTextFontSize())});n.setDropShadow(0,2,0),n.setY(-2),e.add(n),n.setText(this.scene.lang.Text.BUY),this.stampText=n,Phaser.Display.Align.In.BottomCenter(e,this.block,0,26),this.add(e)}},n.createAdsBanner=function(){var e=this.scene.make.image({key:Ps,frame:Os.DASHBOARD_AD_ICON});e.setOrigin(1,0),e.setDisplaySize(33,33),e.setPosition(this.block.x+this.block.displayWidth/2,this.block.y-this.block.displayHeight/2),this.add(e),e.kill(),this.adsBanner=e},n.createUnitImage=function(e){if(this.unitImage=this.scene.add.image(0,0,Ps),e===Wt.Z.MELEE_UNIT_TYPE){var t=Os.DASHBOARD_UNITBAR_DINO;this.unitImage.setFrame(t),this.unitImage.setDisplaySize(49,37.5)}else{var n=Os.DASHBOARD_UNITBAR_ARCHER;this.unitImage.setFrame(n),this.unitImage.setDisplaySize(35,43)}Phaser.Display.Align.In.Center(this.unitImage,this.block,0,-10),this.add(this.unitImage)},n.createPriceText=function(e){var t=18;if("tr"===this.scene.lang.getCurrentLanguage())t=16;this.priceText=this.scene.make.bitmapText({font:pn.Z.PRIMARY.KEY,size:this.scene.fontSize(15),origin:{x:.5,y:0}}),this.priceText.setText(""+e),Phaser.Display.Align.In.Center(this.priceText,this.block,8,t),this.add(this.priceText)},n.createMiniCoinIcon=function(){var e=this.scene.make.image({key:Ps,frame:Os.DASHBOARD_MINI_COIN});this.add(e),e.setDisplaySize(12.5,13.5),Phaser.Display.Align.In.Center(e,this,-22,20),this.coinIcon=e},n.setImage=function(e){this.unitImage.setTexture(e)},n.setPrice=function(e){var t=e.toString();this.priceText.setText(""+t)},n.setAdsMode=function(e){if(this.adsMode=e,this.adsBanner.setVisible(e),this.priceText.setVisible(!e),this.coinIcon.setVisible(!e),e)this.stampText&&(this.stampText.setFontSize(this.scene.fontSize(this.getAdsTextFontSize())),this.stampText.setText(this.scene.lang.Text.FREE)),Phaser.Display.Align.In.Center(this.unitImage,this.block,0,0);else{this.stampText&&(this.stampText.setFontSize(this.scene.fontSize(this.getStampTextFontSize())),this.stampText.setText(this.scene.lang.Text.BUY));var t=this.scene.world.isLandscape()?-6:-10;Phaser.Display.Align.In.Center(this.unitImage,this.block,0,t)}},n.setDisabled=function(e){e!==this.isDisable&&(this.setAlpha(e?.5:1),this.isDisable=e)},n.isDisabled=function(){return this.isDisable},n.logButtonEvent=function(){var e=this.getParentName(),t=this.name;this.scene.analytics.event(Ai._.BUTTON_CLICK,{button_name:t,screen_name:e})},n.getParentName=function(){if(this.parentName)return this.parentName;for(var e=this.parentContainer;e;){if(e instanceof GameCore.Screen){var t=e;return this.parentName=t.getScreenName(),this.parentName}e=e.parentContainer}return this.parentName=this.scene.getSceneName(),this.parentName},n.changeToDesktopFrame=function(){var e=2;if("tr"===this.scene.lang.getCurrentLanguage())e=0;this.block.setFrame(Os.DASHBOARD_UNITBAR_BG_LANDSCAPE),this.clickZone.setSize(this.block.displayWidth,this.block.displayHeight),this.adsBanner.setFrame(Os.DASHBOARD_AD_ICON_LANDSCAPE),this.adsBanner.setPosition(this.block.x+this.block.displayWidth/2,this.block.y-this.block.displayHeight/2);var t=1/this.scene.game.world.getPixelRatio();this.unitImage.setOrigin(.5,.45),this.unitImage.setScale(t/2),this.priceText.setFontSize(this.scene.fontSize(10)),this.priceText.setPosition(8,e),this.coinIcon.setPosition(-15,8),this.coinIcon.setScale(t/1.2),this.updateSize()},(0,bs.Z)(t,[{key:"onClick",set:function(e){var t=this;this.clickZone.setInteractive({useHandCursor:!0}),this.clickZone.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,(function(){t.logButtonEvent(),e(),(0,Gi.ZP)(50)}))}},{key:"onceClick",set:function(e){var t=this;this.clickZone.setInteractive({useHandCursor:!0}),this.clickZone.once(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,(function(){t.logButtonEvent(),e()}))}}]),t}(Phaser.GameObjects.Container),ks=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.bg=void 0,n.meleeBlock=void 0,n.rangedBlock=void 0,n.adChangeMeleeTimer=void 0,n.adChangeRangedTimer=void 0,n.buyMeleeUnit=function(){var e=n.scene.effectManger;n.checkIfFullBoard()&&e.playFullFloatText(),e.isRewardCurveAnimationRunning()||n.meleeBlock.isDisable||n.scene.handleSpawnMelee()},n.buyRangedUnit=function(){var e=n.scene.effectManger;n.checkIfFullBoard()&&(e.playFullFloatText(),n.rangedBlock.setName("BuyRangedUnit"),n.rangedBlock.setAdsMode(!1)),e.isRewardCurveAnimationRunning()||n.rangedBlock.isDisable||n.scene.handleSpawnRanged()},n.scene=t,n.createBg(),n.createMeleeBlock(),n.createRangedBlock(),n.setDepth(d.Z.BUTTON),n.scene.add.existing((0,u.Z)(n)),n}(0,a.Z)(t,e);var n=t.prototype;return n.createStampsBanner=function(){this.meleeBlock.createStampsBanner(),this.rangedBlock.createStampsBanner()},n.setMeleePrice=function(e){this.meleeBlock.setPrice(e)},n.setRangedPrice=function(e){this.rangedBlock.setPrice(e)},n.createBg=function(){this.bg=this.scene.make.image({key:h.Z.DEFAULT.KEY,frame:h.Z.DEFAULT.FRAME.DASHBOARD_UNITBAR_BOTTOM_BG}),this.bg.setWorldSize(375,195),this.bg.setY(52),this.add(this.bg)},n.getGapFromContainerCenterToBottomBg=function(){return this.bg.y+this.bg.displayHeight/2},n.isBgHigherBottom=function(){return this.bg.getWorldPosition().y+this.bg.displayHeight/2<this.scene.gameZone.displayHeight},n.createMeleeBlock=function(){this.meleeBlock=new Ds(this.scene,Wt.Z.MELEE_UNIT_TYPE,999),this.meleeBlock.setName("BuyMeleeUnit"),this.meleeBlock.setPosition(39,0),this.add(this.meleeBlock),this.meleeBlock.onClick=this.buyMeleeUnit},n.createRangedBlock=function(){this.rangedBlock=new Ds(this.scene,Wt.Z.RANGED_UNIT_TYPE,999),this.meleeBlock.setName("BuyRangedUnit"),this.rangedBlock.setPosition(-39,0),this.add(this.rangedBlock),this.rangedBlock.onClick=this.buyRangedUnit},n.setMeleeAdsMode=function(e){var t,n=this;if(e&&this.scene.tutorialManager.isRunning())this.disableMeleeBlock();else{var i=this.adChangeMeleeTimer&&this.adChangeMeleeTimer.getProgress()<1,a=this.meleeBlock.adsMode;if(e){if(e===a)return void(this.scene.ads.canbeShowRewardAd()||this.disableMeleeBlock());if(this.disableMeleeBlock(),i)return;this.adChangeMeleeTimer=this.scene.time.delayedCall(2e3,(function(){if(n.meleeBlock){var e=n.scene.ads.canbeShowRewardAd(),t=n.delayedAdMeleePriceCheck();if(n.checkIfFullBoard()||!e)return n.disableMeleeBlock(),n.meleeBlock.setName("BuyMeleeUnit"),void n.meleeBlock.setAdsMode(!1);if(n.enableMeleeBlock(),!t)return void n.meleeBlock.setAdsMode(!1);n.meleeBlock.setName("ViewAdMeleeUnit"),n.meleeBlock.setAdsMode(!0)}}))}else null==(t=this.adChangeMeleeTimer)||t.destroy(),this.enableMeleeBlock(),this.meleeBlock.setName("BuyMeleeUnit"),this.meleeBlock.setAdsMode(e)}},n.disableMeleeBlock=function(){this.meleeBlock.setDisabled(!0)},n.enableMeleeBlock=function(){this.meleeBlock.setDisabled(!1)},n.killMeleeBlock=function(){this.meleeBlock.kill()},n.reviveMeleeBlock=function(){this.meleeBlock.revive()},n.setRangedAdsMode=function(e){var t,n=this;if(e&&this.scene.tutorialManager.isRunning())this.disableRangedBlock();else{var i=this.adChangeRangedTimer&&this.adChangeRangedTimer.getProgress()<1,a=this.rangedBlock.adsMode;if(e){if(e===a)return void(this.scene.ads.canbeShowRewardAd()||this.disableRangedBlock());if(this.disableRangedBlock(),e&&i)return;this.adChangeRangedTimer=this.scene.time.delayedCall(2e3,(function(){if(n.rangedBlock){var e=n.scene.ads.canbeShowRewardAd(),t=n.delayedAdRangedPriceCheck();if(n.checkIfFullBoard()||!e)return n.disableRangedBlock(),n.rangedBlock.setName("BuyRangedUnit"),void n.rangedBlock.setAdsMode(!1);if(n.enableRangedBlock(),!t)return void n.rangedBlock.setAdsMode(!1);n.rangedBlock.setName("ViewAdRangedUnit"),n.rangedBlock.setAdsMode(!0)}}))}else null==(t=this.adChangeRangedTimer)||t.destroy(),this.enableRangedBlock(),this.rangedBlock.setName("BuyRangedUnit"),this.rangedBlock.setAdsMode(e)}},n.checkIfFullBoard=function(){return 0===this.scene.fieldManager.getRemainingAvailablePlacement()},n.delayedAdMeleePriceCheck=function(){var e=this.scene,t=e.unitManager,n=e.coinManager,i=this.scene.coin.getCurrentCoins(),a=t.getPlayerMeleeSpawnedUnitsCount(),s=n.getUnitPrice(a),r=i.toString(),o=s.toString();return s.biggerThan(i)&&r!==o},n.delayedAdRangedPriceCheck=function(){var e=this.scene,t=e.unitManager,n=e.coinManager,i=this.scene.coin.getCurrentCoins(),a=t.getPlayerRangedSpawnedUnitsCount(),s=n.getUnitPrice(a),r=i.toString(),o=s.toString();return s.biggerThan(i)&&r!==o},n.disableRangedBlock=function(){this.rangedBlock.setDisabled(!0)},n.enableRangedBlock=function(){this.rangedBlock.setDisabled(!1)},n.killRangedBlock=function(){this.rangedBlock.kill()},n.reviveRangedBlock=function(){this.rangedBlock.revive()},n.disableUnitBlocks=function(){this.meleeBlock.setDisabled(!0),this.rangedBlock.setDisabled(!0)},n.disableAdsForBlocks=function(){this.meleeBlock.setName("BuyMeleeUnit"),this.rangedBlock.setName("BuyRangedUnit"),this.meleeBlock.setAdsMode(!1),this.rangedBlock.setAdsMode(!1)},n.addOnceClickEventForMeleeBlock=function(e){this.meleeBlock.onceClick=e},n.addOnceClickEventForRangedBlock=function(e){this.rangedBlock.onceClick=e},n.getMeleeBlockConfig=function(){var e=this.meleeBlock.getWorldPosition(),t=e.x,n=e.y,i=this.meleeBlock,a=i.width,s=i.height;return{worldX:t,worldY:n+(this.scene.world.isLandscape()?0:10),width:a*this.scaleX,height:s*this.scaleY}},n.getRangedBlockConfig=function(){var e=this.rangedBlock.getWorldPosition(),t=e.x,n=e.y,i=this.rangedBlock,a=i.width,s=i.height;return{worldX:t,worldY:n+(this.scene.world.isLandscape()?0:10),width:a*this.scaleX,height:s*this.scaleY}},n.killBg=function(){this.bg.kill()},n.reviveBg=function(){this.bg.revive()},n.changeToDesktopFrame=function(){this.bg.kill(),this.rangedBlock.changeToDesktopFrame(),this.meleeBlock.changeToDesktopFrame(),this.meleeBlock.setPosition(36,0),this.rangedBlock.setPosition(-36,0)},t}(Phaser.GameObjects.Container),Ns=h.Z.GAMEPLAY,Bs=Ns.KEY,Ms=Ns.FRAME,xs=function(){function e(e){this.scene=void 0,this.coinBar=void 0,this.unitBar=void 0,this.levelBar=void 0,this.totalHpBar=void 0,this.startButton=void 0,this.settingsButton=void 0,this.battleLevelBar=void 0,this.showUnitButton=void 0,this.leaderboardButton=void 0,this.freeCoinsItem=void 0,this.speedUpItem=void 0,this.unitModButton=void 0,this.resetLevelButton=void 0,this.selectLevelButton=void 0,this.currentUnitModText=void 0,this.currentUnitModButton=void 0,this.currentAttackModText=void 0,this.currentAttackModButton=void 0,this.group=void 0,this.scene=e,this.createGroup(),this.createObjects()}var t=e.prototype;return t.getAll=function(){return this.group.getChildren()},t.createGroup=function(){this.group=this.scene.add.group()},t.createObjects=function(){this.createCoinBar(),this.createUnitBar(),this.createLevelBar(),this.createTotalHpBar(),this.createStartButton(),this.createBattleLevelBar(),this.createShowUnitButton(),this.createSettingsButton(),this.createLeaderboardButton(),this.createFreeCoinsItem(),this.createSpeedUpItem(),this.createDevTools()},t.createCoinBar=function(){this.coinBar=new ms(this.scene),this.group.add(this.coinBar)},t.createUnitBar=function(){this.unitBar=new ks(this.scene),this.group.add(this.unitBar)},t.createLevelBar=function(){this.levelBar=new vs(this.scene),this.group.add(this.levelBar)},t.createTotalHpBar=function(){this.totalHpBar=new _s(this.scene),this.group.add(this.totalHpBar)},t.createStartButton=function(){this.startButton=new za(this.scene),this.group.add(this.startButton)},t.createBattleLevelBar=function(){this.battleLevelBar=new ps(this.scene),this.group.add(this.battleLevelBar)},t.createShowUnitButton=function(){this.showUnitButton=new Za(this.scene,Bs,Ms.DASHBOARD_UNIT_LIST,31.5,36),this.group.add(this.showUnitButton),this.showUnitButton.setName("ShowUnitList")},t.createSettingsButton=function(){this.settingsButton=new Ma.Z(this.scene,Bs,Ms.DASHBOARD_SETTINGS_BTN,32.5,39),this.group.add(this.settingsButton),this.settingsButton.setName("Settings")},t.createLeaderboardButton=function(){this.leaderboardButton=new Ma.Z(this.scene,Bs,Ms.DASHBOARD_LEADERBOARD_BTN,33,40.5),this.group.add(this.leaderboardButton),this.leaderboardButton.setName("Leaderboards")},t.createFreeCoinsItem=function(){this.freeCoinsItem=new as(this.scene),this.group.add(this.freeCoinsItem)},t.createSpeedUpItem=function(){this.speedUpItem=new _i(this.scene),this.group.add(this.speedUpItem)},t.createDevTools=function(){GameCore.Utils.Valid.isDebugger()&&(this.createResetLevelButton(),this.createSelectLevelButton(),this.createUnitModButton(),this.createAttackModButton())},t.createResetLevelButton=function(){this.resetLevelButton=new Ma.Z(this.scene,Bs,Ms.TOOL_RESET,40,35),this.group.add(this.resetLevelButton),this.resetLevelButton.setName("Reset")},t.createSelectLevelButton=function(){this.selectLevelButton=new Ma.Z(this.scene,Bs,Ms.TOOL_EDIT,40,40),this.group.add(this.selectLevelButton),this.selectLevelButton.setName("Select"),this.selectLevelButton.setAngle(90)},t.createUnitModButton=function(){this.currentUnitModButton=new Ma.Z(this.scene,Bs,Ms.TOOL_UNIT,40,38.5),this.group.add(this.currentUnitModButton),this.currentUnitModButton.setName("UnitMod"),this.currentUnitModText=this.scene.make.bitmapText({font:pn.Z.PRIMARY.KEY,size:this.scene.fontSize(18),text:"0",origin:{x:0,y:.5}}),this.currentUnitModText.x=20,this.currentUnitModButton.add(this.currentUnitModText)},t.createAttackModButton=function(){this.currentAttackModButton=new Ma.Z(this.scene,Bs,Ms.TOOL_ATTACK,40,40),this.group.add(this.currentAttackModButton),this.currentAttackModButton.setName("UnitMod"),this.currentAttackModText=this.scene.make.bitmapText({font:pn.Z.PRIMARY.KEY,size:this.scene.fontSize(18),text:"0",origin:{x:0,y:.5}}),this.currentAttackModText.x=20,this.currentAttackModButton.add(this.currentAttackModText)},e}(),Us=C.STATUS,Fs=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.layout=void 0,n.objects=void 0,n.groups=void 0,n.scene=t,n.createObjects(),n.createLayouts(),n.createGroups(),n}(0,a.Z)(t,e);var n=t.prototype;return n.createObjects=function(){this.objects=new xs(this.scene)},n.createLayouts=function(){this.scene.world.isLandscape()?this.layout=new Ba(this.scene):this.layout=new Na(this.scene),this.layout.setUIObjects(this.objects)},n.createGroups=function(){this.groups=this.layout.groups},n.init=function(){this.layout.alignUI(),this.setState(Us.READY)},t}(w),Zs=C.STATUS,Gs=GameCore.Configs.Gameplay.MaxLevel,Hs=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.loadMapInput=void 0,n.unitModifierInput=void 0,n.attackModifierInput=void 0,n.handleStartLoadMapById=function(){try{n.loadMapInput.style.display="none";var e=document.getElementById("level-id");if(!e)return;var t=JSON.parse(e.value),i=parseInt(t)>Gs?Gs:parseInt(t);n.scene.selectLevel(i)}catch(a){console.warn(a)}},n.handleEditUnitModifier=function(){try{n.unitModifierInput.style.display="none";var e=document.getElementById("unit-mod");if(!e)return;var t=JSON.parse(e.value),i=parseInt(t),a=n.scene,s=a.difficultyManager,r=a.uiManager,o=s.editCurrentLevelUnitMod(i);n.setCurrentUnitModText(t,o),r.updateUIData()}catch(c){console.warn(c)}},n.handleEditAttackModifier=function(){try{n.attackModifierInput.style.display="none";var e=document.getElementById("attack-mod");if(!e)return;var t=JSON.parse(e.value),i=parseInt(t),a=n.scene,s=a.difficultyManager,r=a.uiManager,o=s.editCurrentLevelAttackMod(i);n.setCurrentAttackModText(t,o),r.updateUIData()}catch(c){console.warn(c)}},n.handleShowLoadMapInput=function(){n.loadMapInput.style.display="flex"},n.handleShowModUnitInput=function(){n.unitModifierInput.style.display="flex"},n.handleShowModAttackInput=function(){n.attackModifierInput.style.display="flex"},n.scene=t,n.createDevTools(),n}(0,a.Z)(t,e);var n=t.prototype;return n.start=function(){this.isRunning()||GameCore.Utils.Valid.isDebugger()&&this.setState(Zs.RUNNING)},n.createDevTools=function(){GameCore.Utils.Valid.isDebugger()&&(this.createLoadMapInput(),this.createUnitModifierInput(),this.createAttackModifierInput())},n.createLoadMapInput=function(){this.loadMapInput=this.createInput("input-level","level-id","load-level-id","Load level",this.handleStartLoadMapById)},n.createUnitModifierInput=function(){this.unitModifierInput=this.createInput("input-level","unit-mod","edit-unit-mod","Set Unit Price Modifier",this.handleEditUnitModifier)},n.createAttackModifierInput=function(){this.attackModifierInput=this.createInput("input-level","attack-mod","edit-attack-mod","Set Attack Coin Modifier",this.handleEditAttackModifier)},n.createInput=function(e,t,n,i,a){var s=document.createElement("div");s.id=e,s.style.height="100vh",s.style.width="calc(100vw - 100px)",s.style.padding="50px",s.style.display="flex",s.style.flexFlow="column",s.style.position="absolute",s.style.justifyContent="center",s.style.backgroundColor="#000000cc",s.innerHTML="<input id="+t+' style="height: 50px;text-align: center;font-size: 30px;"></input><input type="button" id='+n+" value="+i+' style="height:40px">',document.body.appendChild(s);var r=document.getElementById(n);return null==r||r.addEventListener("click",a),s.style.display="none",s},n.setCurrentUnitModText=function(e,t){this.scene.layoutManager.objects.currentUnitModText.setText("C: "+100*e+"%\nT: "+t.toString()+"%")},n.setCurrentAttackModText=function(e,t){this.scene.layoutManager.objects.currentAttackModText.setText("C: "+e+"%\nT: "+t.toString()+"%")},t}(w),Ys=n(24),Ks=n(663),Vs=n(650),Ws=n(661),js=n(660),zs=n(31),Xs=n.n(zs),qs=n(111),Qs=n(113),Js=n(129),$s=n(112),er=n(30),tr=n(649),nr=h.Z.DEFAULT,ir=nr.KEY,ar=nr.FRAME,sr=h.Z.DEFAULT_8_BIT,rr=sr.KEY,or=sr.FRAME,cr=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t,n,i,a)||this).popup=void 0,s.title=void 0,s.confirmBtn=void 0,s.cancelBtn=void 0,s.description=void 0,s.showUpAnimation=void 0,s.contentShowUpAnimation=void 0,s.fadeOutAnimation=void 0,s.handleClosePopup=function(){s.runFadeOutAnimation()},s.scene=t,s.background.setAlpha(.7),s.setSize(s.scene.gameZone.displayWidth,s.scene.gameZone.displayHeight),s.createPopup(),s.createCloseButton(),s.createTitle(),s.createContent(),s}(0,a.Z)(t,e);var n=t.prototype;return n.open=function(){e.prototype.open.call(this);var t=this.scene.scene.get(er.C.GAME_SCENE);t instanceof Rr&&t.screenManager.listenResizeEventForCalculateLight(this),this.scene.requestBackgroundMaskUpdate(Ys.o4.RESET_DATA_SCREEN,this.background.alpha),this.runOpenAnimation()},n.createPopup=function(){this.popup=new qs.Z(this.scene,{x:0,y:0,width:300,height:200,rightEdge:870778,topInnerCornerStrokeWidth:2,rightInnerCornerStrokeWidth:3,lightY:-40}),this.add(this.popup)},n.recalculateLightPosition=function(){this.popup&&this.popup.recalculateLightPosition()},n.createCloseButton=function(){var e=new $s.Z(this.scene);e.setName("button"),Phaser.Display.Align.In.TopRight(e,this.popup,10,10),this.popup.add(e),e.onClick=this.handleClosePopup},n.createTitle=function(){var e=this.scene.make.text({text:this.scene.lang.Text.RESET_DATA,style:{fontSize:"22px",stroke:"#000000",strokeThickness:2,color:"#FFFFFF",fixedWidth:325,align:"center",fontFamily:pn.Z.FONT_FAMILY}});e.setName("title"),e.setHighQuality(),e.setShadow(-8,8,"#000000",0,!0),this.add(e),Phaser.Display.Align.In.TopCenter(e,this.popup,0,-13);var t=this.scene.make.image({key:ir,frame:ar.TITLE_LINE});t.setWorldSize(235,23),this.popup.add(t),Phaser.Display.Align.In.BottomCenter(t,e,0,30),this.title=e},n.createContent=function(){this.createDescription(),this.createConfirmButton(),this.createCancelButton()},n.createDescription=function(){var e=17;switch(this.scene.lang.getCurrentLanguage()){case"id":case"de":e=15}this.description=this.scene.make.bitmapText({text:this.scene.lang.Text.RESET_DESC,font:pn.Z.PRIMARY.KEY,size:this.scene.fontSize(e),origin:{x:.5,y:.5}}),this.description.setCenterAlign(),this.add(this.description),this.description.setPosition(0,-10)},n.createConfirmButton=function(){var e=this;this.confirmBtn=new Ma.Z(this.scene,rr,or.BUTTON_RED,108,43),this.confirmBtn.setName("confirmBtn");var t=-5;if("tr"===this.scene.lang.getCurrentLanguage())t=-8;var n=new Ka.Z(this.scene,{font:pn.Z.PRIMARY.KEY,size:this.scene.fontSize(20)});n.setText(this.scene.lang.Text.YES),n.setDropShadow(-1,1.5,0),this.confirmBtn.add(n),n.setPosition(0,t),this.add(this.confirmBtn),Phaser.Display.Align.In.Center(this.confirmBtn,this.popup,-70,60),this.confirmBtn.onClick=function(){var t=e.scene.scene.get(er.C.GAME_SCENE);t instanceof Rr&&t.resetLevel();var n=e.scene.screen.get(Ys.o4.SETTINGS_SCREEN);n instanceof tr.Z&&n.handleClosePopup(),e.handleClosePopup()}},n.createCancelButton=function(){this.cancelBtn=new Ma.Z(this.scene,rr,or.BUTTON_GREEN,108,43),this.cancelBtn.setName("cancelBtn");var e=-5;if("tr"===this.scene.lang.getCurrentLanguage())e=-8;var t=new Ka.Z(this.scene,{font:pn.Z.PRIMARY.KEY,size:this.scene.fontSize(20)});t.setText(this.scene.lang.Text.NO),t.setDropShadow(-1,1.5,0),this.cancelBtn.add(t),t.setPosition(0,e),this.add(this.cancelBtn),Phaser.Display.Align.In.Center(this.cancelBtn,this.popup,70,60),this.cancelBtn.onClick=this.handleClosePopup},n.runOpenAnimation=function(){this.runPopupEntrancesAnimation(),this.runPopupContentEntrancesAnimation(100,400)},n.runPopupEntrancesAnimation=function(){this.showUpAnimation||(this.showUpAnimation=new Qs.Z({targets:[this.popup]})),this.showUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(e,t){var n;null==(n=this.contentShowUpAnimation)||n.remove();var i=[this.title,this.description,this.confirmBtn,this.cancelBtn],a=Xs()(i).call(i,(function(e){return e.alpha}));this.contentShowUpAnimation=new Js.Z({targets:i,duration:t,delay:this.scene.tweens.stagger(100,{start:e}),props:{scale:{getStart:function(e){return e.scale-.3},getEnd:function(e){return e.scale}},alpha:{getStart:function(e){return e.setAlpha(0),0},getEnd:function(e,t,n,i){return a[i]}}}}),this.contentShowUpAnimation.play()},n.runFadeOutAnimation=function(){var e=this;this.fadeOutAnimation||(this.fadeOutAnimation=new mi.Z({targets:[this.background],duration:200,ease:Phaser.Math.Easing.Cubic.Out,props:{alpha:{start:.7,from:.7,to:0}},onActive:function(){e.popup.kill(),e.title.kill(),e.description.kill(),e.confirmBtn.kill(),e.cancelBtn.kill()},onUpdate:function(t,n){e.scene.requestBackgroundMaskUpdate(Ys.o4.RESET_DATA_SCREEN,n.alpha)},onComplete:function(){e.popup.revive(),e.title.revive(),e.description.revive(),e.confirmBtn.revive(),e.cancelBtn.revive();var t=e.scene.scene.get(er.C.GAME_SCENE);t instanceof Rr&&t.screenManager.removeResizeEventForCalculateLight(e),e.background.setAlpha(.7),e.scene.screen.close(e.name)}})),this.fadeOutAnimation.play()},t}(GameCore.Screen),lr=n(657),ur=h.Z.DEFAULT,hr=ur.KEY,dr=ur.FRAME,pr=h.Z.DEFAULT_8_BIT,fr=pr.KEY,gr=pr.FRAME,Er=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t,n,i,a)||this).popup=void 0,s.title=void 0,s.confirmBtn=void 0,s.cancelBtn=void 0,s.description=void 0,s.showUpAnimation=void 0,s.contentShowUpAnimation=void 0,s.fadeOutAnimation=void 0,s.handleClosePopup=function(){s.runFadeOutAnimation()},s.scene=t,s.background.setAlpha(.7),s.setSize(s.scene.gameZone.displayWidth,s.scene.gameZone.displayHeight),s.createPopup(),s.createCloseButton(),s.createTitle(),s.createContent(),s}(0,a.Z)(t,e);var n=t.prototype;return n.open=function(){e.prototype.open.call(this);var t=this.scene.scene.get(er.C.GAME_SCENE);t instanceof Rr&&t.screenManager.listenResizeEventForCalculateLight(this),this.scene.requestBackgroundMaskUpdate(Ys.o4.START_OVER_POPUP,this.background.alpha),this.runOpenAnimation()},n.createPopup=function(){this.popup=new qs.Z(this.scene,{x:0,y:0,width:300,height:200,rightEdge:870778,topInnerCornerStrokeWidth:2,rightInnerCornerStrokeWidth:3,lightY:-40}),this.add(this.popup)},n.recalculateLightPosition=function(){this.popup&&this.popup.recalculateLightPosition()},n.createCloseButton=function(){var e=this,t=new $s.Z(this.scene);t.setName("button"),Phaser.Display.Align.In.TopRight(t,this.popup,10,10),this.popup.add(t),t.onClick=function(){var t=e.scene.scene.get(er.C.GAME_SCENE);t instanceof Rr&&t.stateManager.levelComplete(),e.handleClosePopup()}},n.createTitle=function(){var e=this.scene.make.text({text:this.scene.lang.Text.START_OVER_TITLE,style:{fontSize:"22px",stroke:"#000000",strokeThickness:2,color:"#FFFFFF",fixedWidth:325,align:"center",fontFamily:pn.Z.FONT_FAMILY}});e.setName("title"),e.setHighQuality(),e.setShadow(-8,8,"#000000",0,!0),this.add(e),Phaser.Display.Align.In.TopCenter(e,this.popup,0,-13);var t=this.scene.make.image({key:hr,frame:dr.TITLE_LINE});t.setWorldSize(235,23),this.popup.add(t),Phaser.Display.Align.In.BottomCenter(t,e,0,30),this.title=e},n.createContent=function(){this.createDescription(),this.createConfirmButton(),this.createCancelButton()},n.createDescription=function(){this.description=this.scene.make.bitmapText({text:this.scene.lang.Text.START_OVER_DESC,font:pn.Z.PRIMARY.KEY,size:this.scene.fontSize(17),origin:{x:.5,y:.5}}),this.description.setMaxWidth(275),this.description.setCenterAlign(),this.add(this.description),this.description.setPosition(0,-10)},n.createConfirmButton=function(){var e=this;this.confirmBtn=new Ma.Z(this.scene,fr,gr.BUTTON_RED,108,43),this.confirmBtn.setName("confirmBtn");var t=-5;if("tr"===this.scene.lang.getCurrentLanguage())t=-8;var n=new Ka.Z(this.scene,{font:pn.Z.PRIMARY.KEY,size:this.scene.fontSize(20)});n.setText(this.scene.lang.Text.YES),n.setDropShadow(-1,1.5,0),this.confirmBtn.add(n),n.setPosition(0,t),this.add(this.confirmBtn),Phaser.Display.Align.In.Center(this.confirmBtn,this.popup,-70,60),this.confirmBtn.onClick=function(){var t=e.scene.scene.get(er.C.GAME_SCENE);t instanceof Rr&&t.resetLevel(),e.handleClosePopup()}},n.createCancelButton=function(){var e=this;this.cancelBtn=new Ma.Z(this.scene,fr,gr.BUTTON_GREEN,108,43),this.cancelBtn.setName("cancelBtn");var t=-5;if("tr"===this.scene.lang.getCurrentLanguage())t=-8;var n=new Ka.Z(this.scene,{font:pn.Z.PRIMARY.KEY,size:this.scene.fontSize(20)});n.setText(this.scene.lang.Text.NO),n.setDropShadow(-1,1.5,0),this.cancelBtn.add(n),n.setPosition(0,t),this.add(this.cancelBtn),Phaser.Display.Align.In.Center(this.cancelBtn,this.popup,70,60),this.cancelBtn.onClick=function(){var t=e.scene.scene.get(er.C.GAME_SCENE);t instanceof Rr&&t.stateManager.levelComplete(),e.handleClosePopup()}},n.runOpenAnimation=function(){this.runPopupEntrancesAnimation(),this.runPopupContentEntrancesAnimation(100,400)},n.runPopupEntrancesAnimation=function(){this.showUpAnimation||(this.showUpAnimation=new Qs.Z({targets:[this.popup]})),this.showUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(e,t){var n;null==(n=this.contentShowUpAnimation)||n.remove();var i=[this.title,this.description,this.confirmBtn,this.cancelBtn],a=Xs()(i).call(i,(function(e){return e.alpha}));this.contentShowUpAnimation=new Js.Z({targets:i,duration:t,delay:this.scene.tweens.stagger(100,{start:e}),props:{scale:{getStart:function(e){return e.scale-.3},getEnd:function(e){return e.scale}},alpha:{getStart:function(e){return e.setAlpha(0),0},getEnd:function(e,t,n,i){return a[i]}}}}),this.contentShowUpAnimation.play()},n.runFadeOutAnimation=function(){var e=this;this.fadeOutAnimation||(this.fadeOutAnimation=new mi.Z({targets:[this.background],duration:200,ease:Phaser.Math.Easing.Cubic.Out,props:{alpha:{start:.7,from:.7,to:0}},onActive:function(){e.popup.kill(),e.title.kill(),e.description.kill(),e.confirmBtn.kill(),e.cancelBtn.kill()},onUpdate:function(t,n){e.scene.requestBackgroundMaskUpdate(Ys.o4.START_OVER_POPUP,n.alpha)},onComplete:function(){e.popup.revive(),e.title.revive(),e.description.revive(),e.confirmBtn.revive(),e.cancelBtn.revive();var t=e.scene.scene.get(er.C.GAME_SCENE);t instanceof Rr&&t.screenManager.removeResizeEventForCalculateLight(e),e.background.setAlpha(.7),e.scene.screen.close(e.name)}})),this.fadeOutAnimation.play()},t}(GameCore.Screen),mr=n(664),vr=n(655),Ar=n(654),Sr=n(479),Tr=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.isLandscape=void 0,n.showSettingsScreen=function(){var e=n.scene.game.globalScene.screen,t=e.get(Ys.o4.SETTINGS_SCREEN);t||(t=e.add(Ys.o4.SETTINGS_SCREEN,tr.Z),n.isLandscape?(t.incY(-10),t.incScale(-.15)):t.incY(-40)),t instanceof tr.Z&&t.recalculateLightPosition(),t.once(GameCore.Screens.Events.OPEN,(function(){n.scene.scene.pause()})),t.once(GameCore.Screens.Events.CLOSE,(function(){n.scene.scene.resume()})),e.open(Ys.o4.SETTINGS_SCREEN)},n.showLeaderboardScreen=function(){var e=n.scene.game.globalScene.screen,t=e.get(Ys.o4.LEADER_BOARD_SCREEN);t||(t=e.add(Ys.o4.LEADER_BOARD_SCREEN,Vs.Z)),t instanceof Vs.Z&&t.recalculateLightPosition(),t.once(GameCore.Screens.Events.OPEN,(function(){n.scene.scene.pause()})),t.once(GameCore.Screens.Events.CLOSE,(function(){n.scene.scene.resume()})),e.open(Ys.o4.LEADER_BOARD_SCREEN)},n.showUnitsScreen=function(){var e=n.scene,t=e.effectManger,i=e.layoutManager;t.stopRewardCurveAnimation(),i.objects.showUnitButton.stopAnimation();var a=n.scene.game.globalScene.screen,s=a.get(Ys.o4.UNITS_SCREEN);s||(s=a.add(Ys.o4.UNITS_SCREEN,Ar.Z),n.isLandscape&&s.incScale(-.1)),s.once(GameCore.Screens.Events.OPEN,(function(){n.scene.scene.pause()})),s.once(GameCore.Screens.Events.CLOSE,(function(){n.scene.scene.resume()})),a.open(Ys.o4.UNITS_SCREEN)},n.showUnitUnlockScreen=function(){var e=n.scene.game.globalScene.screen,t=e.get(Ys.o4.UNIT_UNLOCK_SCREEN);t||(t=e.add(Ys.o4.UNIT_UNLOCK_SCREEN,vr.Z),n.isLandscape&&(t.incY(-10),t.incScale(-.1))),t instanceof vr.Z&&t.recalculateLightPosition(),t.once(GameCore.Screens.Events.OPEN,(function(){n.scene.scene.pause()})),t.once(GameCore.Screens.Events.CLOSE,(function(e){e.off(GameCore.Screens.Events.OPEN),n.scene.unitManager.enableDragOnPlayerUnits(),n.scene.scene.resume()})),e.open(Ys.o4.UNIT_UNLOCK_SCREEN),n.scene.audio.playSound(fn.Z.UNIT_UNLOCK)},n.showResultScreen=function(e,t,i){var a=n.scene.game.globalScene.screen,s=a.get(Ys.o4.RESULT_SCREEN);s||(s=a.add(Ys.o4.RESULT_SCREEN,lr.Z),n.isLandscape&&s.incScale(-.18)),s.once(GameCore.Screens.Events.OPEN,(function(){n.scene.scene.pause()})),s.once(GameCore.Screens.Events.CLOSE,(function(e){e.off(GameCore.Screens.Events.OPEN),n.scene.scene.resume()})),t===l.Z.NORMAL||t===l.Z.BATTLE?a.open(Ys.o4.RESULT_SCREEN,{result:e,coinRewarded:i,mode:t}):a.open(Ys.o4.RESULT_SCREEN,{result:e,coinRewarded:i,mode:l.Z.NORMAL})},n.showOfflineScreen=function(){var e=n.scene.storage.getState(),t=(0,Sr.SD)(e);if(!(t<=-1)&&!(0,Sr.yX)(e)){var i=n.scene.game.globalScene.screen,a=i.get(Ys.o4.OFFLINE_REWARD_SCREEN);a||(a=i.add(Ys.o4.OFFLINE_REWARD_SCREEN,js.Z)),a instanceof js.Z&&a.recalculateLightPosition(),a.once(GameCore.Screens.Events.OPEN,(function(){n.scene.scene.pause()})),a.once(GameCore.Screens.Events.CLOSE,(function(){n.scene.scene.resume()})),i.open(Ys.o4.OFFLINE_REWARD_SCREEN,{rewardValue:t})}},n.showLoadingScreen=function(){var e=n.scene.game.globalScene.screen,t=e.get(Ys.o4.LOADING_SCREEN);t||(t=e.add(Ys.o4.LOADING_SCREEN,Ws.Z)),e.open(Ys.o4.LOADING_SCREEN)},n.closeLoadingScreen=function(){n.scene.game.globalScene.screen.close(Ys.o4.LOADING_SCREEN)},n.showChallengeSplashScreen=function(){var e=n.scene.game.globalScene.screen,t=e.get(Ys.o4.CHALLENGE_SPLASH_SCREEN);t||(t=e.add(Ys.o4.CHALLENGE_SPLASH_SCREEN,Ks.Z)),t.once(GameCore.Screens.Events.OPEN,(function(){n.scene.scene.pause()})),t.once(GameCore.Screens.Events.CLOSE,(function(){n.scene.scene.resume(),n.scene.audio.setMusicVolume(.4,2e3)})),e.open(Ys.o4.CHALLENGE_SPLASH_SCREEN)},n.showUnitRewardScreen=function(e){var t=n.scene.game.globalScene.screen;n.scene.effectManger.stopRewardCurveAnimation();var i=t.get(Ys.o4.UNIT_REWARD_SCREEN);i||(i=t.add(Ys.o4.UNIT_REWARD_SCREEN,mr.Z)),i.once(GameCore.Screens.Events.OPEN,(function(){n.scene.scene.pause()})),i.once(GameCore.Screens.Events.CLOSE,(function(e){e.off(GameCore.Screens.Events.OPEN),n.scene.scene.resume()})),t.open(Ys.o4.UNIT_REWARD_SCREEN,{unitType:e})},n.showResetDataPopup=function(){var e=n.scene.game.globalScene.screen,t=e.get(Ys.o4.RESET_DATA_SCREEN);t||(t=e.add(Ys.o4.RESET_DATA_SCREEN,cr)),t instanceof cr&&t.recalculateLightPosition(),t.once(GameCore.Screens.Events.OPEN,(function(){n.scene.scene.pause()})),t.once(GameCore.Screens.Events.CLOSE,(function(e){e.off(GameCore.Screens.Events.OPEN),n.scene.scene.resume()})),e.open(Ys.o4.RESET_DATA_SCREEN)},n.showStartOverPopup=function(){var e=n.scene.game.globalScene.screen,t=e.get(Ys.o4.START_OVER_POPUP);t||(t=e.add(Ys.o4.START_OVER_POPUP,Er)),t instanceof Er&&t.recalculateLightPosition(),t.once(GameCore.Screens.Events.OPEN,(function(){n.scene.scene.pause()})),t.once(GameCore.Screens.Events.CLOSE,(function(e){e.off(GameCore.Screens.Events.OPEN),n.scene.scene.resume()})),e.open(Ys.o4.START_OVER_POPUP)},n.timeOutEvent=void 0,n.updateLightPosition=function(e){return function(){n.timeOutEvent&&clearTimeout(n.timeOutEvent),n.timeOutEvent=setTimeout((function(){e.recalculateLightPosition()}),500)}},n.scene=t,n.isLandscape=n.scene.world.isLandscape(),n}(0,a.Z)(t,e);var n=t.prototype;return n.start=function(){this.isRunning()||e.prototype.start.call(this)},n.listenResizeEventForCalculateLight=function(e){window.addEventListener("resize",this.updateLightPosition(e))},n.removeResizeEventForCalculateLight=function(e){window.removeEventListener("resize",this.updateLightPosition(e))},t}(w),yr=Dn.Z.LEVEL_PROGRESS,Cr=GameCore.Configs.Gameplay.DelayFinishGame,Ir=function(e){function t(){for(var t,n,a=arguments.length,s=new Array(a),o=0;o<a;o++)s[o]=arguments[o];return(n=e.call.apply(e,c()(t=[this]).call(t,s))||this).uiManager=void 0,n.unitManager=void 0,n.coinManager=void 0,n.fieldManager=void 0,n.levelManager=void 0,n.powerManager=void 0,n.stateManager=void 0,n.spineManager=void 0,n.effectManger=void 0,n.layoutManager=void 0,n.screenManager=void 0,n.devToolManager=void 0,n.tutorialManager=void 0,n.animationManager=void 0,n.difficultyManager=void 0,n.accessibilityManager=void 0,n.gameMode=void 0,n.levelStartAt=void 0,n.levelEndAt=void 0,n.isBannerAdShowed=void 0,n.isStartOverPopupShowed=void 0,n.handlePauseScene=function(){n.unitManager.hideAllUnits(),n.unitManager.hideAllProjectiles(),n.spineManager.hideAllSpines(),n.effectManger.hideAllTextEffects()},n.handleResumeScene=function(){n.stateManager.isInLevelLoadingState()||n.unitManager.showAllAliveUnits(),n.stateManager.isInPlayingState()&&n.unitManager.showAllHpBarUnits(),n.unitManager.showAllProjectiles(),n.spineManager.showAllSpines(),n.effectManger.showAllTextEffects(),n.powerManager.syncSpeedSetting()},n.handleSpawnRanged=function(){if(n.stateManager.isInReadyState()){var e=n.coin.getCurrentCoins();if(e instanceof Vt.Z){var t=n.unitManager.getPlayerRangedSpawnedUnitsCount(),i=n.coinManager.getUnitPrice(t);console.log("\ud83e\udd16 ? rangedPrice",i);var a=n.getBuyingUnitLevel();if(e.smallerThan(i)){if(e.toString()!==i.toString())return n.screenManager.showUnitRewardScreen("RANGED"),void n.audio.playSound(fn.Z.BUTTON_CLICK);i=e}var s=n.fieldManager.getAvailablePlacement();s&&(n.coin.minusCoins(i.baseValue,i.suffix),n.unitManager.createPlayerArcher(s.rowId,s.colId,a),0===n.fieldManager.getRemainingAvailablePlacement()&&n.effectManger.playFullFloatText(),n.updateUI(),n.unitManager.savePlayerUnits(),n.audio.playSound(fn.Z.BUTTON_CLICK))}}},n.handleSpawnMelee=function(){if(n.stateManager.isInReadyState()){var e=n.unitManager.getPlayerMeleeSpawnedUnitsCount(),t=n.coinManager.getUnitPrice(e);console.log("\ud83e\udd16 ? meleePrice",t);var i=n.getBuyingUnitLevel(),a=n.coin.getCurrentCoins();if(a instanceof Vt.Z){if(a.smallerThan(t)){if(a.toString()!==t.toString())return n.screenManager.showUnitRewardScreen("MELEE"),void n.audio.playSound(fn.Z.BUTTON_CLICK);t=a}var s=n.fieldManager.getAvailablePlacement();s&&(n.coin.minusCoins(t.baseValue,t.suffix),n.unitManager.createPlayerMelee(s.rowId,s.colId,i),0===n.fieldManager.getRemainingAvailablePlacement()&&n.effectManger.playFullFloatText(),n.updateUI(),n.unitManager.savePlayerUnits(),n.audio.playSound(fn.Z.BUTTON_CLICK))}}},n.run=function(){n.stateManager.init()},n.quit=function(){n.stateManager.quit()},n.prepareRound=function(){n.levelStartAt=Date.now(),n.gameMode===l.Z.NORMAL&&n.time.delayedCall(1e3,n.screenManager.showOfflineScreen),n.stateManager.ready()},n.restartScene=function(){n.stateManager.init()},n.startRound=function(){n.stateManager.play(),n.audio.playSound(fn.Z.START_BATTLE)},n.replayRound=(0,i.Z)(r().mark((function e(){var t;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.unitManager.hideAllUnits(),n.gameMode!==l.Z.BATTLE){e.next=12;break}if(t=n.game.battle.getReplayOpponentId()){e.next=6;break}return n.stateManager.levelLoading(),e.abrupt("return");case 6:return e.next=8,n.game.battle.createBattle(t);case 8:return n.layoutManager.objects.freeCoinsItem.revive(),e.abrupt("return");case 12:n.layoutManager.objects.freeCoinsItem.revive(),n.stateManager.ready();case 14:case"end":return e.stop()}}),e)}))),n.nextRound=function(){n.unitManager.hideAllUnits(),n.stateManager.levelLoading()},n.resetLevel=(0,i.Z)(r().mark((function e(){var t,i,a;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new La.Z({}).toObject(),i=t.coins,a=t.gameData,e.next=4,n.player.setMultiCustomData({coinBaseValue:i.baseValue,coinSuffixValue:i.suffix,playerUnitData:a.playerUnitData,playerLevelProgress:a.playerLevelProgress,meleeUnlockedUnitLevel:a.meleeUnlockedUnitLevel,rangedUnlockedUnitLevel:a.rangedUnlockedUnitLevel});case 4:n.coin.receiveCoins(i.baseValue,i.suffix),n.coinManager.initModifier(),n.difficultyManager.intData(),n.levelManager.setCurrentLevelId(1),n.tutorialManager.initTutorialData(),n.resetGameplay();case 10:case"end":return e.stop()}}),e)}))),n.selectLevel=function(e){n.player.setCustomData(yr,e-1),n.coinManager.initModifier(),n.difficultyManager.intData(),n.levelManager.setCurrentLevelId(e-1),n.resetGameplay()},n.updateUnitData=(0,ka.D)((function(){n.player.setMultiCustomData({playerUnitData:n.unitManager.serializePlayerUnitData()})}),2e3),n}(0,a.Z)(t,e);var n=t.prototype;return n.preload=function(){this.events.on(Phaser.Scenes.Events.WAKE,this.run),this.events.on(Phaser.Scenes.Events.CREATE,this.run),this.events.on(Phaser.Scenes.Events.SLEEP,this.quit),this.events.on(Phaser.Scenes.Events.PAUSE,this.handlePauseScene),this.events.on(Phaser.Scenes.Events.RESUME,this.handleResumeScene),this.ads.preloadInterstitialAdAsync().catch((function(){}))},n.create=function(){e.prototype.create.call(this),this.createManager(),this.levelStartAt=0,this.levelEndAt=0,this.isBannerAdShowed=!1,this.isStartOverPopupShowed=!1},n.createManager=function(){this.layoutManager=new Fs(this),this.coinManager=new en(this),this.unitManager=new na(this),this.levelManager=new Wn(this),this.fieldManager=new Un(this),this.powerManager=new ei(this),this.stateManager=new di(this),this.spineManager=new si(this),this.effectManger=new yn(this),this.screenManager=new Tr(this),this.devToolManager=new Hs(this),this.tutorialManager=new _a(this),this.animationManager=new Kt(this),this.difficultyManager=new un(this),this.accessibilityManager=new L(this),this.uiManager=new Di(this)},n.initManager=function(){this.uiManager.init(),this.unitManager.init(),this.coinManager.init(),this.levelManager.init(),this.fieldManager.init(),this.spineManager.init(),this.effectManger.init(),this.powerManager.init(),this.screenManager.init(),this.devToolManager.init(),this.tutorialManager.init(),this.difficultyManager.init(),this.accessibilityManager.init(),this.layoutManager.init()},n.startManager=function(){this.coinManager.start(),this.unitManager.start(),this.levelManager.start(),this.fieldManager.start(),this.effectManger.start(),this.powerManager.start(),this.screenManager.start(),this.devToolManager.start(),this.tutorialManager.start(),this.difficultyManager.start(),this.accessibilityManager.start(),this.uiManager.start(),this.layoutManager.start()},n.stopManager=function(){this.uiManager.stop(),this.levelManager.stop(),this.coinManager.stop(),this.fieldManager.stop(),this.unitManager.stop(),this.spineManager.stop(),this.effectManger.stop(),this.powerManager.stop(),this.screenManager.stop(),this.devToolManager.stop(),this.tutorialManager.stop(),this.difficultyManager.stop(),this.accessibilityManager.stop(),this.layoutManager.stop()},n.spawnUnit=function(e,t,n,i){if(void 0===t&&(t=!0),void 0===n&&(n=1),void 0===i&&(i=!1),!this.stateManager.isInReadyState())return!1;var a,s=this.fieldManager.getAvailablePlacement();if(!s)return!1;if(i){var r=this.coin.getCurrentCoins();if(!(r instanceof Vt.Z))return!1;var o=0;o="MELEE"===e?this.unitManager.getPlayerMeleeSpawnedUnitsCount():this.unitManager.getPlayerRangedSpawnedUnitsCount();var c=this.coinManager.getUnitPrice(o);if(console.log("\ud83e\udd16 ? "+e+" unit price",c),r.smallerThan(c)){if(r.toString()!==c.toString())return!1;c=r}this.coin.minusCoins(c.baseValue,c.suffix)}return t?(a="MELEE"==e?this.uiManager.getMeleeBlockWorldPosition():this.uiManager.getRangedBlockWorldPosition(),this.effectManger.runCurveAnimationRewardUnit(a.x,a.y,s,e,n)):"MELEE"==e?this.unitManager.createPlayerMelee(s.rowId,s.colId,n):this.unitManager.createPlayerArcher(s.rowId,s.colId,n),this.updateUI(),this.unitManager.savePlayerUnits(),!0},n.getBuyingUnitLevel=function(){var e=this.levelManager.currentLevelId,t=Wt.Z.BUYING_UNIT_LEVEL,n=1;return t.forEach((function(t,i){t<=e&&(n=i+1)})),n},n.giveEnoughCoins=function(e){var t,n=0;"MELEE"==e?(n=this.unitManager.getPlayerMeleeSpawnedUnitsCount(),t=this.coinManager.getUnitPrice(n)):(n=this.unitManager.getPlayerRangedSpawnedUnitsCount(),t=this.coinManager.getUnitPrice(n));var i=this.coin.getCurrentCoins();i instanceof Vt.Z&&i.smallerThan(t)&&(t.subtract(i),this.coin.plusCoins(t.baseValue,t.suffix))},n.updateUI=function(){this.uiManager.updateUIData(),0===this.fieldManager.getRemainingAvailablePlacement()&&(this.uiManager.disableUnitBlocks(),this.uiManager.disableAdsUnitBlocks()),this.uiManager.isStartButtonDisabled()&&this.uiManager.enableStartButton()},n.gameOver=function(e){this.unitManager.setReadyAllUnits(),this.levelEndAt=Date.now(),"win"===e?this.handleStartOverFlow():this.stateManager.levelFail()},n.handleStartOverFlow=function(){this.levelManager.currentLevelId>=1598&&this.gameMode===l.Z.NORMAL&&!this.isStartOverPopupShowed?(this.audio.playSound(fn.Z.WIN_BATTLE),this.effectManger.playResultWinAnimation(),this.isStartOverPopupShowed=!0,this.time.delayedCall(Cr,this.screenManager.showStartOverPopup)):this.stateManager.levelComplete()},n.rewardLostCoin=function(e){var t=this.coinManager.getTotalCoinsByAttack();t.multiply(e),console.log("\ud83e\udd16 ? rewardLostCoin",t,{rewardCoins:t,multiply:e}),this.coin.plusCoins(t.baseValue,t.suffix)},n.rewardWinCoin=function(e){var t=this.coinManager.getRewardCoinsByAttackCoins();t.multiply(e),console.log("\ud83e\udd16 ? rewardWinCoin",t,{rewardCoins:t,multiply:e}),this.coin.plusCoins(t.baseValue,t.suffix)},n.updateLevelToLeaderboard=function(e){var t=this.storage.dispatch,n=this.player.getCustomData("playerLevelProgress"),i=this.player.getCustomData("playerUnitData");t(oa(e,{playerLevel:n,playerUnitData:i}))},n.update=function(){this.stateManager.update()},n.resetGameplay=function(){this.unitManager.initSpawnPools(),this.unitManager.emptyPlayerUnits(),this.uiManager.updateUIData(),this.stateManager.quit(),this.stateManager.levelLoading()},n.initGameMode=function(){this.gameMode=l.Z.NORMAL,this.battle.getStatus()===ca.Z.STARTED&&(this.gameMode=l.Z.BATTLE),console.log("\ud83e\udd16 ? initGameMode",this.gameMode)},n.isChallengeMode=function(){var e=(0,i.Z)(r().mark((function e(){var t,n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t=this.storage.getState(),n=(0,Pa.DE)(t),console.info("\ud83d\ude80 > isRequestingDetectGameMode",n),n){e.next=6;break}return e.abrupt("return",!1);case 6:return e.t0=this.storage,e.next=9,(0,Oa.qF)();case 9:return e.t1=e.sent,e.next=12,e.t0.dispatch.call(e.t0,e.t1);case 12:return e.abrupt("return",this.isContextChallenge());case 15:e.prev=15,e.t2=e.catch(0),console.warn("isChallengeMode",e.t2);case 18:return e.abrupt("return",!1);case 19:case"end":return e.stop()}}),e,this,[[0,15]])})));return function(){return e.apply(this,arguments)}}(),n.isContextChallenge=function(){try{var e=this.storage.getState();return(0,Pa.FB)(e)===Da.jt}catch(t){return console.warn(t),!1}},n.getPlayedTimeSeconds=function(){return Math.floor((this.levelEndAt-this.levelStartAt)/1e3)},t}(ba.Z),Rr=Ir},472:function(e,t,n){"use strict";n.d(t,{Z:function(){return U}});var i=n(57),a=n(1),s=n(41),r=n.n(s),o=n(159),c=n(67),l=n(66),u=n(2),h=n(30),d=n(24),p=n(241),f=n.n(p),g=n(114),E=n.n(g),m=function(e,t,n){if(t&&n){var i=window.game.globalScene.children.getAll(),a=!0;if(i.forEach((function(e){e instanceof GameCore.Screen&&e!==n&&e.visible&&(a=!1)})),!a)return}var s=document.getElementById("background-mask");s&&(s.style.backgroundColor="rgba(0, 0, 0, "+e+")")},v=function(){function e(){this.backgroundAlphaList=void 0,this.backgroundAlphaList=[]}var t=e.prototype;return t.requestBackgroundMaskUpdate=function(e,t){var n,i=f()(n=this.backgroundAlphaList).call(n,(function(t){return t.screenName===e}));if(e===d.o4.CHALLENGE_SPLASH_SCREEN){var a,s=E()(a=this.backgroundAlphaList).call(a,(function(e){return e.screenName===d.o4.LOADING_SCREEN}));if(s&&0!==s.alpha)return void this.handleChallengeSplashScreenCase()}-1===i?this.backgroundAlphaList.push({alpha:t,screenName:e}):this.backgroundAlphaList[i].alpha=t,this.updateBackgroundMask()},t.handleChallengeSplashScreenCase=function(){var e,t,n=f()(e=this.backgroundAlphaList).call(e,(function(e){return e.screenName===d.o4.CHALLENGE_SPLASH_SCREEN})),i=E()(t=this.backgroundAlphaList).call(t,(function(e){return e.screenName===d.o4.LOADING_SCREEN}));i&&0!==i.alpha&&(-1===n?this.backgroundAlphaList.push({alpha:0,screenName:d.o4.CHALLENGE_SPLASH_SCREEN}):this.backgroundAlphaList[n].alpha=0)},t.updateBackgroundMask=function(){if(0!==this.backgroundAlphaList.length){var e=1;this.backgroundAlphaList.forEach((function(t){e*=1-t.alpha})),m(1-e)}else m(0)},e}(),A=n(470),S=(0,n(125).P1)([function(e){return e.scene.currentSceneKey}],(function(e){return e})),T=n(474),y=n(5),C=n(34),I=u.Z.DEFAULT,R=I.KEY,w=I.FRAME,_=function(e){function t(t){var n;return(n=e.call(this,t,0,0)||this).fps=0,n.fpsString="FPS: %1",n.fpsText=void 0,n.background=void 0,n.lastUpdate=void 0,n.update=function(e){if(!(e-n.lastUpdate<800)){n.lastUpdate=e;var t=Math.floor(n.scene.game.loop.actualFps);n.setFps(t)}},n.createFps(),n.setDepth(l.Z.DEBUG),n.scene.add.existing((0,y.Z)(n)),n.scene.events.on(Phaser.Scenes.Events.UPDATE,n.update),n}(0,a.Z)(t,e);var n=t.prototype;return n.setFps=function(e){this.fps=e;var t=Phaser.Utils.String.Format(this.fpsString,[e]);this.fpsText.setText(t)},n.createFps=function(){this.background=this.scene.make.image({key:R,frame:w.BLANK}),this.background.setName("BG"),this.background.setTint(13801480),this.background.setWorldSize(65,20),this.fpsText=this.scene.make.bitmapText({size:this.scene.fontSize(14),text:this.fpsString,font:C.Z.PRIMARY.KEY,origin:{x:.5,y:.5}}),this.fpsText.setName("FPS Meter"),Phaser.Display.Align.In.Center(this.fpsText,this.background,5,-1),this.add([this.background,this.fpsText]),this.setFps(0)},t}(Phaser.GameObjects.Container),b=_,L=function(e){function t(t){var n;if((n=e.call(this,t,0,0)||this).performance=void 0,n.memory=0,n.maxMemoryLimit=void 0,n.maxPercentThreshold=void 0,n.normalColor=3459162,n.warningColor=16768343,n.alarmColor=15812200,n.memoryString="Memory: %1MB / %2MB",n.memoryText=void 0,n.lastUpdate=void 0,n.update=function(e){if(!(e-n.lastUpdate<1e3)){n.lastUpdate=e;var t=n.performance.memory.usedJSHeapSize,i=1048576*n.maxMemoryLimit,a=Math.round(t/1048576);n.setMemory(a),n.memoryText.setTint(n.normalColor),t>n.maxPercentThreshold/100*i&&n.memoryText.setTint(n.warningColor),t>i&&n.memoryText.setTint(n.alarmColor)}},n.performance=window.performance,n.createMemory(),n.setDepth(l.Z.DEBUG),n.scene.add.existing((0,y.Z)(n)),!n.isSupport())return n.memoryText.setText("Memory: not supported!"),(0,y.Z)(n);var i=n.performance.memory.jsHeapSizeLimit;return n.maxPercentThreshold=90,n.setMaxMemory(i/1048576),n.scene.events.on(Phaser.Scenes.Events.UPDATE,n.update),n}(0,a.Z)(t,e);var n=t.prototype;return n.isSupport=function(){var e;return this.performance&&!(null==(e=this.performance)||!e.memory)},n.setMaxMemory=function(e){this.maxMemoryLimit=Math.round(e)},n.setMemory=function(e){this.memory=e;var t=Phaser.Utils.String.Format(this.memoryString,[e,this.maxMemoryLimit]);this.memoryText.setText(t)},n.createMemory=function(){this.memoryText=this.scene.make.bitmapText({size:this.scene.fontSize(14),text:this.memoryString,font:C.Z.PRIMARY.KEY,depth:2e3}),this.memoryText.setName("Memory Meter"),this.add(this.memoryText),this.setMemory(0)},t}(Phaser.GameObjects.Container),P=L,O=n(630),D=function(e){function t(t,n,i,a){return e.call(this,t,n,i,a)||this}(0,a.Z)(t,e);var n=t.prototype;return n.open=function(t){e.prototype.open.call(this,t),this.scene.requestBackgroundMaskUpdate(d.o4.CLOSEABLE_NOTIFY_SCREEN,this.background.alpha),this.addOneTimeCloseEvent()},n.addOneTimeCloseEvent=function(){var e=this;this.scene.input.once(Phaser.Input.Events.POINTER_DOWN,(function(){e.scene.screen.close(e.name)}))},n.close=function(){e.prototype.close.call(this),this.scene.requestBackgroundMaskUpdate(d.o4.CLOSEABLE_NOTIFY_SCREEN,0),this.scene.input.off(Phaser.Input.Events.POINTER_DOWN,void 0,this,!0)},t}(O.Z),k=D,N=u.Z.DEFAULT_8_BIT,B=N.KEY,M=N.FRAME,x=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=e.call.apply(e,r()(t=[this]).call(t,a))||this).mask=void 0,n.fadeInAnim=void 0,n.fadeOutAnim=void 0,n.fpsMeter=void 0,n.memoryMeter=void 0,n.backgroundMaskManager=void 0,n.runScene=function(e){n.currentScene.run(e)},n.sleepScene=function(e){n.currentScene.sleep(e)},n.switchScene=function(e){n.currentScene.switch(e)},n.emitGameEventStartScene=function(e){var t=e.scene.key;console.info("%cScene start","color: #D27D2D",t),n.updateSceneState(),n.runMaskFadeOutAnimation(),n.updateActiveSceneKey(t),n.game.events.emit(Phaser.Scenes.Events.START,t)},n.emitGameEventSleepScene=function(e){var t=e.scene.scene.key;console.info("%cScene sleep","color: #D27D2D",t),t!==h.C.LOAD_SCENE&&(n.runMaskFadeInAnimation(),n.game.events.emit(Phaser.Scenes.Events.SLEEP,t))},n.emitGameEventWakeScene=function(e){var t=e.scene.scene.key;console.info("%cScene wake","color: #D27D2D",t),t!==h.C.LOAD_SCENE&&(n.updateSceneState(),n.runMaskFadeOutAnimation(),n.updateActiveSceneKey(t),n.game.events.emit(Phaser.Scenes.Events.WAKE,t))},n.emitGameEventPauseScene=function(e){var t=e.scene.scene.key;console.info("%cScene pause","color: #D27D2D",t),n.game.events.emit(Phaser.Scenes.Events.PAUSE,t)},n.emitGameEventResumeScene=function(e){var t=e.scene.key;console.info("%cScene resume","color: #D27D2D",t),n.game.events.emit(Phaser.Scenes.Events.RESUME,t)},n.emitGameEventShutdownScene=function(e){var t=e.scene.scene.key;console.info("%cScene shutdown","color: #D27D2D",t),n.game.events.emit(Phaser.Scenes.Events.SHUTDOWN,t)},n}(0,a.Z)(t,e);var n=t.prototype;return n.init=function(){this.listenScenesEvents(),this.game.globalScene=this,this.backgroundMaskManager=new v},n.setup=function(){this.scaleGame(),this.addMask(),this.addNotifyScreen(),this.addCloseableNotifyScreen(),this.addFPS(),this.addMemory()},n.addNotifyScreen=function(){this.screen.add(d.o4.NOTIFY_SCREEN,O.Z)},n.addCloseableNotifyScreen=function(){this.screen.add(d.o4.CLOSEABLE_NOTIFY_SCREEN,k)},n.addMask=function(){this.mask=this.make.image({key:B,frame:M.BLANK});var e=this.gameZone,t=e.width,n=e.height;this.mask.setAlpha(0),this.mask.setOrigin(0,0),this.mask.setTint(0),this.mask.setWorldSize(t,n)},n.addFPS=function(){GameCore.Configs.Statistics.ShowFPSInGame&&(this.fpsMeter=new b(this),this.fpsMeter.setDepth(l.Z.ON_TOP),Phaser.Display.Align.In.TopLeft(this.fpsMeter,this.gameZone,-20,-10))},n.addMemory=function(){GameCore.Configs.Statistics.ShowMemoryInGame&&(this.memoryMeter=new P(this),Phaser.Display.Align.In.TopLeft(this.memoryMeter,this.gameZone,-45,-3))},n.updateSceneState=function(){this.setGlobalSceneOnTop()},n.setGlobalSceneOnTop=function(){this.scene.bringToTop(this)},n.runMaskFadeInAnimation=function(){var e,t;this.mask&&GameCore.Configs.EnableEffectSceneTransition&&(null==(e=this.fadeInAnim)||e.remove(),null==(t=this.fadeOutAnim)||t.remove(),this.fadeInAnim=new o.Z({targets:[this.mask],duration:400,ease:Phaser.Math.Easing.Cubic.In,props:{alpha:{start:0,from:0,to:.6}}}),this.mask.setAlpha(0),this.fadeInAnim.play())},n.runMaskFadeOutAnimation=function(){var e,t;this.mask&&GameCore.Configs.EnableEffectSceneTransition&&(null==(e=this.fadeInAnim)||e.remove(),null==(t=this.fadeOutAnim)||t.remove(),this.fadeOutAnim=new c.Z({targets:[this.mask],duration:400,ease:Phaser.Math.Easing.Cubic.Out,props:{alpha:{start:.6,from:.6,to:0}}}),this.mask.setAlpha(1),this.fadeOutAnim.play())},n.listenScenesEvents=function(){var e=this;this.scene.manager.getScenes(!1).forEach((function(t){t.events.on(Phaser.Scenes.Events.CREATE,e.emitGameEventStartScene),t.events.on(Phaser.Scenes.Events.SLEEP,e.emitGameEventSleepScene),t.events.on(Phaser.Scenes.Events.WAKE,e.emitGameEventWakeScene),t.events.on(Phaser.Scenes.Events.PAUSE,e.emitGameEventPauseScene),t.events.on(Phaser.Scenes.Events.RESUME,e.emitGameEventResumeScene),t.events.on(Phaser.Scenes.Events.SHUTDOWN,e.emitGameEventShutdownScene)})),this.events.on(h.K.RUN,this.runScene),this.events.on(h.K.SLEEP,this.sleepScene),this.events.on(h.K.SWITCH,this.switchScene)},n.getActiveScene=function(){return this.scene.manager.getScenes(!0)[0]},n.getCurrentScene=function(){return this.currentScene},n.requestBackgroundMaskUpdate=function(e,t){this.backgroundMaskManager.requestBackgroundMaskUpdate(e,t)},n.recalculateBackgroundMask=function(){this.backgroundMaskManager.updateBackgroundMask()},n.updateActiveSceneKey=function(e){e!==h.C.GLOBAL_SCENE&&this.storage.dispatch((0,A.I)(e))},n.logEventOpen=function(){},n.logPageviewOnOpen=function(){},(0,i.Z)(t,[{key:"currentScene",get:function(){var e=this.storage.getState(),t=S(e);return(t?this.scene.manager.getScene(t):this.getActiveScene()).scene}}]),t}(T.Z),U=x},630:function(e,t,n){"use strict";n.d(t,{Z:function(){return p}});var i=n(1),a=n(129),s=n(128),r=n(34),o=n(2),c=n(24),l=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).payload=void 0,i.background=void 0,i.shadow=void 0,i.payload=n,i.createBackground(),i.createShadow(),i}(0,i.Z)(t,e);var n=t.prototype;return n.createBackground=function(){var e=this.payload,t=e.width,n=e.height,i=-t/2,a=-n/2;this.background=this.scene.add.graphics(),this.background.fillStyle(657688,1),this.background.fillRect(i,a,t,n),this.background.lineStyle(2,65794),this.background.strokeRect(i,a,t,n),this.add(this.background)},n.createShadow=function(){var e=this.payload,t=e.width,n=e.height,i=-t/2,a=-n/2+n;this.shadow=this.scene.add.graphics(),this.shadow.fillStyle(397608,.8),this.shadow.fillRect(i,a,t,5),this.add(this.shadow)},t}(Phaser.GameObjects.Container),u=o.Z.DEFAULT_8_BIT,h=u.KEY,d=u.FRAME,p=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t,n,i,a)||this).board=void 0,s.notifyIcon=void 0,s.loadingIcon=void 0,s.titleText=void 0,s.messageText=void 0,s.openAnimation=void 0,s.closeTimerEvent=void 0,s.addBoard(),s.addNotifyIcon(),s.addLoadingIcon(),s.addTitleText(),s.addMessageText(),s.setDepth(c.Ks.PRIORITY),s.background.setAlpha(.8),s}(0,i.Z)(t,e);var n=t.prototype;return n.open=function(t){var n,i=this;e.prototype.open.call(this,t),this.scene.requestBackgroundMaskUpdate(c.o4.NOTIFY_SCREEN,this.background.alpha);var a=this.getData(["title","message","duration","loading"]),s=a[0],r=void 0===s?"":s,o=a[1],l=void 0===o?"":o,u=a[2],h=void 0===u?0:u,d=a[3],p=void 0!==d&&d;this.setTitle(r),this.setMessage(l),this.showLoading(p),null==(n=this.closeTimerEvent)||n.remove(),h>0&&(this.closeTimerEvent=this.scene.time.addEvent({delay:h,callback:function(){i.visible&&i.scene.screen.close(i.name)}})),this.runOpenAnimation()},n.addBoard=function(){this.board=new l(this.scene,{width:this.zone.width,height:300}),Phaser.Display.Align.In.Center(this.board,this.zone),this.add(this.board),this.board.kill()},n.close=function(){e.prototype.close.call(this),this.scene.requestBackgroundMaskUpdate(c.o4.NOTIFY_SCREEN,0)},n.addNotifyIcon=function(){this.notifyIcon=this.scene.make.image({key:h,frame:d.ICON_ALERT}),this.notifyIcon.setWorldSize(125.5,106),this.add(this.notifyIcon),Phaser.Display.Align.In.Center(this.notifyIcon,this.zone,0,-90)},n.addLoadingIcon=function(){this.loadingIcon=new s.Z(this.scene),this.add(this.loadingIcon),Phaser.Display.Align.In.Center(this.loadingIcon,this.zone,0,-30)},n.addTitleText=function(){this.titleText=this.scene.make.bitmapText({size:this.scene.fontSize(26),font:r.Z.PRIMARY.KEY,origin:{x:.5,y:.5}}),this.titleText.setTint(11482972),this.titleText.setCenterAlign(),this.titleText.setMaxWidth(this.width),Phaser.Display.Align.In.Center(this.titleText,this.zone,0,10),this.add(this.titleText)},n.addMessageText=function(){this.messageText=this.scene.make.bitmapText({size:this.scene.fontSize(22),font:r.Z.PRIMARY.KEY,origin:{x:.5,y:.5}}),this.messageText.setCenterAlign(),Phaser.Display.Align.In.Center(this.messageText,this.zone,0,90),this.add(this.messageText)},n.setTitle=function(e){this.titleText.setText(e)},n.setMessage=function(e){this.messageText.setText(e)},n.showLoading=function(e){this.titleText.setVisible(!e),this.notifyIcon.setVisible(!e),this.loadingIcon.setVisible(e)},n.runOpenAnimation=function(){var e,t;null==(e=this.openAnimation)||e.stop(),null==(t=this.openAnimation)||t.remove(),this.openAnimation=new a.Z({targets:[this.notifyIcon],props:{scale:{getStart:function(e){return e.scale-.3},getEnd:function(e){return e.scale}}}}),this.openAnimation.play()},n.logPageviewOnOpen=function(){},n.logPageviewOnClose=function(){},t}(GameCore.Screen)},661:function(e,t,n){"use strict";var i=n(1),a=n(662),s=n(2),r=n(30),o=n(24),c=s.Z.DEFAULT_8_BIT,l=c.KEY,u=c.FRAME,h=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t,n,i,a)||this).progressBar=void 0,s.background.setAlpha(.8),s.setDepth(o.Ks.SPLASH),s.createTitleIcon(),s.createProgressBar(),s.scene.game.scene.getScene(r.C.LOAD_SCENE).load.on(Phaser.Loader.Events.PROGRESS,(function(e){s.progressBar.setProcess(e)})),s}(0,i.Z)(t,e);var n=t.prototype;return n.open=function(t){var n=this;e.prototype.open.call(this,t),this.progressBar.setProcess(0,!0),this.scene.requestBackgroundMaskUpdate(o.o4.LOADING_SCREEN,.8),this.scene.time.delayedCall(200,(function(){n.progressBar.setProcess(.2)}))},n.close=function(){var t=this;this.scene.scene.resume(r.C.GAME_SCENE),this.scene.time.delayedCall(600,(function(){var n=t.scene;n.requestBackgroundMaskUpdate(o.o4.LOADING_SCREEN,0);var i=t.scene.screen.get(o.o4.BATTLE_SCREEN);i&&!i.visible&&n.requestBackgroundMaskUpdate(o.o4.BATTLE_SCREEN,0);var a=t.scene.screen.get(o.o4.LEADER_BOARD_SCREEN);a&&!a.visible&&n.requestBackgroundMaskUpdate(o.o4.LEADER_BOARD_SCREEN,0),t.progressBar.setProcess(1),e.prototype.close.call(t)}))},n.createTitleIcon=function(){var e=this.scene.make.image({key:l,frame:u.ICON_TITLE});e.setWorldSize(213.5,157.5),Phaser.Display.Align.In.Center(e,this,0,-150),this.add(e)},n.createProgressBar=function(){this.progressBar=new a.Z(this.scene,450),this.progressBar.setScale(.6),Phaser.Display.Align.In.Center(this.progressBar,this),this.add(this.progressBar)},t}(GameCore.Screen);t.Z=h},660:function(e,t,n){"use strict";n.d(t,{Z:function(){return $}});var i=n(20),a=n(5),s=n(1),r=n(18),o=n.n(r),c=n(53),l=n.n(c),u=n(31),h=n.n(u),d=n(38),p=n(67),f=n(129),g=n(24),E=n(25),m=n(478),v=n(113),A=n(126),S=n(112),T=n(111),y=n(30),C=n(65),I=n(17),R=n(68),w=n(58),_=n(34),b=n(2),L=b.Z.DEFAULT_8_BIT,P=L.KEY,O=L.FRAME,D=function(e){function t(t){var n;return(n=e.call(this,t,P,O.OFFLINE_REWARD_GREEN_BTN,128.5,45.5)||this).createCoinIcon(),n.createText(),n}(0,s.Z)(t,e);var n=t.prototype;return n.createCoinIcon=function(){var e=this.scene.make.image({key:P,frame:O.OFFLINE_REWARD_GOLD});e.setWorldSize(32.5,30.5),e.setPosition(-35,0),this.add(e)},n.createText=function(){var e=15;switch(this.scene.lang.getCurrentLanguage()){case"de":case"it":e=13}var t=this.scene.make.text({text:this.scene.lang.Text.COLLECT,style:{fontSize:e+"px",stroke:"#000000",strokeThickness:2,color:"#FFFFFF",fixedWidth:195,align:"center",fontFamily:_.Z.FONT_FAMILY},origin:{x:.5,y:.65}});t.setHighQuality(),t.setShadow(-8,8,"#000000",0,!0),Phaser.Display.Align.In.RightCenter(t,this.button,0,0),t.setPosition(15,0),this.add(t)},t}(w.Z),k=b.Z.DEFAULT_8_BIT,N=k.KEY,B=k.FRAME,M=function(e){function t(t){var n;return(n=e.call(this,t)||this).icon=void 0,n.text=void 0,n.createIcon(),n.createCoinText(),n.scene.add.existing((0,a.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.createIcon=function(){var e=this.scene.make.image({key:N,frame:B.OFFLINE_REWARD_GOLDS});e.setWorldSize(55,39.5),e.setPosition(50,0),this.add(e),this.icon=e},n.createCoinText=function(){var e=this.scene.make.text({text:"+100 coins",style:{fontSize:"35px",stroke:"#000000",strokeThickness:1,color:"#F0DB0F",fixedWidth:455,align:"center",fontFamily:_.Z.FONT_FAMILY},origin:{x:.5,y:.5}});e.setHighQuality(),e.setShadow(-8,8,"#000000",0,!0),e.setPosition(-30,0),this.add(e),this.text=e},n.setText=function(e){this.text.setText("+"+e)},t}(Phaser.GameObjects.Container),x=b.Z.DEFAULT_8_BIT,U=x.KEY,F=x.FRAME,Z=function(e){function t(t){var n;return(n=e.call(this,t)||this).createRibbon(),n.createTitle(),n.scene.add.existing((0,a.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.createRibbon=function(){var e=this.scene.make.image({key:U,frame:F.OFFLINE_REWARD_RIBBON});e.setWorldSize(247,43.5),this.add(e)},n.createTitle=function(){var e=this.scene.make.text({text:this.scene.lang.Text.OFFLINE_COINS_REWARDS,style:{fontSize:"15px",color:"#ffffff",stroke:"#000000",strokeThickness:2,fixedWidth:195,align:"center",fontFamily:_.Z.FONT_FAMILY},origin:{x:.5,y:.5}});e.setHighQuality(),e.setShadow(-8,8,"#000000",0,!0),e.setPosition(0,-4),this.add(e)},n.createUnderlineText=function(){var e=this.scene.make.text({text:"Get Free Coins!",style:{fontSize:"12px",color:"#D5330F",fixedWidth:130,align:"center",fontFamily:_.Z.FONT_FAMILY},origin:{x:.5,y:.5}});e.setHighQuality(),e.setPosition(0,5),this.add(e)},t}(Phaser.GameObjects.Container),G=n(490),H=b.Z.DEFAULT_8_BIT,Y=H.KEY,K=H.FRAME,V=function(e){function t(t){var n;return(n=e.call(this,t)||this).listParticle=[],n.backEffect=void 0,n.tween=void 0,n.backEffectTween=void 0,n.createBackEffect(),n.createTicketCoin(),n.createParticle(),n.createAnimation(),n.scene.add.existing((0,a.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.createBackEffect=function(){var e=new G.Z(this.scene,{color:234748,width:{min:4,max:8},radius:{min:180,max:170},lineNumber:18});e.setPosition(0,110),this.add(e),this.backEffect=e},n.createTicketCoin=function(){var e=this.scene.make.image({key:Y,frame:K.OFFLINE_REWARD_TICKET});e.setWorldSize(155.5,124.5),e.setPosition(0,110),this.add(e)},n.createParticle=function(){var e=this.scene.make.image({key:Y,frame:K.OFFLINE_REWARD_PARTICLE_1});e.setWorldSize(23,23),e.setPosition(-102,100),this.add(e),this.listParticle.push(e),(e=this.scene.make.image({key:Y,frame:K.OFFLINE_REWARD_PARTICLE_1})).setWorldSize(23,23),e.setPosition(78,156),this.add(e),this.listParticle.push(e),(e=this.scene.make.image({key:Y,frame:K.OFFLINE_REWARD_PARTICLE_2})).setWorldSize(14.5,15),e.setPosition(-90,129),this.add(e),this.listParticle.push(e),(e=this.scene.make.image({key:Y,frame:K.OFFLINE_REWARD_PARTICLE_2})).setWorldSize(14.5,15),e.setPosition(100,110),this.add(e),this.listParticle.push(e),this.listParticle.push(e)},n.createAnimation=function(){var e=this.listParticle[0].scale;this.tween=this.scene.add.tween({paused:!0,targets:this.listParticle,duration:800,ease:Phaser.Math.Easing.Cubic.Out,repeat:-1,yoyo:!0,delay:this.scene.tweens.stagger(50,{start:50*Math.random()+50}),props:{scale:{from:e,to:e*Phaser.Math.FloatBetween(.7,.9)}}}),this.backEffectTween=this.scene.add.tween({paused:!0,targets:this.backEffect,duration:1e6,ease:Phaser.Math.Easing.Linear,repeat:-1,props:{rotation:{start:0,to:180}}})},n.runAnimation=function(){this.tween.resume(),this.backEffectTween.resume()},n.stopAnimation=function(){this.tween.pause(),this.backEffectTween.pause()},t}(Phaser.GameObjects.Container),W=b.Z.DEFAULT_8_BIT,j=W.KEY,z=W.FRAME,X=function(e){function t(t){var n;return(n=e.call(this,t,j,z.OFFLINE_REWARD_YELLOW_BTN,128.5,45.5)||this).createCoinIcon(),n.createText(),n}(0,s.Z)(t,e);var n=t.prototype;return n.createCoinIcon=function(){var e=this.scene.make.image({key:j,frame:z.OFFLINE_REWARD_ADS});e.setWorldSize(32,30),e.setPosition(-40,-3),this.add(e)},n.createText=function(){var e=15;switch(this.scene.lang.getCurrentLanguage()){case"pt":case"es":e=12;break;case"de":case"it":e=13}var t=this.scene.make.text({text:this.scene.lang.Text.X2_COINS,style:{fontSize:e+"px",stroke:"#000000",strokeThickness:2,color:"#FFFFFF",fixedWidth:195,align:"center",fontFamily:_.Z.FONT_FAMILY},origin:{x:.5,y:.65}});t.setHighQuality(),t.setShadow(-8,8,"#000000",0,!0),Phaser.Display.Align.In.RightCenter(t,this.button,0,0),t.setPosition(15,0),this.add(t)},t}(w.Z),q=GameCore.Configs.Network,Q=C.Z.LEVEL_PROGRESS,J=C.Z.PLAYER_UNIT_DATA,$=function(e){function t(t,n,s,r){var c;return(c=e.call(this,t,n,s,r)||this).rewardValue=void 0,c.closeBtn=void 0,c.collectButton=void 0,c.viewAdButton=void 0,c.coinIcon=void 0,c.contents=void 0,c.title=void 0,c.popup=void 0,c.popupFadeOutAnimation=void 0,c.showUpAnimation=void 0,c.contentShowUpAnimation=void 0,c.adsTimer=void 0,c.open=function(t){e.prototype.open.call((0,a.Z)(c),t);var n=c.scene.scene.get(y.C.GAME_SCENE);n instanceof R.Z&&n.screenManager.listenResizeEventForCalculateLight((0,a.Z)(c)),c.scene.ads.canbeShowRewardAd()?c.viewAdButton.setDisabled(!1):c.viewAdButton.setDisabled(!0);var i=c.getData("rewardValue");c.setRewardValue(c.calculateRewardCoins(i)),c.runOpenAnimation(),c.scene.storage.dispatch((0,m.CF)())},c.handleClosePopup=function(){c.runCloseAnimation(),c.rewardCoins(c.rewardValue)},c.handleShowRewardedVideoAd=(0,i.Z)(o().mark((function e(){var t,n,i,a,s,r,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=null,n=c.scene,i=n.audio,a=n.game,e.prev=2,c.viewAdButton.setDisabled(!0),t=a.globalScene.time.delayedCall(200,(function(){a.globalScene.screen.open(g.o4.NOTIFY_SCREEN,{message:a.lang.Text.LOADING_ADS,duration:0,loading:!0})})),i.muteAll(),e.next=8,new(l())((function(e,t){var n;null==(n=c.adsTimer)||n.remove(),c.adsTimer=c.scene.time.delayedCall(q.Timeout,t),c.scene.ads.getAdStatus(GameCore.Ads.Types.REWARDED)===GameCore.Ads.Status.LOADING?c.scene.ads.events.once(GameCore.Ads.Events.LOADED,e):c.scene.ads.preloadRewardedVideoAsync().then(e).catch(t)}));case 8:return e.next=10,c.scene.ads.showRewardedVideoAsync();case 10:c.scene.audio.playSound(E.Z.DAILY_REWARD),(s=c.rewardValue.clone()).multiply(2),c.rewardCoins(s),c.runCloseAnimation(),e.next=24;break;case 17:if(e.prev=17,e.t0=e.catch(2),console.info("\ud83d\ude80 > showRewardedAdAsync",e.t0),!(e.t0 instanceof Object&&GameCore.Utils.Object.hasOwn(e.t0,"code")&&"USER_INPUT"===e.t0.code)){e.next=23;break}return c.showNotifySkipAds(),e.abrupt("return");case 23:c.showNotifyNoAds();case 24:return e.prev=24,null==(r=c.adsTimer)||r.destroy(),i.unmuteAll(),c.viewAdButton.setDisabled(!1),null==(u=t)||u.remove(),a.globalScene.screen.close(g.o4.NOTIFY_SCREEN),c.scene.ads.preloadRewardedVideoAsync().catch((function(e){})),e.finish(24);case 32:case"end":return e.stop()}}),e,null,[[2,17,24,32]])}))),c.showNotifyNoAds=function(e){if(!e||e.name===g.o4.CLOSEABLE_NOTIFY_SCREEN){var t=c.scene.game.globalScene;t.screen.open(g.o4.CLOSEABLE_NOTIFY_SCREEN,{message:t.lang.Text.NO_ADS_TO_DISPLAY,duration:1500,loading:!1})}},c.showNotifySkipAds=function(){var e=c.scene.game.globalScene;e.screen.open(g.o4.CLOSEABLE_NOTIFY_SCREEN,{message:e.lang.Text.SORRY_NO_REWARDS,duration:1500,loading:!1})},c.runCloseAnimation=function(){c.runExitsAnimation(0,200)},c.setName(n),c.setDepth(g.Ks.POPUP),c.background.setAlpha(.7),c.createPopup(),c.createTicketCoinIcon(),c.createCloseBtn(),c.createContents(),c.createTitle(),c.createCollectButton(),c.createViewAdsButton(),c}(0,s.Z)(t,e);var n=t.prototype;return n.createPopup=function(){this.popup=new T.Z(this.scene,{x:0,y:0,width:332,height:404.5,rightEdge:870778,bottomRightCorner:221341,topInnerCornerStrokeWidth:2,rightInnerCornerStrokeWidth:3,lightY:-80}),this.add(this.popup)},n.recalculateLightPosition=function(){this.popup&&this.popup.recalculateLightPosition()},n.createTicketCoinIcon=function(){var e=new V(this.scene);Phaser.Display.Align.In.TopCenter(e,this.popup,0,-30),this.add(e),this.coinIcon=e},n.createCloseBtn=function(){var e=new S.Z(this.scene);e.onClick=this.handleClosePopup,Phaser.Display.Align.In.TopRight(e,this.popup,10,10),this.popup.add(e),this.closeBtn=e},n.createContents=function(){var e=new M(this.scene);Phaser.Display.Align.In.Center(e,this.popup,0,60),this.add(e),this.contents=e},n.createTitle=function(){var e=new Z(this.scene);Phaser.Display.Align.In.TopCenter(e,this.popup,0,-10),this.add(e),this.title=e},n.createCollectButton=function(){var e=new D(this.scene);e.setName("Collect"),e.onClick=this.handleClosePopup,Phaser.Display.Align.In.BottomCenter(e,this.popup,-70,-20),this.add(e),this.collectButton=e},n.createViewAdsButton=function(){var e=new X(this.scene);e.setName("CollectX2"),e.onClick=this.handleShowRewardedVideoAd,Phaser.Display.Align.In.BottomCenter(e,this.popup,70,-20),this.add(e),this.viewAdButton=e},n.logButtonEvent=function(e){var t=this.getScreenName();this.scene.analytics.event(d._.BUTTON_CLICK,{button_name:e,screen_name:t})},n.runOpenAnimation=function(){this.scene.requestBackgroundMaskUpdate(g.o4.OFFLINE_REWARD_SCREEN,this.background.alpha),this.runPopupEntrancesAnimation(),this.runPopupContentEntrancesAnimation(100,400)},n.runPopupEntrancesAnimation=function(){this.showUpAnimation||(this.showUpAnimation=new v.Z({targets:[this.popup,this.title]})),this.showUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(e,t){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.coinIcon.runAnimation();var i=[this.collectButton,this.viewAdButton,this.contents],a=h()(i).call(i,(function(e){return e.alpha}));i.forEach((function(e){return e.setAlpha(0)})),this.contentShowUpAnimation=new f.Z({targets:i,duration:t,delay:this.scene.tweens.stagger(100,{start:e}),props:{scale:{getStart:function(e){return e.scale-.3},getEnd:function(e){return e.scale}},alpha:{getStart:function(){return 0},getEnd:function(e,t,n,i){return a[i]}}}}),this.contentShowUpAnimation.play()},n.rewardCoins=function(e){var t=e;this.scene.coin.plusCoins(t.baseValue,t.suffix);var n=this.scene.scene.get(y.C.GAME_SCENE);n instanceof R.Z&&n.updateUI()},n.calculateRewardCoins=function(e){var t=new A.Z(e),n=new A.Z(I.Z.BASE_UNIT_COIN),i=this.calculateRewardModifier();return t.multiply(i),t.divide(60),t.smallerThan(n)&&(t=n),t},n.calculateRewardModifier=function(){var e=this.calculateLevelModifier(),t=this.calculateUsedUnit();return e.multiply(t),e.multiply(I.Z.BASE_UNIT_COIN),e},n.calculateLevelModifier=function(){var e=this.scene.player.getCustomData(Q);e<0&&(e=0),e++;var t=I.Z.UNIT_COIN_SCALE;if(e<=50){var n=Math.pow(t,e),i=new A.Z(1);return i.multiply(n),i}for(var a=Math.pow(t,50),s=Math.floor(e/50),r=e%50,o=new A.Z(1),c=0;c<s;c++)o.multiply(a);var l=Math.pow(t,r);return o.multiply(l),o},n.calculateUsedUnit=function(){var e=this.scene.player.getCustomData(J);if(!e||"string"!==typeof e)return 1;var t=e.split("/"),n=0,i=0;return t.forEach((function(e){e.split("-").forEach((function(e){if("0"!==e){var t=e[0],a=parseInt(e.substring(1));"m"===t&&(n+=Math.pow(2,a-1)),"r"===t&&(i+=Math.pow(2,a-1))}}))})),n>i?n:i},n.runExitsAnimation=function(e,t){var n=this;this.collectButton.setDisabled(!0),this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new p.Z({targets:[this.background],delay:e,duration:t,props:{alpha:{start:.7,from:.7,to:0}},ease:Phaser.Math.Easing.Cubic.Out,onActive:function(){n.coinIcon.kill(),n.contents.kill(),n.title.kill(),n.popup.kill(),n.collectButton.kill(),n.viewAdButton.kill()},onUpdate:function(e,t){n.scene.requestBackgroundMaskUpdate(g.o4.OFFLINE_REWARD_SCREEN,t.alpha)},onComplete:function(){n.coinIcon.revive(),n.contents.revive(),n.title.revive(),n.popup.revive(),n.collectButton.revive(),n.viewAdButton.revive();var e=n.scene.scene.get(y.C.GAME_SCENE);e instanceof R.Z&&e.screenManager.removeResizeEventForCalculateLight(n),n.scene.screen.close(n.name),n.collectButton.setDisabled(!1),n.coinIcon.stopAnimation(),n.background.setAlpha(.7)}})),this.popupFadeOutAnimation.play()},n.setRewardValue=function(e){this.rewardValue=e,this.contents.setText(e.toString())},t}(GameCore.Screen)},649:function(e,t,n){"use strict";n.d(t,{Z:function(){return N}});var i=n(20),a=n(1),s=n(31),r=n.n(s),o=n(18),c=n.n(o),l=n(111),u=n(57),h=n(38),d=n(86),p=n(34),f=n(2),g=f.Z.DEFAULT,E=g.KEY,m=g.FRAME,v=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).icon=void 0,i.label=void 0,i.switch=void 0,i.hitZone=void 0,i.isSwitchOn=void 0,i.payload=void 0,i.parentName=void 0,i.payload=n,i.setName("SettingSwitch"),i.createHitZone(),i.createIcon(),i.createLabel(),i.createSwitch(),i}(0,a.Z)(t,e);var n=t.prototype;return n.setSwitch=function(e){e?(this.switch.setFrame(m.SETTINGS_SWITCH_ON),this.switch.setWorldSize(37.5,22)):(this.switch.setFrame(m.SETTINGS_SWITCH_OFF),this.switch.setWorldSize(37,21.5)),this.isSwitchOn=e},n.createIcon=function(){this.icon=this.scene.make.image({key:this.payload.iconKey,frame:this.payload.icon}),this.icon.setWorldSize(this.payload.iconWidth,this.payload.iconHeight),this.add(this.icon),Phaser.Display.Align.In.LeftCenter(this.icon,this.hitZone,this.payload.iconLeftOffset)},n.createLabel=function(){var e=this.scene.make.text({text:this.payload.label,style:{fontSize:"15px",color:"#FFFFFF",fontFamily:p.Z.FONT_FAMILY,fixedWidth:100},origin:{x:0,y:.5}});e.setName("label"),e.setHighQuality(),this.add(e),e.setX(this.payload.localTextX),this.label=e},n.createSwitch=function(){this.switch=this.scene.make.image({key:E}),this.setSwitch(!1),Phaser.Display.Align.In.RightCenter(this.switch,this.hitZone),this.add(this.switch)},n.createHitZone=function(){this.hitZone=this.scene.add.zone(0,0,180,45),this.add(this.hitZone)},n.logButtonEvent=function(e){var t=this.getParentName(),n=this.name;this.scene.analytics.event(h._.BUTTON_CLICK,{button_name:n,value:e?"on":"off",screen_name:t})},n.getParentName=function(){if(this.parentName)return this.parentName;for(var e=this.parentContainer;e;){if(e instanceof GameCore.Screen){var t=e;return this.parentName=t.getScreenName(),this.parentName}e=e.parentContainer}return this.parentName=this.scene.getSceneName(),this.parentName},n.setDisabled=function(e){var t,n;e?(null==(t=this.hitZone)||t.disableInteractive(),this.setAlpha(.5)):(null==(n=this.hitZone)||n.setInteractive(),this.setAlpha(1))},(0,u.Z)(t,[{key:"onClick",set:function(e){var t=this;this.hitZone.removeAllListeners(),this.hitZone.setInteractive({useHandCursor:!0}),this.hitZone.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,(function(){var n=!t.isSwitchOn;t.logButtonEvent(n),t.setSwitch(n),e(n),(0,d.ZP)(50)}))}}]),t}(Phaser.GameObjects.Container),A=n(113),S=n(67),T=n(129),y=n(112),C=n(30),I=n(24),R=n(25),w=n(68),_=n(58),b=f.Z.DEFAULT,L=b.KEY,P=b.FRAME,O=f.Z.DEFAULT_8_BIT,D=O.KEY,k=O.FRAME,N=function(e){function t(t,n,a,s){var r;return(r=e.call(this,t,n,a,s)||this).popup=void 0,r.sound=void 0,r.music=void 0,r.vibration=void 0,r.speedUp=void 0,r.shareBtn=void 0,r.title=void 0,r.showUpAnimation=void 0,r.contentShowUpAnimation=void 0,r.fadeOutAnimation=void 0,r.handleChangeSound=function(e){r.scene.audio.playSound(R.Z.TURN_SWITCH),r.scene.player.setSetting("sound",e)},r.handleChangeMusic=function(e){r.scene.audio.playSound(R.Z.TURN_SWITCH),r.scene.player.setSetting("music",e),e?r.scene.audio.playMusic():r.scene.audio.pauseMusic()},r.handleChangeVibration=function(e){r.scene.audio.playSound(R.Z.TURN_SWITCH),r.scene.player.setSetting("vibrate",e),(0,d.wT)(e)},r.handleChangeSpeedUp=function(e){r.scene.audio.playSound(R.Z.TURN_SWITCH),r.scene.player.setSetting("speedUp",e)},r.handleShareGame=(0,i.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.GameSDK.shareAsync({data:"",intent:"SHARE",image:"",text:"\u041f\u0440\u0438\u0445\u043e\u0434\u0438 \u0438 \u0438\u0433\u0440\u0430\u0439 \u0432 \u0414\u0438\u043d\u043e\u0437\u0430\u0432\u0440\u043e\u0432\u0440\u044b \u041c\u0430\u0441\u0442\u0435\u0440 \u0421\u043e\u0432\u043c\u0435\u0449\u0435\u043d\u0438\u0439 \u0441\u043e \u043c\u043d\u043e\u0439!"});case 2:case"end":return e.stop()}}),e)}))),r.handleClosePopup=function(){r.runFadeOutAnimation()},r.scene=t,r.background.setAlpha(.7),r.setSize(r.scene.gameZone.displayWidth,r.scene.gameZone.displayHeight),r.createPopup(),r.createCloseButton(),r.createTitle(),r.createContent(),r}(0,a.Z)(t,e);var n=t.prototype;return n.open=function(){e.prototype.open.call(this);var t=this.scene.scene.get(C.C.GAME_SCENE);t instanceof w.Z&&t.screenManager.listenResizeEventForCalculateLight(this),this.scene.requestBackgroundMaskUpdate(I.o4.SETTINGS_SCREEN,this.background.alpha),this.runOpenAnimation();var n=!!this.scene.player.getPlayerSetting("sound");this.sound.setSwitch(n);var i=!!this.scene.player.getPlayerSetting("music");if(this.music.setSwitch(i),GameCore.Utils.Device.isDesktop()){var a=!!this.scene.player.getPlayerSetting("speedUp");this.speedUp.setSwitch(a)}else if((0,d.O2)()){var s=!!this.scene.player.getPlayerSetting("vibrate");this.vibration.setSwitch(s)}},n.createPopup=function(){this.popup=new l.Z(this.scene,{x:0,y:0,width:261.5,height:323,rightEdge:870778,topInnerCornerStrokeWidth:2,rightInnerCornerStrokeWidth:3,lightY:-40}),this.add(this.popup)},n.recalculateLightPosition=function(){this.popup&&this.popup.recalculateLightPosition()},n.createCloseButton=function(){var e=new y.Z(this.scene);e.setName("button"),Phaser.Display.Align.In.TopRight(e,this.popup,10,10),this.popup.add(e),e.onClick=this.handleClosePopup},n.createTitle=function(){var e=this.scene.make.text({text:this.scene.lang.Text.SETTINGS,style:{fontSize:"22px",stroke:"#000000",strokeThickness:2,color:"#FFFFFF",fixedWidth:325,align:"center",fontFamily:p.Z.FONT_FAMILY}});e.setName("title"),e.setHighQuality(),e.setShadow(-8,8,"#000000",0,!0),this.add(e),Phaser.Display.Align.In.TopCenter(e,this.popup,0,-13);var t=this.scene.make.image({key:L,frame:P.TITLE_LINE});t.setWorldSize(235,23),this.popup.add(t),Phaser.Display.Align.In.BottomCenter(t,e,0,30),this.title=e},n.createContent=function(){this.createSoundSetting(),this.createMusicSetting(),GameCore.Utils.Device.isDesktop()?this.createSpeedUpSetting():(this.createVibrationSetting(),(0,d.O2)()||(this.vibration.setSwitch(!1),this.vibration.setDisabled(!0))),this.createShareButton()},n.createSoundSetting=function(){this.sound=new v(this.scene,{iconKey:D,icon:k.ICON_SOUND,iconWidth:26,iconHeight:24,iconLeftOffset:6,localTextX:-60,label:this.scene.lang.Text.SOUND_FX+"  "});var e=15;switch(this.scene.lang.getCurrentLanguage()){case"pt":e=13;break;case"es":e=11}this.sound.label.setFontSize(e),this.sound.setName("SettingSound"),this.add(this.sound),Phaser.Display.Align.In.Center(this.sound,this.popup,0,-75),this.sound.onClick=this.handleChangeSound;var t=this.scene.make.graphics({});t.fillStyle(16777215,.1),t.fillRect(-104.5,-.5,209,1),t.setPosition(0,-50),this.popup.add(t)},n.createMusicSetting=function(){this.music=new v(this.scene,{iconKey:D,icon:k.ICON_MUSIC,iconWidth:20,iconHeight:20,iconLeftOffset:3,localTextX:-60,label:this.scene.lang.Text.MUSIC+"      "}),this.music.setName("SettingMusic"),this.add(this.music),Phaser.Display.Align.In.Center(this.music,this.popup,0,-25),this.music.onClick=this.handleChangeMusic;var e=this.scene.make.graphics({});e.fillStyle(16777215,.1),e.fillRect(-104.5,-.5,209,1),e.setPosition(0,45.5),this.popup.add(e)},n.createVibrationSetting=function(){this.vibration=new v(this.scene,{iconKey:D,icon:k.ICON_VIBRATION,iconWidth:30.5,iconHeight:27.5,iconLeftOffset:10,localTextX:-60,label:""+this.scene.lang.Text.VIBRATION}),this.vibration.setName("SettingVibration"),this.add(this.vibration),Phaser.Display.Align.In.Center(this.vibration,this.popup,0,25),(0,d.O2)()&&(this.vibration.onClick=this.handleChangeVibration)},n.createSpeedUpSetting=function(){this.speedUp=new v(this.scene,{iconKey:D,icon:k.ICON_QUICK_FIGHT,iconWidth:19,iconHeight:24,iconLeftOffset:4,localTextX:-60,label:""+this.scene.lang.Text.QUICK_FIGHT});var e=15;switch(this.scene.lang.getCurrentLanguage()){case"ja":case"fr":e=13;break;case"de":e=11}this.speedUp.label.setFontSize(e),this.speedUp.setName("SettingSpeed"),this.add(this.speedUp),Phaser.Display.Align.In.Center(this.speedUp,this.popup,0,25),this.speedUp.onClick=this.handleChangeSpeedUp},n.createShareButton=function(){var e=new _.Z(this.scene,D,k.BUTTON_GREEN,143.5,57);e.setName("ShareLevel");var t=this.scene.make.text({text:this.scene.lang.Text.SHARE,style:{fontSize:"22px",stroke:"#000000",strokeThickness:2,color:"#FFFFFF",fontFamily:p.Z.FONT_FAMILY}});t.setHighQuality(),t.setShadow(-8,8,"#000000",0,!0),Phaser.Display.Align.In.Center(t,e,0,-3),e.add(t),this.add(e),Phaser.Display.Align.In.BottomCenter(e,this.popup,0,-20),e.onClick=this.handleShareGame,this.shareBtn=e},n.runOpenAnimation=function(){this.runPopupEntrancesAnimation(),this.runPopupContentEntrancesAnimation(100,400)},n.runPopupEntrancesAnimation=function(){this.showUpAnimation||(this.showUpAnimation=new A.Z({targets:[this.popup]})),this.showUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(e,t){var n;null==(n=this.contentShowUpAnimation)||n.remove();var i=[this.title,this.sound,this.music];this.speedUp&&i.push(this.speedUp),this.vibration&&i.push(this.vibration),i.push(this.shareBtn);var a=r()(i).call(i,(function(e){return e.alpha}));this.contentShowUpAnimation=new T.Z({targets:i,duration:t,delay:this.scene.tweens.stagger(100,{start:e}),props:{scale:{getStart:function(e){return e.scale-.3},getEnd:function(e){return e.scale}},alpha:{getStart:function(e){return e.setAlpha(0),0},getEnd:function(e,t,n,i){return a[i]}}}}),this.contentShowUpAnimation.play()},n.runFadeOutAnimation=function(){var e=this;this.fadeOutAnimation||(this.fadeOutAnimation=new S.Z({targets:[this.background],duration:200,ease:Phaser.Math.Easing.Cubic.Out,props:{alpha:{start:.7,from:.7,to:0}},onActive:function(){var t,n;e.popup.kill(),e.title.kill(),e.sound.kill(),e.music.kill(),null==(t=e.speedUp)||t.kill(),null==(n=e.vibration)||n.kill(),e.shareBtn.kill()},onUpdate:function(t,n){e.scene.requestBackgroundMaskUpdate(I.o4.SETTINGS_SCREEN,n.alpha)},onComplete:function(){var t,n;e.popup.revive(),e.title.revive(),e.sound.revive(),e.music.revive(),null==(t=e.speedUp)||t.revive(),null==(n=e.vibration)||n.revive(),e.shareBtn.revive();var i=e.scene.scene.get(C.C.GAME_SCENE);i instanceof w.Z&&i.screenManager.removeResizeEventForCalculateLight(e),e.background.setAlpha(.7),e.scene.screen.close(e.name)}})),this.fadeOutAnimation.play()},t}(GameCore.Screen)},663:function(e,t,n){"use strict";n.d(t,{Z:function(){return w}});var i=n(1),a=n(159),s=n(67),r=n(30),o=n(24),c=n(5),l=n(34),u=n(84),h=n(2),d=function(e){function t(t){var n;return(n=e.call(this,t,{size:120})||this).handleLoadComplete=function(e){if(n.scene){var t=n.payload.id;if(t&&t===e){var i=t,a=n.scene.textures.get(i);a&&a.key===i?n.setPhoto(a.key):n.setPhoto(u.Z.AVATAR.KEY)}}},n.avtFrame.kill(),n}return(0,i.Z)(t,e),t}(n(233).Z),p=h.Z.DEFAULT_8_BIT,f=p.KEY,g=p.FRAME,E=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).bg=void 0,i.avatar=void 0,i.playerName=void 0,i.level=void 0,i.tween=void 0,i.setName("PlayerCard"),i.createAvatar(),i.createFrame(n),i.updateSize(),i.createNameText(),i.createLevelText(),i.createAnimation(),i.scene.add.existing((0,c.Z)(i)),i}(0,i.Z)(t,e);var n=t.prototype;return n.updateData=function(e){var t=e.playerId,n=e.playerName,i=e.playerPhoto,a=e.playerLevel;this.playerName.setText(n||"Player"),this.level.setText("Lv. "+a),this.avatar.loadPhoto(t,i||u.Z.AVATAR.FILE)},n.createFrame=function(e){var t=e?g.CHALLENGE_GRADE_BLUE:g.CHALLENGE_GRADE_RED,n=this.scene.make.image({key:f,frame:t});n.setName("bg"),n.setWorldSize(119,153.5),this.add(n),this.bg=n},n.updateSize=function(){this.setSize(this.bg.displayWidth,this.bg.displayHeight)},n.createAvatar=function(){var e=new d(this.scene);e.setName("avatar"),e.setPosition(1,-18),this.add(e),this.avatar=e},n.createNameText=function(){var e=this.scene.make.text({text:"Player1",style:{fontSize:"13px",color:"#ffffff",stroke:"#000000",strokeThickness:2,fixedWidth:169,align:"center",fontFamily:l.Z.SYSTEM_FAMILY_FONT},origin:{x:.5,y:.5}});e.setHighQuality(),e.setShadow(0,8,"#000000",0,!0),e.setPosition(0,45),this.add(e),this.playerName=e},n.createLevelText=function(){var e=this.scene.make.text({text:"Lv. 1",style:{fontSize:"9px",color:"#ffffff",stroke:"#000000",strokeThickness:2,fixedWidth:117,align:"center",fontFamily:l.Z.FONT_FAMILY},origin:{x:.5,y:.5}});e.setHighQuality(),e.setShadow(0,8,"#000000",0,!0),e.setPosition(0,60),this.add(e),this.level=e},n.createAnimation=function(){this.tween=this.scene.add.tween({paused:!0,targets:[this.avatar,this.playerName,this.level],duration:800,ease:Phaser.Math.Easing.Cubic.Out,delay:this.scene.tweens.stagger(50,{start:50*Math.random()+50}),props:{alpha:{from:0,to:1}}})},n.runAnimation=function(e){var t=this;this.playerName.setAlpha(0),this.level.setAlpha(0),this.avatar.setAlpha(0),this.scene.time.delayedCall(e,(function(){t.tween.play()}))},t}(Phaser.GameObjects.Container),m=n(39),v={targets:[],repeat:3,duration:33,ease:Phaser.Math.Easing.Expo.InOut,props:{y:5},yoyo:!0},A=function(e){function t(t){var n,i,a;return(a=e.call(this,v,t)||this).targetY=void 0,a.shakeAmount=void 0,a.handleSwitchPosition=function(){var e;a.shakeAmount*=.7,null==(e=a.tween)||e.updateTo("y",a.targetY+a.shakeAmount)},null!=(n=a.config)&&n.props?(a.targetY=a.config.targets[0].y,a.shakeAmount=a.config.props.y-a.targetY,null==(i=a.tween)||i.on(Phaser.Tweens.Events.TWEEN_REPEAT,a.handleSwitchPosition),a):(0,c.Z)(a)}return(0,i.Z)(t,e),t}(m.Z),S=n(25),T=n(86),y=h.Z.DEFAULT_8_BIT,C=y.KEY,I=y.FRAME,R=function(e){function t(t){var n;return(n=e.call(this,t)||this).shape=void 0,n.glow=void 0,n.backEffect=void 0,n.energy=void 0,n.vs=void 0,n.fx1=void 0,n.fx2=void 0,n.mainTween=void 0,n.energyTween=void 0,n.fx1Tween=void 0,n.fx2Tween=void 0,n.glowTween1=void 0,n.glowTween2=void 0,n.onCompleteAnim=void 0,n.setName("VSComponent"),n.createShape(),n.createGlow(),n.createBackEffect(),n.createEnergy(),n.createVS(),n.createFx(),n.createAnimation(),n.scene.add.existing((0,c.Z)(n)),n}(0,i.Z)(t,e);var n=t.prototype;return n.createShape=function(){var e=this.scene.make.image({key:C,frame:I.CHALLENGE_SHAPE});e.setName("shape"),e.setWorldSize(204,123.5),this.add(e),this.shape=e},n.createGlow=function(){var e=this.scene.make.image({key:C,frame:I.CHALLENGE_GLOW});e.setName("glow"),e.setWorldSize(518,88.5),this.add(e),this.glow=e},n.createBackEffect=function(){var e=this.scene.make.image({key:C,frame:I.CHALLENGE_BACK_EFFECT});e.setName("backEffect"),e.setWorldSize(230,230),this.add(e),this.backEffect=e},n.createEnergy=function(){var e=this.scene.make.image({key:C,frame:I.CHALLENGE_ICON_ENERGY});e.setName("energy"),e.setWorldSize(96,106.5),e.setPosition(10,5),this.add(e),this.energy=e},n.createVS=function(){var e=this.scene.make.image({key:C,frame:I.CHALLENGE_VS});e.setName("vs"),e.setWorldSize(40.5,37.5),this.add(e),this.vs=e},n.createFx=function(){var e=this.scene.make.image({key:C,frame:I.CHALLENGE_FX});e.setName("fx1"),e.setWorldSize(371.5,59),e.setPosition(0,-31),this.add(e),this.fx1=e;var t=this.scene.make.image({key:C,frame:I.CHALLENGE_FX});t.setName("fx2"),t.setWorldSize(371.5,59),t.setPosition(0,26),this.add(t),this.fx2=t},n.createAnimation=function(){this.createMainTween(),this.createEnergyTween(),this.createFxTween(),this.createGlowTween()},n.createMainTween=function(){var e=this,t=this.vs.scale;this.mainTween=this.scene.add.tween({paused:!0,targets:this.vs,duration:500,ease:Phaser.Math.Easing.Cubic.Out,onActive:function(){e.vs.setTintFill(16777215),e.vs.setVisible(!0),e.vs.setAlpha(0),e.energyTween.resume()},props:{scale:{from:10*t,to:t},alpha:{from:0,to:1}},onComplete:function(){e.scene.audio.playSound(S.Z.THUNDER_SOUND),(0,T.ZP)(50),e.vs.clearTint(),e.fx1Tween.resume(),e.fx2Tween.resume(),e.glowTween1.resume()}})},n.createEnergyTween=function(){var e=this,t=this.energy,n=t.x,i=t.y;this.energyTween=this.scene.add.tween({paused:!0,targets:this.energy,duration:500,ease:Phaser.Math.Easing.Expo.In,onActive:function(){e.energy.setVisible(!0),e.energy.setAlpha(0)},props:{x:{from:n+50,to:n},y:{from:i-50,to:i},alpha:{from:0,to:1}},onComplete:function(){new A({targets:[e],repeat:5,duration:60,props:{y:e.y+5}}).play()}})},n.createFxTween=function(){var e=this,t=this.fx1.x;this.fx1Tween=this.scene.add.tween({paused:!0,targets:this.fx1,duration:500,ease:Phaser.Math.Easing.Cubic.Out,onActive:function(){e.fx1.setVisible(!0)},props:{x:{from:t-100,to:t},alpha:{from:0,to:1}}});var n=this.fx2.x;this.fx2Tween=this.scene.add.tween({paused:!0,targets:this.fx2,duration:500,ease:Phaser.Math.Easing.Cubic.Out,onActive:function(){e.fx2.setVisible(!0)},props:{x:{from:n+100,to:n},alpha:{from:0,to:1}}})},n.createGlowTween=function(){var e=this;this.glowTween1=this.scene.add.tween({paused:!0,targets:[this.backEffect,this.glow],duration:500,ease:Phaser.Math.Easing.Cubic.Out,onActive:function(){e.backEffect.setVisible(!0),e.glow.setVisible(!0)},props:{alpha:{from:0,to:1}},onComplete:function(){e.glowTween2.resume(),e.onCompleteAnim&&e.onCompleteAnim()}}),this.glowTween2=this.scene.add.tween({paused:!0,targets:this.backEffect,duration:1e6,ease:Phaser.Math.Easing.Linear,repeat:-1,props:{rotation:{start:0,to:180}}})},n.runAnimation=function(e){var t=this;this.vs.setVisible(!1),this.energy.setVisible(!1),this.fx1.setVisible(!1),this.fx2.setVisible(!1),this.glow.setVisible(!1),this.backEffect.setVisible(!1),this.scene.time.delayedCall(e,(function(){t.mainTween.resume()}))},n.stopAnimation=function(){this.glowTween2.pause()},t}(Phaser.GameObjects.Container),w=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t,n,i,a)||this).playerFrame=void 0,s.opponentFrame=void 0,s.vsComponent=void 0,s.backgroundFadeInAnimation=void 0,s.bgFadeOutAnimation=void 0,s.fadeOutAnimation=void 0,s.background.setAlpha(.8),s.setDepth(o.Ks.SPLASH),s.createPlayerFrame(),s.createOpponentFrame(),s.createVsComponent(),s}(0,i.Z)(t,e);var n=t.prototype;return n.createPlayerFrame=function(){this.playerFrame=new E(this.scene,!0),this.playerFrame.setName("playerFrame"),this.add(this.playerFrame),Phaser.Display.Align.In.Center(this.playerFrame,this,0,10-this.playerFrame.height)},n.createOpponentFrame=function(){this.opponentFrame=new E(this.scene,!1),this.opponentFrame.setName("opponentFrame"),this.add(this.opponentFrame),Phaser.Display.Align.In.Center(this.opponentFrame,this,0,this.opponentFrame.height-10)},n.createVsComponent=function(){var e=this;this.vsComponent=new R(this.scene),this.add(this.vsComponent),this.vsComponent.onCompleteAnim=function(){e.scene.scene.resume(r.C.GAME_SCENE),e.scene.time.delayedCall(1e3,(function(){e.close()}))}},n.open=function(){e.prototype.open.call(this),this.scene.requestBackgroundMaskUpdate(o.o4.CHALLENGE_SPLASH_SCREEN,this.background.alpha),this.updateData(),this.runOpenAnimation()},n.close=function(){this.setBlockInputOutsideEnabled(!1),this.visible&&(this.vsComponent.stopAnimation(),this.runExitsAnimation(100,1e3))},n.updateData=function(){var e=this.scene.battle.getPlayerInfo();console.log("\ud83e\udd16 ? playerInfo",e),e&&this.playerFrame.updateData(e);var t=this.scene.battle.getOpponentInfo();console.log("\ud83e\udd16 ? opponentInfo",t),t&&this.opponentFrame.updateData(t)},n.runOpenAnimation=function(){this.runBackgroundEntrancesAnimation(0,200),this.runPopupContentEntrancesAnimation(500,400)},n.runBackgroundEntrancesAnimation=function(e,t){var n=this;this.backgroundFadeInAnimation||(this.backgroundFadeInAnimation=new a.Z({targets:[this.background],delay:e,duration:t,props:{alpha:{start:0,from:0,to:.8}},onUpdate:function(e,t){var i=n.scene,a=n.scene.screen.get(o.o4.LOADING_SCREEN);if(a&&a.visible)return n.background.setAlpha(0),void i.requestBackgroundMaskUpdate(o.o4.CHALLENGE_SPLASH_SCREEN,0);i.requestBackgroundMaskUpdate(o.o4.CHALLENGE_SPLASH_SCREEN,t.alpha)}})),this.backgroundFadeInAnimation.play()},n.runPopupContentEntrancesAnimation=function(e,t){this.playerFrame.setAlpha(.8);var n=this.playerFrame.scale;this.scene.add.tween({targets:[this.playerFrame],props:{scale:{start:n-.05,to:n,duration:500},alpha:{start:.8,from:.8,to:1,duration:t}},ease:Phaser.Math.Easing.Expo.In}),this.playerFrame.runAnimation(e),this.opponentFrame.setAlpha(.1),this.opponentFrame.setX(this.opponentFrame.x+100),this.scene.add.tween({targets:[this.opponentFrame],props:{alpha:{start:.1,from:.1,to:1,duration:t},x:{start:this.opponentFrame.x,to:this.opponentFrame.x-100,duration:t}},ease:Phaser.Math.Easing.Expo.In}),this.opponentFrame.runAnimation(e),this.vsComponent.runAnimation(1e3)},n.runExitsAnimation=function(t,n){var i=this;this.fadeOutAnimation||(this.fadeOutAnimation=new s.Z({targets:[this.vsComponent,this.playerFrame,this.opponentFrame],delay:t,duration:n,props:{alpha:{from:1,to:0}},onComplete:function(){e.prototype.close.call(i),i.vsComponent.setAlpha(1),i.playerFrame.setAlpha(1),i.opponentFrame.setAlpha(1)}}),this.bgFadeOutAnimation=new s.Z({targets:[this.background],delay:t,duration:n,props:{alpha:{start:.8,from:.8,to:0}},onUpdate:function(e,t){i.scene.requestBackgroundMaskUpdate(o.o4.CHALLENGE_SPLASH_SCREEN,t.alpha)}})),this.fadeOutAnimation.play(),this.bgFadeOutAnimation.play()},t}(GameCore.Screen)},233:function(e,t,n){"use strict";var i=n(5),a=n(1),s=n(128),r=n(84),o=n(2).Z.DEFAULT_8_BIT,c=o.KEY,l=o.FRAME,u=function(e){function t(t,n){var a;(a=e.call(this,t)||this).payload=void 0,a.loading=void 0,a.photo=void 0,a.avtFrame=void 0,a.loadPhotoTimer=void 0,a.handleLoadPhotoAfterDelay=function(e,t){return function(){var n=a.scene.textures.get(e);n&&n.key===e?a.handleLoadComplete(e):(a.scene.load.once("filecomplete-image-"+e,a.handleLoadComplete),a.scene.load.image(e,t),a.scene.load.start())}},a.handleLoadComplete=function(e){if(a.scene){var t=a.payload.id;if(t&&t===e){var n=t+"_bordered_100",i=a.scene.textures.get(n);if(i&&i.key===n)a.setPhoto(i.key);else GameCore.Utils.Image.drawCircle({scene:a.scene,key:t,newKey:n})?a.setPhoto(n):a.showLoading(!1)}}},a.handleLoadPhotoFailed=function(e){e.key===a.payload.id&&a.setDefaultAvatar(e.key)},a.scene.add.existing((0,i.Z)(a)),a.payload=n;var s=a.payload.size;return a.setSize(s,s),a.createLoading(),a.createPhoto(),a.createFrame(),a.addDefaultListeners(),a}(0,a.Z)(t,e);var n=t.prototype;return n.loadPhoto=function(e,t){var n;if(this.payload.id=e,this.payload.url=t,null==(n=this.loadPhotoTimer)||n.remove(),e&&t){var i=this.scene.textures.get(e);if(i&&i.key===e)this.handleLoadComplete(e);else{this.showLoading(!0);var a=(this.payload||{}).loadDelay,s=void 0===a?0:a;this.loadPhotoTimer=this.scene.time.delayedCall(s,this.handleLoadPhotoAfterDelay(e,t))}}else this.setPhoto(r.Z.AVATAR.KEY)},n.addDefaultListeners=function(){var e=this;this.scene.load.on(Phaser.Loader.Events.FILE_LOAD_ERROR,this.handleLoadPhotoFailed),this.on(Phaser.GameObjects.Events.DESTROY,(function(){var t;null==(t=e.loadPhotoTimer)||t.remove(),e.scene.load.off(Phaser.Loader.Events.FILE_LOAD_ERROR,e.handleLoadPhotoFailed)}))},n.setDefaultAvatar=function(e){this.loadPhoto(e,r.Z.AVATAR.FILE)},n.createLoading=function(){this.loading=new s.Z(this.scene),this.loading.setWorldSize(.75*this.width,.75*this.height),this.loading.setVisible(!1),this.add(this.loading)},n.createPhoto=function(){this.photo=this.scene.make.image({x:0,y:0,origin:{x:.5,y:.5},visible:!1}),this.add(this.photo)},n.createFrame=function(){this.avtFrame=this.scene.make.image({key:c,frame:l.LEADERBOARD_AVATAR}),this.avtFrame.setWorldSize(34,38),this.add(this.avtFrame)},n.showLoading=function(e){this.photo.setVisible(!e),this.loading.setVisible(e)},n.setPhoto=function(e){this.showLoading(!1),this.photo.setTexture(e),this.photo.setFrame(0);var t=this.payload.size-10;this.photo.setWorldSize(t,t),Phaser.Display.Align.In.Center(this.photo,this.avtFrame,0,-2)},t}(Phaser.GameObjects.Container);t.Z=u},650:function(e,t,n){"use strict";n.d(t,{Z:function(){return le}});var i=n(1),a=n(20),s=n(5),r=n(18),o=n.n(r),c=n(231),l=n(489),u=n(58),h=n(112),d=n(128),p=n(111),f=n(34),g=n(2),E=n(24),m=n(228),v=n(163),A=n.n(v),S=n(89),T=n.n(S),y=n(46),C=n.n(y),I=n(69),R=n.n(I),w=n(90),_=n.n(w),b=n(132),L=n.n(b),P=n(488),O=n(84),D=n(33),k=n(31),N=n.n(k),B=n(486),M=n(113),x=n(233),U=g.Z.DEFAULT_8_BIT,F=U.KEY,Z=U.FRAME,G=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).avatar=void 0,i.rankIcon=void 0,i.rankText=void 0,i.username=void 0,i.score=void 0,i.scoreText=void 0,i.background=void 0,i.showPopUp=void 0,i.showItems=void 0,i.payload=void 0,i.handleChallengeFriend=(0,a.Z)(o().mark((function e(){var t,n,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.payload.playerId,n=i.scene.battle,i.updateBattleProfiles(),e.next=5,n.createBattle(t);case 5:a=i.scene.game.globalScene,n.getStatus()===m.Z.STARTED?i.scene.screen.close(E.o4.LEADER_BOARD_SCREEN):a.recalculateBackgroundMask();case 7:case"end":return e.stop()}}),e)}))),i.createBackground(),i.updateSize(),i.createRank(),i.createAvatar(),i.createUsername(),i.createScore(),n&&i.updateInfo(n),i.scene.add.existing((0,s.Z)(i)),i}(0,i.Z)(t,e);var n=t.prototype;return n.updateInfo=function(e){this.payload=(0,D.Z)({extraData:"",isHighlight:!1},e),this.updateBackground(),this.updateAvatar(),this.updateRank(),this.updateUsername(),this.updateScore()},n.createBackground=function(){this.background=this.scene.make.image({key:F,frame:Z.LEADERBOARD_BG_DARK}),this.add(this.background),this.updateBackground()},n.updateBackground=function(){var e=(this.payload||{}).isHighlight;void 0!==e&&e?(this.background.setFrame(Z.LEADERBOARD_BG_LIGHT),this.background.setWorldSize(313.5,41)):(this.background.setFrame(Z.LEADERBOARD_BG_DARK),this.background.setWorldSize(314.5,42))},n.updateSize=function(){var e=this.background,t=e.width,n=e.height;this.setSize(t,n)},n.createAvatar=function(){this.avatar=new x.Z(this.scene,{size:42,loadDelay:300}),this.add(this.avatar),Phaser.Display.Align.In.LeftCenter(this.avatar,this.rankIcon,-40)},n.updateAvatar=function(){var e=this.payload,t=e.playerId,n=e.photo;this.avatar.loadPhoto(t,n)},n.createRank=function(){this.createRankIcon(),this.createRankText()},n.updateRank=function(){var e=(this.payload||{}).rank,t=void 0===e?99:e;this.updateRankIcon(t),this.updateRankText(t)},n.getRankIconFrame=function(e){var t=null;switch(e){case 1:t=Z.LEADERBOARD_RANK_GOLD;break;case 2:t=Z.LEADERBOARD_RANK_SILVER;break;case 3:t=Z.LEADERBOARD_RANK_COPPER}return t},n.createRankIcon=function(){this.rankIcon=this.scene.make.image({key:F}),this.updateRankIcon(1),this.kill(),this.add(this.rankIcon),Phaser.Display.Align.In.LeftCenter(this.rankIcon,this)},n.updateRankIcon=function(e){var t=this.getRankIconFrame(e);t?(this.rankIcon.revive(),this.rankIcon.setFrame(t),t==Z.LEADERBOARD_RANK_GOLD&&this.rankIcon.setWorldSize(39,34.5),t==Z.LEADERBOARD_RANK_SILVER&&this.rankIcon.setWorldSize(32.5,32),t==Z.LEADERBOARD_RANK_COPPER&&this.rankIcon.setWorldSize(27,35.5)):this.rankIcon.kill()},n.createRankText=function(){this.rankText=this.scene.make.text({text:"0",style:{fontFamily:f.Z.FONT_FAMILY,fontSize:"16px",color:"#ffffff",stroke:"#000000",strokeThickness:3}}),this.rankText.setHighQuality(),this.rankText.kill(),this.add(this.rankText),Phaser.Display.Align.In.Center(this.rankText,this.rankIcon,0,-1)},n.updateRankText=function(e){var t;this.rankText.kill(),e>3&&this.rankText.revive(),null==(t=this.rankText)||t.setText(""+e)},n.getShortName=function(e){var t=e.substring(0,7);return t.split(" ")[0]||t},n.createUsername=function(){this.username=this.scene.make.text({text:"Player",style:{fontFamily:f.Z.SYSTEM_FAMILY_FONT,fontSize:"16px",fontStyle:"bold",color:"#ffffff"}}),this.username.setHighQuality(),Phaser.Display.Align.In.LeftCenter(this.username,this.avatar,-53),this.add(this.username)},n.updateUsername=function(){var e=this.payload.name;this.username.setText(this.getShortName(e))},n.createScore=function(){this.score=this.scene.add.container(),this.scoreText=this.scene.make.text({text:"99999",style:{fontFamily:f.Z.FONT_FAMILY,fontSize:"16px",color:"#ffffff",stroke:"#000000",strokeThickness:2}}),this.scoreText.setOrigin(1,.5),this.scoreText.setHighQuality(),this.score.add(this.scoreText),this.add(this.score),Phaser.Display.Align.In.RightCenter(this.score,this,-10)},n.updateScore=function(){var e=(this.payload||{}).score,t=void 0===e?"0":e;this.scoreText.setText(""+t)},n.updateBattleProfiles=function(){try{var e=this.payload,t=e.playerId,n=e.name,i=e.photo,a=e.extraData,s=this.scene,r=s.battle,o=s.player,c=JSON.parse(a||"{}"),l={playerId:t,playerName:n,playerPhoto:i,playerLevel:c.playerLevel||1,unitData:c.unitData||"0-0-m2-0-0/0-0-0-0-0/r1-0-0-0-0"};console.info("\ud83d\ude80 > opponentData",l),r.updateOpponentProfile(l);var u=o.getPlayer(),h={playerId:u.playerId,playerName:u.name,playerPhoto:u.photo,playerLevel:o.getCustomData("playerLevelProgress")||1,unitData:o.getCustomData("playerUnitData")||"0-0-m2-0-0/0-0-0-0-0/r1-0-0-0-0"};console.info("\ud83d\ude80 > playerData",h),r.updatePlayerProfile(h)}catch(d){console.warn(d)}},n.runShowPopUpAnimation=function(e,t){this.scene.tweens.killTweensOf(this),this.showPopUp=new M.Z({targets:[this],delay:e,duration:t,props:{y:{start:this.y+70,to:this.y}}}),this.showPopUp.play()},n.runShowItemAnimation=function(e,t){var n=this,i=this.getAll();this.scene.tweens.killTweensOf(i),this.showItems=new B.Z({targets:i,duration:t,delay:this.scene.tweens.stagger(50,{start:e+50}),props:{scale:{duration:1e3,getStart:function(e){return.8*e.scale},getEnd:function(e){return e.scale},ease:Phaser.Math.Easing.Elastic.Out,easeParams:[.1,.45]}},onStart:function(){n.showItems.baseScales=N()(i).call(i,(function(e){return e.scale}))},onStop:function(){i.forEach((function(e,t){e.scale=n.showItems.baseScales[t]}))}}),this.showItems.play()},n.runShowUpAnimation=function(e,t){void 0===e&&(e=0),void 0===t&&(t=300);var n=100*e;this.runShowPopUpAnimation(n,t),this.runShowItemAnimation(n,t)},t}(Phaser.GameObjects.Container);function H(e,t){var n="undefined"!==typeof _()&&L()(e)||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){var n;if(!e)return;if("string"===typeof e)return Y(e,t);var i=C()(n=Object.prototype.toString.call(e)).call(n,8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return R()(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Y(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var K=GameCore.Configs.LeadersBoard.Limit,V=function(e){function t(t){var n;(n=e.call(this,t)||this).currentPlayerId=void 0,n.isUpdating=void 0,n.scroller=void 0,n.scene=t;var i=n.scene.player;return n.currentPlayerId=i.getPlayerId(),n.isUpdating=!1,n.createReuseScroller(),n.scene.add.existing((0,s.Z)(n)),n}(0,i.Z)(t,e);var n=t.prototype;return n.createReuseScroller=function(){this.scroller=new P.Z(this.scene,{classType:G,listConfigs:[],width:320,height:290,padding:10,marginTop:10,marginBottom:10}),this.scroller.createMask(),this.scroller.setPosition(0,0),this.add(this.scroller)},n.updateData=function(e){if(!this.isUpdating){this.isUpdating=!0;var t=A()(e)||[];if(t.length<1)this.showLeaderboardIsEmpty();else{for(var n,i=[],a=1,s=H(T()(t).call(t,(function(e,t){return+t.score-+e.score})));!(n=s()).done;){var r=n.value;if(i.length>=K)break;var o=r.playerId,c=r.photo,l=r.score,u=r.name;if(o&&u){var h=this.currentPlayerId===o,d={playerId:o,photo:c||O.Z.AVATAR.FILE,name:u,rank:a,score:l,isHighlight:h};i.push(d),a++}}this.scroller.updateConfig(i),this.showLeaders()}}},n.removeLeaders=function(){this.scroller.updateConfig([])},n.getLeaders=function(){return this.scroller.getChildren()},n.showLeaders=function(){for(var e=this,t=this.getLeaders(),n=Math.min(t.length,6),i=0;i<n;i++){var a=t[i];a&&(a.setVisible(!0),a.runShowUpAnimation(i,300))}var s=300+100*n+250;this.scene.time.delayedCall(s,(function(){var t=e.scene.screen.get(E.o4.LEADER_BOARD_SCREEN);e.isUpdating=!1,t.isSwitchable=!0,e.scroller.setEnable(!0)}))},n.showLeaderboardIsEmpty=function(){var e=this.scene.screen.get(E.o4.LEADER_BOARD_SCREEN);this.isUpdating=!1,e.isSwitchable=!0,e.board.showMessage(!0,this.scene.lang.Text.LEADERBOARD_IS_EMPTY)},t}(Phaser.GameObjects.Container),W=function(e){function t(t){var n;return(n=e.call(this,t)||this).createRankText(),n.createPhotoText(),n.createNameText(),n.createLevelText(),n}(0,i.Z)(t,e);var n=t.prototype;return n.createRankText=function(){var e=this.scene.make.bitmapText({font:f.Z.PRIMARY.KEY,size:this.scene.fontSize(14),text:this.scene.lang.Text.RANK,origin:{x:.2,y:.5}});this.add(e),Phaser.Display.Align.In.Center(e,this,-138)},n.createPhotoText=function(){var e=this.scene.make.bitmapText({font:f.Z.PRIMARY.KEY,size:this.scene.fontSize(14),text:this.scene.lang.Text.PHOTO,origin:{x:.2,y:.5}});this.add(e),Phaser.Display.Align.In.Center(e,this,-94)},n.createNameText=function(){var e=this.scene.make.bitmapText({font:f.Z.PRIMARY.KEY,size:this.scene.fontSize(14),text:this.scene.lang.Text.NAME,origin:{x:.2,y:.5}});this.add(e),Phaser.Display.Align.In.Center(e,this,-45)},n.createLevelText=function(){var e=this.scene.make.bitmapText({font:f.Z.PRIMARY.KEY,size:this.scene.fontSize(14),text:this.scene.lang.Text.LEVEL,origin:{x:.2,y:.5}});this.add(e),Phaser.Display.Align.In.Center(e,this,125)},t}(Phaser.GameObjects.Container),j=g.Z.DEFAULT_8_BIT,z=j.KEY,X=j.FRAME,q=g.Z.DEFAULT,Q=q.KEY,J=q.FRAME,$=function(e){function t(t){var n;return(n=e.call(this,t)||this).background=void 0,n.titleText=void 0,n.titleRibbon=void 0,n.header=void 0,n.leaders=void 0,n.loading=void 0,n.message=void 0,n.challengeFriendsBtn=void 0,n.messageAnimation=void 0,n.onClose=void 0,n.handleChallengeFriends=(0,a.Z)(o().mark((function e(){var t,i,a,s,r,l,u,h;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=n.scene,i=t.player,a=t.battle,s=t.facebook,e.next=4,s.chooseAsync();case 4:if(!1!==(r=e.sent)){e.next=7;break}throw new Error("User canceled");case 7:if(GameCore.Utils.Valid.isString(r)){e.next=9;break}throw new Error("No context found");case 9:return l=i.getPlayerId(),e.next=12,s.getContextPlayers(l);case 12:return u=e.sent,h=c.U.playerId,u.length>0&&(h=u[0].playerId),e.next=17,a.createBattle(h);case 17:a.getStatus()===m.Z.STARTED&&n.scene.screen.close(E.o4.LEADER_BOARD_SCREEN),e.next=23;break;case 20:e.prev=20,e.t0=e.catch(0),console.error(e.t0);case 23:case"end":return e.stop()}}),e,null,[[0,20]])}))),n.handleOnCloseClick=function(){n.onClose&&n.onClose()},n.setName("Board"),n.createBackground(),n.createLoading(),n.createMessage(),n.createContents(),n.createCloseButton(),n.createAnimation(),n.updateSize(),n.scene.add.existing((0,s.Z)(n)),n}(0,i.Z)(t,e);var n=t.prototype;return n.updateSize=function(){var e=this.background,t=e.width,n=e.height;this.setSize(t,n)},n.showLoading=function(e){this.loading.setVisible(e),this.showMessage(!1)},n.showMessage=function(e,t){this.message.setVisible(e),t&&(this.message.setText(t),this.messageAnimation.play())},n.createBackground=function(){this.background=new p.Z(this.scene,{x:0,y:0,width:332,height:404.5,topInnerCornerStrokeWidth:1,rightInnerCornerStrokeWidth:3,lightY:-80}),this.add(this.background),this.setSize(this.background.width,this.background.height)},n.recalculateLightPosition=function(){this.background&&this.background.recalculateLightPosition()},n.createLoading=function(){this.loading=new d.Z(this.scene),this.loading.setTint(16777215),this.loading.setWorldSize(113,113),this.add(this.loading),Phaser.Display.Align.In.Center(this.loading,this.background)},n.createMessage=function(){this.message=this.scene.make.bitmapText({font:f.Z.PRIMARY.KEY,size:this.scene.fontSize(18),origin:{x:.5,y:.5}}),this.message.setTint(16777215),this.add(this.message),Phaser.Display.Align.In.Center(this.message,this.background)},n.createContents=function(){this.createLeaders(),this.createTitle(),this.createHeader()},n.createLeaders=function(){this.leaders=new V(this.scene),this.add(this.leaders),Phaser.Display.Align.In.Center(this.leaders,this.background,0,30)},n.createTitle=function(){var e=this.scene.add.container();e.setName("title");var t=this.scene.make.image({key:Q,frame:J.RIBBON_BLUE});t.setWorldSize(239,67);var n=this.scene.make.bitmapText({font:f.Z.PRIMARY.KEY,size:this.scene.fontSize(22),text:this.scene.lang.Text.LEADERBOARD});Phaser.Display.Align.In.Center(n,t,0,-10),e.add([t,n]),Phaser.Display.Align.In.TopCenter(e,this.background,0,-25),this.add(e),this.titleText=n,this.titleRibbon=t},n.createHeader=function(){var e=this.scene.add.container(),t=this.scene.make.image({key:z,frame:X.LEADERBOARD_TAB_BG});t.setX(1),t.setWorldSize(329,29),this.header=new W(this.scene),e.add([t,this.header]),this.add(e),Phaser.Display.Align.In.TopCenter(this.header,e),Phaser.Display.Align.In.Center(e,this.background,-1,-125)},n.createCloseButton=function(){var e=new h.Z(this.scene);Phaser.Display.Align.In.TopRight(e,this,10,10),this.add(e),e.onClick=this.handleOnCloseClick},n.createChallengeFriendsBtn=function(){this.challengeFriendsBtn=new u.Z(this.scene,z,X.BUTTON_GREEN,144,57),this.add(this.challengeFriendsBtn);var e=this.scene.make.text({text:this.scene.lang.Text.CHALLENGE_FRIENDS,style:{align:"center",fontFamily:f.Z.FONT_FAMILY,fontSize:"17px",stroke:"#000000",strokeThickness:1,padding:{left:10,right:10}}});e.setHighQuality(),e.setOrigin(.5,.5),e.setShadow(-10,4,"#000000",1),this.challengeFriendsBtn.add(e),Phaser.Display.Align.In.Center(e,this.challengeFriendsBtn,18,-3);var t=this.scene.make.image({key:z,frame:X.ICON_BATTLE});t.setOrigin(.5,.5),t.setWorldSize(34.5,31.5),this.challengeFriendsBtn.add(t),Phaser.Display.Align.In.Center(t,this.challengeFriendsBtn,-45,-3),Phaser.Display.Align.In.BottomCenter(this.challengeFriendsBtn,this.background,0,-15),this.challengeFriendsBtn.onClick=this.handleChallengeFriends},n.createAnimation=function(){this.messageAnimation=new l.Z({targets:[this.message],duration:60,repeat:2})},t}(Phaser.GameObjects.Container),ee=n(235),te=n(67),ne=n(30),ie=n(68),ae=n(651),se=n(653),re=GameCore.Configs.LeadersBoard,oe=re.LeaderboardId,ce=re.Limit,le=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t,n,i,a)||this).scene=void 0,s.board=void 0,s.tabId=void 0,s.offset=void 0,s.isRequesting=void 0,s.isSwitchable=void 0,s.showPopupAnimation=void 0,s.fadeOutAnimation=void 0,s.handleCloseClick=function(){s.runFadeOutAnimation()},s.scene=t,s.background.setAlpha(.7),s.setDepth(E.Ks.POPUP),s.createBoard(),s.listensLeaderDataUpdate(),s}(0,i.Z)(t,e);var n=t.prototype;return n.open=function(){e.prototype.open.call(this);var t=this.scene.scene.get(ne.C.GAME_SCENE);t instanceof ie.Z&&t.screenManager.listenResizeEventForCalculateLight(this),this.scene.requestBackgroundMaskUpdate(E.o4.LEADER_BOARD_SCREEN,this.background.alpha),this.runPopupAnimation(),this.isSwitchable=!1,this.selectWorldTab()},n.close=function(){e.prototype.close.call(this),this.scene.requestBackgroundMaskUpdate(E.o4.LEADER_BOARD_SCREEN,0)},n.selectWorldTab=function(){this.tabId=ee.C,this.offset=0,this.board.showLoading(!0),this.board.leaders.removeLeaders(),this.scene.game.storage.dispatch((0,ae.F)(oe,ee.C,2*ce,this.offset))},n.createBoard=function(){this.board=new $(this.scene),this.board.onClose=this.handleCloseClick,Phaser.Display.Align.In.Center(this.board,this,0,-20),this.add(this.board);var e=22;if("es"===this.scene.lang.getCurrentLanguage())e=19;this.board.titleText.setFontSize(e),Phaser.Display.Align.In.Center(this.board.titleText,this.board.titleRibbon,0,-10)},n.recalculateLightPosition=function(){this.board&&this.board.recalculateLightPosition()},n.listensLeaderDataUpdate=function(){var e=this,t=[{selector:se.j,callback:function(t){if(e.isRequesting=t,e.board.showLoading(t),!1===t){var n=e.scene.game.storage.getState(),i=(0,se.c)(n);e.board.leaders.updateData(i)}}}];this.scene.handleStateChange(t)},n.runPopupAnimation=function(){this.showPopupAnimation||(this.showPopupAnimation=new M.Z({targets:[this.board]})),this.showPopupAnimation.play()},n.runFadeOutAnimation=function(){var e=this;this.visible&&(this.fadeOutAnimation||(this.fadeOutAnimation=new te.Z({targets:[this.background],duration:200,ease:Phaser.Math.Easing.Cubic.Out,props:{alpha:{start:.7,from:.7,to:0}},onActive:function(){e.board.kill()},onUpdate:function(t,n){e.scene.requestBackgroundMaskUpdate(E.o4.LEADER_BOARD_SCREEN,n.alpha)},onComplete:function(){e.board.revive();var t=e.scene.scene.get(ne.C.GAME_SCENE);t instanceof ie.Z&&t.screenManager.removeResizeEventForCalculateLight(e),e.background.setAlpha(.7),e.scene.screen.close(e.name)}})),this.fadeOutAnimation.play())},t}(GameCore.Screen)},657:function(e,t,n){"use strict";n.d(t,{Z:function(){return X}});var i=n(20),a=n(1),s=n(18),r=n.n(s),o=n(53),c=n.n(o),l=n(59),u=n.n(l),h=n(31),d=n.n(h),p=n(159),f=n(58),g=n(160),E=n(34),m=n(2),v=n(30),A=n(24),S=n(25),T=n(5),y=m.Z.GAMEPLAY,C=y.KEY,I=y.FRAME,R=function(e){function t(t){var n;return(n=e.call(this,t,C,I.DASHBOARD_COINBAR_COIN)||this).emitter=void 0,n.createEmitters(),n.setActive(!1),n.setVisible(!1),n.scene.add.existing((0,T.Z)(n)),n}(0,a.Z)(t,e);var n=t.prototype;return n.createEmitters=function(){var e=1/this.scene.world.getPixelRatio();this.emitter=this.createEmitter({on:!1,frame:I.DASHBOARD_COINBAR_COIN,gravityY:160,angle:{min:-180,max:0},speed:{min:50,max:200},scale:{min:.8*e,max:.8*e},alpha:{start:1,end:0,ease:Phaser.Math.Easing.Expo.In},lifespan:1500})},n.explode=function(e,t,n){this.setActive(!0),this.setVisible(!0),this.emitter.explode(e,t,n)},t}(Phaser.GameObjects.Particles.ParticleEmitterManager),w=n(658),_=n(85),b=n(17),L=n(68),P=n(57),O=n(491),D=m.Z.DEFAULT_8_BIT,k=D.KEY,N=D.FRAME,B=function(e){function t(t){var n;return(n=e.call(this,t)||this).continueButton=void 0,n.coinText=void 0,n.getText=void 0,n.winContainer=void 0,n.loseContainer=void 0,n.postAdContinueAnimation=void 0,n.replayButton=void 0,n.postAdReplayAnimation=void 0,n.returnButton=void 0,n.postAdReturnAnimation=void 0,n.openAnimation=void 0,n.mode="NORMAL",n.setName("Footer"),n.createContinueButton(),n.createReplayButton(),n.createReturnButton(),n.scene.add.existing((0,T.Z)(n)),n}(0,a.Z)(t,e);var n=t.prototype;return n.createContinueButton=function(){this.continueButton=new O.Z(this.scene,{key:k,frame:N.RESULT_SCREEN_YELLOW_BUTTON,width:129,height:46}),this.continueButton.setName("Continue"),this.add(this.continueButton),this.createContinueWinContainer(),this.createContinueLoseContainer()},n.createContinueWinContainer=function(){var e=this.scene.make.container({});e.setSize(this.continueButton.width,this.continueButton.height),this.winContainer=e,this.continueButton.add(this.winContainer);var t=18,n=-14;switch(this.scene.lang.getCurrentLanguage()){case"ja":case"zh":t=16,n=-12}this.getText=new g.Z(this.scene,{font:E.Z.PRIMARY.KEY,size:this.scene.fontSize(t)}),this.getText.setText(this.scene.lang.Text.GET),this.getText.setDropShadow(-.5,1.5,0),this.getText.setPosition(0,n),e.add(this.getText);var i=this.scene.make.image({key:k,frame:N.RESULT_SCREEN_SINGLE_COIN_ICON});i.setWorldSize(16,16),e.add(i),i.setPosition(-40,7);var a=new g.Z(this.scene,{font:E.Z.PRIMARY.KEY,size:this.scene.fontSize(18)});a.setText("0"),a.setTintText(15650560),a.setDropShadow(-1,1,0),a.setPosition(0,5),e.add(a),this.coinText=a},n.createContinueLoseContainer=function(){var e=this.scene.make.container({});e.setSize(this.continueButton.width,this.continueButton.height),this.loseContainer=e,this.continueButton.add(this.loseContainer);var t=20;switch(this.scene.lang.getCurrentLanguage()){case"pt":case"de":t=18}var n=new g.Z(this.scene,{font:E.Z.PRIMARY.KEY,size:this.scene.fontSize(t)});n.setText(this.scene.lang.Text.CLAIM),n.setDropShadow(-1,1,0),n.setPosition(0,-5),e.add(n)},n.createReplayButton=function(){this.replayButton=new f.Z(this.scene,k,N.RESULT_SCREEN_GREEN_BUTTON,129,46),this.replayButton.setName("BattleReplay");var e=new g.Z(this.scene,{font:E.Z.PRIMARY.KEY,size:this.scene.fontSize(15)});e.setText(this.scene.lang.Text.REPLAY),e.setDropShadow(-1,1,0),e.setPosition(15,-5),this.replayButton.add(e);var t=this.scene.make.image({key:k,frame:N.ICON_REPLAY});t.setWorldSize(23.5,27.5),t.setPosition(-40,-3),this.replayButton.add(t),this.replayButton.setX(-70),this.add(this.replayButton)},n.createReturnButton=function(){this.returnButton=new f.Z(this.scene,k,N.RESULT_SCREEN_YELLOW_BUTTON,129,46),this.returnButton.setName("BackToSinglePlay");var e=new g.Z(this.scene,{font:E.Z.PRIMARY.KEY,size:this.scene.fontSize(15)});e.setText("      "+this.scene.lang.Text.BACK_TO_SINGLEPLAY),e.setDropShadow(-1,1,0),e.setPosition(15,-5),this.returnButton.add(e);var t=this.scene.make.image({key:k,frame:N.ICON_BACK_TO});t.setWorldSize(28.5,20.5),t.setPosition(-45,-2),this.returnButton.add(t),this.returnButton.setX(70),this.add(this.returnButton)},n.setMode=function(e,t,n){this.continueButton.setY(0),this.continueButton.setScale(1),this.continueButton.updateScaleDown(),this.replayButton.setPosition(-70,0),this.replayButton.setScale(1),this.returnButton.setPosition(70,0),this.returnButton.setScale(1),"BATTLE"===e?(this.replayButton.revive(),this.returnButton.revive(),this.continueButton.kill()):(this.replayButton.kill(),this.returnButton.kill(),this.continueButton.revive(),"win"===n?(this.winContainer.revive(),this.loseContainer.kill(),this.coinText.setText(t.toString()),this.getText.setText(this.scene.lang.Text.GET)):(this.winContainer.kill(),this.loseContainer.revive(),this.getText.setText(this.scene.lang.Text.CLAIM))),this.mode=e},n.setCoinText=function(e){this.winContainer.revive(),this.loseContainer.kill(),this.coinText.setText(e)},n.runAnimation=function(e){var t,n,i=this;"BATTLE"===this.mode&&(null==(t=this.openAnimation)||t.stop(),null==(n=this.openAnimation)||n.remove(),this.returnButton.setAlpha(0),this.replayButton.setAlpha(0),this.openAnimation=new p.Z({targets:[this.replayButton,this.returnButton],delay:e,duration:400,props:{alpha:{from:0,to:1}},onComplete:function(){i.returnButton.setAlpha(1),i.replayButton.setAlpha(1)}}),this.openAnimation.play())},n.runPostAnimation=function(e){var t=this;if("BATTLE"===this.mode){var n,i,a,s,r,o;null==(n=this.openAnimation)||n.stop(),null==(i=this.openAnimation)||i.remove(),null==(a=this.postAdReplayAnimation)||a.stop(),null==(s=this.postAdReplayAnimation)||s.remove(),null==(r=this.postAdReturnAnimation)||r.stop(),null==(o=this.postAdReturnAnimation)||o.remove(),this.replayButton.setDisabled(!0),this.replayButton.setAlpha(1);var c=this.replayButton.x;this.postAdReplayAnimation=this.scene.tweens.add({targets:this.replayButton,duration:500,delay:e,y:{from:0,to:-70},x:{from:c,to:c-15},scale:{from:this.replayButton.scale,to:1.2*this.replayButton.scale},ease:Phaser.Math.Easing.Quintic.Out,onComplete:function(){t.replayButton.setDisabled(!1)}}),this.returnButton.setDisabled(!0),this.returnButton.setAlpha(1);var l=this.returnButton.x;this.postAdReturnAnimation=this.scene.tweens.add({targets:this.returnButton,duration:500,delay:e,y:{from:0,to:-70},x:{from:l,to:l+15},scale:{from:this.returnButton.scale,to:1.2*this.returnButton.scale},ease:Phaser.Math.Easing.Quintic.Out,onComplete:function(){t.returnButton.setDisabled(!1)}})}else{var u,h;null==(u=this.postAdContinueAnimation)||u.stop(),null==(h=this.postAdContinueAnimation)||h.remove(),this.continueButton.setDisabled(!0),this.continueButton.setAlpha(1);var d=this.continueButton.scale;this.postAdContinueAnimation=this.scene.tweens.add({targets:this.continueButton,duration:500,delay:e,y:{from:0,to:-70},scale:{from:d,to:2*d},ease:Phaser.Math.Easing.Quintic.Out,onComplete:function(){t.continueButton.updateScaleDown(),t.continueButton.setDisabled(!1)}})}},(0,P.Z)(t,[{key:"onClickContinueBtn",set:function(e){this.continueButton.onClick=e}},{key:"onClickReplayBtn",set:function(e){this.replayButton.onClick=e}},{key:"onClickReturnBtn",set:function(e){this.returnButton.onClick=e}}]),t}(Phaser.GameObjects.Container),M=m.Z.DEFAULT_8_BIT,x=M.KEY,U=M.FRAME,F=function(e){function t(t){var n;return(n=e.call(this,t,0,0)||this).wheelArrow=void 0,n.luckSpinMilestones=void 0,n.luckSpinRewards=void 0,n.spinningTween=void 0,n.createWheelBackground(),n.createWheelArrow(),n.scene.add.existing((0,T.Z)(n)),n}(0,a.Z)(t,e);var n=t.prototype;return n.createWheelBackground=function(){var e=this.scene.make.image({key:x,frame:U.WHEEL_LUCKY_SPIN});this.scene.add.existing(e),this.add(e),e.setOrigin(.5,.5),e.setWorldSize(178.5,114.5),e.setY(-34),this.createText("x2",-63,-35),this.createText("x3",-18,-70),this.createText("x4",22,-60),this.createText("x5",45,-27)},n.createText=function(e,t,n){var i=this.scene.make.bitmapText({text:e,font:E.Z.PRIMARY.KEY,size:this.scene.fontSize(22)});i.setDropShadow(-1,1),this.add(i),i.setPosition(t,n)},n.createWheelArrow=function(){this.wheelArrow=this.scene.make.image({key:x,frame:U.WHEEL_ARROW}),this.wheelArrow.setWorldSize(17,26),this.add(this.wheelArrow),Phaser.Display.Align.In.Center(this.wheelArrow,this,0,-25),this.luckSpinMilestones=[-30,16,59],this.luckSpinRewards=[2,3,4,5]},n.startWheelSpinning=function(){var e,t,n=this;null==(e=this.spinningTween)||e.stop(),null==(t=this.spinningTween)||t.remove();var i=this.scene.screen.get(A.o4.RESULT_SCREEN);i instanceof X&&(this.spinningTween=this.scene.tweens.addCounter({from:Phaser.Math.DegToRad(-90),to:Phaser.Math.DegToRad(90),onUpdate:function(e){var t=e.getValue();n.wheelArrow.setRotation(t);var a=29*Math.sin(t),s=-29*Math.cos(t);n.wheelArrow.setPosition(a,s),null==i||i.updateCoinText(n.getCurrentMultiplierResult())},yoyo:!0,duration:625,repeat:-1}))},n.stopWheelSpinning=function(){var e;null==(e=this.spinningTween)||e.stop()},n.getCurrentMultiplierResult=function(){for(var e=0;e<this.luckSpinMilestones.length;e++){var t=this.luckSpinMilestones[e];if(this.wheelArrow.angle<=t)return this.luckSpinRewards[e]}return this.luckSpinRewards[this.luckSpinRewards.length-1]},n.handleOnOpen=function(){this.startWheelSpinning()},n.handleOnClose=function(){this.stopWheelSpinning()},t}(Phaser.GameObjects.Container),Z=m.Z.DEFAULT_8_BIT,G=Z.KEY,H=Z.FRAME,Y=m.Z.DEFAULT_8_BIT,K=Y.KEY,V=Y.FRAME,W=GameCore.Configs.Network,j=b.Z.MULTIPLY_REWARD_BATTLE,z=b.Z.MULTIPLY_REWARD_ROUND,X=function(e){function t(t,n,a,s){var o;return(o=e.call(this,t,n,a,s)||this).baseValue=void 0,o.rewardWheel=void 0,o.coinText=void 0,o.coinIcon=void 0,o.claimCoinText=void 0,o.claimText=void 0,o.resultText=void 0,o.levelCompletedText=void 0,o.ribbon=void 0,o.shineFx=void 0,o.collectButton=void 0,o.footerContainer=void 0,o.openAnimation=void 0,o.postAdCollectAnimation=void 0,o.fxSpinAnimation=void 0,o.fxScaleAnimation=void 0,o.coinTextAnimation=void 0,o.confettiAnimation=void 0,o.adsTimer=void 0,o.isRewardCollected=void 0,o.coinExplodeEffect=void 0,o.closeScreen=function(){o.stopShineFxTween(),o.rewardWheel.stopWheelSpinning(),o.confettiAnimation.killAllParticles();var e=o.getData("result");if(!o.isRewardCollected){var t=o.scene.scene.get(v.C.GAME_SCENE);t instanceof L.Z&&"win"===e&&t.rewardWinCoin(1)}o.scene.requestBackgroundMaskUpdate(A.o4.RESULT_SCREEN,0),o.scene.screen.close(o.name),o.scene.audio.playSound(S.Z.NEXT_ROUND_EFFECT)},o.handleOnCollect=function(){o.viewAdsReward()},o.viewAdsReward=(0,i.Z)(r().mark((function e(){var t,n,i,a;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=null,n=o.scene.audio,e.prev=2,o.rewardWheel.stopWheelSpinning(),t=o.scene.game.globalScene.time.delayedCall(200,(function(){o.scene.screen.open(A.o4.NOTIFY_SCREEN,{message:o.scene.lang.Text.LOADING,duration:0,loading:!0})})),n.muteAll(),e.next=8,new(c())((function(e,t){var n;null==(n=o.adsTimer)||n.remove(),o.adsTimer=o.scene.time.delayedCall(W.Timeout,t),o.scene.ads.getAdStatus(GameCore.Ads.Types.REWARDED)===GameCore.Ads.Status.LOADING?o.scene.ads.events.once(GameCore.Ads.Events.LOADED,e):o.scene.ads.preloadRewardedVideoAsync().then(e).catch(t)}));case 8:return e.next=10,o.scene.ads.showRewardedVideoAsync();case 10:o.scene.screen.close(A.o4.NOTIFY_SCREEN),o.handleLuckyReward(),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(2),console.info("\ud83d\ude80 > showInterstitialAdAsync",e.t0),o.handleFailedAdsReward();case 18:return e.prev=18,null==(i=o.adsTimer)||i.destroy(),n.unmuteAll(),o.runPostAdAnimation(),null==(a=t)||a.remove(),o.scene.game.globalScene.screen.close(A.o4.NOTIFY_SCREEN),o.scene.ads.preloadRewardedVideoAsync().catch((function(e){})),e.finish(18);case 26:case"end":return e.stop()}}),e,null,[[2,14,18,26]])}))),o.handleFailedAdsReward=function(){o.scene.screen.open(A.o4.CLOSEABLE_NOTIFY_SCREEN,{title:o.scene.lang.Text.DISPLAY_ADS_FAILED,message:o.scene.lang.Text.UNABLE_TO_DISPLAY_ADS,duration:1500,loading:!1})},o.handleLuckyReward=function(){o.onWheelEnding()},o.onWheelEnding=function(){o.runCoinTextAnimation();var e=o.rewardWheel.getCurrentMultiplierResult(),t=o.getData("result"),n=o.scene.scene.get(v.C.GAME_SCENE);"lose"===t?n.rewardLostCoin(e):"win"===t&&n.rewardWinCoin(e);var i=o.baseValue.clone();i.multiply(e),o.footerContainer.setCoinText(i.toString()),o.isRewardCollected=!0},o.handleClickContinueBtn=function(){var e=o.scene.scene.get(v.C.GAME_SCENE),t=o.getData("result"),n=o.getData("mode");e.events.once(Phaser.Scenes.Events.RESUME,(function(){e instanceof L.Z&&(n===_.Z.NORMAL&&"lose"===t?e.replayRound():e.nextRound())})),o.closeScreen()},o.handleClickReplayBtn=function(){var e=o.scene.scene.get(v.C.GAME_SCENE);e.events.once(Phaser.Scenes.Events.RESUME,(function(){e instanceof L.Z&&e.replayRound()})),o.closeScreen()},o.scene=t,o.background.setAlpha(.9),o.setDepth(A.Ks.SCREEN),o.createContent(),o.createEffect(),o}(0,a.Z)(t,e);var n=t.prototype;return n.createEffect=function(){this.coinExplodeEffect=new R(this.scene),this.add(this.coinExplodeEffect),this.confettiAnimation=new w.Z(this.scene),this.confettiAnimation.setDepth(A.Ks.SCREEN+1)},n.open=function(t){e.prototype.open.call(this,t),this.scene.requestBackgroundMaskUpdate(A.o4.RESULT_SCREEN,this.background.alpha);var n=this.getData("coinRewarded");this.baseValue=n,this.updateScreen(),this.collectButton.setDisabled(!1),this.collectButton.setAlpha(1),this.scene.ads.canbeShowRewardAd()?(this.collectButton.setDisabled(!1),this.collectButton.setAlpha(1)):(this.collectButton.setDisabled(!0),this.collectButton.setAlpha(.5)),this.rewardWheel.handleOnOpen(),this.runOpenAnimation()},n.updateScreen=function(){var e=this.baseValue.toString();this.coinText.setText("+"+e),this.isRewardCollected=!1,this.coinIcon.setPosition(this.coinText.displayWidth/2+10,this.coinIcon.y);var t=this.getData("mode"),n=this.getData("result");if(this.footerContainer.setMode(t,this.baseValue,n),"lose"===n)this.resultText.setText(this.scene.lang.Text.FAILED),this.ribbon.setFrame(V.RESULT_SCREEN_RIBBON_LOSE),this.shineFx.setFrame(V.RESULT_SCREEN_FX_LOSE),this.levelCompletedText.setText("");else if("win"===n){this.runConfetti(),this.resultText.setText(this.scene.lang.Text.VICTORY),this.ribbon.setFrame(V.RESULT_SCREEN_RIBBON_WIN),this.shineFx.setFrame(V.RESULT_SCREEN_FX_WIN);var i=z;if(this.scene instanceof L.Z)this.scene.gameMode===_.Z.BATTLE&&(i=j);this.levelCompletedText.setText(""+this.scene.lang.Text.LEVEL_COMPLETED_BONUS_X+i)}},n.runConfetti=function(){var e=this.scene.gameZone,t=e.displayWidth,n=e.displayHeight;this.confettiAnimation.run(0,n,t,.75*n)},n.createContent=function(){this.createCollectButton(),this.createFx(),this.createFooter(),this.createLevelCompleteText(),this.createGoldText(),this.createGoldIcon(),this.createEarnText(),this.createRibbon(),this.createRewardWheel()},n.createCollectButton=function(){var e=this.scene.lang.getCurrentLanguage();this.collectButton=new f.Z(this.scene,K,V.RESULT_SCREEN_GREEN_BUTTON_RESULT,181,71),this.collectButton.setName("ClaimWithAds"),this.add(this.collectButton);var t=30,n=-20,i=-30,a=10;switch(e){case"ru":t=20,n=-17,i=-40;break;case"es":t=21;break;case"pt":case"id":t=25;break;case"ja":t=25,n=-22,a=8;break;case"zh":t=25,i=-18,n=-15;break;case"tr":t=22,i=-32;break;case"fr":t=20;break;case"de":t=18,i=-37;break;case"it":t=23,i=-35}var s=new g.Z(this.scene,{font:E.Z.PRIMARY.KEY,size:this.scene.fontSize(t),origin:{x:0,y:.5}});s.setText(this.scene.lang.Text.GET+" x5"),s.setDropShadow(-1,1,0),this.claimText=s,this.collectButton.add(s),Phaser.Display.Align.In.Center(s,this.collectButton,i,n);var r=this.scene.make.image({key:G,frame:H.ICON_AD});r.setWorldSize(25.5,27),this.collectButton.add(r),Phaser.Display.Align.In.Center(r,this.collectButton,-60,-5);var o=this.scene.make.image({key:K,frame:V.RESULT_SCREEN_SINGLE_COIN_ICON});o.setWorldSize(16,16),this.collectButton.add(o),Phaser.Display.Align.In.Center(o,this.collectButton,-15,13),this.claimCoinText=new g.Z(this.scene,{font:E.Z.PRIMARY.KEY,size:this.scene.fontSize(17)}),this.claimCoinText.setText("0"),this.claimCoinText.setTintText(14993153),this.claimCoinText.setDropShadow(-1.5,1,0),this.collectButton.add(this.claimCoinText),Phaser.Display.Align.In.Center(this.claimCoinText,this.collectButton,22,a),Phaser.Display.Align.In.Center(this.collectButton,this,0,100),this.collectButton.onClick=this.handleOnCollect},n.createFooter=function(){this.footerContainer=new B(this.scene),this.add(this.footerContainer),this.footerContainer.onClickContinueBtn=this.handleClickContinueBtn,this.footerContainer.onClickReplayBtn=this.handleClickReplayBtn,this.footerContainer.onClickReturnBtn=this.handleClickContinueBtn,Phaser.Display.Align.In.Center(this.footerContainer,this.collectButton,0,130)},n.createLevelCompleteText=function(){this.levelCompletedText=new g.Z(this.scene,{font:E.Z.PRIMARY.KEY,size:this.scene.fontSize(18)}),this.levelCompletedText.setTintText(15650560),this.levelCompletedText.setDropShadow(-1,1,0),this.add(this.levelCompletedText),Phaser.Display.Align.In.Center(this.levelCompletedText,this,0,-80),this.levelCompletedText.setScale(this.collectButton.scaleX,this.collectButton.scaleY)},n.createGoldIcon=function(){this.coinIcon=this.scene.make.image({key:K,frame:V.RESULT_SCREEN_GOLD_ICON}),this.coinIcon.setWorldSize(55,39.5),this.add(this.coinIcon),Phaser.Display.Align.In.Center(this.coinIcon,this,this.coinText.displayWidth/2,-120)},n.createGoldText=function(){this.coinText=new g.Z(this.scene,{font:E.Z.PRIMARY.KEY,size:this.scene.fontSize(32)}),this.coinText.setDropShadow(-1,1,0),this.add(this.coinText),Phaser.Display.Align.In.Center(this.coinText,this,-20,-125)},n.createEarnText=function(){var e=new g.Z(this.scene,{font:E.Z.PRIMARY.KEY,size:this.scene.fontSize(18)});e.setText(this.scene.lang.Text.YOU_EARNED),e.setDropShadow(-2,1,0),this.add(e),Phaser.Display.Align.In.Center(e,this,0,-180),e.setScale(this.collectButton.scaleX,this.collectButton.scaleY)},n.createFx=function(){this.shineFx=this.scene.make.image({key:K,frame:V.RESULT_SCREEN_FX_WIN}),this.add(this.shineFx),this.shineFx.setWorldSize(375,407),Phaser.Display.Align.In.Center(this.shineFx,this,0,-120)},n.createRibbon=function(){var e=-7;if("ja"===this.scene.lang.getCurrentLanguage())e=-10;this.ribbon=this.scene.make.image({key:K,frame:V.RESULT_SCREEN_RIBBON_WIN}),this.add(this.ribbon),this.ribbon.setWorldSize(280,50),Phaser.Display.Align.In.Center(this.ribbon,this,2,-240),this.resultText=new g.Z(this.scene,{font:E.Z.PRIMARY.KEY,size:this.scene.fontSize(24)}),this.resultText.setDropShadow(-1,1,0),this.add(this.resultText),Phaser.Display.Align.In.Center(this.resultText,this.ribbon,3,e)},n.createRewardWheel=function(){this.rewardWheel=new F(this.scene),this.add(this.rewardWheel),Phaser.Display.Align.In.Center(this.rewardWheel,this,0,40)},n.runOpenAnimation=function(){var e,t,n,i=this;null==(e=this.openAnimation)||e.stop(),null==(t=this.openAnimation)||t.remove(),this.collectButton.setAlpha(1);var a=u()(n=this.list).call(n,(function(e){return e!==i.background&&e!==i.footerContainer})),s=d()(a).call(a,(function(e){return e.alpha}));a.forEach((function(e){return e.setAlpha(0)})),this.openAnimation=new p.Z({targets:a,delay:0,duration:400,props:{alpha:{getStart:function(){return 0},getEnd:function(e,t,n,i){return s[i]}}},onComplete:function(){i.runShineFxTween()}}),this.footerContainer.runAnimation(2500),this.openAnimation.play()},n.runShineFxTween=function(){var e=this,t=this.getData("result");this.fxSpinAnimation=this.scene.tweens.add({targets:this.shineFx,duration:"win"===t?2e4:4e4,ease:"Linear",repeat:-1,props:{rotation:{from:Phaser.Math.DegToRad(0),to:Phaser.Math.DegToRad(360)}},onStop:function(){e.shineFx.rotation=Phaser.Math.DegToRad(0)}});var n=this.shineFx.scaleX,i=this.shineFx.scaleY;this.fxScaleAnimation=this.scene.tweens.add({targets:this.shineFx,duration:2e3,ease:Phaser.Math.Easing.Quadratic.Out,repeat:-1,yoyo:!0,props:{scaleX:{from:n,to:1.2*n},scaleY:{from:i,to:1.2*i}},onStop:function(){e.shineFx.setScale(n,i)}})},n.stopShineFxTween=function(){var e,t,n,i;null==(e=this.fxSpinAnimation)||e.stop(),null==(t=this.fxSpinAnimation)||t.remove(),null==(n=this.fxScaleAnimation)||n.stop(),null==(i=this.fxScaleAnimation)||i.remove()},n.runPostAdAnimation=function(){var e,t;null==(e=this.postAdCollectAnimation)||e.stop(),null==(t=this.postAdCollectAnimation)||t.remove(),this.postAdCollectAnimation=this.scene.tweens.add({targets:this.collectButton,duration:500,alpha:{from:.5,to:0},ease:Phaser.Math.Easing.Quadratic.In}),this.footerContainer.runPostAnimation(500)},n.runCoinTextAnimation=function(){var e,t,n=this;null==(e=this.coinTextAnimation)||e.stop(),null==(t=this.coinTextAnimation)||t.remove();var i=this.rewardWheel.getCurrentMultiplierResult(),a=this.baseValue.clone(),s=this.baseValue.clone();s.multiply(i);var r=s.clone();r.subtract(a),r.divide(10);var o=this.coinText.scaleX,c=this.coinText.scaleY;this.coinExplodeEffect.explode(12,this.coinIcon.x,this.coinIcon.y),this.coinTextAnimation=this.scene.tweens.addCounter({from:1,to:10,duration:150,onRepeat:function(){a.add(r),n.coinText.setText("+"+a.toString()),n.coinIcon.setPosition(n.coinText.displayWidth/2+10,n.coinIcon.y)},onStart:function(){n.scene.audio.playSound(S.Z.COIN_INCREASE_REPEATEDLY_SOUND),n.coinText.setScale(1.1*o,1.1*c),n.coinIcon.setPosition(n.coinText.displayWidth/2+10,n.coinIcon.y),a.add(r),n.coinText.setText("+"+a.toString()),n.coinIcon.setPosition(n.coinText.displayWidth/2+10,n.coinIcon.y)},onComplete:function(){n.coinText.setScale(o,c),n.coinIcon.setPosition(n.coinText.displayWidth/2+10,n.coinIcon.y)},onStop:function(){n.coinText.setScale(o,c),n.coinIcon.setPosition(n.coinText.displayWidth/2+10,n.coinIcon.y)},repeat:9})},n.updateCoinText=function(e){var t=this.baseValue.clone();t.multiply(e),this.claimCoinText.setText(""+t.toString()),this.claimText.setText(this.scene.lang.Text.GET+" x"+e)},t}(GameCore.Screen)},664:function(e,t,n){"use strict";n.d(t,{Z:function(){return se}});var i=n(20),a=n(5),s=n(1),r=n(18),o=n.n(r),c=n(53),l=n.n(c),u=n(38),h=n(39),d=n(152),p={targets:[],yoyo:!0,repeat:-1,duration:600,repeatDelay:50,ease:n.n(d)()(.55,.47,.43,.91),easeParams:[0,.9],props:{scale:{from:1,to:1.2}}},f=function(e){function t(t){return e.call(this,p,t)||this}return(0,s.Z)(t,e),t}(h.Z),g=n(489),E=n(232),m=n(159),v=n(67),A=n(129),S=n(485),T=n(491),y=n(492),C=n(66),I=n(34),R=n(2),w=n(30),_=n(24),b=n(25),L=n(484),P=n(483),O=n(665),D=n(65),k=n(17),N=n(86),B=n(68),M=R.Z.DEFAULT_8_BIT,x=M.KEY,U=M.FRAME,F=function(e){function t(t){var n;return(n=e.call(this,t,x,U.UNIT_REWARD_PARTICLE)||this).emitZone=void 0,n.emitter=void 0,n.createEmitZone(),n.scene.add.existing((0,a.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.createEmitZone=function(){this.emitZone=new Phaser.Geom.Rectangle},n.createEmitters=function(){var e=1/this.scene.world.getPixelRatio();this.emitter=this.createEmitter({on:!1,frame:U.UNIT_REWARD_PARTICLE,emitZone:{source:this.emitZone,type:"random"},timeScale:1,frequency:100,rotate:{min:0,max:90},alpha:{start:1,end:0,ease:Phaser.Math.Easing.Expo.Out},scale:{start:1*e,end:0,ease:Phaser.Math.Easing.Expo.Out},lifespan:{min:3e3,max:4500}})},n.run=function(e,t,n,i,a,s){void 0===s&&(s=100),this.stop(),this.reset(),this.emitZone.setSize(i,a),this.emitZone.setPosition(t-i/2,n-a/2),this.emitter.setQuantity(e),this.emitter.setFrequency(s),this.emitter.start()},n.stop=function(){var e,t;null==(e=this.emitter)||e.killAll(),null==(t=this.emitter)||t.stop()},n.reset=function(){this.createEmitters()},t}(Phaser.GameObjects.Particles.ParticleEmitterManager),Z=R.Z.DEFAULT_8_BIT,G=Z.KEY,H=Z.FRAME,Y=function(e){function t(t){var n;return(n=e.call(this,t,G,H.UNIT_REWARD_ELLIPSE_FX)||this).emitZone=void 0,n.emitter=void 0,n.createEmitZone(),n.createEmitters(),n.scene.add.existing((0,a.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.createEmitZone=function(){this.emitZone=new Phaser.Geom.Rectangle},n.createEmitters=function(){var e=1/this.scene.world.getPixelRatio();this.emitter=this.createEmitter({on:!1,frame:H.UNIT_REWARD_ELLIPSE_FX,emitZone:{source:this.emitZone,type:"random"},deathZone:{source:this.emitZone,type:"onLeave"},timeScale:1,frequency:150,speedY:{min:-20,max:-60},alpha:{start:1,end:0,ease:Phaser.Math.Easing.Cubic.Out},scale:{start:1*e,end:0,ease:Phaser.Math.Easing.Cubic.Out},lifespan:{min:1500,max:2500}})},n.run=function(e,t,n,i,a){this.stop(),this.emitZone.setSize(i,a),this.emitZone.setPosition(t-i/2,n-a/2),this.emitter.setQuantity(e),this.emitter.start()},n.stop=function(){var e,t;null==(e=this.emitter)||e.killAll(),null==(t=this.emitter)||t.stop()},t}(Phaser.GameObjects.Particles.ParticleEmitterManager),K=R.Z.DEFAULT_8_BIT,V=K.KEY,W=K.FRAME,j=function(e){function t(t){var n;return(n=e.call(this,t)||this).giftAdIcon=void 0,n.particleTweens=[],n.bubbleTwinkleUp=void 0,n.iconAttentionAnimation=void 0,n.createGlow(),n.createFx(),n.createCurrencyIcon(),n.updateSize(),n.createEllipses(),n.createParticles(),n.scene.add.existing((0,a.Z)(n)),n}(0,s.Z)(t,e);var n=t.prototype;return n.createGlow=function(){var e=this.scene.make.image({key:V,frame:W.UNIT_REWARD_GLOW});e.setWorldSize(372.5,372.5),this.add(e)},n.createFx=function(){var e=this.scene.make.image({key:V,frame:W.UNIT_REWARD_FX});e.setWorldSize(375,234.5),this.add(e)},n.createCurrencyIcon=function(){this.giftAdIcon=this.scene.add.image(0,0,V,W.UNIT_REWARD_GIFT_AD),this.giftAdIcon.setWorldSize(168.5,168),this.giftAdIcon.setY(0),this.add(this.giftAdIcon)},n.updateSize=function(){var e=this.giftAdIcon,t=e.displayWidth,n=e.displayHeight;this.setSize(t,n)},n.createEllipses=function(){this.bubbleTwinkleUp=new Y(this.scene),this.bubbleTwinkleUp.setScale(1.5),this.add(this.bubbleTwinkleUp)},n.createParticles=function(){for(var e=0;e<4;e++){var t=new F(this.scene);this.add(t),this.particleTweens.push(t)}},n.runLogoAttentionAnimation=function(e){this.iconAttentionAnimation||(this.iconAttentionAnimation=new f({targets:[this.giftAdIcon],delay:e,props:{scale:"+=0.05"}})),this.iconAttentionAnimation.play();var t=this.giftAdIcon,n=t.x,i=t.y,a=t.width,s=t.height;this.bubbleTwinkleUp.run(1,n,i,a,s),this.particleTweens.forEach((function(e){var t=Phaser.Math.Between(1e3,2e3);e.run(1,0,0,a,s,t)}))},n.stopAnimation=function(){this.particleTweens.forEach((function(e){e.stop()})),this.iconAttentionAnimation.stop()},t}(Phaser.GameObjects.Container),z=n(58),X=n(160),q=R.Z.DEFAULT_8_BIT,Q=q.KEY,J=q.FRAME,$=function(e){function t(t){var n;return(n=e.call(this,t,Q,J.BUTTON_GREEN_LONG,200,64)||this).setName("ViewAd"),n.createIcon(),n.createViewText(),n}(0,s.Z)(t,e);var n=t.prototype;return n.createIcon=function(){var e=this.scene.add.image(0,0,Q,J.ICON_AD);e.setWorldSize(43.5,45.5),Phaser.Display.Align.In.Center(e,this,-60,-5),this.add(e)},n.createViewText=function(){var e=new X.Z(this.scene,{font:I.Z.PRIMARY.KEY,size:this.scene.fontSize(22)});e.setText(this.scene.lang.Text.GET_NOW),e.setDropShadow(-1.5,1.5,0),Phaser.Display.Align.In.Center(e,this,25,-5),this.add(e)},t}(z.Z),ee=GameCore.Configs.Network,te=R.Z.DEFAULT_8_BIT,ne=te.KEY,ie=te.FRAME,ae=D.Z.LEVEL_PROGRESS,se=function(e){function t(t,n,s,r){var c;return(c=e.call(this,t,n,s,r)||this).rewardValue=void 0,c.hand=void 0,c.viewAdButton=void 0,c.skipButton=void 0,c.giftIcon=void 0,c.giftIconWhite=void 0,c.currencyText=void 0,c.giftAdComponent=void 0,c.popupContents=void 0,c.cometTwinkle=void 0,c.starTwinkleUp=void 0,c.sparksExplosive=void 0,c.contentFadeOutAnimation=void 0,c.backgroundFadeInAnimation=void 0,c.contentShowUpAnimation=void 0,c.giftEntrancesAnimation=void 0,c.giftAttentionAnimation=void 0,c.giftShakeAnimation=void 0,c.giftOpenAnimation=void 0,c.adsTimer=void 0,c.open=function(t){e.prototype.open.call((0,a.Z)(c),t),c.background.setAlpha(0),c.scene.requestBackgroundMaskUpdate(_.o4.UNIT_REWARD_SCREEN,c.background.alpha),c.setRewardValue(t.unitType),c.runOpenAnimation(),c.handleShowRewardedVideoAd()},c.handleClosePopup=function(){c.runCloseAnimation()},c.handleShowRewardedVideoAd=(0,i.Z)(o().mark((function e(){var t,n,i,a,s,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=null,n=c.scene,i=n.audio,a=n.game,e.prev=2,c.viewAdButton.setDisabled(!0),t=c.scene.game.globalScene.time.delayedCall(200,(function(){a.globalScene.screen.open(_.o4.NOTIFY_SCREEN,{message:a.lang.Text.LOADING_ADS,duration:0,loading:!0})})),i.muteAll(),e.next=8,new(l())((function(e,t){var n;null==(n=c.adsTimer)||n.remove(),c.adsTimer=c.scene.time.delayedCall(ee.Timeout,t),c.scene.ads.getAdStatus(GameCore.Ads.Types.REWARDED)===GameCore.Ads.Status.LOADING?c.scene.ads.events.once(GameCore.Ads.Events.LOADED,e):c.scene.ads.preloadRewardedVideoAsync().then(e).catch(t)}));case 8:return e.next=10,c.scene.ads.showRewardedVideoAsync();case 10:c.background.setAlpha(.8),c.scene.requestBackgroundMaskUpdate(_.o4.UNIT_REWARD_SCREEN,c.background.alpha),c.starTwinkleUp.stop(),c.scene.audio.playSound(b.Z.DAILY_REWARD),c.popupContents.killGroup(),c.runTheGiftEntrancesAnimation(0,1500),e.next=27;break;case 19:if(e.prev=19,e.t0=e.catch(2),!(e.t0 instanceof Object&&GameCore.Utils.Object.hasOwn(e.t0,"code")&&"USER_INPUT"===e.t0.code)){e.next=25;break}return c.handleClosePopup(),c.showNotifySkipAds(),e.abrupt("return");case 25:c.handleClosePopup(),c.showNotifyNoAds();case 27:return e.prev=27,null==(s=c.adsTimer)||s.destroy(),i.unmuteAll(),null==(r=t)||r.remove(),c.scene.game.globalScene.screen.close(_.o4.NOTIFY_SCREEN),c.scene.ads.preloadRewardedVideoAsync().catch((function(e){})),e.finish(27);case 34:case"end":return e.stop()}}),e,null,[[2,19,27,34]])}))),c.handleTheGiftClick=function(){c.setTheGiftClickable(!1),c.logButtonEvent("OpenGift"),c.hand.stopAnimation(),c.hand.kill(),c.giftIconWhite.revive(),c.scene.tweens.killTweensOf(c.giftIcon),Phaser.Display.Align.In.Center(c.giftIconWhite,c.giftIcon),c.scene.audio.playSound(b.Z.GIFT_CHARGE),(0,N.ZP)(50),c.runShakeTheGift(),c.runOpenTheGift()},c.showNotifyNoAds=function(e){if(!e||e.name===_.o4.CLOSEABLE_NOTIFY_SCREEN){var t=c.scene.game.globalScene;t.screen.open(_.o4.CLOSEABLE_NOTIFY_SCREEN,{message:t.lang.Text.NO_ADS_TO_DISPLAY,duration:1500,loading:!1})}},c.showNotifySkipAds=function(){var e=c.scene.game.globalScene;e.screen.open(_.o4.CLOSEABLE_NOTIFY_SCREEN,{message:e.lang.Text.SORRY_NO_REWARDS,duration:1500,loading:!1})},c.runCloseAnimation=function(){c.runExitsAnimation(0,200)},c.setDepth(_.Ks.POPUP),c.background.setAlpha(0),c.createViewAdsButton(),c.createSkipButton(),c.createGiftAdIcon(),c.createCurrencyText(),c.createEffects(),c.createGiftIcon(),c.createHand(),c.createContentsGroup(),c}(0,s.Z)(t,e);var n=t.prototype;return n.setTheGiftClickable=function(e){e?this.giftIcon.setInteractive():this.giftIcon.disableInteractive()},n.logButtonEvent=function(e){var t=this.getScreenName();this.scene.analytics.event(u._.BUTTON_CLICK,{button_name:e,screen_name:t})},n.runOpenAnimation=function(){this.revive(),this.hand.stopAnimation(),this.hand.kill(),this.popupContents.reviveGroup(),this.starTwinkleUp.stop(),this.runPopupContentEntrancesAnimation(100,400),this.runLogoAttentionAnimation(500)},n.runBackgroundEntrancesAnimation=function(e,t){var n=this;this.backgroundFadeInAnimation||(this.backgroundFadeInAnimation=new m.Z({targets:[this.background],delay:e,duration:t,props:{alpha:{start:0,to:.8}},onUpdate:function(e,t){n.scene.requestBackgroundMaskUpdate(_.o4.UNIT_REWARD_SCREEN,t.alpha)}})),this.backgroundFadeInAnimation.play()},n.runPopupContentEntrancesAnimation=function(e,t){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new A.Z({targets:this.popupContents.getChildren(),duration:t,delay:this.scene.tweens.stagger(100,{start:e}),props:{scale:{getStart:function(e){return e.scale-.3},getEnd:function(e){return e.scale}},alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runLogoAttentionAnimation=function(e){var t=this.giftAdComponent,n=t.x,i=t.y,a=t.width,s=t.height;this.starTwinkleUp.run(1,n,i,a,s),this.giftAdComponent.runLogoAttentionAnimation(e)},n.runTheGiftEntrancesAnimation=function(e,t){var n,i=this;this.giftIcon.revive(),this.giftIcon.setAlpha(1),Phaser.Display.Align.In.TopRight(this.giftIcon,this.zone),null==(n=this.giftEntrancesAnimation)||n.remove();var a=this.giftIcon,s=a.x,r=a.y,o=this.currencyText,c={x:s,y:r},l={x:o.x,y:o.y},u=1/this.scene.world.getPixelRatio();this.giftEntrancesAnimation=new S.Z({targets:[this.giftIcon],delay:e,duration:t,curve:[[c.x,c.y],[c.x-80,c.y+80],[l.x,l.y]],props:{scale:{start:.5*u,to:u},angle:{start:20,to:0}},onCurveUpdate:function(e){var t=e.x+Phaser.Math.RND.between(-40,40),n=e.y+Phaser.Math.RND.between(-40,40);i.cometTwinkle.explode(1,t,n)},onComplete:function(){i.scene.audio.playSound(b.Z.GIFT_REVEAL);i.starTwinkleUp.setScale(1.5);var e=i.giftIcon,t=e.x,n=e.y,a=e.width,s=e.height;i.starTwinkleUp.run(1,t,n,a/1.5,s/1.5),i.moveTo(i.starTwinkleUp,i.length-1),i.runTheGiftAttentionAnimation()}}),this.giftEntrancesAnimation.play()},n.runTheGiftAttentionAnimation=function(){this.giftAttentionAnimation||(this.giftAttentionAnimation=new f({targets:[this.giftIcon],props:{scale:"+=0.05"}})),this.hand.revive(),this.hand.playAnimation(),Phaser.Display.Align.In.Center(this.hand,this.giftIcon,20,20),this.setTheGiftClickable(!0),this.giftAttentionAnimation.play()},n.runShakeTheGift=function(){this.giftShakeAnimation||(this.giftShakeAnimation=new g.Z({targets:[this.giftIcon,this.giftIconWhite],duration:22})),this.giftShakeAnimation.play()},n.runOpenTheGift=function(){var e=this;if(!this.giftOpenAnimation){var t=1/this.scene.world.getPixelRatio();this.giftOpenAnimation=new E.Z({targets:[this.giftIcon,this.giftIconWhite],duration:1500,props:{alpha:0,scale:t},onUpdate:function(){e.giftIconWhite.setAlpha(1)},onComplete:function(){e.giftShakeAnimation.stop(),e.giftIcon.kill(),e.giftIconWhite.kill(),e.sparksExplosive.explode(100,e.giftIcon.x,e.giftIcon.y,230),e.scene.audio.playSound(b.Z.GIFT_EXPLODE),e.rewardUnit(),e.scene.time.delayedCall(500,e.runCloseAnimation)}})}this.giftOpenAnimation.play()},n.rewardUnit=function(){this.scene.analytics.event(u._.EARN_UNIT,{value:this.rewardValue.toLowerCase()+"-lv"+this.getRewardedUnitLevel()});var e=this.scene.scene.get(w.C.GAME_SCENE);e instanceof B.Z&&e.spawnUnit(this.rewardValue,!0,this.getRewardedUnitLevel())},n.getRewardedUnitLevel=function(){var e=this.scene.player.getCustomData(ae),t=GameCore.Utils.Valid.isNumber(e)?e+1:1,n=k.Z.BUYING_UNIT_LEVEL,i=1;return n.forEach((function(e,n){e<=t&&(i=n+1)})),i},n.runExitsAnimation=function(e,t){var n=this;this.contentFadeOutAnimation||(this.contentFadeOutAnimation=new v.Z({targets:this.popupContents.getChildren(),delay:e,duration:t,props:{alpha:{start:.8,to:0}},onComplete:function(){n.scene.requestBackgroundMaskUpdate(_.o4.UNIT_REWARD_SCREEN,0),n.scene.screen.close(n.name),n.viewAdButton.setDisabled(!1),n.skipButton.setDisabled(!1)}})),this.contentFadeOutAnimation.play()},n.createHand=function(){this.hand=new y.Z(this.scene),this.add(this.hand)},n.createContentsGroup=function(){this.popupContents=this.scene.make.group({}),this.popupContents.addMultiple([this.giftAdComponent,this.currencyText])},n.createCurrencyText=function(){this.currencyText=this.scene.make.bitmapText({size:this.scene.fontSize(22),font:I.Z.PRIMARY.KEY,origin:{x:.5,y:.5}}),this.currencyText.setCenterAlign(),this.setRewardValue("MELEE"),this.add(this.currencyText)},n.setRewardValue=function(e){this.rewardValue=e,this.currencyText.setText(this.scene.lang.Text.WATCH_A_VIDEO),Phaser.Display.Align.In.BottomCenter(this.currencyText,this.giftAdComponent,0,20)},n.createViewAdsButton=function(){var e=this;this.viewAdButton=new $(this.scene),this.viewAdButton.onClick=this.handleShowRewardedVideoAd,this.viewAdButton.onDown=function(){e.skipButton.setDisabled(!0)},this.viewAdButton.onOut=function(){e.skipButton.setDisabled(!1)},Phaser.Display.Align.In.Center(this.viewAdButton,this.zone,0,100),this.viewAdButton.kill()},n.createSkipButton=function(){var e=this;this.skipButton=new T.Z(this.scene,{key:ne,frame:ie.UNIT_REWARD_NO_THANKS_TEXT,width:123.5,height:18.5,paddingZone:50}),this.skipButton.setName("NoThanks"),this.skipButton.onClick=this.handleClosePopup,this.skipButton.onDown=function(){e.viewAdButton.setDisabled(!0)},this.skipButton.onOut=function(){e.viewAdButton.setDisabled(!1)},Phaser.Display.Align.In.BottomCenter(this.skipButton,this.viewAdButton,0,80),this.skipButton.kill()},n.createGiftAdIcon=function(){this.giftAdComponent=new j(this.scene),Phaser.Display.Align.In.Center(this.giftAdComponent,this.zone,0,-80),this.add(this.giftAdComponent)},n.createGiftIcon=function(){this.giftIconWhite=this.scene.make.image({key:ne,frame:ie.UNIT_REWARD_GIFT_GLOW,visible:!1}),this.giftIconWhite.setWorldSize(168.5,168),this.giftIconWhite.setDepth(C.Z.PRIORITY),this.add(this.giftIconWhite),this.giftIcon=this.scene.make.image({key:ne,frame:ie.UNIT_REWARD_GIFT,visible:!1}),this.giftIcon.setInteractive({useHandCursor:!0}),this.giftIcon.setWorldSize(168.5,168),this.giftIcon.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,this.handleTheGiftClick),this.setTheGiftClickable(!1),this.add(this.giftIcon)},n.createEffects=function(){this.cometTwinkle=new L.Z(this.scene),this.starTwinkleUp=new O.Z(this.scene),this.sparksExplosive=new P.Z(this.scene),this.add([this.cometTwinkle,this.starTwinkleUp,this.sparksExplosive])},t}(GameCore.Screen)},655:function(e,t,n){"use strict";n.d(t,{Z:function(){return b}});var i=n(1),a=n(24),s=n(2),r=n(17),o=n(5),c=n(128),l=n(34),u=n(30),h=n(490),d=n(656),p=n(68),f=s.Z.UNITS,g=f.KEY,E=(f.FRAME,s.Z.DEFAULT_8_BIT),m=E.KEY,v=E.FRAME,A=function(e){function t(t){var n;return(n=e.call(this,t)||this).glow=void 0,n.backEffect=void 0,n.bg=void 0,n.ribbon=void 0,n.healthContainer=void 0,n.healthText=void 0,n.atkContainer=void 0,n.atkText=void 0,n.unitName=void 0,n.unitFrame=void 0,n.particleTween=[],n.backEffectTween=void 0,n.exitTween=void 0,n.onExitComplete=void 0,n.loading=void 0,n.payload=void 0,n.handleWaitAddTexture=function(e,t){e===g&&(n.scene.textures.off(Phaser.Textures.Events.ADD,n.handleWaitAddTexture),(n.visible||n.active)&&n.setUnitFrame())},n.scene=t,n.setName("UnitCard"),n.createGlow(),n.createBackEffect(),n.createBg(),n.updateSize(),n.createRibbon(),n.createHealthContainer(),n.createAtkContainer(),n.createUnitName(),n.createUnitFrame(),n.createAnimation(),n.scene.add.existing((0,o.Z)(n)),n}(0,i.Z)(t,e);var n=t.prototype;return n.createGlow=function(){var e=this.scene.make.image({key:m,frame:v.UNIT_UNLOCK_GLOW});e.setName("glow"),e.setWorldSize(340.5,349.5),this.add(e),this.glow=e},n.createBackEffect=function(){var e=new h.Z(this.scene,{color:234748,width:{min:4,max:8},radius:{min:180,max:170},lineNumber:18});e.setName("backEffect"),e.setPosition(0,0),this.add(e),this.backEffect=e},n.createBg=function(){var e=this.scene.make.image({key:m,frame:v.UNIT_UNLOCK_FRAME});e.setName("frame"),e.setWorldSize(207.5,292),this.add(e),this.bg=e},n.createRibbon=function(){var e=this.scene.make.image({key:m,frame:v.UNIT_UNLOCK_BG});e.setName("ribbon"),e.setWorldSize(204,34.5),this.add(e),Phaser.Display.Align.In.TopCenter(e,this,-1,-4),this.ribbon=e},n.updateSize=function(){var e=this.bg,t=e.width,n=e.height;this.setSize(t,n)},n.createHealthContainer=function(){this.healthContainer=this.scene.make.container({}),this.healthContainer.setName("healthContainer");var e=this.scene.make.image({key:m,frame:v.UNIT_UNLOCK_BG_1});e.setName("health-bg"),e.setWorldSize(79.5,25),this.healthContainer.setSize(e.width,e.height);var t=this.scene.make.image({key:m,frame:v.UNIT_UNLOCK_ICON_HEART});t.setName("health-icon"),t.setWorldSize(21.5,19),Phaser.Display.Align.In.LeftCenter(t,e,-10);var n=this.scene.make.text({text:"0",style:{fontSize:"22px",color:"#ffffff",stroke:"#000000",strokeThickness:2,fixedWidth:286,align:"center",fontFamily:l.Z.FONT_FAMILY},origin:{x:.5,y:.5}});n.setHighQuality(),n.setPosition(15,0),this.healthText=n,this.healthContainer.add([e,t,n]),this.add(this.healthContainer),Phaser.Display.Align.In.TopLeft(this.healthContainer,this,-15,-8)},n.createAtkContainer=function(){this.atkContainer=this.scene.make.container({}),this.atkContainer.setName("atkContainer");var e=this.scene.make.image({key:m,frame:v.UNIT_UNLOCK_BG_1});e.setName("atk-bg"),e.setWorldSize(79.5,25),this.atkContainer.setSize(e.width,e.height);var t=this.scene.make.image({key:m,frame:v.UNIT_UNLOCK_ICON_BATTLE});t.setName("atk-icon"),t.setWorldSize(20.5,18),Phaser.Display.Align.In.LeftCenter(t,e,-10);var n=this.scene.make.text({text:"0",style:{fontSize:"22px",color:"#ffffff",stroke:"#000000",strokeThickness:2,fixedWidth:286,align:"center",fontFamily:l.Z.FONT_FAMILY},origin:{x:.5,y:.5}});n.setHighQuality(),n.setPosition(15,0),this.atkText=n,this.atkContainer.add([e,t,n]),this.add(this.atkContainer),Phaser.Display.Align.In.TopRight(this.atkContainer,this.ribbon,-15,-4)},n.createUnitName=function(){var e=this.scene.make.text({text:"Abcdefghjklmnopx",style:{fontSize:"22px",color:"#ffffff",fixedWidth:286,align:"center",fontFamily:l.Z.FONT_FAMILY},origin:{x:.5,y:.5}});e.setHighQuality(),this.unitName=e,this.add(e),Phaser.Display.Align.In.BottomCenter(e,this,0,-21)},n.createUnitFrame=function(){this.loading=new c.Z(this.scene),this.loading.setY(-10),this.add(this.loading);var e=this.scene.make.image({key:m,frame:v.BLANK});e.setName("unitFrame"),e.setWorldSize(200,200),e.setY(-9),this.add(e),e.kill(),this.unitFrame=e},n.createAnimation=function(){for(var e=0;e<4;e++){var t=new d.Z(this.scene);this.add(t),this.particleTween.push(t)}this.backEffectTween=this.scene.add.tween({paused:!0,targets:this.backEffect,duration:1e6,ease:Phaser.Math.Easing.Linear,repeat:-1,props:{rotation:{start:0,to:180}}})},n.runAnimation=function(){this.glow.revive(),this.backEffect.revive();var e=this.width,t=this.height;this.particleTween.forEach((function(n){var i=Phaser.Math.Between(1e3,2e3);n.run(1,0,0,e/2,t/2.5,i)})),this.backEffectTween.resume()},n.stopAnimation=function(){this.particleTween.forEach((function(e){e.stop()})),this.backEffectTween.pause()},n.runExitAnimation=function(){this.glow.kill(),this.backEffect.kill(),this.createExitAnimation(),this.exitTween.play()},n.createExitAnimation=function(){var e=this;if(!this.exitTween){var t=this.scale,n=this.x,i=this.y,a=n-160.5,s=i-300,r=this.scene.game.scene.getScene(u.C.GAME_SCENE);if(r instanceof p.Z){var o=r.uiManager.getUnitBtnPos(),c=o.x,l=o.y,h=this.parentContainer.getLocalPoint(c,l);a=h.x,s=h.y}this.exitTween=this.scene.add.tween({paused:!0,targets:this,duration:800,ease:Phaser.Math.Easing.Cubic.Out,props:{scale:{from:t,to:t/10},x:{delay:600,from:n,to:a},y:{delay:600,from:i,to:s},alpha:{delay:1300,duration:200,from:1,to:0}},onComplete:function(){e.onExitComplete&&e.onExitComplete(),e.setPosition(n,i),e.setScale(t),e.setAlpha(1)}})}},n.updateInfo=function(e){this.payload=e;var t=e.name,n=e.health,i=e.atk,a=e.frame;this.unitFrame.kill(),this.loading.revive(),this.unitName.setText(t);var s=GameCore.Utils.Number.toAbbreviatedString(n);this.healthText.setText(s);var r=GameCore.Utils.Number.toAbbreviatedString(i);this.atkText.setText(r),this.scene.textures.get(g).has(a)?this.setUnitFrame():this.scene.textures.on(Phaser.Textures.Events.ADD,this.handleWaitAddTexture),this.unitFrame.setFrame(a)},n.setUnitFrame=function(){var e=this.payload.frame;this.unitFrame.revive(),this.loading.kill(),this.unitFrame.setTexture(g,e),this.unitFrame.setWorldSize(200,200)},t}(Phaser.GameObjects.Container),S=n(112),T=n(111),y=n(25),C=n(113),I=s.Z.UNITS.FRAME,R=s.Z.DEFAULT_8_BIT,w=R.KEY,_=R.FRAME,b=function(e){function t(t,n,i,s){var r;return(r=e.call(this,t,n,i,s)||this).frameBg=void 0,r.popup=void 0,r.title=void 0,r.unitCard=void 0,r.closeBtn=void 0,r.isShowingAdBanner=void 0,r.showPopupAnimation=void 0,r.handleCloseScreen=function(){r.unitCard.stopAnimation(),r.scene.requestBackgroundMaskUpdate(a.o4.UNIT_UNLOCK_SCREEN,0),r.close()},r.background.setAlpha(.7),r.setDepth(a.Ks.POPUP),r.createPopup(),r.createUnitCard(),r.createPopupTitle(),r.createPopupAnimation(),r}(0,i.Z)(t,e);var n=t.prototype;return n.createPopup=function(){this.popup=this.scene.make.container({}),this.add(this.popup),this.popup.setName("popup");var e=new T.Z(this.scene,{x:0,y:0,width:307,height:386,rightEdge:292019,topInnerCornerStrokeWidth:2,rightInnerCornerStrokeWidth:3,lightY:-80});e.setName("frame"),this.frameBg=e,this.popup.add(e);var t=e.width,n=e.height;this.popup.setSize(t,n),this.createCloseButton();var i=this.isShowingAdBanner?-50:0;Phaser.Display.Align.In.Center(this.popup,this,0,i)},n.recalculateLightPosition=function(){this.frameBg&&this.frameBg.recalculateLightPosition()},n.createPopupTitle=function(){var e=this.scene.make.container({});e.setName("title");var t=this.scene.make.image({key:w,frame:_.RIBBON_GREEN});t.setWorldSize(239,65),e.add(t);var n=this.scene.make.text({text:this.scene.lang.Text.NEW_CHARACTER,style:{fontSize:"23px",color:"#FFFFFF",fixedWidth:299,align:"center",fontFamily:l.Z.FONT_FAMILY},origin:{x:.5,y:.5}});n.setHighQuality(),n.setPosition(0,-5),e.add(n),Phaser.Display.Align.In.TopCenter(e,this.popup,0,-28),this.add(e),this.title=e},n.createUnitCard=function(){this.unitCard=new A(this.scene),this.add(this.unitCard);var e=this.isShowingAdBanner?-25:25;this.unitCard.setY(e)},n.updateInfo=function(){var e=this.scene.scene.get(u.C.GAME_SCENE);if(e instanceof p.Z){var t=e.unitManager;if(t){var n=t.latestUnitMergePayload,i=n.level,a=n.type,s=t.getUnitDataForUnlockingScreen(),o="";if(a===r.Z.MELEE_UNIT_TYPE&&(o=I.UNLOCKED.MELEE[i]),a===r.Z.RANGED_UNIT_TYPE&&(o=I.UNLOCKED.RANGED[i]),""!==o){this.unitCard.updateInfo({frame:o,atk:s.damage,health:s.health,name:s.name});var c=this.isShowingAdBanner?-50:0;this.popup.setY(c),Phaser.Display.Align.In.TopCenter(this.title,this.popup,0,-28);var l=this.isShowingAdBanner?-25:25;this.unitCard.setY(l)}}}},n.createCloseButton=function(){var e=new S.Z(this.scene);e.setName("Close"),this.popup.add(e),Phaser.Display.Align.In.TopRight(e,this.popup,10,10),e.onClick=this.handleCloseScreen,this.closeBtn=e},n.open=function(){e.prototype.open.call(this),this.scene.requestBackgroundMaskUpdate(a.o4.UNIT_UNLOCK_SCREEN,this.background.alpha);var t=this.scene.scene.get(u.C.GAME_SCENE);t instanceof p.Z&&t.screenManager.listenResizeEventForCalculateLight(this),this.isShowingAdBanner=!t||t.isBannerAdShowed,this.showPopupAnimation.play(),this.updateInfo(),this.popup.revive(),this.title.revive(),this.background.revive(),this.unitCard.runAnimation()},n.close=function(){var t=this;this.setBlockInputOutsideEnabled(!1),this.visible&&(this.popup.kill(),this.title.kill(),this.background.kill(),this.unitCard.onExitComplete=function(){var n=t.scene.scene.get(u.C.GAME_SCENE);n instanceof p.Z&&n.screenManager.removeResizeEventForCalculateLight(t),t.scene.screen.close(t.name),t.scene.scene.resume(u.C.GAME_SCENE);var i=t.scene.game.scene.getScene(u.C.GAME_SCENE);i instanceof p.Z&&i.uiManager.runUnitBtnAnim(),t.scene.audio.playSound(y.Z.COIN_SPAWN_SOUND),e.prototype.close.call(t)},this.unitCard.runExitAnimation(),this.scene.scene.resume(u.C.GAME_SCENE))},n.createPopupAnimation=function(){this.showPopupAnimation=new C.Z({targets:[this.popup,this.title,this.unitCard,this.closeBtn]})},t}(GameCore.Screen)},654:function(e,t,n){"use strict";n.d(t,{Z:function(){return Te}});var i=n(20),a=n(1),s=n(18),r=n.n(s),o=n(53),c=n.n(o),l=n(150),u=n.n(l),h=n(113),d=n(67),p=n(126),f=n(30),g=n(24),E=n(25),m=n(65),v=n(17),A=n(68),S=n(112),T=n(111),y=n(34),C=n(2),I=n(5),R=n(488),w=C.Z.DEFAULT_8_BIT,_=w.KEY,b=w.FRAME,L=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).numOfCols=void 0,i.colPadding=void 0,i.sliderBg=void 0,i.sliderBar=void 0,i.minSliderY=void 0,i.maxSliderY=void 0,i.numOfCols=n.numOfCols?n.numOfCols:2,i.colPadding=n.colPadding?n.colPadding:0,i.createSlider(),i.updateConfig(n.listConfigs),i}(0,a.Z)(t,e);var n=t.prototype;return n.createSlider=function(){var e=this.scene.make.image({key:_,frame:b.UNIT_SCREEN_SLIDEBAR_BG});e.setName("sliderBg"),e.setWorldSize(6.5,255),Phaser.Display.Align.In.RightCenter(e,this,-3,5),this.add(e),this.sliderBg=e;var t=this.scene.make.image({key:_,frame:b.UNIT_SCREEN_BAR});t.setName("sliderBar"),t.setWorldSize(3.5,41.5),Phaser.Display.Align.In.TopCenter(t,this.sliderBg),this.add(t),this.sliderBar=t;var n=this.sliderBg,i=n.y,a=n.displayHeight;this.minSliderY=i-a/2+this.sliderBar.displayHeight/2+1.5,this.maxSliderY=this.minSliderY+this.sliderBg.displayHeight-this.sliderBar.displayHeight-1.5},n.createEvents=function(){var t=this;e.prototype.createEvents.call(this),this.scene.events.on(Phaser.Scenes.Events.UPDATE,(function(){var e=t.value-t.marginTop;t.value<-t.maxHeight?e=-t.maxHeight:t.value>0&&(e=0);var n=(e=-e)/(t.maxHeight+t.marginTop);t.sliderBar.setY(t.minSliderY+n*(t.maxSliderY-t.minSliderY))}))},n.updateMaxHeight=function(){var e=Math.ceil(this.listConfigs.length/this.numOfCols);return this.maxHeight=Math.max(e*(this.objHeight+this.padding)-this.padding+this.marginBottom-this.height,0)},n.addObjectIndex=function(e,t){for(var n=e;n<=t;n++){var i=this.padding,a=this.listConfigs;if(n>=a.length)return;var s=this.objects.getFirstDead(!0),r=s.height,o=Math.floor(n/this.numOfCols),c=n%this.numOfCols,l=r/2,u=(r+i)*o,h=this.height/2,d=l+u+this.value-h,p=s.width,f=p/2,g=-(this.numOfCols*(p+this.colPadding)-this.colPadding)/2+f+(p+this.colPadding)*c;s.updateInfo(a[n]),s.setPosition(g,d),s.setActive(!0),s.setVisible(!0),this.addAt(s),this.listObjects[n]=s}},n.getEndObjectIndex=function(){var e=this.objHeight,t=this.padding,n=this.listConfigs,i=e+t;return Math.min(this.numOfCols*Math.floor((this.height-this.value)/i)+(this.numOfCols-1),n.length)},n.updateListConfigMember=function(e,t,n){for(var i=0;i<this.listObjects.length;i++){var a=this.listConfigs[i],s=a.unitType,r=a.originData,o=a.currentAdWatched;if(s&&r&&void 0!==o){var c=r.level;if(c&&s===e&&c===t){a.currentAdWatched=n;break}}}this.scene.ads.canbeShowRewardAd()||this.objects.getMatching("active",!0).forEach((function(e){e.disableAds()}))},t}(R.Z),P=n(33),O=n(31),D=n.n(O),k=n(38),N=n(128),B=n(85),M=n(58),x=n(160),U=C.Z.DEFAULT_8_BIT,F=U.KEY,Z=U.FRAME,G=function(e){function t(t){var n;return(n=e.call(this,t,F,Z.UNIT_SCREEN_AD_BUTTON,145,41)||this).countText=void 0,n.adContainer=void 0,n.btnText=void 0,n.iconAd=void 0,n.iconCoin=void 0,n.createText(),n.createAdCount(),n}(0,a.Z)(t,e);var n=t.prototype;return n.createText=function(){var e=new x.Z(this.scene,{font:y.Z.PRIMARY.KEY,size:this.scene.fontSize(20)});e.setText(this.scene.lang.Text.FREE),e.setDropShadow(-1.5,1.5,0),e.setY(-7),this.add(e),this.btnText=e},n.getBtnTextFontSize=function(e){var t=this.scene.lang.getCurrentLanguage(),n=20;if("notAvailable"===e)switch(t){case"pt":n=17;break;case"id":n=18;break;case"de":case"it":case"tr":n=16}return"ja"===t&&(n=16),n},n.createAdCount=function(){var e=this.scene.make.container({}),t=this.scene.make.image({key:F,frame:Z.UNIT_SCREEN_AD_COUNT_BG});t.setWorldSize(68.5,17.5),e.setSize(68.5,17.5),e.add(t);var n=this.scene.make.image({key:F,frame:Z.UNIT_SCREEN_AD_ICON});n.setWorldSize(9,7.5),n.setX(-25),e.add(n),this.iconAd=n;var i=this.scene.make.image({key:F,frame:Z.UNIT_SCREEN_COIN_ICON});i.setWorldSize(12,11.5),i.setX(-25),e.add(i),this.iconCoin=i;var a=this.scene.make.bitmapText({font:y.Z.PRIMARY.KEY,size:this.scene.fontSize(10),origin:{x:.5,y:.6}});a.setText("0/999"),e.add(a),this.countText=a,Phaser.Display.Align.In.BottomCenter(e,this),this.add(e),this.adContainer=e},n.setCountText=function(e,t){0===t?this.countText.setText(""+e.toString()):-1===t?this.countText.setText(""):this.countText.setText(e.toString()+"/"+t),0===t?this.setMode("buy"):-1===t?this.setMode("notAvailable"):e>=t?this.setMode("collect"):this.setMode("watch")},n.setMode=function(e){"watch"===e?(this.adContainer.revive(),this.iconAd.revive(),this.iconCoin.kill(),this.btnText.setText(this.scene.lang.Text.FREE)):"collect"===e?(this.adContainer.kill(),this.btnText.setText(this.scene.lang.Text.COLLECT)):"notAvailable"===e?(this.adContainer.kill(),this.btnText.setText(this.scene.lang.Text.UNAVAILABLE)):(this.adContainer.revive(),this.iconAd.kill(),this.iconCoin.revive(),this.btnText.setText(this.scene.lang.Text.BUY)),this.btnText.setFontSize(this.getBtnTextFontSize(e))},t}(M.Z),H=C.Z.UNITS,Y=H.KEY,K=H.FRAME,V=C.Z.DEFAULT_8_BIT,W=V.KEY,j=V.FRAME,z=GameCore.Configs.Gameplay,X=z.MaximumMeleeLevel,q=z.MaximumRangedLevel,Q=v.Z.MELEE_UNIT_TYPE,J=v.Z.RANGED_UNIT_TYPE,$=function(e){function t(t,n){var a;return(a=e.call(this,t)||this).background=void 0,a.watchAdButton=void 0,a.titleText=void 0,a.lock=void 0,a.healthContainer=void 0,a.healthText=void 0,a.atkContainer=void 0,a.atkText=void 0,a.unitIcon=void 0,a.payload=void 0,a.loading=void 0,a.handleClickWatchAd=(0,i.Z)(r().mark((function e(){var t,n,i,s,o,c,l,u,h,d;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.payload,n=t.currentAdWatched,i=t.targetAdWatched,s=t.updateDataCallback,o=t.unitType,c=t.originData,l=t.showAdsCallback,u=t.collectCallback,h=c.level,!(n>=i)){e.next=13;break}if((d=0===i)||a.scene.analytics.event(k._.BUTTON_CLICK,{button_name:a.watchAdButton.name,unit:o+"-lv"+h,watchCount:n}),u(o,h,d)){e.next=8;break}return e.abrupt("return");case 8:return a.scene.analytics.event(k._.EARN_UNIT,{value:o+"-lv"+h}),a.payload.currentAdWatched=0,s(o,h,a.payload.currentAdWatched),a.updateAdButton(),e.abrupt("return");case 13:return a.scene.analytics.event(k._.BUTTON_CLICK,{button_name:a.watchAdButton.name,unit:o+"-lv"+h,watchCount:n}),e.prev=14,e.next=17,l();case 17:if(e.sent){e.next=20;break}return e.abrupt("return");case 20:e.next=25;break;case 22:return e.prev=22,e.t0=e.catch(14),e.abrupt("return");case 25:a.payload.currentAdWatched++,s(o,h,a.payload.currentAdWatched),a.updateAdButton();case 28:case"end":return e.stop()}}),e,null,[[14,22]])}))),a.handleWaitAddTexture=function(e,t){if(e===Y&&(a.scene.textures.off(Phaser.Textures.Events.ADD,a.handleWaitAddTexture),a.visible||a.active)){var n=a.getUnitFrame();""!==n&&a.setUnitFrame(n)}},a.scene=t,a.createBackground(),a.createWatchAdButton(),a.updateSize(),a.createUnitIcon(),a.createTitleText(),a.createLock(),a.createHealthContainer(),a.createAtkContainer(),n&&a.updateInfo(n),a.scene.add.existing((0,I.Z)(a)),a}(0,a.Z)(t,e);var n=t.prototype;return n.updateInfo=function(e){this.payload=(0,P.Z)({isUnlock:!1,isCanBuy:!1,coinNeed:new p.Z(0)},e),this.updateFrame(),this.updateTitle(),this.updateAdButton(),this.updateLock(),this.updateUnitIcon(),this.updateHealthContainer(),this.updateAtkContainer()},n.disableAds=function(){var e=this.payload,t=e.currentAdWatched,n=e.targetAdWatched;n>0&&t<n&&this.watchAdButton.setDisabled(!0)},n.runShowUpAnimation=function(e,t){void 0===e&&(e=0),void 0===t&&(t=300);var n=100*e;this.runShowPopUpAnimation(n,t),this.runShowItemAnimation(n,t)},n.runShowPopUpAnimation=function(e,t){this.scene.tweens.killTweensOf(this),new h.Z({targets:[this],delay:e,duration:t,props:{y:{start:this.y+70,to:this.y}}}).play()},n.runShowItemAnimation=function(e,t){var n=[this.background,this.watchAdButton,this.titleText,this.lock,this.healthContainer,this.atkContainer];this.unitIcon.visible&&this.unitIcon.active&&n.push(this.unitIcon);var i=D()(n).call(n,(function(e){return e.alpha}));n.forEach((function(e){return e.setAlpha(0)}));var a=D()(n).call(n,(function(e){return e.scale}));this.scene.tweens.killTweensOf(n),this.scene.add.tween({targets:n,duration:t,delay:this.scene.tweens.stagger(50,{start:e+50}),props:{scale:{duration:1e3,getStart:function(e,t,n,i){return.8*a[i]},getEnd:function(e,t,n,i){return a[i]},ease:Phaser.Math.Easing.Elastic.Out,easeParams:[.1,.45]},alpha:{duration:500,getStart:function(e){return e.setAlpha(0),0},getEnd:function(e,t,n,a){return i[a]},ease:Phaser.Math.Easing.Cubic.Out}},onStop:function(){n.forEach((function(e,t){e.setScale(a[t])}))},onComplete:function(){n.forEach((function(e,t){e.setScale(a[t])}))}})},n.createBackground=function(){this.background=this.scene.make.image({key:W,frame:j.UNIT_SCREEN_FRAME_1}),this.background.setWorldSize(145,205),this.background.setY(-20.5),this.add(this.background)},n.createWatchAdButton=function(){var e=new G(this.scene);e.onClick=this.handleClickWatchAd,this.add(e),Phaser.Display.Align.In.BottomCenter(e,this.background,0,41),this.watchAdButton=e},n.updateSize=function(){var e=this.background,t=e.width,n=e.height;this.setSize(t,n+41)},n.createTitleText=function(){var e=this.scene.make.text({text:"Locked",style:{fontSize:"15px",color:"#FFFFFF",fixedWidth:195,align:"center",fontFamily:y.Z.FONT_FAMILY},origin:{x:.5,y:.5}});e.setHighQuality(),this.add(e),this.titleText=e},n.createLock=function(){var e=this.scene.make.image({key:W,frame:j.UNIT_SCREEN_ICON_LOCK});e.setWorldSize(21,28),this.add(e),this.lock=e},n.createHealthContainer=function(){this.healthContainer=this.scene.make.container({});var e=this.scene.make.image({key:W,frame:j.UNIT_SCREEN_BG});e.setWorldSize(56.5,18),this.add(e);var t=this.scene.make.image({key:W,frame:j.UNIT_SCREEN_ICON_HEART});t.setWorldSize(15,13.5),Phaser.Display.Align.In.LeftCenter(t,e,-5);var n=this.scene.make.text({text:"0",style:{fontSize:"13px",color:"#FFFFFF",fixedWidth:169,align:"center",fontFamily:y.Z.FONT_FAMILY},origin:{x:.5,y:.5}});n.setHighQuality(),n.setPosition(10,0),this.healthText=n,this.healthContainer.add([e,t,n]),this.add(this.healthContainer),Phaser.Display.Align.In.TopLeft(this.healthContainer,this.background,-35,-12)},n.createAtkContainer=function(){this.atkContainer=this.scene.make.container({});var e=this.scene.make.image({key:W,frame:j.UNIT_SCREEN_BG});this.add(e),e.setWorldSize(56.5,18);var t=this.scene.make.image({key:W,frame:j.UNIT_SCREEN_ICON_BATTLE});t.setWorldSize(14,13),Phaser.Display.Align.In.LeftCenter(t,e,-5);var n=this.scene.make.text({text:"0",style:{fontSize:"13px",color:"#FFFFFF",fixedWidth:169,align:"center",fontFamily:y.Z.FONT_FAMILY},origin:{x:.5,y:.5}});n.setHighQuality(),n.setPosition(10,0),this.atkText=n,this.atkContainer.add([e,t,n]),this.add(this.atkContainer),Phaser.Display.Align.In.TopRight(this.atkContainer,this.background,-35,-12)},n.createUnitIcon=function(){this.loading=new N.Z(this.scene),this.loading.setY(-30),this.add(this.loading);var e=this.scene.make.image({key:W,frame:j.BLANK});e.setWorldSize(142,142),this.add(e),Phaser.Display.Align.In.Center(e,this.background,0,-8),e.kill(),this.unitIcon=e},n.updateFrame=function(){this.payload.isUnlock?(this.background.setFrame(j.UNIT_SCREEN_FRAME_1),this.background.setWorldSize(145,205)):(this.background.setFrame(j.UNIT_SCREEN_FRAME_LOCKED),this.background.setWorldSize(145,202.5))},n.updateTitle=function(){if(this.payload.isUnlock){var e=this.payload.originData.name;this.titleText.setText(e),this.titleText.setColor("#FFFFFF"),this.titleText.setPosition(0,58)}else{var t;this.isUnitComingSoon()?(t="Coming Soon",this.titleText.setPosition(0,58)):(t=this.scene.lang.Text.LOCKED,this.titleText.setPosition(0,58)),this.titleText.setText(t),this.titleText.setColor("#9AACBF")}},n.isUnitComingSoon=function(){var e=this.payload,t=e.originData,n=e.unitType,i=t.level;switch(n){case Q:return i>X;case J:return i>q;default:return!0}},n.updateAdButton=function(){var e=this.payload,t=e.isUnlock,n=e.currentAdWatched,i=e.targetAdWatched,a=e.isUnitBoardFull,s=e.coinNeed,r=e.isCanBuy,o=e.unitType,c=e.originData.level,l=!1,u=this.scene.scene.get(f.C.GAME_SCENE);if(u instanceof A.Z&&(l=u.gameMode===B.Z.BATTLE),this.watchAdButton.setDisabled(!1),t)if(this.watchAdButton.setVisible(!0),0===i){var h=GameCore.Utils.String.toCamelCase(o);this.watchAdButton.setName("Buy"+h+"Unit"),this.watchAdButton.disableLogEvent(!1),this.watchAdButton.setCountText(s,i),(!r||a||l)&&this.watchAdButton.setDisabled(!0)}else if(-1===i)this.watchAdButton.setName("NotAvailable"+o+c+"Unit"),this.watchAdButton.disableLogEvent(!0),this.watchAdButton.setCountText(0,i),this.watchAdButton.setDisabled(!0);else{var d="BuyUnitByRewardedVideo";n>=i&&(d="CollectUnitByRewardedVideo"),this.watchAdButton.setName(d),this.watchAdButton.disableLogEvent(!0),this.watchAdButton.setCountText(n,i),n>=i&&(a||l)&&this.watchAdButton.setDisabled(!0),n<i&&!this.scene.ads.canbeShowRewardAd()&&this.watchAdButton.setDisabled(!0)}else this.watchAdButton.setVisible(!1)},n.updateLock=function(){this.payload.isUnlock?this.lock.setVisible(!1):(this.isUnitComingSoon()?this.lock.setPosition(-45,53):this.lock.setPosition(-57,25),this.lock.setVisible(!0))},n.updateUnitIcon=function(){var e=this.getUnitFrame();""!==e&&(this.scene.textures.get(Y).has(e)?this.setUnitFrame(e):this.scene.textures.on(Phaser.Textures.Events.ADD,this.handleWaitAddTexture))},n.getUnitFrame=function(){var e=this.payload,t=e.isUnlock,n=e.unitType,i=this.payload.originData.level,a="UNLOCKED";t||(a="LOCKED");var s="";return n===v.Z.MELEE_UNIT_TYPE&&(s=K[a].MELEE[i]),n===v.Z.RANGED_UNIT_TYPE&&(s=K[a].RANGED[i]),s},n.setUnitFrame=function(e){this.unitIcon.revive(),this.loading.kill(),this.unitIcon.setTexture(Y,e),this.unitIcon.setWorldSize(142,142)},n.updateHealthContainer=function(){var e=this.payload.originData.health,t=GameCore.Utils.Number.toAbbreviatedString(e);this.healthText.setText(t)},n.updateAtkContainer=function(){var e=this.payload.originData.damage,t=GameCore.Utils.Number.toAbbreviatedString(e);this.atkText.setText(t)},t}(Phaser.GameObjects.Container),ee=function(e){function t(t){var n;return(n=e.call(this,t)||this).scroller=void 0,n.createScroller(),n.scene.add.existing((0,I.Z)(n)),n}(0,a.Z)(t,e);var n=t.prototype;return n.createScroller=function(){this.scroller=new L(this.scene,{classType:$,listConfigs:[],width:322,height:265.5,padding:10,marginTop:10,marginBottom:10,numOfCols:2,colPadding:5}),this.scroller.setName("scroller"),this.scroller.createMask(),this.scroller.setPosition(0,40),this.add(this.scroller)},n.updateData=function(e){e.length<1||(this.scroller.updateConfig(e),this.runAnimations())},n.updateListConfigMember=function(e,t,n){this.scroller.updateListConfigMember(e,t,n)},n.runAnimations=function(){var e=this,t=this.scroller.getChildren();if(t.length<1){var n=this.scene.screen.get(g.o4.UNITS_SCREEN);if(!(n instanceof Te))return;n.isSwitchable=!0}else{for(var i=Math.min(t.length,3*this.scroller.numOfCols),a=0;a<i;a++){var s=t[a];s&&(s.setVisible(!0),s.runShowUpAnimation(a,300))}var r=300+100*i+250;this.scene.time.delayedCall(r,(function(){var t=e.scene.screen.get(g.o4.UNITS_SCREEN);t instanceof Te&&(t.isSwitchable=!0,e.scroller.setEnable(!0))}))}},t}(Phaser.GameObjects.Container),te=C.Z.DEFAULT_8_BIT,ne=te.KEY,ie=te.FRAME,ae=function(e){function t(t,n,i,a){var s;return(s=e.call(this,t,n,i)||this).focusFrame=void 0,s.text=void 0,s.createText(a),s.createFocus(),s}(0,a.Z)(t,e);var n=t.prototype;return n.createText=function(e){var t=this.scene.make.text({text:e,style:{stroke:"#000000",strokeThickness:2,fontSize:"13px",color:"#FFFFFF",fixedWidth:169,align:"center",fontFamily:y.Z.FONT_FAMILY},origin:{x:.5,y:.5}});t.setHighQuality(),t.setShadow(0,4,"#000000",0,!0),this.add(t),this.text=t},n.createFocus=function(){var e=this.scene.make.image({key:ne,frame:ie.UNIT_SCREEN_TAB_FOCUS});e.setName("focus"),e.setWorldSize(57,3.5),e.setVisible(!1),Phaser.Display.Align.In.Center(e,this,0,this.button.height),e.setPosition(0,13),this.add(e),this.focusFrame=e},n.turnOnFocus=function(){this.focusFrame.setVisible(!0),this.text.setColor("#FFFFFF")},n.turnOffFocus=function(){this.focusFrame.setVisible(!1),this.text.setColor("#72ABFA")},t}(M.Z),se=C.Z.DEFAULT_8_BIT,re=se.KEY,oe=se.FRAME,ce=function(e){function t(t){var n;return(n=e.call(this,t)||this).ribbon=void 0,n.dinosaursBtn=void 0,n.warriorsBtn=void 0,n.createRibbon(),n.createDinosaursBtn(),n.createWarriorsBtn(),n}(0,a.Z)(t,e);var n=t.prototype;return n.selectTabDinosaurs=function(){this.dinosaursBtn.turnOnFocus(),this.warriorsBtn.turnOffFocus()},n.selectTabWarriors=function(){this.dinosaursBtn.turnOffFocus(),this.warriorsBtn.turnOnFocus()},n.createRibbon=function(){var e=this.scene.make.image({key:re,frame:oe.UNIT_SCREEN_TAB_BG});e.setWorldSize(329,29),e.setName("ribbon"),Phaser.Display.Align.In.Center(e,this),this.add(e),this.ribbon=e},n.createDinosaursBtn=function(){var e=new ae(this.scene,re,oe.BLANK,this.scene.lang.Text.DINOSAURS);e.button.setWorldSize(85,29),e.button.setVisible(!1),e.setName("DinosaursTab"),Phaser.Display.Align.In.Center(e,this.ribbon,-100,0),this.add(e),this.dinosaursBtn=e},n.createWarriorsBtn=function(){var e=new ae(this.scene,re,oe.BLANK,this.scene.lang.Text.WARRIORS);e.button.setWorldSize(85,29),e.button.setVisible(!1),e.setName("WarriorsTab"),Phaser.Display.Align.In.Center(e,this.ribbon,0,0),this.add(e),this.warriorsBtn=e},t}(Phaser.GameObjects.Container),le=C.Z.DEFAULT,ue=le.KEY,he=le.FRAME,de=function(e){function t(t){var n;return(n=e.call(this,t)||this).popup=void 0,n.tabs=void 0,n.scrollerController=void 0,n.closeBtn=void 0,n.onClose=void 0,n.handleOnCloseClick=function(){n.onClose&&n.onClose()},n.createPopup(),n.createPopupContents(),n.updateSize(),n.createCloseButton(),n}(0,a.Z)(t,e);var n=t.prototype;return n.updateSize=function(){var e=this.popup,t=e.width,n=e.height;this.setSize(t,n)},n.createPopup=function(){this.popup=new T.Z(this.scene,{x:0,y:0,width:332,height:399,rightEdge:283798,bottomRightCorner:215172,bottomEdge:76382,mainTopColorGradient:145525,mainBotColorGradient:145525,topInnerCornerStrokeWidth:1.3,rightInnerCornerStrokeWidth:3}),this.popup.turnOffLight(),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this)},n.recalculateLightPosition=function(){this.popup&&this.popup.recalculateLightPosition()},n.createPopupContents=function(){this.createTitle(),this.createScrollerController(),this.createNonInteractiveArea(),this.createTabs()},n.createTitle=function(){var e=this.scene.add.container();e.setName("title");var t=this.scene.make.image({key:ue,frame:he.RIBBON_BLUE});t.setWorldSize(239,67);var n=this.scene.make.text({text:""+this.scene.lang.Text.CHARACTER_LIST,style:{fontSize:"21px",color:"#FFFFFF",fixedWidth:286,align:"center",fontFamily:y.Z.FONT_FAMILY},origin:{x:.5,y:.5}});n.setHighQuality(),Phaser.Display.Align.In.Center(n,t,0,-10),e.add([t,n]),this.add(e),Phaser.Display.Align.In.TopCenter(e,this.popup,0,-28)},n.createTabs=function(){this.tabs=new ce(this.scene),this.tabs.setName("tabs"),this.add(this.tabs),Phaser.Display.Align.In.TopCenter(this.tabs,this.popup,0,-85)},n.createScrollerController=function(){this.scrollerController=new ee(this.scene),this.add(this.scrollerController),Phaser.Display.Align.In.Center(this.scrollerController,this.popup)},n.createNonInteractiveArea=function(){var e=0;this.scene.world.isLandscape()&&(e=15);var t=this.scrollerController.y+40,n=315.5,i=this.scene.add.zone(0,0,322,n);i.setPosition(0,t-e-290.5),i.setInteractive(),this.add(i);var a=this.scene.add.zone(0,0,322,n);a.setPosition(0,t+e+290.5),a.setInteractive(),this.add(a)},n.createCloseButton=function(){this.closeBtn=new S.Z(this.scene),Phaser.Display.Align.In.TopRight(this.closeBtn,this,10,10),this.add(this.closeBtn),this.closeBtn.onClick=this.handleOnCloseClick},n.updateData=function(e){this.scrollerController.updateData(e)},n.updateListConfigMember=function(e,t,n){this.scrollerController.updateListConfigMember(e,t,n)},n.removeAllBlocks=function(){this.scrollerController.updateData([])},t}(Phaser.GameObjects.Container),pe=m.Z.MELEE_UNLOCKED,fe=m.Z.RANGED_UNLOCKED,ge=m.Z.UNIT_SCREEN_AD_WATCHED_COUNT,Ee=v.Z.AD_WATCH_REQUIREMENT,me=GameCore.Configs.Network,ve=GameCore.Configs.Gameplay,Ae=ve.MaximumMeleeLevel,Se=ve.MaximumRangedLevel,Te=function(e){function t(t,n,a,s){var o;return(o=e.call(this,t,n,a,s)||this).unitPopup=void 0,o.isSwitchable=void 0,o.showPopupAnimation=void 0,o.fadeOutAnimation=void 0,o.adsTimer=void 0,o.isShowingAds=void 0,o.handleSelectDinosaursTab=function(){o.isSwitchable&&(o.isSwitchable=!1,o.selectDinosaursTab())},o.handleSelectWarriorsTab=function(){o.isSwitchable&&(o.isSwitchable=!1,o.selectWarriorsTab())},o.handleCloseScreen=function(){o.runFadeOutAnimation()},o.updateListConfig=function(e,t,n){var i={MELEE:{},RANGED:{}};try{i=o.mergeAndGetAdWatchedCountConfig(e,t,n)}catch(a){console.error(a)}o.scene.player.setCustomData(ge,i),o.unitPopup.updateListConfigMember(e,t,n)},o.handleShowRewardedVideoAd=(0,i.Z)(r().mark((function e(){var t,n,i,a,s,l,u;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o.isShowingAds){e.next=2;break}return e.abrupt("return",!1);case 2:return t=!1,n=null,i=o.scene,a=i.audio,s=i.game,e.prev=5,o.isShowingAds=!0,n=s.globalScene.time.delayedCall(200,(function(){s.globalScene.screen.open(g.o4.NOTIFY_SCREEN,{message:s.lang.Text.LOADING_ADS,duration:0,loading:!0})})),a.muteAll(),e.next=11,new(c())((function(e,t){var n;null==(n=o.adsTimer)||n.remove(),o.adsTimer=o.scene.time.delayedCall(me.Timeout,t),o.scene.ads.getAdStatus(GameCore.Ads.Types.REWARDED)===GameCore.Ads.Status.LOADING?o.scene.ads.events.once(GameCore.Ads.Events.LOADED,e):o.scene.ads.preloadRewardedVideoAsync().then(e).catch(t)}));case 11:return e.next=13,o.scene.ads.showRewardedVideoAsync();case 13:s.globalScene.screen.close(g.o4.NOTIFY_SCREEN),o.scene.audio.playSound(E.Z.DAILY_REWARD),t=!0,e.next=23;break;case 18:e.prev=18,e.t0=e.catch(5),t=!1,console.info("\ud83d\ude80 > showRewardedAdAsync",e.t0),e.t0 instanceof Object&&GameCore.Utils.Object.hasOwn(e.t0,"code")&&"USER_INPUT"===e.t0.code?o.showNotifySkipAds():o.showNotifyNoAds();case 23:return e.prev=23,o.isShowingAds=!1,null==(l=o.adsTimer)||l.destroy(),a.unmuteAll(),null==(u=n)||u.remove(),s.globalScene.screen.close(g.o4.NOTIFY_SCREEN),o.scene.ads.preloadRewardedVideoAsync().catch((function(e){})),e.finish(23);case 31:return e.abrupt("return",t);case 32:case"end":return e.stop()}}),e,null,[[5,18,23,31]])}))),o.showNotifyNoAds=function(e){if(!e||e.name===g.o4.CLOSEABLE_NOTIFY_SCREEN){var t=o.scene.game.globalScene;t.screen.open(g.o4.CLOSEABLE_NOTIFY_SCREEN,{message:t.lang.Text.NO_ADS_TO_DISPLAY,duration:1500,loading:!1})}},o.showNotifySkipAds=function(){var e=o.scene.game.globalScene;e.screen.open(g.o4.CLOSEABLE_NOTIFY_SCREEN,{message:e.lang.Text.SORRY_NO_REWARDS,duration:1500,loading:!1})},o.handleCollectUnit=function(e,t,n){void 0===n&&(n=!1);var i=o.scene.scene.get(f.C.GAME_SCENE),a=!1;return i instanceof A.Z&&(a=e===v.Z.MELEE_UNIT_TYPE?i.spawnUnit("MELEE",!0,t,n):i.spawnUnit("RANGED",!0,t,n)),o.handleCloseScreen(),a},o.background.setAlpha(.7),o.setDepth(g.Ks.POPUP),o.createUnitPopup(),o}(0,a.Z)(t,e);var n=t.prototype;return n.open=function(){e.prototype.open.call(this),this.isShowingAds=!1,this.scene.requestBackgroundMaskUpdate(g.o4.UNITS_SCREEN,this.background.alpha),this.runPopupAnimation(),this.isSwitchable=!1,this.selectDinosaursTab()},n.selectDinosaursTab=function(){this.unitPopup.tabs.selectTabDinosaurs(),this.unitPopup.removeAllBlocks();var e=this.getDataOf(v.Z.MELEE_UNIT_TYPE);this.unitPopup.updateData(e)},n.selectWarriorsTab=function(){this.unitPopup.tabs.selectTabWarriors(),this.unitPopup.removeAllBlocks();var e=this.getDataOf(v.Z.RANGED_UNIT_TYPE);this.unitPopup.updateData(e)},n.recalculateLightPosition=function(){this.unitPopup&&this.unitPopup.recalculateLightPosition()},n.getDataOf=function(e){var t=this,n=[],i=this.scene.scene.get(f.C.GAME_SCENE),a=this.getAdWatchedCount(e),s=!0,r=1,o=!1;if(i instanceof A.Z&&(s=!(i.fieldManager.getRemainingAvailablePlacement()>0),r=i.getBuyingUnitLevel(),o=i.tutorialManager.isRunning()),e===v.Z.MELEE_UNIT_TYPE){var c=this.scene.player.getCustomData(pe);c&&"number"===typeof c||(c=1);var l=this.scene.coin.getCurrentCoins(),u=new p.Z(0),h=!0;if(i instanceof A.Z){var d=i.unitManager.getPlayerMeleeSpawnedUnitsCount();u=i.coinManager.getUnitPrice(d)}if(l.smallerThan(u))l.toString()!==u.toString()&&(h=!1);this.scene.cache.json.get("unitData").melee.forEach((function(e){n.push({originData:e,unitType:v.Z.MELEE_UNIT_TYPE,isUnlock:e.level<=c,currentAdWatched:a[e.level-1],targetAdWatched:!o&&e.level>=r?Ee[e.level-1]:-1,isUnitBoardFull:s,isCanBuy:1===e.level&&h,coinNeed:u,updateDataCallback:t.updateListConfig,showAdsCallback:t.handleShowRewardedVideoAd,collectCallback:t.handleCollectUnit})}))}else if(e===v.Z.RANGED_UNIT_TYPE){var g=this.scene.player.getCustomData(fe);g&&"number"===typeof g||(g=1);var E=this.scene.coin.getCurrentCoins(),m=new p.Z(0),S=!0;if(i instanceof A.Z){var T=i.unitManager.getPlayerRangedSpawnedUnitsCount();m=i.coinManager.getUnitPrice(T)}if(E.smallerThan(m))E.toString()!==m.toString()&&(S=!1);this.scene.cache.json.get("unitData").ranged.forEach((function(e){n.push({originData:e,unitType:v.Z.RANGED_UNIT_TYPE,isUnlock:e.level<=g,currentAdWatched:a[e.level-1],targetAdWatched:!o&&e.level>=r?Ee[e.level-1]:-1,isUnitBoardFull:s,isCanBuy:1===e.level&&S,coinNeed:m,updateDataCallback:t.updateListConfig,showAdsCallback:t.handleShowRewardedVideoAd,collectCallback:t.handleCollectUnit})}))}else console.error("Unknown type: ",e);return n},n.getAdWatchedCount=function(e){var t=this.scene.player.getCustomData(ge),n={},i=0;if(e===v.Z.MELEE_UNIT_TYPE)n=t.MELEE,i=Ae;else{if(e!==v.Z.RANGED_UNIT_TYPE){console.error("Unknown type: ",e);for(var a=[],s=0;s<i;s++)a.push(0);return a}n=t.RANGED,i=Se}for(var r=[],o=0,c=u()(n);o<c.length;o++){var l=c[o],h=l[0],d=l[1],p=parseInt(h);if(p>i||p<1)break;r[p-1]=d}return r.forEach((function(e,t){void 0===e&&(console.error("Undefined ad watched count for level: ",t+1),r[t]=0)})),r},n.createUnitPopup=function(){this.unitPopup=new de(this.scene),this.unitPopup.setName("UnitPopup"),this.unitPopup.onClose=this.handleCloseScreen,Phaser.Display.Align.In.Center(this.unitPopup,this,0,-20),this.add(this.unitPopup),this.unitPopup.tabs.dinosaursBtn.onClick=this.handleSelectDinosaursTab,this.unitPopup.tabs.warriorsBtn.onClick=this.handleSelectWarriorsTab},n.runPopupAnimation=function(){this.showPopupAnimation||(this.showPopupAnimation=new h.Z({targets:[this.unitPopup]})),this.showPopupAnimation.play()},n.runFadeOutAnimation=function(){var e=this;this.fadeOutAnimation||(this.fadeOutAnimation=new d.Z({targets:[this.background],duration:200,ease:Phaser.Math.Easing.Cubic.Out,props:{alpha:{start:.7,from:.7,to:0}},onActive:function(){e.unitPopup.kill()},onUpdate:function(t,n){e.scene.requestBackgroundMaskUpdate(g.o4.UNITS_SCREEN,n.alpha)},onComplete:function(){e.unitPopup.revive(),e.background.setAlpha(.7),e.scene.screen.close(e.name)}})),this.fadeOutAnimation.play()},n.mergeAndGetAdWatchedCountConfig=function(e,t,n){if(void 0===t||void 0===n)return{MELEE:{},RANGED:{}};var i,a;if(e===v.Z.MELEE_UNIT_TYPE&&t<=Ae&&t>0)return{MELEE:(i={},i[t]=n,i),RANGED:{}};if(e===v.Z.RANGED_UNIT_TYPE)return{MELEE:{},RANGED:(a={},a[t]=n,a)};throw Error("Unknown type in Get Ad Watched Config: "+e)},t}(GameCore.Screen)},597:function(e,t,n){"use strict";var i=n(157),a=n(459),s=n(33),r=n(20),o=n(1),c=n(18),l=n.n(c),u=n(626),h=0,d=0,p=function(){function e(e){this.game=void 0,this.progressFbTimeEvent=void 0,this.game=e}var t=e.prototype;return t.loadingProgressFbBootScene=function(){var e=this,t=100;d=30;!function n(){t<=0?clearTimeout(e.progressFbTimeEvent):e.progressFbTimeEvent=setTimeout((function(){e.game.facebook.setLoadingProgress(Math.round(d)),d+=30/t,t--,n()}),50)}()},t.finishLoadingProgressFbBootScene=function(){clearTimeout(this.progressFbTimeEvent)},t.loadingProgressFbLoadScene=function(){var e=this;(!d||d<30)&&(d=60),h=d;!function t(){e.progressFbTimeEvent=setTimeout((function(){e.game.facebook.setLoadingProgress(Math.round(d)),d+=.1,t()}),50)}()},t.onProgress=function(e){var t=100-d,n=Math.round(e*t+d);n>h&&clearTimeout(this.progressFbTimeEvent),this.game.facebook.setLoadingProgress(n)},e}(),f=function(){function e(e){this.game=void 0,this.game=e}var t=e.prototype;return t.addKillRevive=function(){var e=this;[Phaser.GameObjects.RenderTexture,Phaser.GameObjects.Container,Phaser.GameObjects.Image,Phaser.GameObjects.Sprite,Phaser.GameObjects.Graphics,Phaser.GameObjects.Shape,Phaser.GameObjects.Text,Phaser.GameObjects.BitmapText,Phaser.GameObjects.Particles.ParticleEmitter,Phaser.GameObjects.Particles.ParticleEmitterManager].forEach((function(t){t.prototype.kill=e.kill,t.prototype.revive=e.revive}))},t.addKillReviveGroup=function(){Phaser.GameObjects.Group.prototype.killGroup=this.killGroup,Phaser.GameObjects.Group.prototype.reviveGroup=this.reviveGroup},t.addSetWorldSize=function(){var e=this;[Phaser.GameObjects.RenderTexture,Phaser.GameObjects.Image,Phaser.GameObjects.Sprite].forEach((function(t){t.prototype.setWorldSize=e.setWorldSize}))},t.addSetWorldSizeForContainer=function(){var e=this;[Phaser.GameObjects.Container].forEach((function(t){t.prototype.setWorldSize=e.setWorldSizeForContainer}))},t.addGetWorldPosition=function(){var e=this;[Phaser.GameObjects.RenderTexture,Phaser.GameObjects.Container,Phaser.GameObjects.Image,Phaser.GameObjects.Sprite,Phaser.GameObjects.Graphics,Phaser.GameObjects.Shape,Phaser.GameObjects.Text,Phaser.GameObjects.BitmapText].forEach((function(t){t.prototype.getWorldPosition=e.getWorldPosition}))},t.addDrawDebugBox=function(){var e=this;[Phaser.GameObjects.RenderTexture,Phaser.GameObjects.Container,Phaser.GameObjects.Image,Phaser.GameObjects.Sprite,Phaser.GameObjects.Graphics,Phaser.GameObjects.Shape,Phaser.GameObjects.Text,Phaser.GameObjects.BitmapText,Phaser.GameObjects.Zone].forEach((function(t){t.prototype.drawDebugBox=e.drawDebugBox}))},t.addHighQuality=function(){var e=this;[Phaser.GameObjects.Text].forEach((function(t){t.prototype.setHighQuality=e.setHighQuality}))},t.kill=function(){this.setActive(!1),this.setVisible(!1)},t.revive=function(){this.setActive(!0),this.setVisible(!0)},t.killGroup=function(){this.getChildren().forEach((function(e){e.setActive(!1),e.setVisible(!1)}))},t.reviveGroup=function(){this.getChildren().forEach((function(e){e.setActive(!0),e.setVisible(!0)}))},t.setWorldSize=function(e,t){this.setSize(e,t),this.setDisplaySize(e,t)},t.setWorldSizeForContainer=function(e,t,n){void 0===n&&(n=2),this.setSize(e*n,t*n),this.setDisplaySize(e,t)},t.getWorldPosition=function(){var e=this.getWorldTransformMatrix().decomposeMatrix();return{x:e.translateX,y:e.translateY}},t.drawDebugBox=function(e,t){var n=this.x,i=this.y,a=this.width,s=this.height,r=this.depth,o=this.originX,c=this.originY,l=this.scene.add.rectangle(n,i,a,s,e,t);l.setName("Debug Box"),l.setDepth(r);var u=GameCore.Utils.Valid.isNumber;return u(o)&&u(c)&&l.setOrigin(o,c),l},t.setHighQuality=function(){return this.renderer instanceof Phaser.Renderer.WebGL.WebGLRenderer?this.setResolution(2*this.scene.game.world.getZoomRatio()):this},e}(),g=n(41),E=n.n(g),m=GameCore.Configs.Ads.Mockup.GiphyApiKey,v=GameCore.Configs.Ads.BannerAdOptions,A=function(){function e(){}return e.loadBannerAdAsync=function(){var e=(0,r.Z)(l().mark((function e(){var t,n,i,a,s,r;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getAdContentAsync();case 2:if(t=e.sent,n=document.getElementById("mock-banner-ads"),i=v.length>0?v[0].bannerHeight:120,!n){e.next=12;break}if((a=n.getElementsByTagName("img"))&&!(a.length<=0)){e.next=9;break}return e.abrupt("return");case 9:a[0].src=t,e.next=28;break;case 12:(s=document.createElement("div")).id="mock-banner-ads",s.style.width="100%",s.style.height=i+"px",s.style.bottom="var(--sab)",s.style.position="fixed",s.style.background="#fff url("+t+") center center/auto no-repeat",s.style.outline="2px solid #ffffff40",s.style.outlineOffset="-2px",r=document.createElement("style"),(document.head||document.getElementsByTagName("head")[0]).appendChild(r),"@keyframes fake-gif {\n                0%,10% {\n                    background-position-y: top\n                }\n                60% {\n                    background-position-y: center\n                }\n                100% {\n                    background-position-y: bottom\n                }\n            }",r.appendChild(document.createTextNode("@keyframes fake-gif {\n                0%,10% {\n                    background-position-y: top\n                }\n                60% {\n                    background-position-y: center\n                }\n                100% {\n                    background-position-y: bottom\n                }\n            }")),s.style.animation="fake-gif 6s ease-in-out 0s infinite alternate both",document.body.appendChild(s);case 28:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),e.getAdContentAsync=function(){var e=(0,r.Z)(l().mark((function e(){var t,n,i,a,s;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="https://api.giphy.com/v1/gifs/trending?api_key="+m+"&rate=pg&bundle=low_bandwidth",e.next=3,fetch(t,{method:"GET"});case 3:return n=e.sent,e.next=6,n.json();case 6:if(i=e.sent,GameCore.Utils.Valid.isObject(i)){e.next=9;break}return e.abrupt("return","");case 9:return a=i.data,s=Math.floor(Math.random()*a.length),e.abrupt("return",a[s].images.downsized.url);case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),e.hideBannerAdAsync=function(){var e=(0,r.Z)(l().mark((function e(){var t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=document.getElementById("mock-banner-ads")){e.next=3;break}return e.abrupt("return");case 3:t.remove();case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),e}(),S={LOADED:"loaded",DISPLAYED:"displayed"},T=function(e){return e.IDLE="idle",e.LOADING="loading",e.FILLED="filled",e.SHOWING="showing",e}(T||{}),y=T,C=function(e){return e.REWARDED="rewarded",e.INTERSTITIAL="interstitial",e}(C||{}),I=C,R=n(227),w=function(e){function t(t,n){var i;return(i=e.call(this,n)||this).code=void 0,i.code=t,i.message=n,i}return(0,o.Z)(t,e),t}((0,R.Z)(Error)),_=function(e){this.type=void 0,this.status=void 0,this.type=e,this.status=y.IDLE};GameCore.Ads={Types:I,Status:y,Events:S,AdError:w,AdInstance:_};var b=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=e.call.apply(e,E()(t=[this]).call(t,a))||this).events=void 0,n.enabled=void 0,n.config=void 0,n.lastInterAdShownTime=void 0,n.lastRewardAdShownTime=void 0,n.interstitial=void 0,n.rewardedVideo=void 0,n.safeAreaBottom=void 0,n.showingBannerAd=void 0,n.reloadBannerAdIntervals=void 0,n.bannerAdConfig=void 0,n.isHaveBannerAdOptions=void 0,n}(0,o.Z)(t,e);var n=t.prototype;return n.init=function(){this.events=new Phaser.Events.EventEmitter,this.safeAreaBottom=0,this.lastInterAdShownTime=0,this.lastRewardAdShownTime=0,this.showingBannerAd={},this.reloadBannerAdIntervals={},this.isHaveBannerAdOptions=!0},n.calculateSafeAreaBottom=function(){try{if(!this.config.calculateSafeAreaBottom)return;this.safeAreaBottom=parseInt(getComputedStyle(document.documentElement).getPropertyValue("--sab")),isNaN(this.safeAreaBottom)&&(this.safeAreaBottom=0)}catch(e){this.safeAreaBottom=0}},n.configure=function(e,t){this.enabled=t.enabled,this.config=t,0===this.config.bannerAdOptions.length&&(this.isHaveBannerAdOptions=!1),this.setAdInstance(e),this.calculateSafeAreaBottom()},n.setAdInstance=function(e){var t=this.config,n=t.rewardAdOptions,i=t.interstitialAdOptions;this.interstitial=new e(I.INTERSTITIAL,n.pID),this.rewardedVideo=new e(I.REWARDED,i.pID)},n.preloadInterstitialAdAsync=function(){var e=(0,r.Z)(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.preloadAdAsync(I.INTERSTITIAL);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.showInterstitialAdAsync=function(){var e=(0,r.Z)(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.canbeShowInterstitialAd()){e.next=2;break}throw new w("INTERSTITIAL_AD_CAN_NOT_SHOW","Can't show interstitial ad");case 2:return e.next=4,this.showAdAsync(I.INTERSTITIAL);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.preloadRewardedVideoAsync=function(){var e=(0,r.Z)(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.preloadAdAsync(I.REWARDED);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.showRewardedVideoAsync=function(){var e=(0,r.Z)(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.canbeShowRewardAd()){e.next=2;break}throw new w("REWARDED_VIDEO_CAN_NOT_SHOW","Can't show rewarded video");case 2:return e.next=4,this.showAdAsync(I.REWARDED);case 4:this.lastRewardAdShownTime=window.performance.now()/1e3;case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.getRemainingRewardTime=function(){var e=window.performance.now()/1e3,t=this.config.rewardAdOptions.secondsBetweenAds,n=e-this.lastRewardAdShownTime;return n<t?t-n:0},n.preloadAdAsync=function(){var e=(0,r.Z)(l().mark((function e(t){var n;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.enabled){e.next=2;break}throw new w("ADS_NOT_ENABLED","Ads is't enabled");case 2:if(null!==(n=this.getAdInstanceByType(t))){e.next=5;break}throw new w("AD_INSTANCE_NOT_INITIATED","The instance ads not yet initiated");case 5:return e.next=7,n.loadAsync();case 7:this.events.emit(S.LOADED,t);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.showAdAsync=function(){var e=(0,r.Z)(l().mark((function e(t){var n;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.enabled){e.next=2;break}throw new w("ADS_NOT_ENABLED","Ads is't enabled");case 2:if(null!==(n=this.getAdInstanceByType(t))){e.next=5;break}throw new w("AD_INSTANCE_NOT_INITIATED","The instance ads not yet initiated");case 5:return t===I.INTERSTITIAL&&(this.lastInterAdShownTime=window.performance.now()/1e3),t===I.REWARDED&&(this.lastRewardAdShownTime=window.performance.now()/1e3,this.config.enableRewardVideoResetInterstitial&&(this.lastInterAdShownTime=this.lastRewardAdShownTime)),e.next=9,n.showAsync();case 9:this.events.emit(S.DISPLAYED,t);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.getAdStatus=function(e){var t=this.getAdInstanceByType(e);return t?t.getStatus():null},n.getAdInstanceByType=function(e){switch(e){case I.INTERSTITIAL:return this.interstitial;case I.REWARDED:return this.rewardedVideo;default:return null}},n.canbeShowInterstitialAd=function(){return this.canbeShowInterstitialAdByTime()},n.canbeShowInterstitialAdByTime=function(){var e=window.performance.now()/1e3,t=this.config.interstitialAdOptions,n=t.secondsFirstTime,i=t.secondsBetweenAds,a=Math.floor(e-this.lastInterAdShownTime);return this.lastInterAdShownTime>0?a>=i:a>=n},n.canbeShowRewardAd=function(){var e=window.performance.now()/1e3,t=this.config.rewardAdOptions,n=t.secondsFirstTime,i=t.secondsBetweenAds,a=Math.floor(e-this.lastRewardAdShownTime);return this.lastRewardAdShownTime>0?a>=i:a>=n},n.canShowBannerAd=function(){if(!this.isHaveBannerAdOptions)return!1;for(var e=this.config.bannerAdOptions,t=GameCore.Utils.Device.isDesktop(),n=0;n<e.length;n++){var i=e[n],a=i.platform;("ALL"==a||"DESKTOP"==a&&t||"MOBILE"==a&&!t)&&(this.bannerAdConfig=i)}var s=GameCore.Configs.Game,r=s.PortraitWidth,o=s.PortraitHeight,c=this.game.world.getWorldSize(),l=c.width,u=c.height,h=(this.bannerAdConfig||{}).bannerHeight,d=void 0===h?0:h,p=this.game.world,f=p.getPixelRatio(),g=p.getZoomRatio(),E=r/(o-120),m=l/(u-this.game.world.getPhysicPixels(d,f/g));return console.log({gameRatioWithBanner:m,defaultRatio:E,gameWidth:l,gameHeight:u,bannerHeight:d}),!(m>E)&&void 0!=this.bannerAdConfig},n.showBannerAdAsync=function(){var e=(0,r.Z)(l().mark((function e(){var t,n,i,a=this;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.enabled){e.next=2;break}return e.abrupt("return");case 2:if(this.canShowBannerAd()){e.next=4;break}return e.abrupt("return");case 4:if(this.reloadBannerAdIntervals=this.reloadBannerAdIntervals||{},t=this.bannerAdConfig,n=t.placementId,i=t.secondsReload,n&&""!=n){e.next=8;break}return e.abrupt("return");case 8:if(!(i>0)){e.next=14;break}if(!this.reloadBannerAdIntervals[n]){e.next=11;break}return e.abrupt("return");case 11:return this.loadBannerAdAsync(n),this.reloadBannerAdIntervals[n]=setInterval((function(){a.loadBannerAdAsync(n)}),1e3*i),e.abrupt("return");case 14:return this.loadBannerAdAsync(n),e.abrupt("return");case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.loadBannerAdAsync=function(){var e=(0,r.Z)(l().mark((function e(t){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.enabled){e.next=2;break}return e.abrupt("return");case 2:if(e.prev=2,!GameCore.Configs.Ads.Mockup.Enable){e.next=9;break}return e.next=7,A.loadBannerAdAsync();case 7:e.next=11;break;case 9:return e.next=11,GameSDK.loadBannerAdAsync(t);case 11:this.showingBannerAd[t]=!0,e.next=17;break;case 14:e.prev=14,e.t0=e.catch(2),console.log(e.t0);case 17:case"end":return e.stop()}}),e,this,[[2,14]])})));return function(t){return e.apply(this,arguments)}}(),n.hideBannerAdAsync=function(){var e=(0,r.Z)(l().mark((function e(){var t=this;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.enabled){e.next=2;break}return e.abrupt("return");case 2:if(this.isHaveBannerAdOptions){e.next=4;break}return e.abrupt("return");case 4:if(e.prev=4,!GameCore.Configs.Ads.Mockup.Enable){e.next=11;break}return e.next=9,A.hideBannerAdAsync();case 9:e.next=15;break;case 11:return this.config.bannerAdOptions.forEach((function(e){var n=e.placementId,i=t.reloadBannerAdIntervals[n];i&&(clearInterval(i),t.reloadBannerAdIntervals[n]=null),t.showingBannerAd[n]=!1})),e.next=15,GameSDK.hideBannerAdAsync();case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(4),console.log(e.t0);case 20:case"end":return e.stop()}}),e,this,[[4,17]])})));return function(){return e.apply(this,arguments)}}(),n.getBannerHeight=function(){if(!this.enabled)return 0;if(!this.canShowBannerAd())return 0;var e=(this.bannerAdConfig||{}).bannerHeight,t=(void 0===e?0:e)+this.safeAreaBottom;if(this.game.world){var n=this.game.world,i=n.getPixelRatio(),a=n.getZoomRatio();return this.game.world.getPhysicPixels(t,i/a)}return t},t}(Phaser.Plugins.BasePlugin),L=b,P=function(){function e(e,t,n){this.name=void 0,this.color=void 0,this.selfLog=void 0,this.options=void 0,this.name=e,this.color=n||"#FFF",this.options=t,this.selfLog=!0,console.info("%c"+this.name+": init","color: "+this.color,this.options)}var t=e.prototype;return t.event=function(e,t,n){this.processEvent(e,t,n),this.selfLog&&console.info("%c"+this.name+": event","color: "+this.color,{name:e,value:n,payload:t})},t.pageview=function(e){var t=this.getPageByKey(e);this.processPageView(t),this.selfLog&&console.info("%c"+this.name+": pageview","color: "+this.color,{page:t})},t.levelStart=function(e,t){this.processLevelStart(e,t),this.selfLog&&console.info("%c"+this.name+": level start","color: "+this.color,{level:e,gameMode:t})},t.levelFail=function(e,t,n){this.processLevelFail(e,t,n),this.selfLog&&console.info("%c"+this.name+": level fail","color: "+this.color,{level:e,gameMode:t,playedTime:n})},t.levelRescue=function(e,t){this.processLevelRescue(e,t),this.selfLog&&console.info("%c"+this.name+": level rescue","color: "+this.color,{level:e,gameMode:t})},t.levelComplete=function(e,t,n){this.processLevelComplete(e,t,n),this.selfLog&&console.info("%c"+this.name+": level complete","color: "+this.color,{level:e,gameMode:t,playedTime:n})},t.showInterstitialAd=function(e){this.processShowInterstitialAd(e),this.selfLog&&console.info("%c"+this.name+": show interstitial ad","color: "+this.color,{placement:e})},t.showRewardedVideoAd=function(e){this.processShowRewardedVideoAd(e),this.selfLog&&console.info("%c"+this.name+": show rewarded video ad","color: "+this.color,{placement:e})},t.receiveReward=function(e){this.processReceiveReward(e),this.selfLog&&console.info("%c"+this.name+": receive reward","color: "+this.color,{placement:e})},t.showAdFail=function(e,t,n){this.processShowAdFail(e,t,n),this.selfLog&&console.info("%c"+this.name+": show ad fail","color: "+this.color,{type:e,placement:t,reason:n})},t.getPageByKey=function(e){var t=e.replace(/_/g,"-");return t=t.toLowerCase()},e}();GameCore.Analytics={BaseAnalytics:P};var O=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=e.call.apply(e,E()(t=[this]).call(t,a))||this).analytics=void 0,n.pageview=function(e){n.isActive()&&n.analytics.forEach((function(t){t.pageview(e)}))},n}(0,o.Z)(t,e);var n=t.prototype;return n.init=function(){this.analytics=[]},n.add=function(e){this.analytics.push(e)},n.event=function(e,t,n){this.isActive()&&this.analytics.forEach((function(i){i.event(e,t,n)}))},n.levelStart=function(e,t){this.isActive()&&this.analytics.forEach((function(n){n.levelStart(e,t)}))},n.levelRescue=function(e,t){this.isActive()&&this.analytics.forEach((function(n){n.levelRescue(e,t)}))},n.levelFail=function(e,t,n){this.isActive()&&this.analytics.forEach((function(i){i.levelFail(e,t,n)}))},n.levelComplete=function(e,t,n){this.isActive()&&this.analytics.forEach((function(i){i.levelComplete(e,t,n)}))},n.showInterstitialAd=function(e){this.isActive()&&this.analytics.forEach((function(t){t.showInterstitialAd(e)}))},n.showRewardedVideoAd=function(e){this.isActive()&&this.analytics.forEach((function(t){t.showRewardedVideoAd(e)}))},n.receiveReward=function(e){this.isActive()&&this.analytics.forEach((function(t){t.receiveReward(e)}))},n.showAdFail=function(e,t,n){this.isActive()&&this.analytics.forEach((function(i){i.showAdFail(e,t,n)}))},n.isActive=function(){return this.analytics.length>=1},t}(Phaser.Plugins.BasePlugin),D=O,k={BACKGROUND:{KEY:"background",FILE:"./assets/music/bg_music.mp3"},EFFECTS_FILES:{"start-game-sound":"./assets/sounds/start-game-sound.mp3","next-round-effect":"./assets/sounds/next-round-effect.mp3","lose-sound":"./assets/sounds/lose-sound.mp3","thunder-sound":"./assets/sounds/thunder-sound.mp3","close-click":"./assets/sounds/close-click.mp3","button-click":"./assets/sounds/button-click.mp3","drag-unit-end":"./assets/sounds/drag-unit-end.mp3","drag-unit-start":"./assets/sounds/drag-unit-start.mp3","start-battle":"./assets/sounds/start-battle.mp3","melee-attack":"./assets/sounds/melee-attack.mp3","arrow-shoot":"./assets/sounds/arrow-shoot.mp3","win-battle":"./assets/sounds/win-battle.mp3","unit-damaged":"./assets/sounds/unit-damaged.mp3","unit-merge":"./assets/sounds/unit-merge.mp3","turn-switch":"./assets/sounds/turn-switch.mp3","unit-unlock":"./assets/sounds/unit-unlock.mp3","coin-spawn":"./assets/sounds/coin-spawn.mp3","coin-increase-repeatedly":"./assets/sounds/coin-increase-repeatedly.mp3","gift-charge":"./assets/sounds/gift-charge.mp3","gift-explode":"./assets/sounds/gift-explode.mp3","gift-reveal":"./assets/sounds/gift-reveal.mp3"}},N=n(239),B=n.n(N),M=k.EFFECTS_FILES,x=function(){function e(e){var t=this;this.game=void 0,this.audios=void 0,this.volume=void 0,this.isMusicEnabled=function(){return!!t.game.player.getPlayerSetting("music")},this.isSoundEnabled=function(){return!!t.game.player.getPlayerSetting("sound")},this.game=e,this.audios=new(B())}var t=e.prototype;return t.play=function(e,t){var n=this,i=(0,s.Z)({volume:this.volume},t||{});i.volume!==this.volume&&(i.volume*=this.volume);var a=this.audios.get(e);a?a.play(void 0,i):(this.game.globalScene.load.audio(e,M[e]),this.game.globalScene.load.on(Phaser.Loader.Events.FILE_KEY_COMPLETE+"audio-"+e,(function(){var t=n.game.sound.add(e);n.audios.set(e,t),t.play(void 0,i)})),this.game.globalScene.load.start())},t.pause=function(e){var t=this.audios.get(e);t&&t.pause()},t.stop=function(e){var t=this.audios.get(e);t&&t.stop()},t.setVolume=function(e){this.volume=e},e}(),U=x,F=function(){function e(e,t,n){var i=this;this.name=void 0,this.game=void 0,this.isSprite=void 0,this.audio=void 0,this.markers=void 0,this.volume=void 0,this.volumePerMs=void 0,this.targetVolume=void 0,this.handleIncreaseVolume=function(e,t){var n;i.volume+=i.volumePerMs*t,null==(n=i.audio)||n.setVolume(i.volume),(i.volumePerMs>=0&&i.volume>=i.targetVolume||i.volumePerMs<=0&&i.volume<=i.targetVolume)&&(i.volume=i.targetVolume,i.game.globalScene.events.off(Phaser.Scenes.Events.UPDATE,i.handleIncreaseVolume))},this.isMusicEnabled=function(){return!!i.game.player.getPlayerSetting("music")},this.isSoundEnabled=function(){return!!i.game.player.getPlayerSetting("sound")},this.name=t,this.game=e,this.markers={},this.isSprite=n,this.volume=0,this.isSprite||(this.audio=this.game.sound.add(this.name))}var t=e.prototype;return t.play=function(e,t){var n,i,a,r=(0,s.Z)({volume:this.volume},t||{});if(r.volume!==this.volume&&(r.volume*=this.volume),!this.isSprite)return(null==(i=this.audio)?void 0:i.seek)>0?void this.audio.resume():void(null==(a=this.audio)||a.play(e,r));this.createMaker(e),null==(n=this.markers[e])||n.play(e,r)},t.pause=function(e){var t,n;this.isSprite?null==(t=this.markers[e])||t.pause():null==(n=this.audio)||n.pause()},t.stop=function(e){var t,n;this.isSprite?null==(t=this.markers[e])||t.stop():null==(n=this.audio)||n.stop()},t.setVolume=function(e,t){var n;if(0===t||e===this.volume)return this.game.globalScene.events.off(Phaser.Scenes.Events.UPDATE,this.handleIncreaseVolume),this.volume=e,void(null==(n=this.audio)||n.setVolume(e));this.volumePerMs=(e-this.volume)/t,this.targetVolume=e,this.game.globalScene.events.off(Phaser.Scenes.Events.UPDATE,this.handleIncreaseVolume),this.game.globalScene.events.on(Phaser.Scenes.Events.UPDATE,this.handleIncreaseVolume)},t.createMaker=function(e){if(!this.markers[e])try{this.markers[e]=this.game.sound.addAudioSprite(this.name)}catch(t){console.warn("createMaker",t)}},e}(),Z=F,G=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=e.call.apply(e,E()(t=[this]).call(t,a))||this).soundManager=void 0,n.musicManager=void 0,n.isMuteAll=void 0,n.initMusic=function(e){n.musicManager=new Z(n.game,e,!1),n.setMusicVolume(0)},n.initSound=function(){n.soundManager=new U(n.game),n.setSoundVolume(1)},n}(0,o.Z)(t,e);var n=t.prototype;return n.playSound=function(e,t){try{if(!this.soundManager||this.isMuteAll||!this.game.visibility.isGameVisible())return;if(!this.soundManager.isSoundEnabled())return;this.soundManager.play(e,t)}catch(n){}},n.stopSound=function(e){try{this.soundManager.stop(e)}catch(t){}},n.playMusic=function(e){void 0===e&&(e={});try{if(!this.musicManager||this.isMuteAll||!this.game.visibility.isGameVisible())return;if(!this.musicManager.isMusicEnabled())return;this.musicManager.play("",(0,s.Z)({loop:!0,volume:.4},e))}catch(t){}},n.pauseMusic=function(){try{if(!this.musicManager)return;this.musicManager.pause("")}catch(e){}},n.stopMusic=function(){try{if(!this.musicManager)return;this.musicManager.stop("")}catch(e){}},n.setSoundVolume=function(e){try{if(!this.soundManager)return;this.soundManager.setVolume(e)}catch(t){console.warn("setSoundVolume",t)}},n.setMusicVolume=function(e,t){void 0===t&&(t=0);try{if(!this.musicManager)return;this.musicManager.setVolume(e,t)}catch(n){console.warn("setMusicVolume",n)}},n.muteAll=function(){this.isMuteAll=!0,this.game.sound.mute=!0},n.unmuteAll=function(){this.isMuteAll=!1,this.game.globalScene.sound.mute=!1},t}(Phaser.Plugins.BasePlugin),H=G,Y=n(57),K="AUTH_TOKEN_REQUEST",V="AUTH_TOKEN_RECEIVED",W=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).payload=void 0,i.name="RequestTokenFail",i.message=t||"Request token fail",i.payload=n||{},i}return(0,o.Z)(t,e),t}((0,R.Z)(Error)),j=W,z=n(125),X="auth",q=(0,z.P1)([function(e){return e[X].token}],(function(e){return e})),Q=(0,z.P1)([function(e){return e[X].isRequesting}],(function(e){return e})),J=function(e){return{type:V,payload:{token:e}}},$=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var n=t.prototype;return n.requestToken=function(){var e=(0,r.Z)(l().mark((function e(){var t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.game.storage,e.next=3,t.dispatch(function(){var e=(0,r.Z)(l().mark((function e(t,n){var a,s,r,o;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,a=window.game.facebook,s=n(),r=q(s),!Q(s)&&""===r){e.next=7;break}return e.abrupt("return");case 7:return t({type:K,payload:{}}),e.next=10,a.getPlayerToken();case 10:o=e.sent,t(J(o)),e.next=25;break;case 14:if(e.prev=14,e.t0=e.catch(0),!(e.t0 instanceof Object&&GameCore.Utils.Object.hasOwn(e.t0,"code"))){e.next=19;break}if("PENDING_REQUEST"!==e.t0.code){e.next=19;break}return e.abrupt("return");case 19:if(t(J("")),!(e.t0 instanceof Object&&GameCore.Utils.Object.hasOwn(e.t0,"message"))){e.next=24;break}if("string"!==typeof e.t0.message){e.next=24;break}return(0,i.tO)(new Error(e.t0.message)),e.abrupt("return");case 24:(0,i.tO)(new j);case 25:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t,n){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.getToken=function(){return q(this.state)},(0,Y.Z)(t,[{key:"state",get:function(){return this.game.storage.getState()}}]),t}(Phaser.Plugins.BasePlugin),ee=$,te=n(31),ne=n.n(te),ie=n(87),ae=n.n(ie),se=n(84),re=n(30),oe=n(24),ce=n(158),le="open",ue="active",he="finished",de=n(226),pe=n(38),fe=n(229),ge=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="InvalidContextId",i.message=t||"This contextId is not valid",i.payload=n,i}return(0,o.Z)(t,e),t}((0,R.Z)(Error)),Ee=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="InvalidOpponentId",i.message=t||"This opponentId is not valid",i.payload=n,i}return(0,o.Z)(t,e),t}((0,R.Z)(Error)),me=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="WideFrameRenderFail",i.message=t||"Wide frame render fail",i.payload=n,i}return(0,o.Z)(t,e),t}((0,R.Z)(Error)),ve={PASS_LEVELS:{ID:"pass-levels",EVENTS:{PASS_LEVEL:"pass-level"}},COLLECT_DIAMONDS:{ID:"collect-diamonds",EVENTS:{COLLECT_DIAMONDS:"collect-diamonds"}},INVITE_FRIENDS:{ID:"invite-friends",EVENTS:{INVITED_FRIEND:"INVITED_FRIEND"}},REACH_SCORE:{ID:"reach-score",EVENTS:{ADD_SCORE:"add-score"}},EVENTS:{TASKS_RESET:"tasks-reset",NOTICE_UPDATE:"notice-update"}},Ae=(0,z.P1)([function(e){return e.messages.data}],(function(e){return e})),Se=((0,z.P1)([Ae,function(e,t){return t.opponentId}],(function(e,t){return!!GameCore.Utils.Valid.isString(t)&&(!!GameCore.Utils.Object.hasOwn(e,t)&&e[t].sent)})),n(445)),Te=new(n.n(Se)()),ye=n(65),Ce=ye.Z.LEVEL_PROGRESS,Ie=function(e){if("string"!==typeof e||!e)throw new me(null,{imageShare:e})},Re=(function(){var e=(0,r.Z)(l().mark((function e(){var t,n,i,a,s,r,o,c,u,h,d;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=window.game,n=t.player,i=t.analytics,a=t.facebook,s=t.globalScene,r=t.rollbar,e.prev=1,s.screen.open(oe.o4.NOTIFY_SCREEN,{message:s.lang.Text.LOADING,loading:!0}),e.next=5,Re();case 5:return o=e.sent,Ie(o),c=n.getPlayer(),u=c.playerId,h=c.name,d=c.photo,e.next=10,a.shareAsync({text:"A ha, I'm the best!",intent:"CHALLENGE",image:o||"",data:{playerId:u,playerName:h,playerPhoto:d,type:fe.W6}});case 10:i.event(pe._.SHARE,{share_content_type:"BestLevel",success:!0}),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),i.event(pe._.SHARE,{share_content_type:"BestLevel",success:!1}),r.sendException(e.t0);case 17:return e.prev=17,s.screen.close(oe.o4.NOTIFY_SCREEN),e.finish(17);case 20:case"end":return e.stop()}}),e,null,[[1,13,17,20]])})))}(),function(){var e=(0,r.Z)(l().mark((function e(){var t,n,i,a,s,r,o,c,u;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=window.game,n=t.player,i=t.globalScene,a=n.getPlayer(),s=a.playerId,r=a.photo,o=n.getCustomData(Ce),c=we({playerId:s,playerPhoto:r,playerLevel:o})){e.next=7;break}return console.warn("getRenderOptionsGame"),e.abrupt("return");case 7:return u={name:"share-game",width:375,height:500,renderOptions:c},e.next=10,i.frameCapture.capture(u);case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()),we=function(e){var t=e.playerId,n=e.playerPhoto,i=e.playerLevel,a=void 0===i?1:i;return"string"!==typeof t||"string"!==typeof n?null:{avatar:{name:""+t,type:"image",x:135,y:72,image:n,width:105,height:105,fallbackWithImage:se.Z.AVATAR.KEY},wideFrame:{name:"wide-frame-share",type:"image",x:0,y:0,image:"./assets/wideframes/wide-frame-share.png",width:375,height:500},playerLevel:{type:"text",x:185,y:212,font:"800 18px",fillStyle:"#424ec4",text:"Level "+a,textAlign:"center"}}},_e=function(){var e=(0,r.Z)(l().mark((function e(){var t,n,i,a,s,r,o,c,u;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=window.game,n=t.player,i=t.globalScene,a=n.getPlayer(),s=a.playerId,r=a.photo,o=n.getCustomData(Ce),c=be({playerId:s,playerPhoto:r,playerLevel:o})){e.next=7;break}return console.warn("getRenderOptionsGameResult"),e.abrupt("return",null);case 7:return u={name:"mess-game-result",width:476,height:246,renderOptions:c},e.next=10,i.frameCapture.capture(u);case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),be=function(e){var t=e.playerId,n=e.playerPhoto,i=e.playerLevel,a=void 0===i?1:i;return"string"!==typeof t||"string"!==typeof n?null:{avatar:{name:""+t,type:"image",x:50,y:68,image:n,width:105,height:105,fallbackWithImage:se.Z.AVATAR.KEY},wideFrame:{name:"wide-frame-game-result",type:"image",x:0,y:0,image:"./assets/wideframes/wide-frame-game-result.png",width:476,height:246},playerLevel:{type:"text",x:234,y:35,font:"800 18px",fillStyle:"#424ec4",text:"Level "+a,textAlign:"center"}}},Le=function(){var e=(0,r.Z)(l().mark((function e(t){var n,i,a;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=window.game.globalScene,console.info("\ud83d\ude80 > getRenderOptionsChallenge",t),i=Pe(t)){e.next=6;break}return console.warn("getRenderOptionsChallenge"),e.abrupt("return",null);case 6:return a={name:"mess-challenge",width:476,height:246,renderOptions:i},e.next=9,n.frameCapture.capture(a);case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Pe=function(e){var t=e.playerId,n=e.playerPhoto,i=e.opponentId,a=e.opponentPhoto;return"string"!==typeof t||"string"!==typeof i?null:{playerAvatar:{name:""+t,type:"image",x:20,y:75,image:n||se.Z.AVATAR.FILE,width:105,height:105,fallbackWithImage:se.Z.AVATAR.KEY},opponentAvatar:{name:""+i,type:"image",x:357,y:75,image:a||se.Z.AVATAR.FILE,width:105,height:105,fallbackWithImage:se.Z.AVATAR.KEY},wideFrame:{name:"wide-frame-game-challenge",type:"image",x:0,y:0,image:"./assets/wideframes/wide-frame-game-challenge.png",width:476,height:246}}},Oe=(function(){var e=(0,r.Z)(l().mark((function e(t){var n,i,a,s,r,o,c,u,h,d,p;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=window.game,i=n.player,a=n.analytics,s=n.facebook,r=n.globalScene,o=n.rollbar,e.prev=1,r.screen.open(oe.o4.NOTIFY_SCREEN,{message:r.lang.Text.LOADING,loading:!0}),e.next=5,Oe(t);case 5:return c=e.sent,Ie(c),u=i.getPlayer(),h=u.playerId,d=u.name,p=u.photo,e.next=10,s.shareAsync({text:"I unlocked a new unit!",intent:"SHARE",image:c||"",data:{playerId:h,playerName:d,playerPhoto:p,type:fe.W6}});case 10:a.event(pe._.SHARE,{share_content_type:"UnlockNewUnit",success:!0}),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),a.event(pe._.SHARE,{share_content_type:"UnlockNewUnit",success:!1}),o.sendException(e.t0);case 17:return e.prev=17,r.screen.close(oe.o4.NOTIFY_SCREEN),e.finish(17);case 20:case"end":return e.stop()}}),e,null,[[1,13,17,20]])})))}(),function(){var e=(0,r.Z)(l().mark((function e(t){var n,i,a;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=window.game.globalScene,i=De(t)){e.next=5;break}return console.warn("getRenderOptionsNewUnit"),e.abrupt("return",null);case 5:return a={name:"mess-new-unit",width:375,height:500,renderOptions:i},e.next=8,n.frameCapture.capture(a);case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),De=function(e){var t=e.unitType,n=e.unitLevel,i=e.unitHp,a=e.unitAtk,s=e.unitName;return{wideFrame:{name:"wide-frame-new-unit",type:"image",x:0,y:0,image:"./assets/wideframes/wide-frame-new-unit.png",width:375,height:500},unitSprite:{name:s,type:"image",x:90,y:176,image:"melee"===t?ke(n):Ne(n),width:200,height:200},unitName:{type:"text",x:185,y:404,font:"800 18px",fillStyle:"#ffffff",text:s,textAlign:"center"},unitHp:{type:"text",x:155,y:164,font:"800 20px",fillStyle:"#ffffff",text:""+GameCore.Utils.Number.toAbbreviatedString(i),textAlign:"center"},unitAtk:{type:"text",x:243,y:164,font:"800 20px",fillStyle:"#ffffff",text:""+GameCore.Utils.Number.toAbbreviatedString(a),textAlign:"center"}}},ke=function(e){var t="";switch(e){case 1:t="lv01-velociraptor.png";break;case 2:t="lv02-saurolophus.png";break;case 3:t="lv03-pachysaurus.png";break;case 4:t="lv04-triceratops.png";break;case 5:t="lv05-stegosaurus.png";break;case 6:t="lv06-ankylosaurus.png";break;case 7:t="lv07-baroptiloraptor.png";break;case 8:t="lv08-tyrannosaurus.png";break;case 9:t="lv09-dilophosaurus.png";break;case 10:t="lv10-triceradonosaurus.png";break;case 11:t="lv11-spinosaurus-rex.png"}return"./assets/dino-unlocked/"+t},Ne=function(e){var t="";switch(e){case 1:t="lv01-rockthrower.png";break;case 2:t="lv02-javelineer.png";break;case 3:t="lv03-boomeranger.png";break;case 4:t="lv04-macer.png";break;case 5:t="lv05-artemis.png";break;case 6:t="lv06-william.png";break;case 7:t="lv07-blanchette.png";break;case 8:t="lv08-phantom.png";break;case 9:t="lv09-oracle.png";break;case 10:t="lv10-shaman.png";break;case 11:t="lv11-seraph.png"}return"./assets/warriors-unlocked/"+t},Be=function(e){var t=e.contextId;if(""===t||"string"!==typeof t)throw new ge(null,{contextId:t})},Me=function(e){var t=e.opponentId,n=e.contextId;if(""===t||"string"!==typeof t)throw new Ee(null,{opponentId:t});if(""===n||"string"!==typeof n)throw new ge(null,{contextId:n})},xe=function(e){if(null===e.imageShare)throw new me},Ue=function(e,t){return void 0===t&&(t=!0),function(n,i){var a,s=i(),r=Ae(s);if(t){var o;if(null!=(o=r[e])&&o.sent)return;n(Fe(e))}null!=(a=r[e])&&a.sent&&n(Ze(e))}},Fe=function(e){return{type:de.qj,payload:{opponentId:e}}},Ze=function(e){return{type:de.rh,payload:{opponentId:e}}},Ge=function(){var e=(0,r.Z)(l().mark((function e(t,n){var i,a,s,r;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=window.game,a=i.facebook,s=i.rollbar,e.prev=1,Me({opponentId:t,contextId:n}),(r=FBInstant.context.getID())!==n||""===n){e.next=6;break}return e.abrupt("return",r);case 6:if("10"!==t||""===n){e.next=8;break}return e.abrupt("return",n);case 8:if(!n){e.next=12;break}return e.next=11,a.switchAsync(n);case 11:return e.abrupt("return",FBInstant.context.getID());case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(1),s.sendException(e.t0);case 17:return e.abrupt("return","");case 18:case"end":return e.stop()}}),e,null,[[1,14]])})));return function(t,n){return e.apply(this,arguments)}}(),He=function(){var e=(0,r.Z)(l().mark((function e(t){var n,i,a,s,r,o,c,u,h,d,p,f,g,E,m,v,A;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=window.game,i=n.battle,a=n.analytics,s=n.facebook,r=n.storage,o=n.rollbar,e.prev=1,c=t.matchId,u=t.opponentId,h=t.contextId,d=i.getPlayerInfo()){e.next=6;break}return e.abrupt("return");case 6:if(p=i.getOpponentInfo()){e.next=9;break}return e.abrupt("return");case 9:return f=d.playerId,g=d.playerName,E=d.playerPhoto,m=p.playerPhoto,e.next=13,Ge(u,h);case 13:return v=e.sent,Be({contextId:v}),e.next=17,Le({playerId:f,playerPhoto:E,opponentId:u,opponentPhoto:m});case 17:return A=e.sent,xe({imageShare:A}),e.next=21,s.sendMessage({cta:{default:"Play now",localizations:{vi_VN:"Ch\u01a1i ngay"}},text:{default:g+" challenges you",localizations:{vi_VN:g+" th\u1eed th\xe1ch b\u1ea1n trong tr\u1eadn \u0111\u1ea5u n\xe0y. Ch\u01a1i ngay!"}},image:A||"",template:"challenge",data:{type:fe.Sb,matchId:c,playerId:f,opponentId:u,status:ue}});case 21:r.dispatch(Ue(u)),a.event(pe._.MESSAGE,{message_content_type:"Challenge",success:!0}),Te.emit(ve.INVITE_FRIENDS.EVENTS.INVITED_FRIEND,{type:"friend",value:1,opponentId:u}),e.next=30;break;case 26:e.prev=26,e.t0=e.catch(1),a.event(pe._.MESSAGE,{message_content_type:"Challenge",success:!1}),o.sendException(e.t0);case 30:case"end":return e.stop()}}),e,null,[[1,26]])})));return function(t){return e.apply(this,arguments)}}(),Ye=function(){var e=(0,r.Z)(l().mark((function e(t){var n,i,a,s,r,o,c,u,h,d,p,f,g,E;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=window.game,i=n.player,a=n.analytics,s=n.facebook,r=n.storage,o=n.rollbar,e.prev=1,c=t.matchId,u=t.opponentId,h=t.contextId,e.next=5,Ge(u,h);case 5:return d=e.sent,Be({contextId:d}),e.next=9,_e();case 9:return p=e.sent,xe({imageShare:p}),f=i.getPlayer(),g=f.name,E=f.playerId,e.next=14,s.sendMessage({cta:{default:"Revenge",localizations:{vi_VN:"Tr\u1ea3 th\xf9"}},text:{default:g+" beat your troops!",localizations:{vi_VN:g+" \u0111\xe3 \u0111\xe1nh b\u1ea1i qu\xe2n c\u1ee7a b\u1ea1n!"}},image:p||"",template:"pass_score",data:{type:fe.Sb,matchId:c,playerId:E,opponentId:u,status:ue}});case 14:r.dispatch(Ue(u)),a.event(pe._.MESSAGE,{message_content_type:"Beat",success:!0}),e.next=22;break;case 18:e.prev=18,e.t0=e.catch(1),a.event(pe._.MESSAGE,{message_content_type:"Beat",success:!1}),o.sendException(e.t0);case 22:case"end":return e.stop()}}),e,null,[[1,18]])})));return function(t){return e.apply(this,arguments)}}(),Ke=n(88),Ve=n.n(Ke),We=n(46),je=n.n(We),ze="player",Xe=(0,z.P1)([function(e){return e[ze]}],(function(e){return e})),qe=(0,z.P1)([Xe],(function(e){return e.playerId})),Qe=(0,z.P1)([Xe],(function(e){return e.ASID})),Je=(0,z.P1)([function(e){return e[ze].data}],(function(e){return e})),$e=((0,z.P1)([Je],(function(e){return e.settings})),(0,z.P1)([function(e){return e[ze].connectedPlayers}],(function(e){return e}))),et=(0,z.P1)([$e,function(e,t){return t.limit},function(e,t){return t.offset}],(function(e,t,n){if("number"!==typeof t)return[];if("number"!==typeof n)return[];var i=Ve()(e);return je()(i).call(i,n,t+n)||[]})),tt=(0,z.P1)([Je],(function(e){return e.customFields})),nt=n(468),it=GameCore.Configs.ApiHost,at=function(){var e=(0,r.Z)(l().mark((function e(t){var n;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,"matches",e.next=4,(0,nt.v)("matches",{opponentPlayerId:t},{},it);case 4:if(n=e.sent){e.next=7;break}return e.abrupt("return",{});case 7:if(GameCore.Utils.Valid.isObject(n.data)){e.next=9;break}return e.abrupt("return",{});case 9:return e.abrupt("return",n.data);case 12:return e.prev=12,e.t0=e.catch(0),console.warn("createMatchAsync",e.t0),e.abrupt("return",{});case 16:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t){return e.apply(this,arguments)}}(),st=function(){var e=(0,r.Z)(l().mark((function e(){var t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,"matches",e.next=4,(0,nt.U)("matches",{},it);case 4:if(t=e.sent){e.next=7;break}return e.abrupt("return",[]);case 7:return e.abrupt("return",t.data);case 10:return e.prev=10,e.t0=e.catch(0),console.warn("getMatchesAsync",e.t0),e.abrupt("return",[]);case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}(),rt=function(){var e=(0,r.Z)(l().mark((function e(t){var n,i;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n="matches/"+t+"/join",e.next=4,(0,nt.v)(n,{},{},it);case 4:if(i=e.sent){e.next=7;break}return e.abrupt("return",{});case 7:if(GameCore.Utils.Valid.isObject(i.data)){e.next=9;break}return e.abrupt("return",{});case 9:return e.abrupt("return",i.data);case 12:return e.prev=12,e.t0=e.catch(0),console.warn("joinMatchAsync",e.t0),e.abrupt("return",{});case 16:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t){return e.apply(this,arguments)}}(),ot=function(){var e=(0,r.Z)(l().mark((function e(t){var n,i;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n="matches/"+t,e.next=4,(0,nt.U)(n,{},it);case 4:if(i=e.sent){e.next=7;break}return e.abrupt("return",{});case 7:if(GameCore.Utils.Valid.isObject(i.data)){e.next=9;break}return e.abrupt("return",{});case 9:return e.abrupt("return",i.data);case 12:return e.prev=12,e.t0=e.catch(0),console.warn("getMatchDetailByIdAsync",e.t0),e.abrupt("return",{});case 16:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t){return e.apply(this,arguments)}}(),ct=function(){var e=(0,r.Z)(l().mark((function e(t,n){var i,a;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i="matches/"+t+"/finish",e.next=4,(0,nt.v)(i,{matchId:t,level:n},{},it);case 4:if(a=e.sent){e.next=7;break}return e.abrupt("return",{});case 7:if(GameCore.Utils.Valid.isObject(a.data)){e.next=9;break}return e.abrupt("return",{});case 9:return e.abrupt("return",a.data);case 12:return e.prev=12,e.t0=e.catch(0),console.warn("finishMatchAsync",e.t0),e.abrupt("return",{});case 16:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t,n){return e.apply(this,arguments)}}(),lt=n(228),ut=GameCore.Configs.Gameplay,ht=ut.MaximumMeleeLevel,dt=ut.MaximumRangedLevel,pt=GameCore.Configs.Gameplay.CheaterIds,ft=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=e.call.apply(e,E()(t=[this]).call(t,a))||this).status=lt.Z.IDLE,n.matchId=void 0,n.contextId=void 0,n.playerInfo=void 0,n.opponentInfo=void 0,n.replayOpponentId=void 0,n}(0,o.Z)(t,e);var n=t.prototype;return n.sendChallengeMessage=function(){var e=(0,r.Z)(l().mark((function e(t,n){var i,a,s;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i=qe(this.state),e.next=4,this.updateProfiles(i,n);case 4:return e.next=6,at(n);case 6:return a=e.sent,this.validateMatchData(a),s=a._id,e.next=11,He({contextId:t,opponentId:n,matchId:s});case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),console.warn("sendChallengeMessage",e.t0);case 16:return e.prev=16,this.playerInfo=null,this.opponentInfo=null,e.finish(16);case 20:case"end":return e.stop()}}),e,this,[[0,13,16,20]])})));return function(t,n){return e.apply(this,arguments)}}(),n.createBattle=function(){var e=(0,r.Z)(l().mark((function e(t,n){var i,a,s,r,o,c,u;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===n&&(n=!0),i=this.game,a=i.facebook,s=i.globalScene,e.prev=2,s.screen.open(oe.o4.NOTIFY_SCREEN,{message:s.lang.Text.LOADING,loading:!0}),this.setStatus(lt.Z.INITIALIZING),r=qe(this.state),t!==r){e.next=8;break}throw new Error("You can not challenge yourself");case 8:return o=null,e.next=11,a.getContextPlayers("");case 11:if((c=e.sent).length>0&&(u=ne()(c).call(c,(function(e){return e.playerId})),ae()(u).call(u,t)&&(o=FBInstant.context.getID())),o){e.next=17;break}return e.next=16,a.createAsync(t);case 16:o=e.sent;case 17:if(this.validateContextId(o),""===o||"string"!==typeof o){e.next=21;break}return e.next=21,this.startBattle(o,t);case 21:n&&this.game.scene.sleep(re.C.GAME_SCENE),this.setStatus(lt.Z.STARTED),e.next=30;break;case 25:e.prev=25,e.t0=e.catch(2),console.warn("createBattle",e.t0),n&&this.game.scene.sleep(re.C.GAME_SCENE),this.setStatus(lt.Z.IDLE);case 30:return e.prev=30,n&&this.game.scene.run(re.C.GAME_SCENE),s.screen.close(oe.o4.NOTIFY_SCREEN),e.finish(30);case 34:case"end":return e.stop()}}),e,this,[[2,25,30,34]])})));return function(t,n){return e.apply(this,arguments)}}(),n.continueBattle=function(){var e=(0,r.Z)(l().mark((function e(t,n){var i,a,s,r,o,c;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.game,a=i.globalScene,s=i.facebook,e.prev=1,a.screen.open(oe.o4.NOTIFY_SCREEN,{message:a.lang.Text.LOADING,loading:!0}),this.setStatus(lt.Z.INITIALIZING),r=qe(this.state),n!==r){e.next=7;break}throw new Error("You can not challenge yourself");case 7:return e.next=9,rt(t);case 9:if("_id"in(o=e.sent)!==!1){e.next=14;break}return e.next=13,ot(t);case 13:o=e.sent;case 14:if(this.validateMatchData(o,t),this.matchId=t,this.contextId=s.getContextID(),o.status!==he){e.next=23;break}return e.next=20,at(n);case 20:c=e.sent,this.validateMatchData(c),this.matchId=c._id;case 23:return e.next=25,this.updateProfiles(r,n);case 25:this.setStatus(lt.Z.STARTED),e.next=32;break;case 28:e.prev=28,e.t0=e.catch(1),console.warn("continueBattle",e.t0),this.setStatus(lt.Z.IDLE);case 32:return e.prev=32,a.screen.close(oe.o4.NOTIFY_SCREEN),e.finish(32);case 35:case"end":return e.stop()}}),e,this,[[1,28,32,35]])})));return function(t,n){return e.apply(this,arguments)}}(),n.finishBattle=function(){var e=(0,r.Z)(l().mark((function e(t){var n,i,a,s;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("\ud83e\udd16 ? finishBattle",t),e.prev=1,this.matchId){e.next=4;break}return e.abrupt("return");case 4:if("win"!==t){e.next=11;break}return e.next=7,ct(this.matchId,1);case 7:if(n=this.opponentInfo||{},i=n.playerId,!this.contextId||!i){e.next=11;break}return e.next=11,Ye({matchId:this.matchId,contextId:this.contextId,opponentId:i});case 11:if("lose"!==t){e.next=14;break}return e.next=14,ct(this.matchId,2);case 14:this.logMatchEvent(pe._.MATCH_END),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(1),console.warn("finishBattle",e.t0);case 20:return e.prev=20,this.matchId=null,this.contextId=null,this.playerInfo=null,a=this.opponentInfo||{},s=a.playerId,this.replayOpponentId=s||this.replayOpponentId,this.opponentInfo=null,window.clientInformation.opponentIsCheater=!1,this.setStatus(lt.Z.IDLE),e.finish(20);case 30:case"end":return e.stop()}}),e,this,[[1,17,20,30]])})));return function(t){return e.apply(this,arguments)}}(),n.getReplayOpponentId=function(){return this.replayOpponentId},n.getPlayerInfo=function(){return this.playerInfo},n.getOpponentInfo=function(){return this.opponentInfo},n.logMatchEvent=function(e){var t=(this.opponentInfo||{}).playerLevel;t&&this.game.analytics.event(e,{game_mode:GameCore.Utils.String.toUpperCamelCase(ce.jt),level:t,level_name:"level_"+t})},n.startBattle=function(){var e=(0,r.Z)(l().mark((function e(t,n){var i,a;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,at(n);case 3:i=e.sent,this.validateMatchData(i),a=i._id,this.matchId=a,this.contextId=t,this.logMatchEvent(pe._.MATCH_START),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.warn("startBattleFriends",e.t0);case 14:case"end":return e.stop()}}),e,this,[[0,11]])})));return function(t,n){return e.apply(this,arguments)}}(),n.updateProfiles=function(){var e=(0,r.Z)(l().mark((function e(t,n){var i,a,s,r,o,c,u,h,d,p;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i=this.game.profile,e.next=4,i.requestProfile(t);case 4:return e.next=6,i.requestProfile(n);case 6:a=i.getProfiles(),s=a[t],this.validateProfileData(s),r=a[n]||{},console.log("opponentProfile",r),r=this.handleNewPlayerInvitation(r),this.validateProfileData(r),console.log("\ud83e\udd16 ? updateProfiles",s,r),o=s.customFields||{},c=o.playerUnitData,u=o.playerLevelProgress,this.updatePlayerProfile({playerId:t,playerName:s.name,playerPhoto:s.photo?s.photo:se.Z.AVATAR.FILE,playerLevel:u,unitData:c}),h=r.customFields||{},d=h.playerUnitData,p=h.playerLevelProgress,this.updatePlayerProfile({playerId:n,playerName:r.name,playerPhoto:r.photo?r.photo:se.Z.AVATAR.FILE,playerLevel:p,unitData:d}),ae()(pt).call(pt,n)&&(window.clientInformation.opponentIsCheater=!0),e.next=25;break;case 21:throw e.prev=21,e.t0=e.catch(0),console.warn(e.t0),new Error("Can not update profiles");case 25:case"end":return e.stop()}}),e,this,[[0,21]])})));return function(t,n){return e.apply(this,arguments)}}(),n.updatePlayerProfile=function(e){this.playerInfo=e},n.updateOpponentProfile=function(e){this.opponentInfo=e},n.handleNewPlayerInvitation=function(e){var t=GameCore.Utils.Json.clone(e||{});if(!t.customFields){for(var n={MELEE:{},RANGED:{}},i=1;i<=ht;i++)n.MELEE[i]=0;for(var a=1;a<=dt;a++)n.RANGED[a]=0;return t.customFields={playerUnitData:"0-0-m2-0-0/0-0-0-0-0/r1-0-0-0-0",playerLevelProgress:2},t}var s=t.customFields||{},r=s.playerUnitData,o=s.playerLevelProgress,c=o&&"number"===typeof o&&o>=2;return c||(t.customFields.playerLevelProgress=2),r&&c||(t.customFields.playerUnitData="0-0-m2-0-0/0-0-0-0-0/r1-0-0-0-0"),t},n.validateProfileData=function(e){if(!e)throw new Error("Profile is not found");var t=e.customFields;if(!t)throw new Error("Profile customFields is not found");var n=t||{},i=n.playerUnitData;if("number"!==typeof n.playerLevelProgress)throw new Error("Player level is not found");if("string"!==typeof i)throw new Error("Player unit data is not found");this.validateUnitData(i)},n.validateUnitData=function(e){var t=e.split("/");if(3!==t.length)throw new Error("Unit data segment is not valid");var n=[],i=t[0].split("-");if(5!==i.length)throw new Error("Unit data row 1 is not valid");n.push.apply(n,i);var a=t[1].split("-");if(5!==a.length)throw new Error("Unit data row 2 is not valid");n.push.apply(n,a);var s=t[2].split("-");if(5!==s.length)throw new Error("Unit data row 3 is not valid");if(n.push.apply(n,s),n.some((function(e){if("0"===e[0])return!1;if("r"!==e[0]&&"m"!==e[0])return!0;var t=parseInt(e.substring(1));return t<1||t>11})))throw new Error("Unit type is not valid")},n.validateContextId=function(e){if(!1===e)throw new Error("User canceled")},n.validateMatchData=function(e,t){if(console.log("\ud83e\udd16 ? validateMatchData",e),!e)throw new Error("Match is not found");if(!GameCore.Utils.Valid.isObject(e))throw new Error("Match is not valid");if("_id"in e===!1)throw new Error("Match id is not valid");if(t&&t!==e._id)throw new Error("Match id is not matched");if("whitePlayerId"in e===!1)throw new Error("Match white player id is not valid");if("blackPlayerId"in e===!1)throw new Error("Match black player id is not valid")},n.getMatchHistory=function(){var e=(0,r.Z)(l().mark((function e(){var t,n,i,a,s,r,o,c,u;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,st();case 3:if(t=e.sent,n=GameCore.Configs.Battle.UseMock,console.log("\ud83e\udd16 ? getMatchHistory",t,n),!n){e.next=15;break}if(i=[],a=qe(this.state),console.log("\ud83e\udd16 ? getMatchHistory",a),a){e.next=12;break}return e.abrupt("return",[]);case 12:for(s=0;s<50;s++)u={_id:""+s,whitePlayerId:a,blackPlayerId:r=""+(s+1e5),winnerId:s%2===0?a:r,whitePlayerScore:o=s%2===0?1:2,blackPlayerScore:c=s%2===0?2:1,whitePlayerLevel:o,blackPlayerLevel:c,status:"finished",updatedAt:"2022-07-13T07:07:00.524Z"},i.push(u);return this.validateMatchHistory(i),e.abrupt("return",i);case 15:return this.validateMatchHistory(t),e.abrupt("return",t);case 19:return e.prev=19,e.t0=e.catch(0),console.warn("getMatchHistory",e.t0),e.abrupt("return",[]);case 23:case"end":return e.stop()}}),e,this,[[0,19]])})));return function(){return e.apply(this,arguments)}}(),n.validateMatchHistory=function(e){if(!1===Array.isArray(e))throw new Error("Match history is invalid");e.forEach((function(e){if(!1===GameCore.Utils.Valid.isObject(e))throw new Error("Match is not valid");if("_id"in e===!1)throw new Error("Match id is not valid");if("whitePlayerId"in e===!1)throw new Error("Match white player id is not valid");if("blackPlayerId"in e===!1)throw new Error("Match black player id is not valid");if("status"in e===!1)throw new Error("Match status is not valid");if("whitePlayerScore"in e===!1)throw new Error("Match white player score is not valid");if("blackPlayerScore"in e===!1)throw new Error("Match black player score is not valid");if("whitePlayerLevel"in e===!1)throw new Error("Match white player level is not valid");if("blackPlayerLevel"in e===!1)throw new Error("Match black player level is not valid");if("updatedAt"in e===!1)throw new Error("Match updated at is not valid")}))},n.setStatus=function(e){this.status=e},n.getStatus=function(){return this.status},(0,Y.Z)(t,[{key:"state",get:function(){return this.game.storage.getState()}}]),t}(Phaser.Plugins.BasePlugin),gt=ft,Et=n(126),mt=n(156),vt=function(e){function t(){return e.apply(this,arguments)||this}return(0,o.Z)(t,e),t.prototype.emit=function(t,n){return e.prototype.emit.call(this,t,n)},t}(Phaser.Events.EventEmitter),At=vt,St=n(467),Tt="UPDATE_COINS",yt=ye.Z.COIN_BASE_VALUE,Ct=ye.Z.COIN_SUFFIX,It=function(e,t){return function(){var n=(0,r.Z)(l().mark((function n(i){var a;return l().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:try{a=new Et.Z(e,t,!0),i(Rt(a.baseValue,a.suffix))}catch(s){window.game.rollbar.sendException(s)}case 1:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},Rt=function(e,t){return{type:Tt,payload:{coinBaseValue:e,coinSuffixValue:t}}},wt="coins",_t=function(e){return e[wt]},bt=(0,z.P1)([function(e){return _t(e).coinBaseValue}],(function(e){return e})),Lt=(0,z.P1)([function(e){return _t(e).coinSuffixValue}],(function(e){return e})),Pt=function(e){function t(t){var n;return(n=e.call(this,t)||this).events=void 0,n.currentCoins=void 0,n.updateCurrentCoins=(0,mt.D)((function(){var e,t,i=n.game.storage,a=n.currentCoins,s=a.baseValue,o=a.suffix;i.dispatch((e=s,t=o,function(){var n=(0,r.Z)(l().mark((function n(i){var a,s,r,o;return l().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:try{s=new Et.Z(e,t,!0),r=s.suffix,o=s.baseValue,i(Rt(o,r)),window.game.player.setMultiCustomData(((a={})[Ct]=r,a[yt]=o,a))}catch(c){window.game.rollbar.sendException(c)}case 1:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()))}),2e3),n.events=new At,n}(0,o.Z)(t,e);var n=t.prototype;return n.getCurrentCoins=function(){if(!this.currentCoins){var e=bt(this.state),t=Lt(this.state);this.currentCoins=new Et.Z(e,t,!0)}return this.currentCoins},n.plusCoins=function(e,t){var n=new Et.Z(e,t,!0);this.currentCoins.add(n),this.updateCurrentCoins()},n.minusCoins=function(e,t){var n=new Et.Z(e,t,!0);this.currentCoins.subtract(n),this.updateCurrentCoins()},n.receiveCoins=function(e,t){this.game.storage.dispatch(It(e,t)),this.currentCoins=new Et.Z(e,t,!0),this.events.emit(St.Z.RECEIVED,this.currentCoins)},(0,Y.Z)(t,[{key:"state",get:function(){return this.game.storage.getState()}}]),t}(Phaser.Plugins.BasePlugin),Ot=Pt,Dt=n(53),kt=n.n(Dt),Nt=function(e,t){void 0===t&&(t=1);var n=new Image;n.onload=function(){var n,i,a=(n=this.width*t,i=this.height*t,{string:"+",style:"font-size: 1px; padding: "+Math.floor(i/2)+"px "+Math.floor(n/2)+"px;"});console.info("%c "+a.string,a.style+" background: transparent url("+e+") no-repeat center center; background-size: "+this.width*t+"px "+this.height*t+"px;")},n.src=e},Bt=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=e.call.apply(e,E()(t=[this]).call(t,a))||this).width=void 0,n.height=void 0,n.renderOptions=void 0,n.canvas=void 0,n}(0,o.Z)(t,e);var n=t.prototype;return n.preload=function(e){var t=this,n=Ve()(e);n.length<1||(n.forEach((function(n){t.scene.load.image(n,e[n])})),this.scene.load.start())},n.capture=function(){var e=(0,r.Z)(l().mark((function e(t){var n,i,a;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.width,i=t.height,a=t.renderOptions,this.width=n,this.height=i,this.renderOptions=a,this.createCanvas(),e.next=7,this.loadImages();case 7:return this.drawObjects(),e.abrupt("return",this.snapshotFrame());case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.createCanvas=function(){this.canvas||(this.canvas=this.game.textures.createCanvas("FrameCaptureCanvas")),this.canvas.clear(),this.canvas.setSize(this.width,this.height)},n.loadImages=function(){var e=this;return new(kt())((function(t,n){for(var i in e.renderOptions){var a=e.renderOptions[i],s=a.name,r=a.image;if(r)e.scene.textures.get(s).key!==s&&e.scene.load.image(s,r)}e.scene.load.on(Phaser.Loader.Events.COMPLETE,t),e.scene.load.on(Phaser.Loader.Events.FILE_LOAD_ERROR,(function(){var e=new Error("Load image failed");n(e)})),e.scene.load.start()}))},n.drawObjects=function(){for(var e in this.renderOptions){var t=this.renderOptions[e];switch(t.type){case"text":this.drawText(t);break;case"image":this.drawImage(t)}}},n.drawText=function(e){var t=this.canvas.context,n=e.x,i=e.y,a=e.font,s=e.text,r=e.fillStyle,o=e.lineWidth,c=e.textAlign;t.font=a+' nunito,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",sans-serif',t.fillStyle=r||"#ffffff",o&&(t.lineWidth=o),c&&(t.textAlign=c),t.fillText(s,n,i)},n.drawImage=function(e){var t=this.canvas.context,n=e.x,i=e.y,a=e.name,s=e.frame,r=e.width,o=e.height,c=e.fallbackWithImage,l=this.scene.textures.get(a),u=l.getSourceImage(s);"__MISSING"===l.key&&c&&(u=(l=this.scene.textures.get(c)).getSourceImage()),t.drawImage(u,n,i,r,o)},n.snapshotFrame=function(){var e=this.canvas.getCanvas().toDataURL("image/jpeg",.85);return GameCore.Utils.Valid.isDebugger()&&Nt(e),e},t}(Phaser.Plugins.ScenePlugin),Mt=Bt,xt=function(e){function t(t,n,i){var a;return(a=e.call(this)||this).game=void 0,a.options=void 0,a.performance=void 0,a.isRunning=!1,a.checkTimer=void 0,a.fpsHistory=void 0,a.start=function(){if(!a.isRunning){a.isRunning=!0;var e=a.options.checkInterval;a.checkTimer=e,a.fpsHistory=[],a.game.events.on(Phaser.Core.Events.POST_STEP,a.onPostStep)}},a.stop=function(){a.isRunning&&(a.isRunning=!1,a.game.events.off(Phaser.Core.Events.POST_STEP,a.onPostStep),a.options.onlyUpdateWhenSwitchScene&&a.checkFps())},a.onPostStep=function(e,t){if(a.checkTimer-=t,!(a.checkTimer>0)){var n=a.options,i=n.checkInterval,s=n.onlyUpdateWhenSwitchScene;a.checkTimer+=i,a.fpsHistory.push(a.game.loop.actualFps),!1===s&&a.fpsHistory.length>=5&&a.checkFps()}},a.game=t,a.options=i,a.performance=n,a}(0,o.Z)(t,e);var n=t.prototype;return n.checkFps=function(){if(0!==this.fpsHistory.length){var e=this.options.autoUpgradeQuality,t=!1;this.isLowFps()?t=this.performance.downgradeGraphicsQuality():e&&this.isHighFps()&&(t=this.performance.upgradeGraphicsQuality()),t&&(this.fpsHistory=[])}},n.getFpsMedian=function(){return Phaser.Math.Median(this.fpsHistory)},n.isLowFps=function(){return this.getFpsMedian()<this.options.fpsThreshold},n.isHighFps=function(){return this.getFpsMedian()>1.2*this.options.fpsThreshold},t}(Phaser.Events.EventEmitter),Ut=xt,Ft=["pixelRatio","minQuality","maxQuality","qualityAdjustStep","trackingSceneKeys"],Zt=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=e.call.apply(e,E()(t=[this]).call(t,a))||this).fpsTracker=void 0,n.pixelRatio=void 0,n.minQuality=void 0,n.maxQuality=void 0,n.qualityAdjustStep=void 0,n.trackingSceneKeys=[],n.trackingScene=function(e){var t;if(ae()(t=n.trackingSceneKeys).call(t,e)){var i=n.game.scene.getScene(e);i.events.once(Phaser.Scenes.Events.UPDATE,n.fpsTracker.start),i.events.once(Phaser.Scenes.Events.SLEEP,n.fpsTracker.stop)}},n}(0,o.Z)(t,e);var n=t.prototype;return n.configure=function(e){var t=e.pixelRatio,n=e.minQuality,i=e.maxQuality,s=e.qualityAdjustStep,r=e.trackingSceneKeys,o=(0,a.Z)(e,Ft);this.pixelRatio=t,this.minQuality=n,this.maxQuality=i,this.qualityAdjustStep=s,this.trackingSceneKeys=r,this.fpsTracker=new Ut(this.game,this,o)},n.active=function(){this.game.events.on(Phaser.Scenes.Events.WAKE,this.trackingScene),this.game.events.on(Phaser.Scenes.Events.START,this.trackingScene)},n.downgradeGraphicsQuality=function(){var e=this.pixelRatio;if(e<=this.minQuality)return!1;var t=+(e-this.qualityAdjustStep).toFixed(2);return!(t<this.minQuality)&&(this.pixelRatio=t,this.game.world.resize(this.pixelRatio),console.warn("\ud83d\udcab Graphics quality was downgraded! ("+e+" -> "+t+")"),!0)},n.upgradeGraphicsQuality=function(){var e=this.pixelRatio;if(e>=this.maxQuality)return!1;var t=+(e+this.qualityAdjustStep).toFixed(2);return!(t>this.maxQuality)&&(this.pixelRatio=t,this.game.world.resize(this.pixelRatio),console.warn("\ud83d\ude80 Graphics quality was upgraded! ("+e+" -> "+t+")"),!0)},t}(Phaser.Plugins.BasePlugin),Gt=Zt,Ht=n(461),Yt=n(59),Kt=n.n(Yt),Vt=n(469),Wt=(GameCore.Configs.ApiHost,function(){var e=(0,r.Z)(l().mark((function e(t){var n;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return");case 3:return n=e.sent,e.abrupt("return",(null==n?void 0:n.data)||{});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),jt=function(){var e=(0,r.Z)(l().mark((function e(t){var n;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null);case 3:return n=e.sent,e.abrupt("return",(null==n?void 0:n.data)||{});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),zt="PLAYER_RECEIVED",Xt="PLAYER_DATA_UPDATE",qt="PLAYER_PROFILE_UPDATE",Qt="PLAYER_SETTING_UPDATE",Jt="PLAYER_CONNECTED_PLAYERS_UPDATE",$t=n(224),en=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).payload=void 0,i.name="PlayerDataNameNotSupport",i.message=t||"The name of player data is not supported",i.payload=n||{},i}return(0,o.Z)(t,e),t}((0,R.Z)(Error)),tn=GameCore.Configs,nn=tn.AppId,an=tn.Tutorial,sn=function(e,t){return function(n){var i=e.playerId,a=e.name,s=e.photo,r=e.locale;n({type:zt,payload:{playerId:i,name:a,photo:s,locale:r,data:t||{}}})}},rn=function(e){return{type:Jt,payload:{connectedPlayers:e}}},on=function(e,t){return function(){var n=(0,r.Z)(l().mark((function n(a,s){var r,o,c;return l().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,a({type:Qt,payload:{name:e,value:t}});case 3:r=s(),o=Je(r),c=new Vt.Z({}).convertToFacebookData(o),FBInstant.player.setDataAsync(c),n.next=12;break;case 9:n.prev=9,n.t0=n.catch(0),(0,i.tO)(n.t0);case 12:case"end":return n.stop()}}),n,null,[[0,9]])})));return function(e,t){return n.apply(this,arguments)}}()},cn=function(e,t){return function(){var n=(0,r.Z)(l().mark((function n(a,s){var r,o,c,u,h;return l().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,console.info("\ud83d\ude80 > setPlayerCustomData",{name:e,data:t}),o={customFields:(r={},r[e]=t,r)},n.next=5,a(un(o));case 5:c=s(),u=Je(c),h=new Vt.Z({}).convertToFacebookData(u),FBInstant.player.setDataAsync(h),n.next=16;break;case 11:if(n.prev=11,n.t0=n.catch(0),!(n.t0 instanceof en)){n.next=15;break}return n.abrupt("return");case 15:(0,i.tO)(n.t0);case 16:case"end":return n.stop()}}),n,null,[[0,11]])})));return function(e,t){return n.apply(this,arguments)}}()},ln=function(e){return function(){var t=(0,r.Z)(l().mark((function t(n,a){var s,r,o,c;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,s={customFields:e},t.next=4,n(un(s));case 4:r=a(),o=Je(r),c=new Vt.Z({}).convertToFacebookData(o),FBInstant.player.setDataAsync(c),t.next=16;break;case 10:if(t.prev=10,t.t0=t.catch(0),console.log("\ud83e\udd16 ? error",t.t0),!(t.t0 instanceof en)){t.next=15;break}return t.abrupt("return");case 15:(0,i.tO)(t.t0);case 16:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(e,n){return t.apply(this,arguments)}}()},un=function(e){return{type:Xt,payload:{data:e}}},hn=ye.Z.COIN_BASE_VALUE,dn=ye.Z.COIN_SUFFIX,pn=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var n=t.prototype;return n.incUserGuideDisplays=function(){var e=(0,r.Z)(l().mark((function e(){var t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.game.storage,e.next=3,t.dispatch(function(){var e=(0,r.Z)(l().mark((function e(t,n){var a,s,r,o;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!an.ForceUseTutorial){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,t(un({userGuideDisplays:1}));case 5:a=n(),s=qe(a),r=Je(a),o=new Vt.Z({}).convertToFacebookData(r),FBInstant.player.setDataAsync(o),jt(s),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),(0,i.tO)(e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t,n){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.receiveData=function(){var e=(0,r.Z)(l().mark((function e(t,n){var i;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.game.storage,e.next=3,i.dispatch(sn(t,n));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.updateData=function(){var e=(0,r.Z)(l().mark((function e(){var t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.game.storage,e.next=3,t.dispatch(function(){var e=(0,r.Z)(l().mark((function e(t,n){var a,s,r,o,c,u,h,d;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=n(),s=Xe(a),r=s.playerId,o=s.name,c=s.photo,u=s.locale,e.next=6,FBInstant.player.getASIDAsync();case 6:return h=e.sent,d={appId:nn,playerId:r,name:o,photo:c,locale:u,ASID:h},e.next=10,t({type:qt,payload:{profile:d}});case 10:return e.next=12,Wt(d);case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),(0,i.tO)(e.t0);case 17:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t,n){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.setBestScore=function(){var e=(0,r.Z)(l().mark((function e(t){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.setSetting=function(){var e=(0,r.Z)(l().mark((function e(t,n){var i;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.game.storage,e.next=3,i.dispatch(on(t,n));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.setCustomData=function(){var e=(0,r.Z)(l().mark((function e(t,n){var i;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.game.storage,e.next=3,i.dispatch(cn(t,n));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.setMultiCustomData=function(){var e=(0,r.Z)(l().mark((function e(t){var n;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.game.storage,e.next=3,n.dispatch(ln(t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.requestConnectedPlayers=function(){var e=(0,r.Z)(l().mark((function e(){var t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.game.storage,e.next=3,t.dispatch(function(){var e=(0,r.Z)(l().mark((function e(t){var n,a,s,r,o;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=window.game.facebook,e.next=4,new(kt())((function(e,t){a.once("players",(function(t){e(t)})),a.once("playersfail",(function(){return t([])})),a.getPlayers()}));case 4:if(s=e.sent,r=function(e){return!!e},o=Kt()(n=ne()(s).call(s,(function(e){var t=e.getID(),n=e.getName(),i=e.getPhoto();return t&&n&&i?new $t.Z(t,n,i).toObject():null}))).call(n,r),!(o.length<1)){e.next=9;break}return e.abrupt("return");case 9:t(rn(o)),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),(0,i.tO)(e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.updateConnectedPlayers=function(){var e=(0,r.Z)(l().mark((function e(t){var n;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.game.storage,e.next=3,n.dispatch(rn(t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.getPlayer=function(){return Xe(this.state)},n.getPlayerId=function(){return this.getPlayer().playerId},n.getPlayerASID=function(){return Qe(this.state)},n.getPlayerData=function(){return this.getPlayer().data},n.getPlayerSetting=function(e){var t=this.getPlayerSettings();return"string"!==typeof e?null:GameCore.Utils.Object.hasOwn(t,e)?t[e]:GameCore.Utils.Object.hasOwn(Ht.h,e)?Ht.h[e]:null},n.getPlayerSettings=function(){return this.getPlayerData().settings},n.getPlayerIsNew=function(){return this.getPlayer().isUserNew},n.getCoins=function(){var e=this.getCustomData(hn),t=this.getCustomData(dn);return GameCore.Utils.Valid.isNumber(e)&&GameCore.Utils.Valid.isNumber(t)?new Et.Z(e,t,!0):0},n.getDiamond=function(){return 0},n.getBestScore=function(){return 0},n.getCustomData=function(e){var t=tt(this.state);return GameCore.Utils.Valid.isObject(t)&&GameCore.Utils.Object.hasOwn(t,e)?t[e]:null},n.getConnectedPlayers=function(){return $e(this.state)},n.getConnectedPlayerIds=function(e,t){return et(this.state,{limit:e,offset:t})},(0,Y.Z)(t,[{key:"state",get:function(){return this.game.storage.getState()}}]),t}(Phaser.Plugins.BasePlugin),fn=pn,gn=GameCore.Configs.ApiHost,En=function(){var e=(0,r.Z)(l().mark((function e(t){var n,i;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=GameCore.Utils.String.params(t),e.next=3,(0,nt.U)("players?"+n,{},gn);case 3:return i=e.sent,e.abrupt("return",(null==i?void 0:i.data)||[]);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),mn=function(){var e=(0,r.Z)(l().mark((function e(t){var n;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,nt.U)("players/"+t,{},gn);case 2:return n=e.sent,e.abrupt("return",(null==n?void 0:n.data)||[]);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),vn="PROFILES_DATA_UPDATE",An="profile",Sn=(0,z.P1)([function(e){return e[An].data}],(function(e){return e})),Tn=(0,z.P1)([function(e){return e[An].profileIds}],(function(e){return e})),yn=function(e){return function(){var t=(0,r.Z)(l().mark((function t(n,a){var s,r,o,c;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,s=a(),r=Tn(s),!((o=GameCore.Utils.Array.difference(e,r)).length<1)){t.next=6;break}return t.abrupt("return");case 6:return t.next=8,En({playerIds:o});case 8:c=t.sent,n({type:vn,payload:{data:c}}),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(0),(0,i.tO)(t.t0);case 15:case"end":return t.stop()}}),t,null,[[0,12]])})));return function(e,n){return t.apply(this,arguments)}}()},Cn=function(e){return function(){var t=(0,r.Z)(l().mark((function t(n){var a;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,mn(e);case 3:a=t.sent,n({type:vn,payload:{data:[a]}}),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),(0,i.tO)(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()},In=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var n=t.prototype;return n.requestProfiles=function(){var e=(0,r.Z)(l().mark((function e(t){var n;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.game.storage,e.next=3,n.dispatch(yn(t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.requestProfile=function(){var e=(0,r.Z)(l().mark((function e(t){var n;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.game.storage,e.next=3,n.dispatch(Cn(t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.getProfiles=function(){return Sn(this.state)},(0,Y.Z)(t,[{key:"state",get:function(){return this.game.storage.getState()}}]),t}(Phaser.Plugins.BasePlugin),Rn=In,wn=n(70),_n=n.n(wn),bn=n(47),Ln=n.n(bn),Pn=n(240),On=n.n(Pn),Dn=["player","match"],kn="b89a8a8c593943f485435ab11ea0d055",Nn=GameCore.Configs.Rollbar,Bn=Nn.UseMockup,Mn=Nn.FilterError,xn=Nn.ListPlayerDevIds,Un=function(e){function t(){for(var t,n,i=arguments.length,s=new Array(i),r=0;r<i;r++)s[r]=arguments[r];return(n=e.call.apply(e,E()(t=[this]).call(t,s))||this).enable=void 0,n.rollbar=void 0,n.events=[],n.beforeSend=function(e,t,i){Bn&&n.showPopupError(i)},n.checkIgnore=function(e,t,i){try{return!!n.isErrorIgnore(t)&&(console.warn(t),!0)}catch(a){return!1}},n.showPopupError=function(e){var t,i,a,s,r,o=null==e||null==(t=e.body)||null==(i=t.trace)?void 0:i.exception;o&&n.events.push(o);var c=(null==e||null==(a=e.body)||null==(s=a.trace)?void 0:s.frames)||[];(r=n.events).push.apply(r,c);var l=document.getElementById("popup-error");l||((l=document.createElement("div")).id="popup-error",document.body.appendChild(l)),l.innerHTML='<div style="color: #fff; display: flex; flex-flow: column; align-items: center; ">\n      <pre id="json" style="overflow: auto; background-color: rgb(195 112 97 / 80%); padding: 10px; max-height: 80vh; max-width: 90vw; border: 5px solid #545454;">'+_n()(n.events,null,2)+'</pre>\n      <button id="close" style="cursor: pointer; padding: 10px 20px; border-radius: 100px;">Close</button>\n      </div>',l.style="top: 0px; z-index: 10000; width: 100vw; max-height: 100vh; position: absolute; display: flex; align-items: center; justify-content: center;";var u=document.getElementById("close");u&&(u.onclick=n.closePopup)},n.closePopup=function(){n.events=[{}];var e=document.getElementById("popup-error");null==e||e.remove()},n.isNoneErrorEvent=function(e){if(!e||0===e.length)return!1;if(!e[0].message)return!1;return"Non-Error promise rejection captured with keys: code, message"===e[0].message},n.isErrorIgnore=function(e){if(!e||0===e.length)return!1;var t=!1,i=e[0];return i instanceof Object&&(t=n.isIgnoreByCode(i)||n.isIgnoreByMessage(i)),t},n.isIgnoreByCode=function(e){if(GameCore.Utils.Object.hasOwn(e,"code")){var t=e.code,n=Mn.Codes,i=n.accepted,a=n.ignored;if("string"===typeof t){if(Ln()(i).call(i,t)>=0)return!1;if(Ln()(a).call(a,t)>=0)return!0}}else if(GameCore.Utils.Object.hasOwn(e,"name")){var s=e.name,r=Mn.Codes,o=r.accepted,c=r.ignored;if("string"===typeof s){if(Ln()(o).call(o,s)>=0)return!1;if(Ln()(c).call(c,s)>=0)return!0}}return!1},n.isIgnoreByMessage=function(e){if(GameCore.Utils.Object.hasOwn(e,"message")){var t=e.message,n=Mn.Messages,i=n.accepted,a=n.ignored;if("string"===typeof t){if(Ln()(i).call(i,t)>=0)return!1;if(Ln()(a).call(a,t)>=0)return!0}}return!1},n.addExtraState=function(){try{if(!GameCore.Utils.Object.hasOwn(window,"game"))return;if(!GameCore.Utils.Object.hasOwn(window.game,"storage"))return;if(!GameCore.Utils.Object.hasOwn(window.game.storage,"getState"))return;var e=(0,window.game.storage.getState)()||{},t=e.player,i=e.match,s=(0,a.Z)(e,Dn);n.rollbar.configure({payload:{player:t,match:i,other:s}})}catch(r){console.warn("%c addExtraState: ","font-size:12px;background-color: #42b983;color:#fff;",r)}},n}(0,o.Z)(t,e);var n=t.prototype;return n.setup=function(){this.rollbar=new(On())({accessToken:kn,checkIgnore:this.checkIgnore,onSendCallback:this.beforeSend,captureUncaught:!0,scrubTelemetryInputs:!0,captureUnhandledRejections:!0,autoInstrument:{dom:!1,navigation:!1},payload:{environment:"production",client:{javascript:{code_version:"212"}},server:{root:"webpack:///./",branch:"master"}}}),this.enable=!0,this.sendTestException()},n.configure=function(e){this.rollbar&&this.rollbar.configure(e)},n.sendTestException=function(){var e=this.game.facebook.getPlayerID();ae()(xn).call(xn,e)&&this.rollbar.debug(new Error("Test rollbar"),{playerID:e})},n.sendException=function(e,t){e&&(this.enable?this.rollbar&&(this.addExtraState(),this.rollbar.error(e,t)):console.error(e))},t}(Phaser.Plugins.BasePlugin),Fn=Un,Zn=function(e){function t(){return e.apply(this,arguments)||this}return(0,o.Z)(t,e),t.prototype.emit=function(t,n){return e.prototype.emit.call(this,t,n)},t}(Phaser.Events.EventEmitter),Gn=Zn,Hn=function(e){function t(t,n,i,a){var s;(s=e.call(this,t)||this).zone=void 0,s.background=void 0,s.setName(n),s.setVisible(!1);var r=s.scene.world.getWorldSize(),o=r.width,c=r.height;return s.setSize(i||o,a||c),s.addZone(),s.addBackground(),s}(0,o.Z)(t,e);var n=t.prototype;return n.open=function(e){GameCore.Utils.Valid.isObject(e)&&(this.setDataEnabled(),this.setData(e)),this.setBlockInputOutsideEnabled(!0),this.scene.screen.bringToTop(this.name),this.visible||(this.setVisible(!0),this.logPageviewOnOpen(),this.logEventOpen())},n.close=function(){var e=this.scene.screen.get(oe.o4.UNITS_SCREEN);!1!==(null==e?void 0:e.visible)&&this.name!==oe.o4.UNITS_SCREEN||this.setBlockInputOutsideEnabled(!1),this.visible&&(this.setVisible(!1),this.logPageviewOnClose())},n.setBlockInputOutsideEnabled=function(e){this.scene.input.setTopOnly(e)},n.incX=function(e){this.x+=e,this.background.x-=e},n.incY=function(e){this.y+=e,this.background.y-=e},n.incScale=function(e){this.scale+=e,this.background.scale-=e^e*(100/e)},n.addZone=function(){this.zone=this.scene.add.zone(0,0,this.width,this.height),this.zone.setInteractive({}),this.add(this.zone)},n.addBackground=function(){var e="screen-background";if(!this.scene.textures.exists(e)){var t=this.width+2,n=this.height+2,i=this.scene.add.graphics();i.fillStyle(0,1),i.fillRect(0,0,t,n),i.generateTexture(e,t,n),i.destroy()}this.background=this.scene.add.image(0,0,e),this.add(this.background)},n.logPageviewOnOpen=function(){this.scene.analytics.pageview(this.name)},n.logPageviewOnClose=function(){this.scene.analytics.pageview(this.scene.scene.key)},n.logEventOpen=function(){this.scene.analytics.event(pe._.SCREEN_OPEN,{screen_name:this.getScreenName()})},n.getScreenName=function(){return GameCore.Utils.String.toUpperCamelCase(this.name.toLowerCase())},t}(Phaser.GameObjects.Container),Yn=Hn,Kn={OPEN:"open",CLOSE:"close",CREATED:"created"};GameCore.Screen=Yn,GameCore.Screens={Events:Kn};var Vn=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=e.call.apply(e,E()(t=[this]).call(t,a))||this).events=void 0,n}(0,o.Z)(t,e);var n=t.prototype;return n.boot=function(){this.events=new Gn,this.registryScreenFactory()},n.get=function(e){var t=this.scene.children.getByName(e);return null===t?null:t},n.add=function(e,t,n,i){var a=this.get(e);return a||(a=this.scene.add.screen(e,t,n,i),this.events.emit(GameCore.Screens.Events.CREATED,a),a)},n.open=function(e,t){var n=this.get(e);return!!n&&(n.open(t),n.emit(GameCore.Screens.Events.OPEN,n),this.events.emit(GameCore.Screens.Events.OPEN,n),console.log("Screen open",e,t),!0)},n.close=function(e){var t=this.get(e);return!!t&&(t.close(),t.emit(GameCore.Screens.Events.CLOSE,t),this.events.emit(GameCore.Screens.Events.CLOSE,t),console.log("Screen close",e),!0)},n.bringToTop=function(e){var t=this.scene.children.getByName(e);t&&this.scene.children.bringToTop(t)},n.registryScreenFactory=function(){Phaser.GameObjects.GameObjectFactory.register("screen",this.createScreen)},n.createScreen=function(e,t,n,i){var a=new t(this.scene,e,n,i);return Phaser.Display.Align.In.Center(a,this.scene.gameZone),this.existing(a),a},t}(Phaser.Plugins.ScenePlugin),Wn=Vn,jn=n(424),zn=n.n(jn),Xn=n(627),qn=n(628),Qn=n(629),Jn={currentSceneKey:"",prevSceneKey:""};(0,Qn.pV)();var $n,ei,ti,ni,ii,ai,si,ri={processed:!1,contextId:"",contextType:"SOLO",entryPointData:{},currentGameMode:"",isRequestingDetectGameMode:!0},oi=ri,ci={data:{}},li={token:"",isRequesting:!1},ui=(($n={})[X]=function(e,t){return void 0===e&&(e=li),(0,Qn.ZP)(e,(function(e){var n=t.payload;if(n){var i=n.token;switch(t.type){case K:e.isRequesting=!0;break;case V:e.token=i,e.isRequesting=!1}}}))},$n),hi={coinBaseValue:0,coinSuffixValue:0},di=((ei={})[wt]=function(e,t){return void 0===e&&(e=hi),(0,Qn.ZP)(e,(function(e){var n=t.type,i=t.payload;if(i){var a=i.coinBaseValue,s=i.coinSuffixValue;if(n===Tt)e.coinBaseValue=a,e.coinSuffixValue=s}}))},ei),pi=n(124),fi={settings:(0,s.Z)({},Ht.h),userGuideDisplays:0,customFields:{selectedLevel:0,playerUnitData:"",playerLevelProgress:0,meleeUnlockedUnitLevel:0,rangedUnlockedUnitLevel:0,coinBaseValue:0,coinSuffixValue:0,freeCoinsLastUsedTime:0,offlineRewardLastCheck:0,unitScreenAdWatchedCount:{MELEE:{},RANGED:{}}}},gi={ASID:"",playerId:"",name:"",photo:"",locale:"",connectedPlayers:{},data:{settings:Ht.h,customFields:fi.customFields,userGuideDisplays:0},isUserNew:!0},Ei=((ti={})[ze]=function(e,t){return void 0===e&&(e=gi),(0,Qn.ZP)(e,(function(n){var i=t.payload;if(i){var a=i.name,s=i.value,r=i.data,o=void 0===r?{}:r,c=i.score,l=i.connectedPlayers,u=void 0===l?[]:l,h=i.profile;switch(t.type){case zt:var d=i.playerId,p=i.name,f=i.photo,g=i.locale,E=i.data;if(n.playerId=d,n.name=p,n.photo=f,n.locale=g,GameCore.Utils.Valid.isObject(E)){var m=E;n.data=(0,pi.TS)(e.data,m)}E.userGuideDisplays>0&&(n.isUserNew=!1);break;case qt:var v=h.playerId,A=h.name,S=h.photo,T=h.locale,y=h.ASID;n.ASID=y,n.playerId=v,n.name=A,n.photo=S,n.locale=T;break;case"PLAYER_SCORE_UPDATE":n.data.score=c;break;case Qt:if(!GameCore.Utils.Object.hasOwn(n.data.settings,a))break;n.data.settings[a]=s;break;case Xt:n.data=(0,pi.TS)(e.data,o),o.userGuideDisplays>0&&(n.isUserNew=!1);break;case Jt:if(u.length<=0)break;var C=GameCore.Utils.Object.keyBy(u,"playerId");n.connectedPlayers=(0,pi.TS)(e.connectedPlayers,C)}}}))},ti),mi={data:{},profileIds:[]},vi=((ni={})[An]=function(e,t){return void 0===e&&(e=mi),(0,Qn.ZP)(e,(function(n){var i=t.payload;if(i){var a=i.data,r=void 0===a?[]:a;if(t.type===vn){var o,c=GameCore.Utils.Object.keyBy(r,"playerId"),l=Ve()(c);n.data=(0,pi.TS)((0,s.Z)({},e.data),c),n.profileIds=GameCore.Utils.Array.unique(E()(o=[]).call(o,e.profileIds,l))}}}))},ni),Ai=n(466),Si={mode:"",status:le,rescued:0,startAt:0,finishAt:0},Ti={single:{_id:"",data:{fen:""},playerId:"",status:le},group:{status:le,opponentInfo:{playerId:"",name:"",photo:""}},challenge:{_id:"",status:le,whitePlayerId:"",blackPlayerId:"",opponentInfo:{playerId:"",name:"",photo:""}},online:{_id:"",status:le,players:{}},updateAt:0,isRequesting:!1},yi={current:{updateAt:0},data:{updateAt:0},isRequesting:!1},Ci=((ii={}).match=(0,Xn.UY)({gameplay:function(e,t){return void 0===e&&(e=Si),(0,Qn.ZP)(e,(function(n){var i=t.payload;if(i){var a=i.mode,s=i.status;switch(t.type){case Ai.Er:n.status=le,n.mode=Si.mode,n.rescued=Si.rescued,n.startAt=Si.startAt,n.finishAt=Si.finishAt,n.opponentInfo=Si.opponentInfo;break;case Ai.tk:n.mode=a,n.status=ue,n.rescued=Si.rescued,n.startAt=Date.now();break;case Ai.qm:n.mode="string"===typeof a?a:e.mode,n.status=s||e.status;break;case Ai.Mg:n.status=he,n.finishAt=Date.now();break;case Ai.XW:n.rescued+=1}}}))},match:function(e,t){return void 0===e&&(e=Ti),(0,Qn.ZP)(e,(function(n){var i=t.payload;if(i){var a=i.match,r=i.opponentInfo,o=i.players;switch(t.type){case Ai.xm:case Ai.AJ:case Ai.Qi:case Ai.DI:case Ai.ar:n.isRequesting=!0;break;case Ai.T7:n.single=(0,s.Z)({},e.single,a),n.updateAt=Date.now();break;case Ai.Uo:n.isRequesting=!1,n.single=a||Ti.single;break;case Ai.zu:n.isRequesting=!1,n.single=Ti.single;break;case Ai.tU:case Ai.f3:n.isRequesting=!0,n.challenge.opponentInfo=r;break;case Ai.AO:n.isRequesting=!1,n.challenge=(0,s.Z)({},a||Ti.challenge),n.challenge.opponentInfo=e.challenge.opponentInfo;break;case Ai.Un:n.isRequesting=!1,n.challenge=Ti.challenge;break;case Ai.Vj:n.group.status=ue,r&&(n.group.opponentInfo=r);break;case Ai.Sl:n.group.status=he;break;case Ai.UK:n.online.status=Ti.online.status,n.online.players=Ti.online.players;break;case Ai.li:n.online.status=ue,n.online.players=o;break;case Ai.NW:n.online.status=he}}}))},stats:function(e,t){return void 0===e&&(e=yi),(0,Qn.ZP)(e,(function(n){var i=t.payload;if(i){var a=i.playerId,r=i.stats,o=i.match,c=i.current,l=i.players,u=i.leaders;switch(t.type){case Ai.VY:delete n.data[a],n.current=yi.current;break;case Ai.go:n.data=yi.data,n.isRequesting=!0;break;case Ai.PM:n.data=r,n.isRequesting=!1;break;case Ai.HV:n.data[a]=r;break;case Ai.DP:n.current=(0,pi.TS)((0,s.Z)({},e.current),r);break;case Ai.li:Ve()(l).forEach((function(e){n.data[e]={score:0}}));break;case Ai.Ly:u.forEach((function(e){var t=e.playerId,i=e.score,a=e.rank;n.data[t]={score:i,rank:a}}));break;case Ai.AO:var h=o||{},d=h.blackPlayerId,p=h.blackPlayerScore,f=h.whitePlayerId,g=h.whitePlayerScore,E=h.whitePlayerLevel,m=h.blackPlayerLevel;if(!d||!f)break;c&&(n.current=c),n.data[d]={score:p,level:m},n.data[f]={score:g,level:E}}}}))}}),ii),Ii=n(462),Ri=n(463),wi={checked:!1,valueReceived:-1,hasShowReward:!1},_i=((ai={})[Ii.L]=function(e,t){return void 0===e&&(e=wi),(0,Qn.ZP)(e,(function(e){var n=t.payload;if(n){var i=n.value;switch(t.type){case Ri.g0:e.checked=!0;break;case Ri.lf:e.valueReceived=i;break;case Ri.uJ:e.hasShowReward=!0}}}))},ai),bi=n(464),Li=n(163),Pi=n.n(Li),Oi=n(89),Di=n.n(Oi),ki=n(465),Ni={leaderboardId:"",type:"",limit:0,offset:0,leaders:{},isRequesting:!1},Bi=((si={})[bi.L]=function(e,t){return void 0===e&&(e=Ni),(0,Qn.ZP)(e,(function(n){var i=t.payload;if(i){var a=i.leaderboardId,r=i.type,o=i.limit,c=i.offset,l=i.leaders;switch(t.type){case ki.Cc:e.type!==r&&0===c&&(n.leaders=Ni.leaders),n.isRequesting=!0,n.leaderboardId=a,n.type=r,n.limit=o,n.offset=c;break;case ki.HB:if(n.isRequesting=!1,e.type!==r)break;var u=GameCore.Utils.Json.clone((0,s.Z)({},e.leaders,l)),h=Pi()(u),d=Kt()(h).call(h,(function(e){return!!e.name&&!!e.photo}));Di()(d).call(d,(function(e,t){return+t.score-+e.score})),d.forEach((function(t,i){t.rank=i+1,e.leaders[t.playerId]||(n.leaders[t.playerId]=t)}));break;case ki.dU:n.isRequesting=!1,n.type=Ni.type,n.limit=Ni.limit,n.offset=Ni.offset,n.leaders=Ni.leaders,n.leaderboardId=Ni.leaderboardId}}}))},si),Mi=(0,Xn.UY)((0,s.Z)({scene:function(e,t){return void 0===e&&(e=Jn),(0,Qn.ZP)(e,(function(n){var i=t.payload;if(i){var a=i.sceneKey;if(t.type===de.DW)n.currentSceneKey=a,n.prevSceneKey=e.currentSceneKey}}))},context:function(e,t){return void 0===e&&(e=ri),(0,Qn.ZP)(e,(function(e){var n=t.payload;if(n){var i=n.gameMode,a=n.contextId,s=n.contextType,r=n.entryPointData,o=n.isRequestingDetectGameMode;switch(t.type){case de.kL:e.contextId=a,e.contextType=s,e.entryPointData=r;break;case de.fJ:e.contextId=a,e.contextType=s,e.processed=!0;break;case de.EH:e.currentGameMode=i,e.isRequestingDetectGameMode=!1;break;case de.Bv:e.isRequestingDetectGameMode=o}}}))},messages:function(e,t){return void 0===e&&(e=ci),(0,Qn.ZP)(e,(function(n){var i=t.payload;if(i){var a=i.opponentId;if("string"===typeof a)switch(t.type){case de.qj:e.data[a]?n.data[a].sent=!0:n.data[a]={sent:!0};break;case de.rh:e.data[a]?n.data[a].sent=!1:n.data[a]={sent:!1}}}}))}},ui,di,Ei,vi,_i,Bi,Ci)),xi=(window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__,Xn.qC),Ui=function(e){var t=xi((0,Xn.md)(qn.Z));return(0,Xn.MT)(Mi,e,t)},Fi=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=e.call.apply(e,E()(t=[this]).call(t,a))||this).store=void 0,n.initiator=void 0,n.dispatch=function(e){return n.store.dispatch(e)},n.getState=function(){return n.store.getState()},n.subscribe=function(e){return n.store.subscribe(e)},n.watch=function(e,t){var i=zn()((function(){var t=n.getState();return e(t)}));return n.subscribe(i((function(e){t(e)})))},n}(0,o.Z)(t,e);var n=t.prototype;return n.init=function(){this.store=Ui({})},n.setInitiator=function(e){this.initiator=e},n.syncStore=function(){var e=(0,r.Z)(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.initiator.initContext(),e.next=3,this.initiator.initPlayer();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t}(Phaser.Plugins.BasePlugin),Zi=Fi,Gi=n(623),Hi=n.n(Gi),Yi=function(e){function t(t,n){var i;return(i=e.call(this,t,{type:"webfont",key:n.type})||this).payload=void 0,i.payload=n,i}(0,o.Z)(t,e);var n=t.prototype;return n.load=function(){var e;switch(this.payload.type){case"google":e=this.getGoogleFontConfig(this.payload);break;case"local":e=this.getLocalFontConfig(this.payload)}Hi().load(e)},n.getGoogleFontConfig=function(e){var t=this,n=e.character,i=e.fontName,a=e.fontWeight;return{google:{families:[i+":"+(void 0===a?400:a)],text:n},active:function(){t.loader.nextFile(t,!0)},timeout:15e3}},n.getLocalFontConfig=function(e){var t=this,n=e.fontName,i=e.fontType,a=document.createElement("style");document.head.appendChild(a);var s=a.sheet;if(s){var r='@font-face { font-family: "'+n+'"; src: url("assets/fonts/'+n+("opentype"===i?".otf":".ttf")+'") format("'+i+'"); }';s.insertRule(r,0)}return{custom:{families:[n]},active:function(){t.loader.nextFile(t,!0)},timeout:15e3}},t}(Phaser.Loader.File),Ki=Yi,Vi=function(e){function t(){return e.apply(this,arguments)||this}return(0,o.Z)(t,e),t.prototype.addFont=function(e){var t=new Ki(this.scene.load,e);this.scene.load.addFile(t)},t}(Phaser.Plugins.ScenePlugin),Wi=Vi,ji=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=e.call.apply(e,E()(t=[this]).call(t,a))||this).portraitRatio=void 0,n.portraitWidth=void 0,n.portraitHeight=void 0,n.landscapeRatio=void 0,n.landscapeWidth=void 0,n.landscapeHeight=void 0,n.worldWidth=void 0,n.worldHeight=void 0,n.worldRatio=void 0,n.autoResize=void 0,n.disableLandscape=void 0,n.fullSizeOnLandscape=void 0,n.forcePixelRatio=void 0,n.handleResize=(0,mt.D)((function(){n.resize()}),300),n}(0,o.Z)(t,e);var n=t.prototype;return n.configure=function(e){var t=e.autoResize,n=e.portraitRatio,i=e.portraitWidth,a=e.portraitHeight,s=e.landscapeWidth,r=e.landscapeHeight,o=e.landscapeRatio,c=e.disableLandscape,l=e.fullSizeOnLandscape;this.autoResize=t,this.disableLandscape=c,this.fullSizeOnLandscape=l,this.portraitRatio=n,this.portraitWidth=i,this.portraitHeight=a,this.landscapeRatio=o,this.landscapeWidth=s,this.landscapeHeight=r,this.initWorldSize(),this.addEventResize()},n.resize=function(e){var t=this;e&&e>0&&(this.forcePixelRatio=e);var n=this.getCanvasSizeFixedRatio(this.worldRatio),i=n.width,a=n.height;this.resizeCanvas(i,a),this.game.scene.scenes.forEach((function(e){var n=e.cameras.main;if(n){var i=t.getZoomRatio(),a=t.getWorldSize(),s=a.width,r=a.height;n.setZoom(i),n.centerOn(s/2,r/2)}}))},n.resizeCanvas=function(e,t){this.game.canvas.width=e,this.game.canvas.height=t,this.game.scale.resize(e,t)},n.getWorldSize=function(){return{width:this.worldWidth,height:this.worldHeight}},n.initWorldSize=function(){this.worldWidth=this.portraitWidth,this.worldHeight=this.portraitHeight;var e=this.getScreenRatio();if(this.isScreenSmallerRatio(this.portraitRatio))this.worldHeight=this.worldWidth/this.getScreenRatio();else if(this.disableLandscape)this.isScreenSmallerRatio(this.portraitRatio)&&(this.worldHeight=this.worldWidth/e);else if(this.worldWidth=this.landscapeWidth,this.worldHeight=this.landscapeHeight,this.landscapeRatio>e&&(this.worldHeight=this.worldWidth/e),this.fullSizeOnLandscape){this.worldRatio=this.worldWidth/this.worldHeight,this.landscapeRatio=e;var t=this.getCanvasSizeFixedRatio(this.landscapeRatio),n=t.width,i=t.height,a=this.getZoomRatio();this.worldWidth=n/a,this.worldHeight=i/a}this.worldRatio=this.worldWidth/this.worldHeight,console.info("\ud83d\ude80 > this.worldRatio",this.worldRatio)},n.getZoomRatio=function(){var e=this.getWorldSize().width;return this.getCanvasSizeFixedRatio(this.worldRatio).width/e},n.getPixelRatio=function(){if(this.forcePixelRatio>0)return this.forcePixelRatio;if(GameCore.Utils.Device.isDesktop())return 2;var e=GameCore.Utils.Device.pixelRatio();return e>2&&(e=2),e},n.getPhysicPixels=function(e,t){return e*t},n.getCanvasSizeFixedRatio=function(e){var t=this.getPixelRatio(),n=this.getScreenWidth()*t,i=this.getScreenHeight()*t;return this.isScreenSmallerRatio(e)?i=n/e:n=i*e,{width:n,height:i}},n.getScreenRatio=function(){return this.getScreenWidth()/this.getScreenHeight()},n.getScreenHeight=function(){var e=document,t=e.body,n=e.documentElement,i=t.clientHeight,a=n.clientHeight;return Math.max(a,i)||0},n.getScreenWidth=function(){var e=document,t=e.body,n=e.documentElement,i=t.clientWidth,a=n.clientWidth;return Math.max(a,i)||0},n.isScreenSmallerRatio=function(e){return this.getScreenRatio()<e},n.isGameWorldSmallerRatio=function(e){var t=this.getWorldSize();return t.width/t.height<=e},n.addEventResize=function(){this.autoResize&&window.addEventListener("resize",this.handleResize)},n.isLandscape=function(){return this.worldRatio>this.portraitRatio},n.isUsingLandscapeBackground=function(){return this.worldRatio>.796},t}(Phaser.Plugins.BasePlugin),zi=ji,Xi=function(){function e(e,t,n){this.contextId=void 0,this.contextType=void 0,this.entryPointData=void 0,this.contextId=e||oi.contextId,this.contextType=t||oi.contextType,this.entryPointData=n||oi.entryPointData}return e.prototype.toObject=function(){return{contextId:this.contextId,contextType:this.contextType,entryPointData:this.entryPointData}},e}(),qi=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="InvalidPlayerId",i.message=t||"The playerId is not valid",i.payload=n,i}return(0,o.Z)(t,e),t}((0,R.Z)(Error)),Qi=n(230),Ji={COINS:"coins",SETTINGS:"settings",GAME_DATA:"gameData",USER_GUIDE_DISPLAYS:"userGuideDisplays",FREE_COINS_LAST_USED_TIME:"freeCoinsLastUsedTime",OFFLINE_REWARD_LAST_CHECK:"offlineRewardLastCheck"},$i=n(86),ea=GameCore.Configs.Gameplay.MaxLevel,ta=GameCore.Configs.SyncProfileFromAPI,na=function(e){var t=this;this.game=void 0,this.initContext=function(){var e=window.GameSDK.context.getID(),n=window.GameSDK.context.getType(),i=window.GameSDK.getEntryPointData(),a=new Xi(e,n,i).toObject(),s=a.contextId,r=a.contextType,o=a.entryPointData;t.game.storage.dispatch((0,Qi.U1)(s,r,o))},this.initPlayer=(0,r.Z)(l().mark((function e(){var n,i,a,s,r,o,c,u,h,d,p;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.game,i=n.player,a=n.storage,s=t.getPlayerInfo(),r=Pi()(Ji),e.next=5,FBInstant.player.getDataAsync(r);case 5:return o=e.sent,console.info("\ud83d\ude80 > rawData",o),c=new Vt.Z(o),console.info("\ud83d\ude80 > playerData",c),e.next=11,t.maintainDataStructure(c);case 11:return c=e.sent,!0===(u=c.toObject()).settings.music&&window.game.audio.playMusic(),!0===u.settings.vibrate&&(0,$i.wT)(!0),u.gameData.playerLevelProgress&&u.gameData.playerLevelProgress>=ea&&(u.gameData.playerLevelProgress=ea-1),h=u.coins,d=h.baseValue,p=h.suffix,a.dispatch(It(d,p)),e.next=20,i.receiveData(s,c.convertToPlayerData());case 20:case"end":return e.stop()}}),e)}))),this.maintainDataStructure=function(){var e=(0,r.Z)(l().mark((function e(t){var n,i,a,r;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,ta){e.next=3;break}return e.abrupt("return",t);case 3:return e.next=5,FBInstant.player.getDataAsync(["isSynced","customFields"]);case 5:if(e.t0=e.sent,e.t0){e.next=8;break}e.t0={};case 8:if(n=e.t0,!0!==(n.isSynced||!1)){e.next=12;break}return e.abrupt("return",t);case 12:if(i=n.customFields||!1){e.next=15;break}return e.abrupt("return",t);case 15:return(a=t.convertToPlayerData()).customFields=i,r=new Vt.Z({}).convertToFacebookData(a),e.next=20,FBInstant.player.setDataAsync((0,s.Z)({},r,{isSynced:!0}));case 20:return e.abrupt("return",new Vt.Z(r));case 23:return e.prev=23,e.t1=e.catch(0),console.warn(e.t1),e.abrupt("return",t);case 27:case"end":return e.stop()}}),e,null,[[0,23]])})));return function(t){return e.apply(this,arguments)}}(),this.getPlayerInfo=function(){try{var e=window.GameSDK.player.getID(),t=window.GameSDK.player.getName(),n=window.GameSDK.player.getPhoto(),i=window.GameSDK.getLocale();if(!GameCore.Utils.Valid.isString(e))throw new qi(null,{playerId:e});return GameCore.Utils.Valid.isString(t)||(t="You"),new $t.Z(e,t,n,i).toObject()}catch(a){return new $t.Z("123","You").toObject()}},this.game=e},ia=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=e.call.apply(e,E()(t=[this]).call(t,a))||this).Text=void 0,n.Texture=void 0,n.currentLocale=void 0,n.supportedLanguages=void 0,n.data=void 0,n.options=void 0,n}(0,o.Z)(t,e);var n=t.prototype;return n.configure=function(e){this.applyOptions(e)},n.getCurrentLanguage=function(){return this.currentLocale},n.switchLanguage=function(e){void 0===e&&(e="en");var t=this.getCorrectLocale(e);this.currentLocale=t,this.Text=this.data[t].Text,this.Texture=this.data[t].Texture},n.getText=function(e){if("object"==typeof e){var t=e.key,n=e.variables,i=void 0===n?[]:n,a=e.locale,s=void 0===a?this.currentLocale:a,r=this.getCorrectLocale(s),o=this.data[r].Text[t];return this.replaceVariables(o,i)}return this.Text[e]},n.getTexture=function(e){if("object"==typeof e){var t=e.key,n=e.variables,i=void 0===n?[]:n,a=e.locale,s=void 0===a?this.currentLocale:a,r=this.getCorrectLocale(s),o=this.data[r].Texture[t];return this.replaceVariables(o,i)}return this.Texture[e]},n.isSupportLanguage=function(e){var t;return Ln()(t=this.supportedLanguages).call(t,e)>=0},n.applyOptions=function(e){this.options=(0,s.Z)({},e);var t=e.data,n=e.locale,i=void 0===n?"en":n,a=e.upperCaseText,r=void 0!==a&&a;this.data=t,this.supportedLanguages=Ve()(t);var o=this.getCorrectLocale(i);if(this.currentLocale=o,this.Text=t[o].Text,this.Texture=t[o].Texture,r)for(var c in this.Text)this.Text[c]=this.Text[c].toUpperCase()},n.replaceVariables=function(e,t){var n=t.length;if(0==n)return e;var i=0;return e.replace(/{.*}/,(function(){return String(t[Math.min(i++,n-1)])}))},n.getCorrectLocale=function(e){var t=e;return this.isSupportLanguage(e)||(t="en"),t},t}(Phaser.Plugins.BasePlugin),aa={en:JSON.parse('{"Text":{"START_FIGHT":"START FIGHT","COLLECT":"Collect","SETTINGS":"Settings","SOUND_FX":"Sound Fx","MUSIC":"Music","VIBRATION":"Vibration","QUICK_FIGHT":"Quick Fight","SPEED":"Speed","LEADERBOARD":"Leaderboard","RANK":"Rank","PHOTO":"Photo","NAME":"Name","LEVEL":"Level","CHARACTER_LIST":"Character List","DINOSAURS":"Dinosaurs","WARRIORS":"Warriors","BUY":"BUY","FREE":"FREE","LOCKED":"Locked","BATTLE":"Battle","FRIENDS":"Friends","REVENGE":"Revenge","RANKING":"Ranking","HISTORY":"History","CHALLENGE_FRIENDS":"CHALLENGE\\nFRIENDS","GLOBAL":"Global","WIN":"WIN","LOSE":"LOSE","FULL":"FULL","NEW_CHARACTER":"New Character","SHARE":"SHARE","SHARE_CAPITAL":"Share","VICTORY":"VICTORY","YOU_EARNED":"YOU EARNED","LEVEL_COMPLETED_BONUS_X":"Level Completed Bonus x","SPIN":"SPIN!","CLAIM":"CLAIM","CONTINUE":"Continue","FAILED":"FAILED","OFFLINE_COINS_REWARDS":"OFFLINE COINS REWARDS","X2_COINS":"X2 COINS","UNAVAILABLE":"UNAVAILABLE","REPLAY":"REPLAY","BACK_TO_SINGLEPLAY":"BACK TO\\n SINGLEPLAY","LOADING":"Loading...","VS":"VS","NO_ADS_TO_DISPLAY":"No ads to display!","WATCH_A_VIDEO":"Watch a video to get free unit!","LOADING_ADS":"Loading ads...","SORRY_NO_REWARDS":"Sorry, No Rewards!\\nYou have cancelled the ad!","DISPLAY_ADS_FAILED":"Display Ads Failed","UNABLE_TO_DISPLAY_ADS":"Unable to display ads.\\nPlease try again later.","LEADERBOARD_IS_EMPTY":"Leaderboard is empty!","NO_MATCHES_AVAILABLE":"No matches available!","GET_NOW":"GET NOW!","GET":"GET","RESET_DATA":"Reset Data","RESET_DESC":"This will reset your data and\\n you will lose all your\\n progress. Are you sure you\\n want to continue?","YES":"Yes","NO":"No","START_OVER_TITLE":"Completed","START_OVER_DESC":"Are you sure to start over?"},"Texture":{"EMPTY":"EMPTY"}}'),ru:JSON.parse('{"Text":{"START_FIGHT":"\u041d\u0410\u0427\u0410\u0422\u042c \u0411\u041e\u0419","COLLECT":"\u0421\u043e\u0431\u0440\u0430\u0442\u044c","SETTINGS":"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438","SOUND_FX":"\u0417\u0432\u0443\u043a\u043e\u0432\u044b\u0435","MUSIC":"\u041c\u0443\u0437\u044b\u043a\u0430","VIBRATION":"\u0412\u0438\u0431\u0440\u0430\u0446\u0438\u044f","QUICK_FIGHT":"\u0411\u044b\u0441\u0442\u0440\u044b\u0439 \u0411\u043e\u0439","SPEED":"\u0421\u043a\u043e\u0440\u043e\u0441\u0442\u044c","LEADERBOARD":"\u0422\u0430\u0431\u043b\u0438\u0446\u0430 \u041b\u0438\u0434\u0435\u0440\u043e\u0432","RANK":"\u0420\u0430\u043d\u0433","PHOTO":"\u0424\u043e\u0442\u043e","NAME":"\u0418\u043c\u044f","LEVEL":"\u0423\u0440\u043e\u0432\u0435\u043d\u044c","CHARACTER_LIST":"\u0421\u043f\u0438\u0441\u043e\u043a \u041f\u0435\u0440\u0441\u043e\u043d\u0430\u0436\u0435\u0439","DINOSAURS":"\u0414\u0438\u043d\u043e\u0437\u0430\u0432\u0440\u044b","WARRIORS":"\u0412\u043e\u0438\u043d\u044b","BUY":"\u041a\u0423\u041f\u0418\u0422\u042c","FREE":"\u0411\u0415\u0421\u041f\u041b\u0410\u0422\u041d\u041e","LOCKED":"\u0417\u0430\u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u043d\u043e","BATTLE":"\u0411\u043e\u0439","FRIENDS":"\u0414\u0440\u0443\u0437\u044c\u044f","REVENGE":"\u041c\u0435\u0441\u0442\u044c","RANKING":"\u0420\u0435\u0439\u0442\u0438\u043d\u0433","HISTORY":"\u0418\u0441\u0442\u043e\u0440\u0438\u044f","CHALLENGE_FRIENDS":"\u0411\u0440\u043e\u0441\u044c\u0442\u0435 \u0432\u044b\u0437\u043e\u0432\\n\u0434\u0440\u0443\u0437\u044c\u044f\u043c","GLOBAL":"\u0413\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u044b\u0439","WIN":"\u041f\u041e\u0411\u0415\u0414\u0410","LOSE":"\u041f\u041e\u0420\u0410\u0416\u0415\u041d\u0418\u0415","FULL":"\u041f\u041e\u041b\u041d\u042b\u0419","NEW_CHARACTER":"\u041d\u043e\u0432\u044b\u0439 \u041f\u0435\u0440\u0441\u043e\u043d\u0430\u0436","SHARE":"\u041f\u041e\u0414\u0415\u041b\u0418\u0422\u042c\u0421\u042f","SHARE_CAPITAL":"\u041f\u043e\u0434\u0435\u043b\u0438\u0442\u044c\u0441\u044f","VICTORY":"\u041f\u041e\u0411\u0415\u0414\u0410","YOU_EARNED":"\u0412\u042b \u0417\u0410\u0420\u0410\u0411\u041e\u0422\u0410\u041b\u0418","LEVEL_COMPLETED_BONUS_X":"\u0411\u043e\u043d\u0443\u0441 \u0417\u0430 \u0417\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u0435 \u0423\u0440\u043e\u0432\u043d\u044f x","SPIN":"\u0412\u0420\u0410\u0429\u0415\u041d\u0418\u0415!","CLAIM":"\u0421\u041e\u0411\u0420\u0410\u0422\u042c","CONTINUE":"\u041f\u0440\u043e\u0434\u043e\u043b\u0436\u0438\u0442\u044c","FAILED":"\u041d\u0415\u0423\u0414\u0410\u0427\u0410","OFFLINE_COINS_REWARDS":"\u041d\u0410\u0413\u0420\u0410\u0414\u042b \u0412 \u041e\u0424\u0424\u041b\u0410\u0419\u041d\u0415","X2_COINS":"X2 \u041c\u041e\u041d\u0415\u0422","UNAVAILABLE":"\u041d\u0415\u0414\u041e\u0421\u0422\u0423\u041f\u0415\u041d","REPLAY":"\u041f\u041e\u0412\u0422\u041e\u0420","BACK_TO_SINGLEPLAY":"\u0412\u0415\u0420\u041d\u0423\u0422\u042c\u0421\u042f \u0412\\n \u041e\u0414\u0418\u041d\u041e\u0427\u041d\u0423\u042e \u0418\u0413\u0420\u0423","LOADING":"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430...","VS":"\u041f\u0420\u041e\u0422\u0418\u0412","NO_ADS_TO_DISPLAY":"\u041d\u0435\u0442 \u041e\u0431\u044a\u044f\u0432\u043b\u0435\u043d\u0438\u0439\\n\u0414\u043b\u044f \u041e\u0442\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f","WATCH_A_VIDEO":"\u041f\u043e\u0441\u043c\u043e\u0442\u0440\u0438\u0442\u0435 \u0412\u0438\u0434\u0435\u043e, \u0427\u0442\u043e\u0431\u044b\\n\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0411\u0435\u0441\u043f\u043b\u0430\u0442\u043d\u044b\u0439 \u042e\u043d\u0438\u0442!","LOADING_ADS":"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u041e\u0431\u044a\u044f\u0432\u043b\u0435\u043d\u0438\u0439...","SORRY_NO_REWARDS":"\u0418\u0437\u0432\u0438\u043d\u0438\u0442\u0435, \u043d\u0430\u0433\u0440\u0430\u0434 \u043d\u0435\u0442!\\n\u0412\u044b \u043e\u0442\u043c\u0435\u043d\u0438\u043b\u0438 \u0440\u0435\u043a\u043b\u0430\u043c\u0443!","DISPLAY_ADS_FAILED":"\u041e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0440\u0435\u043a\u043b\u0430\u043c\u0443 \u043d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c","UNABLE_TO_DISPLAY_ADS":"\u041d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e \u043f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0440\u0435\u043a\u043b\u0430\u043c\u0443.\\n\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u043f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435\\n\u043f\u043e\u0437\u0436\u0435.","LEADERBOARD_IS_EMPTY":"\u0422\u0430\u0431\u043b\u0438\u0446\u0430 \u043b\u0438\u0434\u0435\u0440\u043e\u0432 \u043f\u0443\u0441\u0442\u0430!","NO_MATCHES_AVAILABLE":"\u041d\u0435\u0442 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0445 \u0441\u043e\u0432\u043f\u0430\u0434\u0435\u043d\u0438\u0439!","GET_NOW":"\u041f\u041e\u041b\u0423\u0427\u0418\u0422\u042c \u0421\u0415\u0419\u0427\u0410\u0421!","GET":"\u041f\u041e\u041b\u0423\u0427\u0418\u0422\u042c","RESET_DATA":"\u0421\u0431\u0440\u043e\u0441\u0438\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435","RESET_DESC":"\u042d\u0442\u043e \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435 \u043f\u0440\u0438\u0432\u0435\u0434\u0435\u0442 \u043a \u0441\u0431\u0440\u043e\u0441\u0443\\n \u0432\u0441\u0435\u0445 \u0432\u0430\u0448\u0438\u0445 \u0434\u0430\u043d\u043d\u044b\u0445 \u0438 \u043f\u0440\u043e\u0433\u0440\u0435\u0441\u0441\u0430.\\n \u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b, \u0447\u0442\u043e \u0445\u043e\u0442\u0438\u0442\u0435\\n \u043f\u0440\u043e\u0434\u043e\u043b\u0436\u0438\u0442\u044c?","YES":"\u0414\u0430","NO":"\u041d\u0435\u0442","START_OVER_TITLE":"\u0417\u0430\u0432\u0435\u0440\u0448\u0435\u043d","START_OVER_DESC":"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b, \u0447\u0442\u043e \u043d\u0430\u0447\u043d\u0435\u0442\u0435\\n \u0441\u043d\u0430\u0447\u0430\u043b\u0430?"},"Texture":{"EMPTY":"EMPTY"}}'),ja:JSON.parse('{"Text":{"START_FIGHT":"\u30d0\u30c8\u30eb\u30b9\u30bf\u30fc\u30c8","COLLECT":"\u96c6\u3081\u308b","SETTINGS":"\u8a2d\u5b9a","SOUND_FX":"\u52b9\u679c\u97f3","MUSIC":"BGM","VIBRATION":"\u632f\u52d5","QUICK_FIGHT":"\u30af\u30a4\u30c3\u30af\u30d0\u30c8\u30eb","SPEED":"\u30b9\u30d4\u30fc\u30c9","LEADERBOARD":"\u30ea\u30fc\u30c0\u30fc\u30dc\u30fc\u30c9","RANK":"\u30e9\u30f3\u30af","PHOTO":"\u5199\u771f","NAME":"\u540d\u524d","LEVEL":"\u30ec\u30d9\u30eb","CHARACTER_LIST":"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u30ea\u30b9\u30c8","DINOSAURS":"\u6050\u7adc","WARRIORS":"\u6226\u58eb","BUY":"\u8cfc\u5165\u3059\u308b","FREE":"\u7121\u6599","LOCKED":"\u30ed\u30c3\u30af","BATTLE":"\u30d0\u30c8\u30eb","FRIENDS":"\u30d5\u30ec\u30f3\u30c9","REVENGE":"\u30ea\u30d9\u30f3\u30b8","RANKING":"\u30e9\u30f3\u30ad\u30f3\u30b0","HISTORY":"\u6b74\u53f2","CHALLENGE_FRIENDS":"\u30d5\u30ec\u30f3\u30c9\u306b\u6311\u6226","GLOBAL":"\u30d6\u30ed\u30fc\u30d0\u30eb","WIN":"\u52dd\u5229","LOSE":"\u6557\u5317","FULL":"\u30d5\u30eb","NEW_CHARACTER":"\u65b0\u3057\u3044\u30ad\u30e3\u30e9\u30af\u30bf\u30fc","SHARE":"\u30b7\u30a7\u30a2","SHARE_CAPITAL":"\u30b7\u30a7\u30a2","VICTORY":"\u52dd\u5229","YOU_EARNED":"\u7372\u5f97","LEVEL_COMPLETED_BONUS_X":"\u30ec\u30d9\u30eb\u5b8c\u4e86\u30dc\u30fc\u30ca\u30b9 x","SPIN":"\u30b9\u30d4\u30f3","CLAIM":"\u53d7\u3051\u53d6\u308b","CONTINUE":"\u7d9a\u3051\u308b","FAILED":"\u5931\u6557","OFFLINE_COINS_REWARDS":"\u30aa\u30d5\u30e9\u30a4\u30f3\u30b3\u30a4\u30f3\u5831\u916c","X2_COINS":"X2 \u30b3\u30a4\u30f3","UNAVAILABLE":"\u5229\u7528\u4e0d\u53ef","REPLAY":"\u30ea\u30d7\u30ec\u30a4","BACK_TO_SINGLEPLAY":"\u30b7\u30f3\u30b0\u30eb\u30d7\u30ec\u30a4\u306b\u623b\u308b","LOADING":"\u8aad\u307f\u8fbc\u3093\u3067\u3044\u307e\u3059...","VS":"VS","NO_ADS_TO_DISPLAY":"\u8868\u793a\u3067\u304d\u308b\u5e83\u544a\u306f\u3042\u308a\u307e\u305b\u3093","WATCH_A_VIDEO":"\u52d5\u753b\u3092\u8996\u8074\u3057\u3066\u7121\u6599\u30e6\u30cb\u30c3\u30c8\u3092\u7372\u5f97\u3059\u308b\uff01","LOADING_ADS":"\u5e83\u544a\u3092\u8aad\u307f\u8fbc\u3093\u3067\u3044\u307e\u3059...","SORRY_NO_REWARDS":"\u30ea\u30ef\u30fc\u30c9\u306f\u3042\u308a\u307e\u305b\u3093\uff01\\n\u5e83\u544a\u3092\u30ad\u30e3\u30f3\u30bb\u30eb\u3057\u307e\u3057\u305f\uff01","DISPLAY_ADS_FAILED":"\u5e83\u544a\u306e\u8868\u793a\u306b\u5931\u6557","UNABLE_TO_DISPLAY_ADS":"\u5e83\u544a\u3092\u8868\u793a\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002\\n\u307e\u305f\u5f8c\u3067\u8a66\u3057\u3066\u304f\u3060\u3055\u3044\u3002","LEADERBOARD_IS_EMPTY":"\u30ea\u30fc\u30c0\u30fc\u30dc\u30fc\u30c9\u304c\u7a7a\u3067\u3059\uff01","NO_MATCHES_AVAILABLE":"\u5229\u7528\u53ef\u80fd\u306a\u8a66\u5408\u304c\u3042\u308a\u307e\u305b\u3093","GET_NOW":"\u53d6\u5f97","GET":"\u53d6\u5f97","RESET_DATA":"\u30c7\u30fc\u30bf\u30ea\u30bb\u30c3\u30c8","RESET_DESC":"\u3053\u308c\u3092\u884c\u3046\u3068\u30c7\u30fc\u30bf\u304c\u30ea\u30bb\u30c3\u30c8\u3055\u308c,\\n\u9032\u6357\u72b6\u6cc1\u304c\u3059\u3079\u3066\u5931\u308f\u308c\u307e\u3059.\\n\u7d9a\u3051\u307e\u3059\u304b\uff1f","YES":"\u306f\u3044","NO":"\u3044\u3044\u3048","START_OVER_TITLE":"\u5b8c\u4e86","START_OVER_DESC":"\u672c\u5f53\u306b\u6700\u521d\u304b\u3089\u3084\u308a\u76f4\u3057\u3066\\n\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f"},"Texture":{"EMPTY":"EMPTY"}}'),zh:JSON.parse('{"Text":{"START_FIGHT":"\u5f00\u6218","COLLECT":"\u6536\u96c6","SETTINGS":"\u8bbe\u7f6e","SOUND_FX":"\u97f3\u6548","MUSIC":"\u97f3\u4e50","VIBRATION":"\u632f\u52a8","QUICK_FIGHT":"\u5feb\u901f\u6218\u6597","SPEED":"\u901f\u5ea6","LEADERBOARD":"\u6392\u884c\u699c","RANK":"\u9636\u7ea7","PHOTO":"\u5934\u50cf","NAME":"\u540d\u5b57","LEVEL":"\u7b49\u7ea7","CHARACTER_LIST":"\u89d2\u8272\u5217\u8868","DINOSAURS":"\u6050\u9f99","WARRIORS":"\u6218\u58eb","BUY":"\u8d2d\u4e70","FREE":"\u514d\u8d39","LOCKED":"\u9501\u5b9a","BATTLE":"\u5bf9\u6218","FRIENDS":"\u597d\u53cb","REVENGE":"\u590d\u4ec7","RANKING":"\u6392\u540d","HISTORY":"\u5386\u53f2","CHALLENGE_FRIENDS":"\u6311\u6218\u597d\u53cb","GLOBAL":"\u5168\u7403","WIN":"\u83b7\u80dc","LOSE":"\u6218\u8d25","FULL":"\u5df2\u6ee1","NEW_CHARACTER":"\u65b0\u89d2\u8272","SHARE":"\u5206\u4eab","SHARE_CAPITAL":"\u5206\u4eab","VICTORY":"\u80dc\u5229","YOU_EARNED":"\u4f60\u8d62\u5f97\u4e86","LEVEL_COMPLETED_BONUS_X":"\u5173\u5361\u5b8c\u6210\u5956\u52b1X","SPIN":"\u8f6c","CLAIM":"\u9886\u53d6","CONTINUE":"\u7ee7\u7eed","FAILED":"\u5931\u8d25","OFFLINE_COINS_REWARDS":"\u79bb\u7ebf\u91d1\u5e01\u5956\u52b1","X2_COINS":"X2\u91d1\u5e01","UNAVAILABLE":"\u4e0d\u53ef\u7528","REPLAY":"\u56de\u653e","BACK_TO_SINGLEPLAY":"\u8fd4\u56de\u5355\u4eba\u6a21\u5f0f","LOADING":"\u52a0\u8f7d\u4e2d\u2026\u2026","VS":"\u5bf9","NO_ADS_TO_DISPLAY":"\u65e0\u5e7f\u544a\u53ef\u5c55\u793a","WATCH_A_VIDEO":"\u89c2\u770b\u89c6\u9891\u514d\u8d39\u83b7\u5f97\u6218\u529b\uff01","LOADING_ADS":"\u8f7d\u5165\u5e7f\u544a\u4e2d\u2026\u2026","SORRY_NO_REWARDS":"\u62b1\u6b49\uff0c\u6ca1\u6709\u5956\u52b1\uff01\\n\u4f60\u5df2\u7ecf\u53d6\u6d88\u4e86\u5e7f\u544a\uff01","DISPLAY_ADS_FAILED":"\u5e7f\u544a\u663e\u793a\u5931\u8d25","UNABLE_TO_DISPLAY_ADS":"\u65e0\u6cd5\u663e\u793a\u5e7f\u544a\u3002\u8bf7\u7a0d\u540e\u91cd\u8bd5\u3002","LEADERBOARD_IS_EMPTY":"\u6392\u884c\u699c\u4e3a\u7a7a\uff01","NO_MATCHES_AVAILABLE":"\u6ca1\u6709\u53ef\u7528\u7684\u6bd4\u8d5b","GET_NOW":"\u4eca\u3059\u3050\u5165\u624b","GET":"\u5f97\u5230","RESET_DATA":"\u91cd\u7f6e\u6570\u636e","RESET_DESC":"\u8fd9\u5c06\u91cd\u7f6e\u60a8\u7684\u6570\u636e\uff0c\u60a8\u5c06\u5931\u53bb\\n\u6240\u6709\u8fdb\u5ea6\u3002 \u4f60\u786e\u5b9a\u4f60\u8981\u7ee7\u7eed\u5417\uff1f","YES":"\u662f\u7684","NO":"\u4e0d","START_OVER_TITLE":"\u5df2\u5b8c\u6210","START_OVER_DESC":"\u4f60\u786e\u5b9a\u60f3\u8981\u91cd\u6765\u5417\uff1f"},"Texture":{"EMPTY":"EMPTY"}}'),pt:JSON.parse('{"Text":{"START_FIGHT":"COME\xc7AR LUTA","COLLECT":"COLETAR","SETTINGS":"DEFINI\xc7\xd5ES","SOUND_FX":"EFEITOS DE SOM","MUSIC":"M\xdaSICA","VIBRATION":"VIBRA\xc7\xc3O","QUICK_FIGHT":"LUTA R\xc1PIDA","SPEED":"VELOC","LEADERBOARD":"CLASSIFICA\xc7\xc3O","RANK":"CLAS","PHOTO":"FOTO","NAME":"NOME","LEVEL":"N\xcdVEL","CHARACTER_LIST":"LISTA DE PERSONAGENS","DINOSAURS":"DINOSSAUROS","WARRIORS":"GUERREIROS","BUY":"COMPRAR","FREE":"GR\xc1TIS","LOCKED":"BLOQUEADO","BATTLE":"BATALHA","FRIENDS":"AMIGOS","REVENGE":"VINGAN\xc7A","RANKING":"CLASSIFICA\xc7\xc3O","HISTORY":"HIST\xd3RIA","CHALLENGE_FRIENDS":"DESAFIA OS TEUS AMIGOS","GLOBAL":"GLOBAL","WIN":"VIT\xd3RIA","LOSE":"DERROTA","FULL":"COMPLETO","NEW_CHARACTER":"NOVA PERSONAGEM!","SHARE":"PARTILHAR","SHARE_CAPITAL":"PARTILHAR","VICTORY":"VIT\xd3RIA","YOU_EARNED":"GANHASTE","LEVEL_COMPLETED_BONUS_X":"B\xd3NUS DE N\xcdVEL COMPLETADO x","SPIN":"GIRAR","CLAIM":"REIVINDICAR","CONTINUE":"CONTINUAR","FAILED":"FALHOU","OFFLINE_COINS_REWARDS":"RECOMPENSAS OFFLINE","X2_COINS":"MOEDAS x2","UNAVAILABLE":"N\xc3O DISPON\xcdVEL","REPLAY":"REPETI\xc7\xc3O","BACK_TO_SINGLEPLAY":"VOLTAR AO JOGO INDIVIDUAL","LOADING":"A CARREGAR...","VS":"VS","NO_ADS_TO_DISPLAY":"SEM AN\xdaNCIOS A EXIBIR","WATCH_A_VIDEO":"V\xca UM V\xcdDEO PARA RECEBER UMA UNIDADE GR\xc1TIS!","LOADING_ADS":"A CARREGAR AN\xdaNCIOS...","SORRY_NO_REWARDS":"Desculpa, n\xe3o h\xe1 recompensas! \\nCancelaste o an\xfancio!","DISPLAY_ADS_FAILED":"Falha na exibi\xe7\xe3o de an\xfancios","UNABLE_TO_DISPLAY_ADS":"N\xe3o \xe9 poss\xedvel exibir an\xfancios. \\nPor favor, tenta novamente\\n mais tarde.","LEADERBOARD_IS_EMPTY":"Placar est\xe1 vazio!","NO_MATCHES_AVAILABLE":"Nenhum jogo dispon\xedvel","GET_NOW":"OBTER","GET":"OBTER","RESET_DATA":"Redefinir dados","RESET_DESC":"Isso redefinir\xe1 seus dados e\\n voc\xea perder\xe1 todo o progresso.\\n Voc\xea tem certeza que quer\\n continuar?","YES":"SIM","NO":"N\xc3O","START_OVER_TITLE":"Conclu\xeddo","START_OVER_DESC":"Tens a certeza que queres\\n come\xe7ar de novo?"},"Texture":{"EMPTY":"EMPTY"}}'),es:JSON.parse('{"Text":{"START_FIGHT":"EMPEZAR PELEA","COLLECT":"RECOGER","SETTINGS":"CONFIGURACI\xd3N","SOUND_FX":"EFECTOS DE SONIDO","MUSIC":"M\xdaSICA","VIBRATION":"VIBRACI\xd3N","QUICK_FIGHT":"PELEA R\xc1PIDA","SPEED":"VELOC","LEADERBOARD":"TABLA DE CLASIFICACI\xd3N","RANK":"CLASIF","PHOTO":"FOTO","NAME":"NOMBRE","LEVEL":"NIVEL","CHARACTER_LIST":"LISTA DE PERSONAJES","DINOSAURS":"DINOSAURIOS","WARRIORS":"GUERREROS","BUY":"COMPRAR","FREE":"GRATIS","LOCKED":"BLOQUEADO","BATTLE":"BATALLA","FRIENDS":"AMIGOS","REVENGE":"VENGANZA","RANKING":"CLASIFICACI\xd3N","HISTORY":"HISTORIA","CHALLENGE_FRIENDS":"DESAF\xcdA A TUS AMIGOS","GLOBAL":"GLOBAL","WIN":"VICTORIA","LOSE":"DERROTA","FULL":"LLENO","NEW_CHARACTER":"\xa1NUEVO PERSONAJE!","SHARE":"COMPARTIR","SHARE_CAPITAL":"COMPARTIR","VICTORY":"VICTORIA","YOU_EARNED":"HAS GANADO","LEVEL_COMPLETED_BONUS_X":"BONO DE NIVEL COMPLETADO x","SPIN":"GIRAR","CLAIM":"RECLAMAR","CONTINUE":"CONTINUAR","FAILED":"FRACASO","OFFLINE_COINS_REWARDS":"RECOMPENSAS OFFLINE","X2_COINS":"MONEDAS X2","UNAVAILABLE":"NO DISPONIBLE","REPLAY":"REPETICI\xd3N","BACK_TO_SINGLEPLAY":"VOLVER AL JUEGO INDIVIDUAL","LOADING":"CARGANDO...","VS":"vs","NO_ADS_TO_DISPLAY":"SIN ANUNCIOS QUE MOSTRAR","WATCH_A_VIDEO":"\xa1MIRA UN V\xcdDEO PARA RECIBIR UNA UNIDAD GRATIS!","LOADING_ADS":"CARGANDO ANUNCIOS...","SORRY_NO_REWARDS":"Lo sentimos, no hay\\n recompensas. \xa1Has cancelado\\n el anuncio!","DISPLAY_ADS_FAILED":"Error en la visualizaci\xf3n de\\n anuncios","UNABLE_TO_DISPLAY_ADS":"No se pueden mostrar anuncios. \\nPor favor, int\xe9ntalo de nuevo\\n m\xe1s tarde.","LEADERBOARD_IS_EMPTY":"\xa1Tabla de l\xedderes est\xe1 vac\xeda!","NO_MATCHES_AVAILABLE":"No hay partidas disponibles","GET_NOW":"OBTENER","GET":"OBTENER","RESET_DATA":"Reiniciar datos","RESET_DESC":"Esto restablecer\xe1 sus datos y\\n perder\xe1 todo el progreso. Est\xe1s\\n seguro de que quieres\\n continuar?","YES":"S\xcd","NO":"NO","START_OVER_TITLE":"Completo","START_OVER_DESC":"\xbfEst\xe1s seguro de que quieres\\n empezar de nuevo?"},"Texture":{"EMPTY":"EMPTY"}}'),tr:JSON.parse('{"Text":{"START_FIGHT":"D\xd6V\xdc\u015eE BA\u015eLA","COLLECT":"TOPLA","SETTINGS":"AYARLAR","SOUND_FX":"SES","MUSIC":"M\xdcZ\u0130K","VIBRATION":"T\u0130TRE\u015e\u0130M","QUICK_FIGHT":"HIZLI D\xd6V\xdc\u015e","SPEED":"HIZ","LEADERBOARD":"L\u0130DERL\u0130K TABLOSU","RANK":"SIRA","PHOTO":"FOTO","NAME":"AD","LEVEL":"SEV\u0130YE","CHARACTER_LIST":"KARAKTER L\u0130STES\u0130","DINOSAURS":"D\u0130NOZORLAR","WARRIORS":"SAVA\u015e\xc7ILAR","BUY":"SATIN AL","FREE":"\xdcCRETS\u0130Z","LOCKED":"K\u0130L\u0130TL\u0130","BATTLE":"D\xd6V\xdc\u015e","FRIENDS":"ARKADA\u015eLAR","REVENGE":"\u0130NT\u0130KAM","RANKING":"SIRALAMA","HISTORY":"GE\xc7M\u0130\u015e","CHALLENGE_FRIENDS":"ARKADA\u015eLARINA MEYDAN OKU","GLOBAL":"GENEL","WIN":"GAL\u0130B\u0130YET","LOSE":"YEN\u0130LG\u0130","FULL":"TAM","NEW_CHARACTER":"YEN\u0130 KARAKTER","SHARE":"PAYLA\u015e","SHARE_CAPITAL":"PAYLA\u015e","VICTORY":"ZAFER","YOU_EARNED":"KAZANCIN","LEVEL_COMPLETED_BONUS_X":"SEV\u0130YE TAMAMLAMA BONUSU x","SPIN":"D\xd6ND\xdcR","CLAIM":"TALEP ET","CONTINUE":"DEVAM","FAILED":"BA\u015eARISIZ","OFFLINE_COINS_REWARDS":"\xc7EVR\u0130MDI\u015eI PARA \xd6D\xdcLLER\u0130","X2_COINS":"X2 PARA","UNAVAILABLE":"KULLANILAMIYOR","REPLAY":"YEN\u0130DEN OYNAT","BACK_TO_SINGLEPLAY":"TEKL\u0130 OYUNA D\xd6N","LOADING":"Y\xdcKLEN\u0130YOR\u2026","VS":"VS","NO_ADS_TO_DISPLAY":"G\xd6R\xdcNT\xdcLENECEK REKLAM YOK","WATCH_A_VIDEO":"\xdcCRETS\u0130Z B\u0130R\u0130M ALMAK \u0130\xc7\u0130N V\u0130DEO \u0130ZLE!","LOADING_ADS":"REKLAM Y\xdcKLEN\u0130YOR...","SORRY_NO_REWARDS":"\xdczg\xfcn\xfcm, \xd6d\xfcl Yok!\\n Reklam\u0131 iptal ettin!","DISPLAY_ADS_FAILED":"Reklam G\xf6r\xfcnt\xfclenemedi","UNABLE_TO_DISPLAY_ADS":"Reklam g\xf6sterilemiyor. \\nL\xfctfen daha sonra tekrar dene.","LEADERBOARD_IS_EMPTY":"Lider tablosu bo\u015f!","NO_MATCHES_AVAILABLE":"E\u015fle\u015fme yok","GET_NOW":"AL","GET":"\u015e\u0130MD\u0130 AL","RESET_DATA":"Veriyi s\u0131f\u0131rla","RESET_DESC":"Bu, verilerinizi s\u0131f\u0131rlayacak ve\\n t\xfcm ilerlemenizi\\n kaybedeceksiniz. Devam etmek\\n istedi\u011fine emin misin?","YES":"EVET","NO":"HAYIR","START_OVER_TITLE":"Tamamland\u0131","START_OVER_DESC":"Ba\u015ftan ba\u015flayaca\u011f\u0131ndan emin\\n misin?"},"Texture":{"EMPTY":"EMPTY"}}'),fr:JSON.parse('{"Text":{"START_FIGHT":"COMBATTRE","COLLECT":"RECEVOIR","SETTINGS":"PARAM\xc8TRES","SOUND_FX":"EFFETS AUDIO","MUSIC":"MUSIQUE","VIBRATION":"VIBRATIONS","QUICK_FIGHT":"COMBAT RAPIDE","SPEED":"VITESSE","LEADERBOARD":"CLASSEMENT","RANK":"PLACE","PHOTO":"PHOTO","NAME":"NOM","LEVEL":"NIVEAU","CHARACTER_LIST":"LISTE DES UNIT\xc9S","DINOSAURS":"DINOSAURES","WARRIORS":"GUERRIERS","BUY":"ACHETER","FREE":"GRATUIT","LOCKED":"VERROUILL\xc9","BATTLE":"COMBATS","FRIENDS":"AMIS","REVENGE":"VENGEANCES","RANKING":"CLASSEMENT","HISTORY":"HISTORIQUE","CHALLENGE_FRIENDS":"D\xc9FIER DES AMIS","GLOBAL":"MONDIAL","WIN":"VICTOIRE","LOSE":"D\xc9FAITE","FULL":"PLEIN","NEW_CHARACTER":"NOUVELLE UNIT\xc9","SHARE":"PARTAGER","SHARE_CAPITAL":"PARTAGER","VICTORY":"VICTOIRE","YOU_EARNED":"VOUS AVEZ GAGN\xc9","LEVEL_COMPLETED_BONUS_X":"BONUS DE NIVEAU TERMIN\xc9 x","SPIN":"LANCER","CLAIM":"RECEVOIR","CONTINUE":"CONTINUER","FAILED":"\xc9CHEC","OFFLINE_COINS_REWARDS":"R\xc9COMPENSE HORS LIGNE","X2_COINS":"PI\xc8CES X2","UNAVAILABLE":"INDISPONIBLE","REPLAY":"RECOMMENCER","BACK_TO_SINGLEPLAY":"REVENIR EN MODE SOLO","LOADING":"CHARGEMENT...","VS":"VS","NO_ADS_TO_DISPLAY":"AUCUNE PUB DISPONIBLE","WATCH_A_VIDEO":"REGARDEZ UNE VID\xc9O ET RECEVEZ UNE UNIT\xc9 GRATUITEMENT !","LOADING_ADS":"CHARGEMENT DES PUBS...","SORRY_NO_REWARDS":"Vous avez interrompu la\\n pub ! Aucune r\xe9compense !","DISPLAY_ADS_FAILED":"\xc9chec de l\'affichage des pubs","UNABLE_TO_DISPLAY_ADS":"Erreur lors de l\'affichage des\\n publicit\xe9s. R\xe9essayez\\n ult\xe9rieurement.","LEADERBOARD_IS_EMPTY":"Le tableau des leaders est vide !","NO_MATCHES_AVAILABLE":"Aucune correspondance disponible","GET_NOW":"OBTENIR","GET":"OBTENIR","RESET_DATA":"R\xe9initialiser","RESET_DESC":"Cela r\xe9initialisera vos donn\xe9es\\n et vous perdrez toute\\n progression. Es-tu sur de\\n vouloir continuer?","YES":"OUI","NO":"NON","START_OVER_TITLE":"Termin\xe9","START_OVER_DESC":"Voulez-vous vraiment\\n recommencer ?"},"Texture":{"EMPTY":"EMPTY"}}'),id:JSON.parse('{"Text":{"START_FIGHT":"MULAI TARUNG","COLLECT":"KUMPUL","SETTINGS":"PENGATURAN","SOUND_FX":"EFEK SUARA","MUSIC":"MUSIK","VIBRATION":"GETARAN","QUICK_FIGHT":"TARUNG CEPAT","SPEED":"KECEP","LEADERBOARD":"PAPAN PERINGKAT","RANK":"RANK","PHOTO":"FOTO","NAME":"NAMA","LEVEL":"LEVEL","CHARACTER_LIST":"DAFTAR KARAKTER","DINOSAURS":"DINOSAURUS","WARRIORS":"PEJUANG","BUY":"BELI","FREE":"GRATIS","LOCKED":"TERKUNCI","BATTLE":"PERTEMPURAN","FRIENDS":"TEMAN","REVENGE":"PEMBALASAN","RANKING":"PERINGKAT","HISTORY":"RIWAYAT","CHALLENGE_FRIENDS":"TANTANG TEMAN","GLOBAL":"GLOBAL","WIN":"MENANG","LOSE":"KALAH","FULL":"PENUH","NEW_CHARACTER":"KARAKTER BARU","SHARE":"BAGIKAN","SHARE_CAPITAL":"BAGIKAN","VICTORY":"KEMENANGAN","YOU_EARNED":"KAMU MENDAPAT","LEVEL_COMPLETED_BONUS_X":"BONUS LEVEL SELESAI x","SPIN":"PUTAR","CLAIM":"KLAIM","CONTINUE":"LANJUT","FAILED":"GAGAL","OFFLINE_COINS_REWARDS":"HADIAH KOIN OFFLINE","X2_COINS":"X2 KOIN","UNAVAILABLE":"TIDAK TERSEDIA","REPLAY":"ULANGI PERMAINAN","BACK_TO_SINGLEPLAY":"KEMBALI KE MAIN TUNGGAL","LOADING":"MEMUAT...","VS":"VS","NO_ADS_TO_DISPLAY":"TIDAK ADA IKLAN UNTUK DITONTON","WATCH_A_VIDEO":"TONTON VIDEO UNTUK MENDAPAT UNIT GRATIS!","LOADING_ADS":"MEMUAT IKLAN...","SORRY_NO_REWARDS":"Maaf, Tak Ada Hadiah!\\n Kamu membatalkan iklan!","DISPLAY_ADS_FAILED":"Tonton Iklan Gagal","UNABLE_TO_DISPLAY_ADS":"Tidak bisa menonton iklan. \\nSilakan coba lagi nanti.","LEADERBOARD_IS_EMPTY":"Papan peringkat kosong!","NO_MATCHES_AVAILABLE":"Tidak ada pertandingan tersedia","GET_NOW":"AMBIL","GET":"AMBIL","RESET_DATA":"Setel ulang data","RESET_DESC":"Ini akan mengatur ulang data Anda\\n dan Anda akan kehilangan semua\\n kemajuan. Apakah anda yakin ingin\\n melanjutkan?","YES":"YA","NO":"TIDAK","START_OVER_TITLE":"Selesai","START_OVER_DESC":"Yakin ingin memulai dari\\n awal?"},"Texture":{"EMPTY":"EMPTY"}}'),de:JSON.parse('{"Text":{"START_FIGHT":"KAMPFBEGINN","COLLECT":"SAMMELN","SETTINGS":"EINSTELLUNGEN","SOUND_FX":"SOUND","MUSIC":"MUSIK","VIBRATION":"VIBRATION","QUICK_FIGHT":"SCHNELLER KAMPF","SPEED":"GESCH","LEADERBOARD":"BESTENLISTE","RANK":"RANG","PHOTO":"FOTO","NAME":"NAME","LEVEL":"LEVEL","CHARACTER_LIST":"CHARAKTERLISTE","DINOSAURS":"DINOSAURIER","WARRIORS":"KRIEGER","BUY":"KAUFEN","FREE":"KOSTENLOS","LOCKED":"GESPERRT","BATTLE":"KAMPF","FRIENDS":"FREUNDE","REVENGE":"RACHE","RANKING":"RANGLISTE","HISTORY":"VERLAUF","CHALLENGE_FRIENDS":"FREUNDE HERAUSFORDERN","GLOBAL":"GLOBAL","WIN":"SIEG","LOSE":"NIEDERLAGE","FULL":"VOLL","NEW_CHARACTER":"NEUER CHARAKTER","SHARE":"TEILEN","SHARE_CAPITAL":"TEILEN","VICTORY":"SIEG","YOU_EARNED":"VERDIENT","LEVEL_COMPLETED_BONUS_X":"LEVELABSCHLUSS-BONUS x","SPIN":"DREHEN","CLAIM":"EINFORDERN","CONTINUE":"WEITER","FAILED":"GESCHEITERT","OFFLINE_COINS_REWARDS":"OFFLINE-BELOHNUNGEN","X2_COINS":"X2 M\xdcNZEN","UNAVAILABLE":"NICHT VERF\xdcGBAR","REPLAY":"WIEDERHOLEN","BACK_TO_SINGLEPLAY":"ZUR\xdcCK ZUM EINZELSPIELER","LOADING":"L\xc4DT \u2026","VS":"VS","NO_ADS_TO_DISPLAY":"KEINE ANZEIGEN VERF\xdcGBAR","WATCH_A_VIDEO":"VIDEO ANSCHAUEN, UM\\n KOSTENLOSE EINHEIT ZU\\n ERHALTEN!","LOADING_ADS":"ANZEIGEN WERDEN GELADEN \u2026","SORRY_NO_REWARDS":"Leider keine Belohnungen!\\n Du hast die Anzeige\\n abgebrochen!","DISPLAY_ADS_FAILED":"Abspielen von Anzeigen\\n gescheitert","UNABLE_TO_DISPLAY_ADS":"Anzeigen k\xf6nnen nicht\\n abgespielt werden. Bitte\\n versuche es sp\xe4ter noch einmal.","LEADERBOARD_IS_EMPTY":"Die Bestenliste ist leer!","NO_MATCHES_AVAILABLE":"Keine Spiele verf\xfcgbar","GET_NOW":"BEKOMMEN","GET":"BEKOMMEN","RESET_DATA":"Zur\xfccksetzen","RESET_DESC":"Dadurch werden Ihre Daten\\n zur\xfcckgesetzt und Sie verlieren\\n jeglichen Fortschritt. Bist du dir\\n sicher, dass du weitermachen\\n willst?","YES":"JA","NO":"NEIN","START_OVER_TITLE":"Abgeschlossen","START_OVER_DESC":"Willst du neu starten?"},"Texture":{"EMPTY":"EMPTY"}}'),it:JSON.parse('{"Text":{"START_FIGHT":"INIZIA IL DUELLO","COLLECT":"RACCOGLI","SETTINGS":"IMPOSTAZIONI","SOUND_FX":"SOUND FX","MUSIC":"MUSICA","VIBRATION":"VIBRAZIONE","QUICK_FIGHT":"LOTTA VELOCE","SPEED":"VELOC","LEADERBOARD":"CLASSIFICA","RANK":"RANGO","PHOTO":"FOTO","NAME":"NOME","LEVEL":"LIVELLO","CHARACTER_LIST":"ELENCO PERSONAGGI","DINOSAURS":"DINOSAURI","WARRIORS":"GUERRIERI","BUY":"ACQUISTA","FREE":"LIBERA","LOCKED":"BLOCCATO","BATTLE":"BATTAGLIA","FRIENDS":"AMICI","REVENGE":"VENDETTA","RANKING":"CLASSIFICA","HISTORY":"CRONOLOGIA","CHALLENGE_FRIENDS":"SFIDA I TUOI AMICI","GLOBAL":"GLOBALE","WIN":"VITTORIA","LOSE":"SCONFITTA","FULL":"COMPLETATO","NEW_CHARACTER":"NUOVO PERSONAGGIO","SHARE":"CONDIVIDI","SHARE_CAPITAL":"CONDIVIDI","VICTORY":"VITTORIA","YOU_EARNED":"HAI GUADAGNATO","LEVEL_COMPLETED_BONUS_X":"LIVELLO COMPLETATO BONUS x","SPIN":"RUOTA","CLAIM":"RIVENDICA","CONTINUE":"CONTINUA","FAILED":"FALLITO","OFFLINE_COINS_REWARDS":"RICOMPENSE OFFLINE","X2_COINS":"X2 MONETE","UNAVAILABLE":"NON DISPONIBILE","REPLAY":"GIOCA ANCORA","BACK_TO_SINGLEPLAY":"TORNA AL GIOCATORE SINGOLO","LOADING":"CARICAMENTO\u2026","VS":"VS","NO_ADS_TO_DISPLAY":"NESSUN ANNUNCIO DA\\n VISUALIZZARE","WATCH_A_VIDEO":"GUARDA UN VIDEO PER\\n OTTENERE UN\'UNIT\xc0 GRATUITA!","LOADING_ADS":"CARICAMENTO ANNUNCI...","SORRY_NO_REWARDS":"Spiacente, nessuna ricompensa!\\n Hai cancellato l\'annuncio!","DISPLAY_ADS_FAILED":"Visualizzazione annunci non\\n riuscita","UNABLE_TO_DISPLAY_ADS":"Impossibile visualizzare gli\\n annunci. Riprova pi\xf9 tardi.","LEADERBOARD_IS_EMPTY":"La classifica \xe8 vuota!","NO_MATCHES_AVAILABLE":"Nessuna partita disponibile","GET_NOW":"OTTIENI","GET":"OTTIENI","RESET_DATA":"Reimposta i dati","RESET_DESC":"Questo ripristiner\xe0 i tuoi dati\\n e perderai tutti i progressi. Sei\\n sicuro di voler continuare?","YES":"S\xcc","NO":"NO","START_OVER_TITLE":"Completato","START_OVER_DESC":"Sei sicuro di voler\\n ricominciare da capo?"},"Texture":{"EMPTY":"EMPTY"}}')},sa=function(e){function t(){return e.apply(this,arguments)||this}return(0,o.Z)(t,e),t.prototype.configure=function(t){e.prototype.configure.call(this,(0,s.Z)({data:aa,locale:"en",upperCaseText:!1},t))},t}(ia),ra=sa,oa=n(127),ca=[pe._.SCREEN_OPEN],la=(function(e){function t(t,n){var i;(i=e.call(this,"GoogleAnalytics",(0,s.Z)({},n),"#E35335")||this).game=void 0,i.trackingId=void 0,i.currentPath="/";var a=n.trackingId;i.game=t;var r=(GameCore.Configs.Analytics.GoogleAnalytics||{}).consoleLog;return i.selfLog=!!r,i.trackingId=a,i}(0,o.Z)(t,e);var n=t.prototype;n.processEvent=function(e,t,n){if(!(Ln()(ca).call(ca,e)>=0)){var i=this.formatEventName(e),a=t?(0,s.Z)({},t):{};a=n?(0,s.Z)({},a,{value:n}):a,a=(0,s.Z)({},a,{page_path:this.currentPath,send_to:"GA"}),gtag("event",i,a)}},n.processLevelStart=function(e,t){this.processEvent(pe._.LEVEL_START,{level:e,level_name:"level_"+e,game_mode:t})},n.processLevelRescue=function(e,t){this.processEvent(pe._.LEVEL_RESCUE,{level:e,level_name:"level_"+e,game_mode:t})},n.processLevelFail=function(e,t,n){this.processEvent(pe._.LEVEL_END,{success:!1,level:e,level_name:"level_"+e,game_mode:t,played_time:n})},n.processLevelComplete=function(e,t,n){this.processEvent(pe._.LEVEL_END,{success:!0,level:e,level_name:"level_"+e,game_mode:t,played_time:n})},n.processShowInterstitialAd=function(e){this.processEvent(pe._.AD_SHOW,{ad_type:"interstitial",screen_name:""+e}),this.processEvent(pe._.AD_IMPRESSION,{ad_format:"Interstitial"})},n.processShowRewardedVideoAd=function(e){this.processEvent(pe._.AD_SHOW,{ad_type:"rewarded_video",screen_name:""+e}),this.processEvent(pe._.AD_IMPRESSION,{ad_format:"Rewarded"})},n.processShowAdFail=function(e,t){var n=e===GameCore.Ads.Types.REWARDED?"rewarded_video":"interstitial";this.processEvent(pe._.AD_SHOW_FAILED,{ad_type:n,screen_name:""+t})},n.processPageView=function(e){var t=this.getGameplayMode(),n="/"+t+"/"+e;this.currentPath=n,document.title=this.formatPageTitle(t,e),gtag("event","page_view",{page_path:this.currentPath,send_to:["GA",this.trackingId]})},n.getGameplayMode=function(){var e=this.game.storage.getState();return(0,oa.FB)(e)},n.formatEventName=function(e){return e.toLowerCase().replace(/:/g,"_")},n.formatPageTitle=function(e,t){return this.toUpperCamelCaseWithSpace(e)+"::"+this.toUpperCamelCaseWithSpace(t)},n.toUpperCamelCaseWithSpace=function(e){var t=e.replace(/[-_\s.]+(.)?/g,(function(e,t){return t?" "+t.toUpperCase():""}));return t.substr(0,1).toUpperCase()+t.substr(1)}}(GameCore.Analytics.BaseAnalytics),GameCore.Configs.Gameplay.CheaterIds),ua=function(e){function t(){for(var t,n,a=arguments.length,s=new Array(a),o=0;o<a;o++)s[o]=arguments[o];return(n=e.call.apply(e,E()(t=[this]).call(t,s))||this).startGame=(0,r.Z)(l().mark((function e(){var t,a;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.auth.requestToken();case 3:return e.next=5,n.storage.syncStore();case 5:return t=n.player.getPlayer(),a=t.playerId,window.clientInformation||(window.clientInformation={}),ae()(la).call(la,a)&&(window.clientInformation.playerIsCheater=!0),n.configureRollbar(),e.next=11,n.detectGameMode();case 11:n.initAnalytics(),n.analytics.event(pe._.LOAD_START),n.scene.launch(re.C.GLOBAL_SCENE),n.scene.start(re.C.LOAD_SCENE),n.analytics.pageview(re.C.LOAD_SCENE),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(0),(0,i.tO)(e.t0);case 21:return e.prev=21,n.facebook.progressLoading.finishLoadingProgressFbBootScene(),n.scene.sleep(re.C.BOOT_SCENE),e.finish(21);case 25:case"end":return e.stop()}}),e,null,[[0,18,21,25]])}))),n}(0,o.Z)(t,e);var n=t.prototype;return n.create=function(){this.facebook.progressLoading.loadingProgressFbBootScene(),this.startGame()},n.configureRollbar=function(){if(this.rollbar){var e=this.player.getPlayer();this.rollbar.configure({payload:{person:{id:e.playerId,name:e.name}}})}},n.detectGameMode=function(){var e=(0,r.Z)(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.storage.dispatch((0,Qi.qF)());case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.initAnalytics=function(){},t}(Phaser.Scene),ha=ua,da=n(68),pa=n(472),fa=n(69),ga=n.n(fa),Ea=GameCore.Configs.Notification.ApiUrl,ma=function(){var e=(0,r.Z)(l().mark((function e(t){var n,i;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.playerId,e.next=3,(0,nt.v)("players/"+n,t,{},Ea,10);case 3:return i=e.sent,e.abrupt("return",(null==i?void 0:i.data)||{});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),va=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="LoadResourceFail",i.message=t||"Load resource fail",i.payload=n,i}return(0,o.Z)(t,e),t}((0,R.Z)(Error)),Aa=n(34),Sa=n(2),Ta=n(471),ya=n(470),Ca=n(17),Ia=Ca.Z.MELEE_UNIT_TYPE,Ra=Ca.Z.RANGED_UNIT_TYPE,wa=Ca.Z.ALIEN_UNIT_TYPE,_a=Sa.Z.UNITS_SPINES,ba=ye.Z.PLAYER_UNIT_DATA,La=ye.Z.LEVEL_PROGRESS,Pa=GameCore.Configs,Oa=(Pa.Notification,Pa.UnitsConfig),Da=GameCore.Configs.Gameplay,ka=Da.MaximumMeleeLevel,Na=Da.MaximumRangedLevel,Ba=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=e.call.apply(e,E()(t=[this]).call(t,a))||this).requestingSpines=[],n.requestingSprites=[],n.isLazyLoadRequesting=void 0,n.handleFBInstantGameStarted=function(){window.__fbGameReady=!0,n.updateBackgroundElement(),n.player.updateData().then(n.processAfterUpdatePlayerProfile).catch((function(e){n.rollbar.sendException(e)})),n.ads.preloadRewardedVideoAsync().catch((function(){})),n.player.requestConnectedPlayers(),setTimeout(n.subscribebot,800)},n.processAfterUpdatePlayerProfile=function(){},n.startGame=function(){n.analytics.event(pe._.APP_READY),n.storage.dispatch((0,ya.I)(re.C.LOAD_SCENE)),n.storage.dispatch((0,Ta.ZC)())},n.subscribebot=function(){n.facebook.attemptToSubscribeBot()},n.handleLoadMusicCompleted=function(){n.audio.initMusic(k.BACKGROUND.KEY),n.audio.playMusic(),n.audio.setMusicVolume(.4,3e3)},n}(0,o.Z)(t,e);var n=t.prototype;return n.preload=function(){var e=this;this.facebook.progressLoading.loadingProgressFbLoadScene(),this.analytics.event(pe._.SCREEN_OPEN,{screen_name:"LoadScene"}),this.load.on("progress",(function(t){e.facebook.progressLoading.onProgress(t)})),this.load.on(Phaser.Loader.Events.FILE_LOAD_ERROR,(function(t){var n=new va("Load resources at LoadScene failed.");e.rollbar.sendException(n,{file:t})}));var t=this.getLevelJsonName();this.load.on("filecomplete-json-"+t,(function(){e.scene.wake(),e.loadEnemyUnits(t)})),this.load.json(t,"assets/json/"+t+".json"),this.loadDefaultUnits(),this.loadPlayerUnits(),this.load.json("unitData","assets/json/unit-data.json"),this.loadFonts(),this.textStyler.addFont({type:"local",fontType:"truetype",fontName:Aa.Z.FONT_FAMILY}),this.load.multiatlas({key:Sa.Z.DEFAULT_8_BIT.KEY,atlasURL:Sa.Z.DEFAULT_8_BIT.JSON,path:Sa.Z.DEFAULT_8_BIT.PATH}),this.load.atlas({key:Sa.Z.DEFAULT.KEY,atlasURL:Sa.Z.DEFAULT.JSON,textureURL:Sa.Z.DEFAULT.TEXTURE}),this.load.atlas({key:Sa.Z.GAMEPLAY.KEY,atlasURL:Sa.Z.GAMEPLAY.JSON,textureURL:Sa.Z.GAMEPLAY.TEXTURE}),this.loadBackgroundByCurrentLevel(),this.load.multiatlas({key:Sa.Z.EFFECTS.KEY,path:Sa.Z.EFFECTS.PATH,atlasURL:Sa.Z.EFFECTS.JSON}),this.load.spine(Sa.Z.SPINE_EFFECTS.FX_MERGE.KEY,Sa.Z.SPINE_EFFECTS.FX_MERGE.jsonPATH,Sa.Z.SPINE_EFFECTS.FX_MERGE.atlasPATH)},n.create=function(){this.audio.initSound(),this.analytics.event(pe._.LOAD_COMPLETE),this.facebook.on("startgame",this.handleFBInstantGameStarted),this.facebook.gameStarted(),this.setupGlobalScene(),this.startGame()},n.updatePlayerProfileToNotificationService=function(){try{var e=this.player.getPlayer(),t=e.playerId,n={name:e.name,photo:e.photo,locale:e.locale,playerId:t,ASID:e.ASID};console.info("\ud83d\ude80 > profileData",n),ma(n)}catch(i){this.rollbar.sendException(i)}},n.sendNotificationForNewUser=function(){try{if(!this.player.getPlayerIsNew())return;var e=this.player.getPlayerASID();if(!e)return;this.facebook.sendNotificationAsync({message:"Hi @["+e+"] your friends are waiting to play with you, play now!",delayTime:3600})}catch(t){this.rollbar.sendException(t)}},n.updateBackgroundElement=function(){if(this.world.isUsingLandscapeBackground()){var e=document.getElementById("background-image");if(e){var t=this.player.getCustomData(La);if("number"!==typeof t||t<0)e.src=se.Z.BG_LANDSCAPE_TREE.FILE;else{var n=se.Z.BG_LANDSCAPE_TREE.FILE;switch(Math.floor((t+1)/10)%5){case 0:n=se.Z.BG_LANDSCAPE_TREE.FILE;break;case 1:n=se.Z.BG_LANDSCAPE_DESERT.FILE;break;case 2:n=se.Z.BG_LANDSCAPE_ICE.FILE;break;case 3:n=se.Z.BG_LANDSCAPE_CRYSTAL.FILE;break;case 4:n=se.Z.BG_LANDSCAPE_VOLCANO.FILE}e.src=n}}}},n.setupGlobalScene=function(){var e=this.scene.get(re.C.GLOBAL_SCENE);e instanceof pa.Z&&e.setup()},n.loadBackgroundByCurrentLevel=function(){var e=this.player.getCustomData(La);if("number"!==typeof e||e<0)this.loadAllBackgrounds();else{var t=Math.floor((e+1)/10)%5;this.world.isUsingLandscapeBackground()?(this.loadBackgroundImage(se.Z.BG_LANDSCAPE_TREE.FILE,se.Z.BG_LANDSCAPE_TREE.KEY),1===t?this.loadBackgroundImage(se.Z.BG_LANDSCAPE_DESERT.FILE,se.Z.BG_LANDSCAPE_DESERT.KEY):2===t?this.loadBackgroundImage(se.Z.BG_LANDSCAPE_ICE.FILE,se.Z.BG_LANDSCAPE_ICE.KEY):3===t?this.loadBackgroundImage(se.Z.BG_LANDSCAPE_CRYSTAL.FILE,se.Z.BG_LANDSCAPE_CRYSTAL.KEY):4===t&&this.loadBackgroundImage(se.Z.BG_LANDSCAPE_VOLCANO.FILE,se.Z.BG_LANDSCAPE_VOLCANO.KEY)):(this.load.image(se.Z.BG_TREE.KEY,se.Z.BG_TREE.FILE),1===t?this.load.image(se.Z.BG_DESERT.KEY,se.Z.BG_DESERT.FILE):2===t?this.load.image(se.Z.BG_ICE.KEY,se.Z.BG_ICE.FILE):3===t?this.load.image(se.Z.BG_CRYSTAL.KEY,se.Z.BG_CRYSTAL.FILE):4===t&&this.load.image(se.Z.BG_VOLCANO.KEY,se.Z.BG_VOLCANO.FILE))}},n.loadFonts=function(){var e=this.lang.getCurrentLanguage();switch(e){case"tr":Aa.Z.PRIMARY={KEY:"BalooTr",TEXTURE:"./assets/fonts/BalooTr.png",DATA:"./assets/fonts/BalooTr.xml"},Aa.Z.FONT_FAMILY="BalooTr";break;case"id":Aa.Z.PRIMARY={KEY:"LilitaOne-en",TEXTURE:"./assets/fonts/LilitaOne-en.png",DATA:"./assets/fonts/LilitaOne-en.xml"};break;case"ja":Aa.Z.PRIMARY={KEY:"MPlusJa",TEXTURE:"./assets/fonts/MPlusJa.png",DATA:"./assets/fonts/MPlusJa.xml"},Aa.Z.FONT_FAMILY="MPlusJa";break;default:Aa.Z.PRIMARY={KEY:"LilitaOne-"+e,TEXTURE:"./assets/fonts/LilitaOne-"+e+".png",DATA:"./assets/fonts/LilitaOne-"+e+".xml"}}this.load.bitmapFont(Aa.Z.PRIMARY.KEY,Aa.Z.PRIMARY.TEXTURE,Aa.Z.PRIMARY.DATA)},n.getLevelJsonName=function(){var e=this.player.getCustomData(La),t=e||0,n=100*Math.floor(t/100)+1,i=n+99;return"levels-"+(1e4+n).toString().substring(1)+"-"+(1e4+i).toString().substring(1)},n.loadDefaultUnits=function(){var e=this.getBuyingUnitLevel(),t="m1-r1-m"+e+"-r"+e+"-0/0-0-0-0-0/0-0-0-0-0";this.loadUnits("spine",t)},n.getBuyingUnitLevel=function(){var e=this.player.getCustomData(La),t=GameCore.Utils.Valid.isNumber(e)?e+1:1,n=Ca.Z.BUYING_UNIT_LEVEL,i=1;return n.forEach((function(e,n){e<=t&&(i=n+1)})),i},n.loadPlayerUnits=function(){var e=this.player.getCustomData(ba);if(e&&"string"===typeof e){var t=this.upgradePlayerUnits(e);this.player.setCustomData(ba,t),this.loadUnits("spine",t)}else this.loadAllUnits()},n.upgradePlayerUnits=function(e){for(var t=this.getPlayerUnitList(e),n=this.getBuyingUnitLevel(),i=[],a=[],s=0;s<15;s++){var r=t[s],o=r[0];if("m"===o||"r"===o)parseInt(r.substring(1))>=n||("m"===o?i.push(s):a.push(s))}for(var c=0;c<i.length;c++)t[i[c]]="m"+(n-1),t[a[c]]="r"+(n-1);i.length%2===1&&(t[i[0]]="m"+n);a.length%2===1&&(t[a[0]]="r"+n);var l=this.handleCannotMergeCase(t);return this.serializePlayerUnitData(l)},n.handleCannotMergeCase=function(e){if(this.isBoardCanBeMerged(e))return e;for(var t=this.getBuyingUnitLevel(),n=Number.MAX_SAFE_INTEGER,i=-1,a=Number.MAX_SAFE_INTEGER,s=-1,r=Number.MAX_SAFE_INTEGER,o=-1,c=Number.MAX_SAFE_INTEGER,l=-1,u=0,h=0;h<e.length;h++){var d=e[h],p=d[0];if("m"===p||"r"===p){u++;var f=parseInt(d.substring(1));"m"===p?f<n?(a=n,s=i,n=f,i=h):f<a&&(a=f,s=h):f<r?(c=r,l=o,r=f,o=h):f<c&&(c=f,l=h)}}return 15===u&&t===n&&-1!==i&&-1!==s?e[i]=e[s]:15===u&&t===r&&-1!==o&&-1!==l&&(e[o]=e[l]),e},n.isBoardCanBeMerged=function(e){var t=new(B()),n=new(B());e.forEach((function(e){var i=e[0];if("m"===i||"r"===i){var a=parseInt(e.substring(1));switch(i){case Ia:var s=t.get(a);s?t.set(a,s+1):t.set(a,1);break;case Ra:var r=n.get(a);r?n.set(a,r+1):n.set(a,1)}}}));var i=ga()(t,(function(e){return{key:e[0],value:e[1]}})).some((function(e){var t=e.key;return e.value>1&&t+1<=ka})),a=ga()(n,(function(e){return{key:e[0],value:e[1]}})).some((function(e){var t=e.key;return e.value>1&&t+1<=Na}));return i||a},n.getPlayerUnitList=function(e){var t=e.split("/"),n=[];return t.forEach((function(e){e.split("-").forEach((function(e){n.push(e)}))})),n},n.serializePlayerUnitData=function(e){for(var t="",n=0,i=0;i<3;i++){for(var a="",s=0;s<5;s++)a+=e[n],n++,4!==s&&(a+="-");t+=a,2!==i&&(t+="/")}return t},n.loadEnemyUnits=function(e){var t=this.player.getCustomData(La),n="number"===typeof t?t:0,i=n-(100*Math.floor(n/100)+1)+1,a=this.cache.json.get(e).levels[i],s=a.enemy_row1+"/"+a.enemy_row2+"/"+a.enemy_row3;this.loadUnits("spine",s)},n.loadUnits=function(e,t){var n=this,i=t.split("/"),a=[];i.forEach((function(t){t.split("-").forEach((function(t){if("0"!==t&&!ae()(a).call(a,t)){var i=wa;if("m"===t[0]?i=Ia:"r"===t[0]&&(i=Ra),i!==wa){var s,r,o=parseInt(t.substring(1));if(i===Ia)if(ae()(s=Oa.MELEE.listLevelsUseSprite).call(s,o)){if("spine"===e)return}else if("sprite"===e)return;if(i===Ra)if(ae()(r=Oa.RANGED.listLevelsUseSprite).call(r,o)){if("spine"===e)return}else if("sprite"===e)return;a.push(t),n.loadUnit(e,o,i)}}}))}))},n.loadUnit=function(e,t,n){var i=_a.MELEE,a=_a.RANGED,s=null;switch(n){case Ia:t>0&&t<=Ve()(i).length&&(s=i[t]);break;case Ra:t>0&&t<=Ve()(a).length&&(s=a[t])}if(s){if("spine"===e){var r;if(ae()(r=this.requestingSpines).call(r,s.KEY))return;this.requestingSpines.push(s.KEY),this.load.spine(s.KEY,s.jsonPATH,s.atlasPATH),this.isLazyLoadRequesting=!0}if("sprite"===e){var o;if(this.textures.exists(s.KEY))return;if(ae()(o=this.requestingSprites).call(o,s.KEY))return;this.requestingSprites.push(s.KEY),console.log("load sprite unit",s.KEY),this.load.multiatlas({key:s.KEY,atlasURL:s.JSON,path:s.PATH}),this.isLazyLoadRequesting=!0}}},n.lazyLoadResource=function(){var e=this;this.isLazyLoadRequesting=!1,this.loadSounds(),this.loadAllUnits(),this.loadAvatarUnits(),this.loadAllBackgrounds(),this.isLazyLoadRequesting&&(this.scene.wake(),this.load.once(Phaser.Loader.Events.COMPLETE,(function(){e.scene.sleep()})),this.load.start())},n.showBannerAds=function(){var e=this;setTimeout((function(){e.ads.showBannerAdAsync()}),3e3)},n.loadSounds=function(){var e=Phaser.Loader.Events.FILE_KEY_COMPLETE;this.cache.audio.exists(k.BACKGROUND.KEY)||(this.load.once(e+"audio-"+k.BACKGROUND.KEY,this.handleLoadMusicCompleted),this.load.audio(k.BACKGROUND.KEY,k.BACKGROUND.FILE),this.isLazyLoadRequesting=!0)},n.loadAllUnits=function(){this.loadUnits("spine","m1-m2-m3-m4-m5/m6-m7-m8-m9-m10/m11-r1-r2-r3-r4-r5"),this.loadUnits("spine","r6-r7-r8-r9-r10/r11-0-0-0-0/0-0-0-0-0")},n.loadAvatarUnits=function(){this.textures.exists(Sa.Z.UNITS.KEY)||(this.load.multiatlas({key:Sa.Z.UNITS.KEY,atlasURL:Sa.Z.UNITS.JSON,path:Sa.Z.UNITS.PATH}),this.isLazyLoadRequesting=!0)},n.loadAllBackgrounds=function(){this.world.isUsingLandscapeBackground()?(this.textures.exists(se.Z.BG_LANDSCAPE_TREE.KEY)||(this.loadBackgroundImage(se.Z.BG_LANDSCAPE_TREE.FILE,se.Z.BG_LANDSCAPE_TREE.KEY),this.isLazyLoadRequesting=!0),this.textures.exists(se.Z.BG_LANDSCAPE_DESERT.KEY)||(this.loadBackgroundImage(se.Z.BG_LANDSCAPE_DESERT.FILE,se.Z.BG_LANDSCAPE_DESERT.KEY),this.isLazyLoadRequesting=!0),this.textures.exists(se.Z.BG_LANDSCAPE_ICE.KEY)||(this.loadBackgroundImage(se.Z.BG_LANDSCAPE_ICE.FILE,se.Z.BG_LANDSCAPE_ICE.KEY),this.isLazyLoadRequesting=!0),this.textures.exists(se.Z.BG_LANDSCAPE_VOLCANO.KEY)||(this.loadBackgroundImage(se.Z.BG_LANDSCAPE_VOLCANO.FILE,se.Z.BG_LANDSCAPE_VOLCANO.KEY),this.isLazyLoadRequesting=!0),this.textures.exists(se.Z.BG_LANDSCAPE_CRYSTAL.KEY)||(this.loadBackgroundImage(se.Z.BG_LANDSCAPE_CRYSTAL.FILE,se.Z.BG_LANDSCAPE_CRYSTAL.KEY),this.isLazyLoadRequesting=!0)):(this.textures.exists(se.Z.BG_TREE.KEY)||(this.load.image(se.Z.BG_TREE.KEY,se.Z.BG_TREE.FILE),this.isLazyLoadRequesting=!0),this.textures.exists(se.Z.BG_DESERT.KEY)||(this.load.image(se.Z.BG_DESERT.KEY,se.Z.BG_DESERT.FILE),this.isLazyLoadRequesting=!0),this.textures.exists(se.Z.BG_ICE.KEY)||(this.load.image(se.Z.BG_ICE.KEY,se.Z.BG_ICE.FILE),this.isLazyLoadRequesting=!0),this.textures.exists(se.Z.BG_VOLCANO.KEY)||(this.load.image(se.Z.BG_VOLCANO.KEY,se.Z.BG_VOLCANO.FILE),this.isLazyLoadRequesting=!0),this.textures.exists(se.Z.BG_CRYSTAL.KEY)||(this.load.image(se.Z.BG_CRYSTAL.KEY,se.Z.BG_CRYSTAL.FILE),this.isLazyLoadRequesting=!0))},n.loadBackgroundImage=function(){var e=(0,r.Z)(l().mark((function e(t,n){var i=this;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new(kt())((function(e,a){var s=new Image;s.crossOrigin="use-credentials",s.onload=function(){i.load.image(n,t),e()},s.onerror=function(){console.error("Load image failed",t),a()},s.src=t})));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),t}(Phaser.Scene),Ma=Ba,xa=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=e.call.apply(e,E()(t=[this]).call(t,a))||this).isVisible=!0,n.browserPrefixes=["moz","ms","o","","webkit"],n.visibleCallbacks=[],n.hiddenCallbacks=[],n.handleVisibilityChange=function(e){if("boolean"===typeof e)return e?n.onVisibleEvent():n.onHiddenEvent();var t=n.getBrowserPrefix(),i=n.getHiddenPropertyName(t);return document[i]?n.onHiddenEvent():n.onVisibleEvent()},n}(0,o.Z)(t,e);var n=t.prototype;return n.configure=function(){var e=this,t=this.getBrowserPrefix(),n=this.getVisibilityEvent(t);document.addEventListener(n,this.handleVisibilityChange,!1),document.addEventListener("focus",(function(){e.handleVisibilityChange(!0)}),!1),document.addEventListener("blur",(function(){e.handleVisibilityChange(!1)}),!1),window.addEventListener("focus",(function(){e.handleVisibilityChange(!0)}),!1),window.addEventListener("blur",(function(){e.handleVisibilityChange(!1)}),!1)},n.addEventVisible=function(e){this.visibleCallbacks.push(e)},n.addEventHidden=function(e){this.hiddenCallbacks.push(e)},n.isGameVisible=function(){return this.isVisible},n.getHiddenPropertyName=function(e){return e?e+"Hidden":"hidden"},n.getVisibilityEvent=function(e){return(e||"")+"visibilitychange"},n.getBrowserPrefix=function(){for(var e=0;e<this.browserPrefixes.length;e++)if(this.getHiddenPropertyName(this.browserPrefixes[e])in document)return this.browserPrefixes[e];return""},n.onVisibleEvent=function(){this.isVisible||(this.isVisible=!0,console.log("visible"),this.visibleCallbacks.forEach((function(e){e()})))},n.onHiddenEvent=function(){this.isVisible&&(this.isVisible=!1,console.log("hidden"),this.hiddenCallbacks.forEach((function(e){e()})))},t}(Phaser.Plugins.BasePlugin),Ua=xa,Fa=n(666),Za=["Enable"],Ga=function(e){function t(t){return e.call(this,t)||this}(0,o.Z)(t,e);var i=t.prototype;return i.boot=function(){var t=(0,r.Z)(l().mark((function t(){return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.prototype.boot.call(this),this.addExtraGameObjectMethods(),this.addExtraFBInstantFunctions(),this.addPlugins(),t.next=6,this.addDevPlugins();case 6:return t.next=8,this.initAdsAsync();case 8:this.addScenes(),this.addDevScenes(),this.initWorld(),this.initStorage(),this.initLanguage(),this.initVisibilityChangeHandler(),this.initUtils(),this.initRollbar(),this.initConsole(),this.initStatistics(),this.initLevelBuilder(),this.initProfilerPlugin(),this.initAdaptivePerformance(),this.handleShowInterAdWhenStartGame(),this.handleShowBackgroundElement();case 23:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),i.start=function(){e.prototype.start.call(this)},i.addExtraGameObjectMethods=function(){var e=new f(this);e.addKillRevive(),e.addKillReviveGroup(),e.addDrawDebugBox(),e.addSetWorldSize(),e.addSetWorldSizeForContainer(),e.addGetWorldPosition(),e.addHighQuality()},i.addExtraFBInstantFunctions=function(){var e=new u.Z(this.facebook);this.facebook.getLocale=e.getLocale,this.facebook.shareAsync=e.shareAsync,this.facebook.inviteAsync=e.inviteAsync,this.facebook.switchAsync=e.switchAsync,this.facebook.chooseAsync=e.chooseAsync,this.facebook.createAsync=e.createAsync,this.facebook.sendMessage=e.sendMessage,this.facebook.isSupportAPI=e.isSupportAPI,this.facebook.getContextID=e.getContextID,this.facebook.getPlayerToken=e.getPlayerToken,this.facebook.matchPlayerAsync=e.matchPlayerAsync,this.facebook.getContextPlayers=e.getContextPlayers,this.facebook.setLoadingProgress=e.setLoadingProgress,this.facebook.attemptToAddShortcut=e.attemptToAddShortcut,this.facebook.attemptToSubscribeBot=e.attemptToSubscribeBot,this.facebook.postSessionScoreAsync=e.postSessionScoreAsync,this.facebook.getRewardedVideoAsync=e.getRewardedVideoAsync,this.facebook.sendNotificationAsync=e.sendNotificationAsync,this.facebook.getInterstitialAdAsync=e.getInterstitialAdAsync,e.injectTournament(),this.facebook.progressLoading=new p(this)},i.addPlugins=function(){this.plugins.install("Storage",Zi,!0,"storage"),this.plugins.install("Rollbar",Fn,!0,"rollbar"),this.plugins.install("AdsManager",L,!0,"ads"),this.plugins.install("AuthManager",ee,!0,"auth"),this.plugins.install("CoinManager",Ot,!0,"coin"),this.plugins.install("AudioManager",H,!0,"audio"),this.plugins.install("WorldManager",zi,!0,"world"),this.plugins.install("BattleManager",gt,!0,"battle"),this.plugins.install("PlayerManager",fn,!0,"player"),this.plugins.install("LanguageManager",ra,!0,"lang"),this.plugins.install("ProfileManager",Rn,!0,"profile"),this.plugins.install("AnalyticsManager",D,!0,"analytics"),this.plugins.install("AdaptivePerformance",Gt,!0,"performance"),this.plugins.install("VisibilityChangeHandler",Ua,!0,"visibility"),this.plugins.installScenePlugin("textStyler",Wi,"textStyler"),this.plugins.installScenePlugin("ScreenManager",Wn,"screen"),this.plugins.installScenePlugin("FrameCapture",Mt,"frameCapture"),window.SpinePlugin&&this.plugins.installScenePlugin("SpinePlugin",SpinePlugin,"spine"),this.storage=this.plugins.get("Storage"),this.rollbar=this.plugins.get("Rollbar"),this.ads=this.plugins.get("AdsManager"),this.auth=this.plugins.get("AuthManager"),this.audio=this.plugins.get("AudioManager"),this.world=this.plugins.get("WorldManager"),this.battle=this.plugins.get("BattleManager"),this.player=this.plugins.get("PlayerManager"),this.lang=this.plugins.get("LanguageManager"),this.profile=this.plugins.get("ProfileManager"),this.analytics=this.plugins.get("AnalyticsManager"),this.performance=this.plugins.get("AdaptivePerformance"),this.visibility=this.plugins.get("VisibilityChangeHandler")},i.addDevPlugins=function(){var e=(0,r.Z)(l().mark((function e(){var t,i,a,s;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(GameCore.Utils.Valid.isDebugger()){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Promise.all([n.e(7),n.e(942)]).then(n.bind(n,667));case 4:return t=e.sent.default,e.next=7,n.e(401).then(n.bind(n,668));case 7:return i=e.sent.default,e.next=10,Promise.all([n.e(498),n.e(123)]).then(n.bind(n,669));case 10:return a=e.sent.default,e.next=13,Promise.all([n.e(498),n.e(953)]).then(n.bind(n,670));case 13:s=e.sent.default,this.plugins.install("Console",t,!0,"console"),this.plugins.install("Statistics",i,!0,"statistics"),this.plugins.install("Profiler",a,!0,"profiler"),this.plugins.install("LevelBuilder",s,!0,"level-builder"),this.eruda=this.plugins.get("Console"),this.profiler=this.plugins.get("Profiler"),this.statistics=this.plugins.get("Statistics"),this.profiler=this.plugins.get("Profiler"),this.levelBuilder=this.plugins.get("LevelBuilder");case 23:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),i.addScenes=function(){this.scene.add(re.C.BOOT_SCENE,ha,!0),this.scene.add(re.C.LOAD_SCENE,Ma,!1),this.scene.add(re.C.GAME_SCENE,da.Z,!1),this.scene.add(re.C.GLOBAL_SCENE,pa.Z,!1)},i.addDevScenes=function(){var e=(0,r.Z)(l().mark((function e(){var t,i,a;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(GameCore.Utils.Valid.isDebugger()){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,n.e(389).then(n.bind(n,671));case 4:return t=e.sent.default,e.next=7,n.e(713).then(n.bind(n,672));case 7:return i=e.sent.default,e.next=10,n.e(733).then(n.bind(n,673));case 10:a=e.sent.default,this.scene.add(re.C.TEST_SCENE,t,!1),this.scene.add(re.C.ANIMATIONS_SCENE,i,!1),this.scene.add(re.C.LEVEL_BUILDER_SCENE,a,!1);case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),i.initAdsAsync=function(){var e=(0,r.Z)(l().mark((function e(){var t,i,a,r;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=GameCore.Configs.Ads,Fa.Z.setGame(this),i=Fa.Z,!t.Mockup.Enable){e.next=8;break}return e.next=6,n.e(131).then(n.bind(n,674));case 6:a=e.sent.default,i=a;case 8:(r=(0,s.Z)({},t.InterstitialAdOptions)).showWhenStartGame&&(r.secondsFirstTime=0),this.ads.configure(i,{enabled:t.Enabled,calculateSafeAreaBottom:t.CalculateSafeAreaBottom,enableRewardVideoResetInterstitial:t.EnableRewardVideoResetInterstitial,interstitialAdOptions:r,rewardAdOptions:t.RewardAdOptions,bannerAdOptions:t.BannerAdOptions});case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),i.initWorld=function(){var e=GameCore.Configs.Game,t=e.AutoResize,n=e.PortraitRatio,i=e.PortraitWidth,a=e.PortraitHeight,s=e.LandscapeRatio,r=e.LandscapeWidth,o=e.LandscapeHeight,c=t,l=e.DisableLandscape,u=e.FullSizeOnLandscape,h=n,d=i,p=a,f=s,g=r,E=o;console.info("\ud83d\ude80 > portraitRatio",h),console.info("\ud83d\ude80 > landscapeRatio",f),this.world.configure({autoResize:c,portraitRatio:h,portraitWidth:d,portraitHeight:p,landscapeRatio:f,landscapeWidth:g,landscapeHeight:E,disableLandscape:l,fullSizeOnLandscape:u}),this.world.resize(e.ForcePixelRatio)},i.initStorage=function(){var e=new na(this);this.storage.setInitiator(e)},i.initLanguage=function(){var e=this.facebook.getLocale();this.lang.configure({locale:e,upperCaseText:!0})},i.initVisibilityChangeHandler=function(){this.visibility.configure()},i.initUtils=function(){this.handlePauseAudio(),this.removeUnusedPipelines(),(0,$i.bP)()},i.initConsole=function(){GameCore.Utils.Valid.isDebugger()&&(GameCore.Configs.Debugger.ShowConsole&&this.eruda.configure({tool:["console","info"],defaults:{theme:"Dark"}}))},i.initDebugger=function(){if(GameCore.Utils.Valid.isDebugger()){var e=GameCore.Configs.Debugger,t=e.ShowInspector,n=e.ShowMonitoring;(t||n)&&this.debugger&&this.debugger.configure(GameCore.Configs.Debugger)}},i.initStatistics=function(){GameCore.Utils.Valid.isDebugger()&&(GameCore.Configs.Statistics.Enable&&this.statistics&&this.statistics.configure(GameCore.Configs.Statistics))},i.initParticleEditor=function(){GameCore.Utils.Valid.isDebugger()&&(GameCore.Configs.ParticleEditor.Enable&&this.particleEditor&&this.particleEditor.configure(GameCore.Configs.ParticleEditor))},i.initLevelBuilder=function(){GameCore.Utils.Valid.isDebugger()&&(GameCore.Configs.LevelBuilder.Enable&&this.levelBuilder.configure(GameCore.Configs.LevelBuilder))},i.initProfilerPlugin=function(){GameCore.Utils.Valid.isDebugger()&&(GameCore.Configs.ProfilerPlugin.Enable&&this.profiler&&this.profiler.configure())},i.initAdaptivePerformance=function(){var e=GameCore.Configs.Performance,t=e.Enable,n=(0,a.Z)(e,Za);if(t){var i=this.world.getPixelRatio();this.performance.configure((0,s.Z)({pixelRatio:i},n)),this.performance.active()}},i.initRollbar=function(){var e=GameCore.Configs.Rollbar.Enable;console.warn({isRollbarEnabled:e}),e&&this.rollbar.setup()},i.handlePauseAudio=function(){var e=this;this.sound.pauseOnBlur=!1,this.visibility.addEventVisible((function(){e.audio.playMusic()})),this.visibility.addEventHidden((function(){e.audio.pauseMusic()}))},i.removeUnusedPipelines=function(){var e=this.renderer;if(e instanceof Phaser.Renderer.WebGL.WebGLRenderer){var t=e.pipelines,n=Phaser.Renderer.WebGL.Pipelines;if(n)[n.ROPE_PIPELINE,n.LIGHT_PIPELINE,n.POINTLIGHT_PIPELINE,n.BITMAPMASK_PIPELINE].forEach((function(e){var n;null==(n=t.get(e))||n.destroy(),t.remove(e)}))}},i.handleShowInterAdWhenStartGame=function(){var e=(0,r.Z)(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(GameCore.Configs.Ads.InterstitialAdOptions.showWhenStartGame){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,this.audio.muteAll(),e.next=7,this.ads.preloadInterstitialAdAsync();case 7:return e.next=9,this.ads.showInterstitialAdAsync();case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(3),console.info("\ud83d\ude80 > showInterstitialAdAsync",e.t0);case 14:return e.prev=14,this.audio.unmuteAll(),this.ads.preloadInterstitialAdAsync().catch((function(){})),e.finish(14);case 18:case"end":return e.stop()}}),e,this,[[3,11,14,18]])})));return function(){return e.apply(this,arguments)}}(),i.handleShowBackgroundElement=function(){if(this.world.isLandscape()){var e=document.getElementById("background");e&&(e.style.display="block");var t=document.getElementById("app");t&&t.classList.remove("has-background")}},t}(Phaser.Game),Ha=Ga,Ya=GameCore.Configs.Debugger.ShowInspector,Ka={parent:"app",type:Phaser.AUTO,width:0,height:0,scale:{autoRound:!0},dom:{createContainer:!1},loader:{maxParallelDownloads:6,crossOrigin:"no-cros"},audio:{noAudio:!1,disableWebAudio:!1},input:{gamepad:!1,keyboard:Ya,touch:{capture:!0},smoothFactor:1,activePointers:1,windowEvents:!1},disableContextMenu:!0,render:{pixelArt:!1,antialias:!0,antialiasGL:!0,transparent:!1,desynchronized:!1,powerPreference:"high-performance",clearBeforeRender:!1,roundPixels:!1},plugins:{global:[]}};(0,i.j6)();var Va=setInterval((function(){window.__analyticsInitiated&&(window.__fbGameReady=!1,clearInterval(Va),clearInterval(window.__fbInstantLoadingTimer),GameSDK.setLoadingProgress(30),gtag("event","app_initialize",{send_to:["GA"]}),function(){try{var e=new Ha(Ka);window.game=e}catch(t){(0,i.tO)(t)}}())}),50)},651:function(e,t,n){"use strict";n.d(t,{F:function(){return P}});var i=n(20),a=n(18),s=n.n(a),r=n(31),o=n.n(r),c=n(91),l=n.n(c),u=n(59),h=n.n(u),d=n(46),p=n.n(d),f=n(69),g=n.n(f),E=n(90),m=n.n(E),v=n(132),A=n.n(v),S=n(225),T=n(157),y=n(487),C=n(465),I=n(235);function R(e,t){var n="undefined"!==typeof m()&&A()(e)||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){var n;if(!e)return;if("string"===typeof e)return w(e,t);var i=p()(n=Object.prototype.toString.call(e)).call(n,8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return g()(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return w(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var _=GameCore.Configs.LeadersBoard,b=_.UseMock,L=_.Limit,P=function(e,t,n,a){return void 0===n&&(n=L),void 0===a&&(a=0),function(){var r=(0,i.Z)(s().mark((function i(r){var c,u,d,p,f,g,E,m,v,A,w,_,L,P,D,k,N,B;return s().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(i.prev=0,c=window.game.player,u=c.getPlayerId(),r(clearLeaderboardData()),r({type:C.Cc,payload:{leaderboardId:e,type:t,limit:n,offset:a}}),!b){i.next=12;break}return i.next=8,(0,S.qZ)(1e3);case 8:return 145,f=o()(d=l()(p=new Array(n)).call(p,null)).call(d,(function(e,t){var n=(t+1)*(a+1);return{playerId:145===t?u:"0"+n,name:145===t?"Current Player":"MPlayer "+n,photo:"./assets/images/others/avatar.png",rank:n,score:Math.floor(1e5/n)}})),r(O(f,t)),i.abrupt("return");case 12:if(g=[],t!==I.C){i.next=19;break}return i.next=16,(0,y.H$)({limit:n,offset:a});case 16:g=i.sent,i.next=27;break;case 19:if(t!==I.n){i.next=27;break}return(E=c.getConnectedPlayerIds(n,a)).push(u),m=GameCore.Utils.Array.unique(E),i.next=25,(0,y.tu)({playerIds:m,limit:m.length});case 25:g=i.sent,m.forEach((function(e){var t=h()(g).call(g,(function(t){return t.playerId===e}));t&&0!==t.length||g.push({playerId:e,score:0})}));case 27:for(v={},A=R(g);!(w=A()).done;)_=w.value,L=_.playerId,P=_.score,D=_.rank,k=_.getPlayer(),N=k.getPhoto(),B=k.getName(),v[L]={playerId:L,name:B,photo:N,score:P,rank:D};console.log("Request leaderboard data",v),r(O(v,t)),i.next=37;break;case 33:i.prev=33,i.t0=i.catch(0),r(O([],t)),(0,T.tO)(i.t0);case 37:case"end":return i.stop()}}),i,null,[[0,33]])})));return function(e){return r.apply(this,arguments)}}()},O=function(e,t){return{type:C.HB,payload:{leaders:e,type:t}}}},487:function(e,t,n){"use strict";n.d(t,{GA:function(){return _},H$:function(){return T},aV:function(){return P},tu:function(){return I}});var i=n(33),a=n(20),s=n(18),r=n.n(s),o=n(31),c=n.n(o),l=n(468),u=n(235),h=GameCore.Configs,d=h.OtherHost,p=h.LeadersBoard,f=p.Prefix,g=p.LeaderboardId,E=p.Name,m=f+"/"+g+"/leaders",v=f+"/"+g+"/players",A=function(e){var t="";return g?(e===u.C?t=m:e===u.n&&(t=v),t):t},S=function(){var e=(0,a.Z)(r().mark((function e(t){var n,a,s,o;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=c()(t).call(t,(function(e){return e.playerId})),e.next=3,window.GameSDK.player.getConnectedPlayersAsync(n);case 3:if(a=e.sent){e.next=6;break}return e.abrupt("return",[]);case 6:return s=GameCore.Utils.Object.keyBy(t,"playerId"),o=c()(a).call(a,(function(e){var t=s[e.getID()];return(0,i.Z)({},e,{score:t.score,rank:t.rank,playerId:e.getID(),getScore:function(){return t.score},getFormattedScore:function(){return""},getTimestamp:function(){return(new Date).valueOf()},getRank:function(){return t.rank},getExtraData:function(){return t.extraData},getPlayer:function(){return e}})})),e.abrupt("return",o);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),T=function(){var e=(0,a.Z)(r().mark((function e(t){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(t={}),null==g){e.next=3;break}return e.abrupt("return",y(t));case 3:return e.abrupt("return",C(t));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),y=function(){var e=(0,a.Z)(r().mark((function e(t){var n,i,a,s,o;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(t={}),n=[],i=A(u.C)){e.next=5;break}return e.abrupt("return",n);case 5:return a=GameCore.Utils.String.params(t),e.next=8,(0,l.U)(i+"?"+a,{},d);case 8:if(s=e.sent,!((o=(null==s?void 0:s.data)||[]).length<1)){e.next=12;break}return e.abrupt("return",n);case 12:return n=o,e.abrupt("return",S(n));case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),C=function(){var e=(0,a.Z)(r().mark((function e(t){var n,i,a,s,o;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t={}),i=(n=t).limit,a=n.offset,e.next=4,window.GameSDK.getLeaderboardAsync(E);case 4:return s=e.sent,e.next=7,s.getEntriesAsync(i,a);case 7:return o=e.sent,e.abrupt("return",o);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),I=function(){var e=(0,a.Z)(r().mark((function e(t){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(t={}),null==g){e.next=3;break}return e.abrupt("return",R(t));case 3:return e.abrupt("return",w(t));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),R=function(){var e=(0,a.Z)(r().mark((function e(t){var n,i,a,s,o;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(t={}),n=[],i=A(u.n)){e.next=5;break}return e.abrupt("return",n);case 5:return a=GameCore.Utils.String.params(t),e.next=8,(0,l.U)(i+"?"+a,{},d);case 8:if(s=e.sent,!((o=(null==s?void 0:s.data)||[]).length<1)){e.next=12;break}return e.abrupt("return",n);case 12:return n=o,e.abrupt("return",S(n));case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),w=function(){var e=(0,a.Z)(r().mark((function e(t){var n,i,a,s,o;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t={}),i=(n=t).limit,a=n.offset,e.next=4,window.GameSDK.getLeaderboardAsync(E);case 4:return s=e.sent,e.next=7,s.getConnectedPlayerEntriesAsync(i,a);case 7:return o=e.sent,e.abrupt("return",o);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_=function(){var e=(0,a.Z)(r().mark((function e(t){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==g){e.next=2;break}return e.abrupt("return",b(t));case 2:return e.abrupt("return",L());case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),b=function(){var e=(0,a.Z)(r().mark((function e(t){var n,i,a,s,o;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=null,t){e.next=3;break}return e.abrupt("return",n);case 3:if(i=A(u.n)){e.next=6;break}return e.abrupt("return",n);case 6:return a=GameCore.Utils.String.params({playerIds:t}),e.next=9,(0,l.U)(i+"?"+a,{},d);case 9:if(s=e.sent,!((o=(null==s?void 0:s.data)||[]).length<1)){e.next=13;break}return e.abrupt("return",n);case 13:return e.next=15,S(o);case 15:return n=e.sent[0],e.abrupt("return",n);case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),L=function(){var e=(0,a.Z)(r().mark((function e(){var t,n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.GameSDK.getLeaderboardAsync(E);case 2:return t=e.sent,e.next=5,t.getPlayerEntryAsync();case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),P=function(){var e=(0,a.Z)(r().mark((function e(t,n,i){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==g){e.next=2;break}return e.abrupt("return",O(t,n));case 2:return e.abrupt("return",D(n,i));case 3:case"end":return e.stop()}}),e)})));return function(t,n,i){return e.apply(this,arguments)}}(),O=function(){var e=(0,a.Z)(r().mark((function e(t,n){var i;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,l.v)("leaderboards/"+g+"/players/"+t,{score:n},{},d);case 2:return i=e.sent,e.abrupt("return",(null==i?void 0:i.data)||{});case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),D=function(){var e=(0,a.Z)(r().mark((function e(t){var n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.GameSDK.getLeaderboardAsync(E);case 2:return n=e.sent,e.next=5,n.setScoreAsync(t);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},465:function(e,t,n){"use strict";n.d(t,{Cc:function(){return i},HB:function(){return a},dU:function(){return s}});var i="LEADERBOARD_DATA_REQUEST",a="LEADERBOARD_DATA_UPDATE",s="LEADERBOARD_DATA_CLEAR"},235:function(e,t,n){"use strict";n.d(t,{C:function(){return i},n:function(){return a}});var i="global",a="friend"},464:function(e,t,n){"use strict";n.d(t,{L:function(){return i}});var i="leaderboards"},653:function(e,t,n){"use strict";n.d(t,{c:function(){return r},j:function(){return o}});var i=n(125),a=n(464),s=function(e){return e[a.L]},r=(0,i.P1)([function(e){return s(e).leaders}],(function(e){return e})),o=(0,i.P1)([function(e){return s(e).isRequesting}],(function(e){return e}))},466:function(e,t,n){"use strict";n.d(t,{AJ:function(){return f},AO:function(){return y},DI:function(){return S},DP:function(){return u},Er:function(){return i},HV:function(){return l},Ly:function(){return b},Mg:function(){return s},NW:function(){return L},PM:function(){return d},Qi:function(){return v},Sl:function(){return R},T7:function(){return g},UK:function(){return P},Un:function(){return C},Uo:function(){return E},VY:function(){return c},Vj:function(){return I},XW:function(){return o},ar:function(){return w},f3:function(){return T},go:function(){return h},li:function(){return _},qm:function(){return r},tU:function(){return A},tk:function(){return a},xm:function(){return p},zu:function(){return m}});var i="MATCH_GAMEPLAY_INITIALIZE",a="MATCH_GAMEPLAY_START",s="MATCH_GAMEPLAY_FINISH",r="MATCH_GAMEPLAY_UPDATE",o="MATCH_GAMEPLAY_RESCUE",c="MATCH_STATS_DATA_CLEAR",l="MATCH_STATS_DATA_UPDATE",u="MATCH_STATS_CURRENT_UPDATE",h="MATCH_STATS_CONTEXT_REQUEST",d="MATCH_STATS_CONTEXT_RECEIVED",p="MATCH_SINGLE_CREATE_REQUEST",f="MATCH_SINGLE_DETAIL_REQUEST",g="MATCH_SINGLE_MOVE_UPDATED",E="MATCH_SINGLE_DATA_RECEIVED",m="MATCH_SINGLE_DATA_CLEAR",v="MATCH_CHALLENGE_JOIN_REQUEST",A="MATCH_CHALLENGE_CREATE_REQUEST",S="MATCH_CHALLENGE_FINISH_REQUEST",T="MATCH_CHALLENGE_CONTINUE_REQUEST",y="MATCH_CHALLENGE_DATA_RECEIVED",C="MATCH_CHALLENGE_DATA_CLEAR",I="MATCH_GROUP_CREATE_REQUEST",R="MATCH_GROUP_FINISH_REQUEST",w="MATCH_ONLINE_CREATE_REQUEST",_="MATCH_ONLINE_DATA_RECEIVED",b="MATCH_ONLINE_STATS_UPDATE",L="MATCH_ONLINE_FINISH_REQUEST",P="MATCH_ONLINE_DATA_CLEAR"},158:function(e,t,n){"use strict";n.d(t,{ey:function(){return s},jt:function(){return a},kC:function(){return r},oN:function(){return i}});var i="single",a="challenge-friends",s="matching-group",r="tournaments"},478:function(e,t,n){"use strict";n.d(t,{MN:function(){return h},CF:function(){return p}});var i=n(65),a=n(463),s="offlineRewardLastCheck",r=n(479),o=GameCore.Configs.OfflineReward,c=o.Enable,l=o.MinimumTimeToActive,u=i.Z.LEVEL_PROGRESS,h=function(){return function(e,t){if(c){var n=t();if(!(0,r.pi)(n)){e({type:a.g0,payload:{}});var i=window.game.player,o=Date.now(),h=i.getCustomData(s);if(i.setCustomData(s,o),h){var p=i.getCustomData(u),f=0;if(p&&"number"===typeof p&&(f=p),!(f<3)){var g=o-h;if(!(g<l)){var E=Math.floor(g/6e4);e(d(E))}}}}}}},d=function(e){return{type:a.lf,payload:{value:e}}},p=function(){return function(e){c&&e({type:a.uJ,payload:{}})}}},463:function(e,t,n){"use strict";n.d(t,{g0:function(){return i},lf:function(){return a},uJ:function(){return s}});var i="OFFLINE_REWARD_CHECKING",a="OFFLINE_REWARD_RECEIVED",s="OFFLINE_REWARD_RECEIVED_CHECKED"},462:function(e,t,n){"use strict";n.d(t,{L:function(){return i}});var i="offline-reward"},479:function(e,t,n){"use strict";n.d(t,{pi:function(){return r},yX:function(){return c},SD:function(){return o}});var i=n(125),a=n(462),s=function(e){return e[a.L]},r=(0,i.P1)([function(e){return s(e).checked}],(function(e){return e})),o=(0,i.P1)([function(e){return s(e).valueReceived}],(function(e){return e})),c=(0,i.P1)([function(e){return s(e).hasShowReward}],(function(e){return e}))},38:function(e,t,n){"use strict";n.d(t,{_:function(){return i}});var i={BUTTON_CLICK:"button_click",SCREEN_OPEN:"screen_open",LOAD_START:"load_start",LOAD_COMPLETE:"load_complete",APP_READY:"app_ready",TUTORIAL_BEGIN:"tutorial_begin",TUTORIAL_STEP:"tutorial_step",TUTORIAL_COMPLETE:"tutorial_complete",MATCH_START:"match_start",MATCH_RESCUE:"match_rescue",MATCH_END:"match_end",LEVEL_START:"level_start",LEVEL_RESCUE:"level_rescue",LEVEL_END:"level_end",SHARE:"share",MESSAGE:"message",INVITE:"invite",SHORTCUT_CREATE:"shortcut_create",SHORTCUT_CREATE_POPUP:"shortcut_create_popup",BOT_SUBSCRIBE:"bot_subscribe",BOT_SUBSCRIBE_POPUP:"bot_subscribe_popup",AD_SHOW:"ad_show",AD_SHOW_FAILED:"ad_show_failed",AD_REWARDED_IMPS:"ad_rewarded_imps",AD_INTERSTITIAL_IMPS:"ad_interstitial_imps",NEW_USER:"new_user",AD_IMPRESSION:"ad_impression",JOIN_GROUP:"join_group",EARN_UNIT:"earn_unit",USE_ITEM:"use_item",TOURNAMENT_SHARE:"tournament_share",TOURNAMENT_CREATE:"tournament_create",TOURNAMENT_POST_SCORE:"tournament_post_score"}},228:function(e,t){"use strict";t.Z={IDLE:"IDLE",INITIALIZING:"INITIALIZING",STARTED:"STARTED"}},467:function(e,t){"use strict";t.Z={RECEIVED:"received"}},461:function(e,t,n){"use strict";n.d(t,{h:function(){return i}});var i={sound:!0,music:!0,vibrate:!0,speedUp:!1}},224:function(e,t,n){"use strict";var i=n(84),a=function(){function e(e,t,n,a){this.playerId=void 0,this.name=void 0,this.photo=void 0,this.locale=void 0,this.playerId=e,this.name=t,this.photo=n||i.Z.AVATAR.FILE,this.locale=a||"en_US"}return e.prototype.toObject=function(){return{playerId:this.playerId,name:this.name,photo:this.photo,locale:this.locale,score:0}},e}();t.Z=a},230:function(e,t,n){"use strict";n.d(t,{U1:function(){return p},oX:function(){return E},qF:function(){return f}});var i=n(20),a=n(18),s=n.n(a),r=n(47),o=n.n(r),c=n(226),l=n(229),u=n(231),h=n(158),d=n(127),p=function(e,t,n){return{type:c.kL,payload:{contextId:e,contextType:t,entryPointData:n}}},f=function(){return function(){var e=(0,i.Z)(s().mark((function e(t,n){var i,a,r,c,p,f,E,m,v,A,S,T,y,C,I,R,w,_,b;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n(),r=(0,d.fw)(a),c=window.game,p=c.player,f=c.facebook,E=p.getPlayerId(),m=r.contextId,v=r.entryPointData,S=(A=v||{}).type,T=A.matchId,y=A.playerId,C=A.opponentId,I=void 0===C?u.U.playerId:C,R=A.tournamentContextId,w=E===y,_=I===u.U.playerId||o()(i=[I,y]).call(i,E)>=0,b=h.oN,!m||void 0!==S&&S!==l.nx){e.next=18;break}return e.prev=10,e.next=13,f.getTournamentAsync();case 13:b=h.kC,e.next=18;break;case 16:e.prev=16,e.t0=e.catch(10);case 18:S===l.nx&&R&&(b=h.kC),m&&S===l.W6&&!w&&(b=h.jt),T&&m&&_&&S===l.Sb&&(b=h.jt),m&&S===l.zV&&!w&&(b=h.jt),m&&S===l.lB&&(b=h.ey),t(g(b));case 24:case"end":return e.stop()}}),e,null,[[10,16]])})));return function(t,n){return e.apply(this,arguments)}}()},g=function(e){return function(t){t({type:c.EH,payload:{gameMode:e}})}},E=function(e){return{type:c.Bv,payload:{isRequestingDetectGameMode:e}}}},471:function(e,t,n){"use strict";n.d(t,{ZC:function(){return v},ec:function(){return A}});var i=n(20),a=n(47),s=n.n(a),r=n(18),o=n.n(r),c=n(38),l=n(229),u=n(30),h=n(24),d=n(65),p=n(158),f=n(127),g=n(230),E=d.Z.LEVEL_PROGRESS,m=d.Z.SELECTED_LEVEL,v=function(){return function(){var e=(0,i.Z)(o().mark((function e(t,n){var i,a,s,r,d,v,T,y,C,I,R,w,_,b,L;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=window.game,a=i.player,s=i.rollbar,r=i.analytics,d=i.globalScene,e.prev=1,v=n(),T=(0,f.fw)(v),y=(0,f.FB)(v),C=a.getPlayer(),I=T.entryPointData,R=(I||{}).type,C.isUserNew&&r.event(c._.NEW_USER),w=a.getCustomData(m),_=a.getCustomData(E),b="number"===typeof _&&_>=0,w||(L=1,b&&(L=_+1),a.setCustomData(m,L)),y!==p.jt){e.next=41;break}if(d.screen.open(h.o4.NOTIFY_SCREEN,{message:d.lang.Text.LOADING,loading:!0}),!(b&&_>=2)){e.next=34;break}if(R!==l.Sb){e.next=25;break}return e.t0=t,e.next=20,A();case 20:return e.t1=e.sent,e.next=23,(0,e.t0)(e.t1);case 23:e.next=32;break;case 25:if(R!==l.zV){e.next=32;break}return e.t2=t,e.next=29,S();case 29:return e.t3=e.sent,e.next=32,(0,e.t2)(e.t3);case 32:e.next=41;break;case 34:return e.t4=t,e.next=37,(0,g.oX)(!0);case 37:return e.t5=e.sent,e.next=40,(0,e.t4)(e.t5);case 40:console.info("\ud83d\ude80 > setRequestDetectGameMode",!0);case 41:e.next=46;break;case 43:e.prev=43,e.t6=e.catch(1),s.sendException(e.t6);case 46:return e.prev=46,d.screen.close(h.o4.NOTIFY_SCREEN),d.events.emit(u.K.SWITCH,u.C.GAME_SCENE),e.finish(46);case 50:case"end":return e.stop()}}),e,null,[[1,43,46,50]])})));return function(t,n){return e.apply(this,arguments)}}()},A=function(){return function(){var e=(0,i.Z)(o().mark((function e(t,n){var i,a,r,c,l,u,h,d,p,g,m,v,A;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,a=n(),r=(0,f.fw)(a),c=window.game,l=c.player,u=c.battle,h=l.getPlayer(),d=r.entryPointData,g=(p=d||{}).matchId,m=p.opponentId,v=p.playerId,"number"===typeof(A=l.getCustomData(E))){e.next=10;break}return e.abrupt("return");case 10:if(!(A<2)){e.next=12;break}return e.abrupt("return");case 12:if(s()(i=[m,v]).call(i,h.playerId)>=0){e.next=15;break}return e.abrupt("return");case 15:if(!(h.playerId===v)){e.next=21;break}return e.next=19,u.continueBattle(g,m);case 19:e.next=23;break;case 21:return e.next=23,u.continueBattle(g,v);case 23:e.next=28;break;case 25:e.prev=25,e.t0=e.catch(0),console.error(e.t0);case 28:case"end":return e.stop()}}),e,null,[[0,25]])})));return function(t,n){return e.apply(this,arguments)}}()},S=function(){return function(){var e=(0,i.Z)(o().mark((function e(t,n){var i,a,s,r,c,l,u,h;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,i=n(),a=(0,f.fw)(i),s=window.game,r=s.player,c=s.battle,l=r.getPlayer(),u=a.entryPointData,h=(u||{}).playerId,!(l.playerId===h)){e.next=10;break}return e.abrupt("return");case 10:if(h){e.next=12;break}return e.abrupt("return");case 12:return e.next=14,c.createBattle(h,!1);case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(0),console.error(e.t0);case 19:case"end":return e.stop()}}),e,null,[[0,16]])})));return function(t,n){return e.apply(this,arguments)}}()}},470:function(e,t,n){"use strict";n.d(t,{I:function(){return a}});var i=n(226),a=function(e){return{type:i.DW,payload:{sceneKey:e}}}},127:function(e,t,n){"use strict";n.d(t,{DE:function(){return r},FB:function(){return s},fw:function(){return a}});var i=n(125),a=(0,i.P1)([function(e){return e.context}],(function(e){return e})),s=(0,i.P1)([function(e){return e.context.currentGameMode}],(function(e){return e})),r=(0,i.P1)([function(e){return e.context.isRequestingDetectGameMode}],(function(e){return e}))},225:function(e,t,n){"use strict";n.d(t,{Gm:function(){return r},qZ:function(){return s}});var i=n(53),a=n.n(i),s=(n(46),function(e){return new(a())((function(t){return setTimeout(t,e)}))}),r=function(e){var t=new Date(e),n=new Date;return t.getDate()===n.getDate()&&t.getMonth()===n.getMonth()&&t.getFullYear()===n.getFullYear()}},157:function(e,t,n){"use strict";n.d(t,{j6:function(){return a},sw:function(){return s},tO:function(){return o}});n(459),n(209),n(70),n(47);var i=!1,a=function(){var e=setInterval((function(){window.Sentry&&(clearInterval(e),console.warn({isSentryEnabled:i}))}),100)},s=function(e,t){window.Sentry&&window.Sentry.addBreadcrumb({category:e,message:t})},r=function(e){console.error(e)},o=function(e){e&&r(e)}},460:function(e,t,n){"use strict";n.d(t,{t:function(){return a}});var i=GameCore.Configs.Game.ForcePixelRatio,a=function(){return i>0?i:GameCore.Utils.Device.isDesktop()||GameCore.Utils.Device.pixelRatio()>1?2:1}},86:function(e,t,n){"use strict";n.d(t,{O2:function(){return h},bP:function(){return u},wT:function(){return l}});var i=n(20),a=n(53),s=n.n(a),r=n(18),o=n.n(r),c=n(225),l=function(e){e},u=function(){h()},h=function(){return!1};!function(){var e=(0,i.Z)(o().mark((function e(t){var n,a,r,l,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Math.round(t/80),a=0,r=function(){var e=(0,i.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();case 3:if(!(a<n)){e.next=11;break}return l=r(),u=(0,c.qZ)(80),a+=1,e.next=9,s().all([l,u]);case 9:e.next=3;break;case 11:case"end":return e.stop()}}),e)})))}();t.ZP=function(e){return!1}}},t={};function n(i){var a=t[i];if(void 0!==a)return a.exports;var s=t[i]={id:i,loaded:!1,exports:{}};return e[i].call(s.exports,s,s.exports,n),s.loaded=!0,s.exports}n.m=e,n.amdO={},function(){var e=[];n.O=function(t,i,a,s){if(!i){var r=1/0;for(u=0;u<e.length;u++){i=e[u][0],a=e[u][1],s=e[u][2];for(var o=!0,c=0;c<i.length;c++)(!1&s||r>=s)&&Object.keys(n.O).every((function(e){return n.O[e](i[c])}))?i.splice(c--,1):(o=!1,s<r&&(r=s));if(o){e.splice(u--,1);var l=a();void 0!==l&&(t=l)}}return t}s=s||0;for(var u=e.length;u>0&&e[u-1][2]>s;u--)e[u]=e[u-1];e[u]=[i,a,s]}}(),n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.f={},n.e=function(e){return Promise.all(Object.keys(n.f).reduce((function(t,i){return n.f[i](e,t),t}),[]))},n.u=function(e){return e+".bundle.js"},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.hmd=function(e){return(e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:function(){throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e={},t="game-core:";n.l=function(i,a,s,r){if(e[i])e[i].push(a);else{var o,c;if(void 0!==s)for(var l=document.getElementsByTagName("script"),u=0;u<l.length;u++){var h=l[u];if(h.getAttribute("src")==i||h.getAttribute("data-webpack")==t+s){o=h;break}}o||(c=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,n.nc&&o.setAttribute("nonce",n.nc),o.setAttribute("data-webpack",t+s),o.src=i),e[i]=[a];var d=function(t,n){o.onerror=o.onload=null,clearTimeout(p);var a=e[i];if(delete e[i],o.parentNode&&o.parentNode.removeChild(o),a&&a.forEach((function(e){return e(n)})),t)return t(n)},p=setTimeout(d.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=d.bind(null,o.onerror),o.onload=d.bind(null,o.onload),c&&document.head.appendChild(o)}}}(),n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},function(){var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var i=t.getElementsByTagName("script");if(i.length)for(var a=i.length-1;a>-1&&!e;)e=i[a--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e}(),function(){var e={757:0};n.f.j=function(t,i){var a=n.o(e,t)?e[t]:void 0;if(0!==a)if(a)i.push(a[2]);else{var s=new Promise((function(n,i){a=e[t]=[n,i]}));i.push(a[2]=s);var r=n.p+n.u(t),o=new Error;n.l(r,(function(i){if(n.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var s=i&&("load"===i.type?"missing":i.type),r=i&&i.target&&i.target.src;o.message="Loading chunk "+t+" failed.\n("+s+": "+r+")",o.name="ChunkLoadError",o.type=s,o.request=r,a[1](o)}}),"chunk-"+t,t)}},n.O.j=function(t){return 0===e[t]};var t=function(t,i){var a,s,r=i[0],o=i[1],c=i[2],l=0;if(r.some((function(t){return 0!==e[t]}))){for(a in o)n.o(o,a)&&(n.m[a]=o[a]);if(c)var u=c(n)}for(t&&t(i);l<r.length;l++)s=r[l],n.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return n.O(u)},i=self.webpackChunkgame_core=self.webpackChunkgame_core||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))}(),n.O(void 0,[216,630,542],(function(){return n(676)})),n.O(void 0,[216,630,542],(function(){return n(677)})),n.O(void 0,[216,630,542],(function(){return n(493)})),n.O(void 0,[216,630,542],(function(){return n(494)})),n.O(void 0,[216,630,542],(function(){return n(678)})),n.O(void 0,[216,630,542],(function(){return n(574)})),n.O(void 0,[216,630,542],(function(){return n(679)}));var i=n.O(void 0,[216,630,542],(function(){return n(597)}));i=n.O(i)})();