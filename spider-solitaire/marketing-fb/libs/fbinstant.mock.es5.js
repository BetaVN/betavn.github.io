"use strict";var _this5=void 0;function ownKeys(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(n),!0).forEach((function(e){_defineProperty(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function _defineProperty(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _newArrowCheck(t,e){if(t!==e)throw new TypeError("Cannot instantiate an arrow function")}var SAMPLE_ERROR=["INVALID_PARAM","SAME_CONTEXT","NETWORK_FAILURE","PENDING_REQUEST","CLIENT_UNSUPPORTED_OPERATION"];function getRandomError(){return SAMPLE_ERROR[Math.floor(SAMPLE_ERROR.length*Math.random())]}var playersData=[],useLog=!1,maxPlayers=playersData.length,pName="Default Name",pId="1",pASID="1",pPhoto="",pSignature="1",FBUtils={log:function(){var t;if(useLog){var e=[];e.push("[FBInstantMock Mock]:");for(var n=0;n<arguments.length;n++)e.push(arguments[n]);(t=console).log.apply(t,e)}},getQueryString:function(){var t=this,e={};return location.search&&location.search.substr(1).split("&").forEach(function(n){_newArrowCheck(this,t);var r=n.split("="),o=r[0],i=r[1]&&decodeURIComponent(r[1]);(e[o]=e[o]||[]).push(i)}.bind(this)),e},returnAndLog:function(t){return FBUtils.log(t),t},returnUserData:function(t){return FBInstantMock.__mockState.initialized?FBUtils.returnAndLog(t):(FBUtils.log("User Data is not available until startGameAsync has resolved"),null)},getFromLocalStorage:function(t,e){var n=this;return new Promise(function(r){var o=this;_newArrowCheck(this,n);var i=localStorage.getItem(t),a={};i&&(i=JSON.parse(i),e.forEach(function(t){_newArrowCheck(this,o),"undefined"!==i[t]&&(a[t]=i[t])}.bind(this))),FBUtils.log(a),r(a)}.bind(this))},writeToLocalStorage:function(t,e){var n=this;return new Promise(function(r){_newArrowCheck(this,n);var o=_objectSpread(_objectSpread({},JSON.parse(localStorage.getItem(t))),e);FBUtils.log(JSON.stringify(o)),localStorage.setItem(t,JSON.stringify(o)),r()}.bind(this))}},FBInstantMock={__mockState:{initialized:!1},leaderboard:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t+1;return e&&(n=15),{getRank:function(){return n},getScore:function(){return Math.floor(1e3/n)},getExtraData:function(){return JSON.stringify({})},getPlayer:function(){return FBInstantMock.leader(t,e)}}},leader:function(t,e){_newArrowCheck(this,_this5);var n=Math.floor(Math.random()*Math.floor(200)),r=e?playersData[0]:{};return{getID:function(){return r.playerId||n},getName:function(){return r.name||"Bot ".concat(n)},getPhoto:function(){return r.photo||"https://api.adorable.io/avatars/285/".concat(n,"@adorable.png")}}}.bind(void 0),player:{getName:function(){return FBUtils.returnUserData(pName)},getPhoto:function(){return FBUtils.returnUserData(pPhoto)},getID:function(){return FBUtils.returnUserData(pId)},getASIDAsync:function(){return FBUtils.returnUserData(pASID)},getDataAsync:function(t){return FBUtils.log("player.getDataAsync"),FBUtils.getFromLocalStorage("fbPlayerData",t)},setDataAsync:function(t){return FBUtils.log("player.setDataAsync"),FBUtils.writeToLocalStorage("fbPlayerData",t)},flushDataAsync:function(){var t=this;return new Promise(function(e){var n=this;_newArrowCheck(this,t),FBUtils.log("player.flushDataAsync"),FBUtils.writeToLocalStorage("fbPlayerData",{}).finally(function(){_newArrowCheck(this,n),e()}.bind(this))}.bind(this))},getConnectedPlayersAsync:function(){var t=this;return new Promise(function(e){_newArrowCheck(this,t);var n=[];if(FBInstantMock.__mockState.initialized)for(var r=0;r<maxPlayers;r++){var o=playersData[r],i=o.playerId,a=o.name,s=o.photo;n.push({id:i,name:a,photo:s,getID:function(){return this.id},getName:function(){return this.name},getPhoto:function(){return this.photo}})}else FBUtils.log("getConnectedPlayersAsync","Connected players data is not available before startGameAsync resolves");FBUtils.log("getConnectedPlayersAsync","players: ",n),e(n)}.bind(this))},getSignedPlayerInfoAsync:function(){var t=this;return new Promise(function(e){_newArrowCheck(this,t),e({getSignature:function(){return pSignature},getPlayerID:function(){return pId}})}.bind(this))}},context:{id:FBUtils.getQueryString().context_source_id||"",type:FBUtils.getQueryString().context_type||"SOLO",getID:function(){return FBInstantMock.context.id},chooseAsync:function(){var t=this;return new Promise(function(e,n){var r=this;_newArrowCheck(this,t);var o=createElementFromHTML('<div style="z-index: 1000000000; display: flex; align-items: center; height: 100%; width: 56vh;max-width:100vh; background-color: rgba(31, 120, 136, 0.48); position: absolute;margin:auto;left:0;right:0"></div'),i=(playersData.filter(function(t){return _newArrowCheck(this,r),t.playerId!=pId}.bind(this)).map(function(t){var n=this;_newArrowCheck(this,r);var i=createElementFromHTML('<div style="cursor: pointer;width: 100%;height: 100px;background-color: rgb(255, 255, 255);color:black;display: flex;justify-content: space-evenly;align-items: center;z-index: inherit;"><div style="width: 85px;height: 85px;overflow: hidden;border-radius: 50%;"><img style="height:100%"src="'.concat(t.photo,'"/></div><p>').concat(t.name,'</p><button style="width:100px;height:70%;pointer-events:none">Play</button></div>\n                        '));return i.onclick=function(t){_newArrowCheck(this,n),t.stopPropagation(),t.preventDefault(),FBUtils.log("context.chooseAsync"),FBInstantMock.context.id="123456789",FBInstantMock.context.type="THREAD",e(FBInstantMock.context.id),o.remove()}.bind(this),o.appendChild(i),i}.bind(this)),createElementFromHTML('<button style="width:100px;height:70px;cursor:pointer;position:absolute;right: 10px;top:10px">Close</button>'));i.onclick=function(t){_newArrowCheck(this,r),t.stopPropagation(),t.preventDefault(),n({code:"USER_INPUT",message:"User close popup!"}),o.remove()}.bind(this),o.appendChild(i),FBUtils.log("context.chooseAsync"),FBInstantMock.context.id="123456789",FBInstantMock.context.type="THREAD",setTimeout(function(){_newArrowCheck(this,r),100*Math.random()<window.GameCore.Configs.MatchMockFailRate?n({code:getRandomError(),message:"Random error"}):document.body.append(o)}.bind(this),500)}.bind(this))},switchAsync:function(t){var e=this;return new Promise(function(n){_newArrowCheck(this,e),FBUtils.log("context.switchAsync"),FBInstantMock.context.id=t,FBInstantMock.context.type="SOLO"==t?"SOLO":"THREAD",n(t)}.bind(this))},createAsync:function(){var t=this;return new Promise(function(e,n){var r=this;_newArrowCheck(this,t);var o=playersData.filter(function(t){return _newArrowCheck(this,r),t.playerId!=pId}.bind(this))[0],i=createElementFromHTML('<div style="height: 40vh;width: 53vh;max-width: 95vw;position:absolute;background-color: rgba(31, 120, 136, 0.48);border-radius: 2vh;margin: auto;right: 0;left: 0;top: 0;bottom: 0;display: flex;flex-direction:column;justify-content:space-evenly;"><div style="display:flex; justify-content:center; width: 100%"><div style="width: 100px;height: 100px;overflow: hidden;border-radius: 50%;"><img style="height:100%"src="'.concat(pPhoto,'"/></div><div style="width: 100px;height: 100px;overflow: hidden;border-radius: 50%;"><img style="height:100%"src="').concat(o.photo,'"/></div></div><p style="color: white;font-size: 21px;text-align: center;margin: 10px 40px 10px 40px;">Send an invitation to play Game<br>through Messenger.</p></div>')),a=createElementFromHTML('<button style="border: none;background-color: #1877f2;color: #fff;width: 90%;height: 50px;border-radius: 15px;margin-left: auto;margin-right: auto;font-size: 20px;cursor: pointer;">Play</button>');a.onclick=function(t){_newArrowCheck(this,r),t.stopPropagation(),t.preventDefault(),FBUtils.log("context.chooseAsync"),FBInstantMock.context.id="123456789",FBInstantMock.context.type="THREAD",e(FBInstantMock.context.id),i.remove()}.bind(this);var s=createElementFromHTML('<button style="border: none;background-color: #1877f2;color: #fff;width: 80px;height: 50px;font-size: 20px;cursor: pointer;position:absolute;top:10px;right:10px;border-radius: 10px;">Close</button>');s.onclick=function(t){_newArrowCheck(this,r),t.stopPropagation(),t.preventDefault(),n({code:"USER_INPUT",message:"User close popup!"}),i.remove()}.bind(this),i.append(a),i.append(s),setTimeout(function(){_newArrowCheck(this,r),100*Math.random()<window.GameCore.Configs.MatchMockFailRate?n({code:getRandomError(),message:"Random error"}):document.body.append(i)}.bind(this),500)}.bind(this))},getType:function(){return FBUtils.returnAndLog(FBInstantMock.context.type)},isSizeBetween:function(){return FBUtils.returnAndLog(!1)},getPlayersAsync:function(){var t=this;return new Promise(function(e){var n=this;_newArrowCheck(this,t);var r=playersData.map(function(t){return _newArrowCheck(this,n),{getID:function(){return t.playerId},getName:function(){return t.name},getPhoto:function(){return t.photo}}}.bind(this));FBUtils.log("context.getPlayersAsync","players: ",r),e(r)}.bind(this))}},getLocale:function(){return"vi_VN"},initializeAsync:function(){var t,e,n,r,o=(null===(t=window.GameCore)||void 0===t||null===(e=t.Configs)||void 0===e?void 0:e.PlayerMock)||{},i=(null===(n=window.GameCore)||void 0===n||null===(r=n.Configs)||void 0===r?void 0:r.OpponentMock)||{};playersData=[{name:o.name||"Mock1",photo:o.photo||"https://reqres.in/img/faces/2-image.jpg",playerId:o.id||"1",signature:o.signature||"1"},{name:i.name||"Mock2",photo:i.photo||"https://reqres.in/img/faces/3-image.jpg",playerId:i.id||"2",signature:i.signature||"2"}];var a=FBUtils.getQueryString(),s=0;return a.playerId&&a.playerId[0]===playersData[1].playerId&&(s=1),maxPlayers=playersData.length,pName=playersData[s].name,pId=playersData[s].playerId,pPhoto=playersData[s].photo,pSignature=playersData[s].signature,new Promise((function(t){FBUtils.log("initializeAsync"),FBInstantMock.__mockState.initialized=!0,t()}))},setLoadingProgress:function(){},startGameAsync:function(){var t=this;return new Promise(function(e){_newArrowCheck(this,t),FBUtils.log("startGameAsync","Showing game start dialog"),FBInstantMock.__mockState.initialized=!0,e()}.bind(this))},quit:function(){FBUtils.log("QUIT was called. At this point the game will exit")},updateAsync:function(t){var e=this;return logMessage(t.data||{}),new Promise(function(n,r){_newArrowCheck(this,e),FBUtils.log("updateAsync"),t.image?n():r()}.bind(this))},getEntryPointData:function(){var t=FBUtils.getQueryString();return FBUtils.log("getEntryPointData","query string: ",t,"entry point data: ",t.entryPointData),t.entryPointData?JSON.parse(decodeURIComponent(t.entryPointData[0])):null},getEntryPointAsync:function(){var t=this;return new Promise(function(e){_newArrowCheck(this,t),e("admin_message")}.bind(this))},setSessionData:function(t){FBUtils.log("setSessionData","Object to be persisted",t,"(Please note, while using the mock SDK, setSessionData will have no effect.)")},getPlatform:function(){return"WEB"},getSDKVersion:function(){return"6.3"},getSupportedAPIs:function(){var t=[];for(var e in FBInstantMock)t.push(e);for(var n in FBInstantMock.player)t.push("player.".concat(n));for(var r in FBInstantMock.context)t.push("context.".concat(r));return t},shareAsync:function(){return!0},switchGameAsync:function(){return Promise.reject(new Error("FBInstantMock.switchAsync is not available in the Mocked SDK."))},logEvent:function(){return null},onPause:function(t){var e=this;window.onblur=function(){_newArrowCheck(this,e),FBUtils.log("onPause","Interruption event triggered"),t()}.bind(this)},getLeaderboardAsync:function(){return Promise.resolve({getEntriesAsync:function(t,e){for(var n=[],r=0;r++;r<t)n.push(FBInstantMock.leaderboard(r+e));return Promise.resolve(n)},getConnectedPlayerEntriesAsync:function(t,e){for(var n=[],r=0;r++;r<t)n.push(FBInstantMock.leaderboard(r+e));return Promise.resolve(n)},getPlayerEntryAsync:function(){return Promise.resolve(FBInstantMock.leaderboard(0,!0))},setScoreAsync:function(){return Promise.resolve(FBInstantMock.leaderboard(0,!0))}})},postSessionScoreAsync:function(){return Promise.resolve()},loadBannerAdAsync:function(){return Promise.resolve()},hideBannerAdAsync:function(){return Promise.resolve()},getTournamentAsync:function(){return Promise.reject()}};window.FBInstant=FBInstantMock;var decode=function(t){var e={};return t.split("&").each((function(t){var n=t.split("="),r=n[0],o=unescape(n[1]);if(/\[\w+\]/.test(r)){var i=/\[(\w+)\]/g,a=/^([^\\[]+)/.exec(r)[0],s=i.exec(r);e[a]||(e[a]={});!function t(e){if(null!=s){var n=s[1];s=i.exec(r),e[n]||(e[n]=s?{}:o),t(e[n])}}(e[a])}else/\[\]$/.test(r)?(r=/(^\w+)/.exec(r)[0],e[r]||(e[r]=[]),e[r].push(o)):e[r]=o})),e},encode=function(t){return _newArrowCheck(this,_this5),encodeURIComponent(JSON.stringify(t))}.bind(void 0),logMessage=function(t){_newArrowCheck(this,_this5);var e=playersData[0].playerId===pId?playersData[1].playerId:playersData[0].playerId;console.log("Link to receive message: \n".concat(document.location.origin+document.location.pathname,"?playerId=").concat(e,"&context_source_id=123456789&context_type=THREAD&entryPointData=").concat(encode(t),"}"))}.bind(void 0);function createElementFromHTML(t){var e=document.createElement("div");return e.innerHTML=t.trim(),e.firstChild}