(function(){var e={384:function(){HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(e,t,n){for(var i=atob(this.toDataURL(t,n).split(",")[1]),a=i.length,r=a>>2,s=new Uint8Array(a),o=new Uint32Array(s.buffer,0,r),c=0,u=0;c<r;c++)o[c]=i.charCodeAt(u++)|i.charCodeAt(u++)<<8|i.charCodeAt(u++)<<16|i.charCodeAt(u++)<<24;for(var l=3&a;l--;)s[u]=i.charCodeAt(u++);e(new Blob([s],{type:t||"image/png"}))}})},527:function(e,t,n){"use strict";n.d(t,{J:function(){return m}});var i=n(1),a=n(39),r=n.n(a),s=n(40),o=n.n(s),c=n(2),u=n.n(c),l=n(532),h=n(528),d=n(531),f=GameCore.Configs.Notification,p=f.GameTitle,g=f.GameImage,m=function(){function e(){}var t=e.prototype;return t.createAsync=function(){var e=(0,i.Z)(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,FBInstant.tournament.createAsync(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.shareAsync=function(){var e=(0,i.Z)(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,FBInstant.tournament.shareAsync(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.joinAsync=function(){var e=(0,i.Z)(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,FBInstant.tournament.joinAsync(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.postScoreAsync=function(){var e=(0,i.Z)(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,FBInstant.tournament.postScoreAsync(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.getTournamentsAsync=function(){var e=(0,i.Z)(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,FBInstant.tournament.getTournamentsAsync();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),e}(),v=function(){function e(e){var t=this;this.facebook=void 0,this.isCalledSubscribeBot=!1,this.isCalledCreateShortcut=!1,this.requestTournamentAsync=function(){var e=(0,i.Z)(u().mark((function e(n){var i;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.facebook.getTournamentAsync();case 3:return e.next=5,t.facebook.tournament.shareAsync({score:n});case 5:e.next=12;break;case 7:return e.prev=7,e.t0=e.catch(0),i=FBInstant.player.getName(),e.next=12,t.facebook.tournament.createAsync({initialScore:n,config:{tournamentTitle:i+"'s Tournament"}});case 12:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),this.facebook=e}var t=e.prototype;return t.switchAsync=function(){var e=(0,i.Z)(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,GameCore.Utils.Valid.isValueChangeAsync(window.__fbGameReady,!0);case 2:return e.next=4,FBInstant.context.switchAsync(t);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.chooseAsync=function(){var e=(0,i.Z)(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,GameCore.Utils.Valid.isValueChangeAsync(window.__fbGameReady,!0);case 3:return e.next=5,FBInstant.context.chooseAsync({filters:["INCLUDE_EXISTING_CHALLENGES"],minSize:2,maxSize:2});case 5:case 15:return e.abrupt("return",FBInstant.context.getID());case 8:if(e.prev=8,e.t0=e.catch(0),!(e.t0 instanceof Object&&GameCore.Utils.Object.hasOwn(e.t0,"code"))){e.next=16;break}e.t1=e.t0.code,e.next="USER_INPUT"===e.t1?14:"SAME_CONTEXT"===e.t1?15:16;break;case 14:return e.abrupt("return",!1);case 16:return e.abrupt("return",null);case 17:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),t.createAsync=function(){var e=(0,i.Z)(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,GameCore.Utils.Valid.isValueChangeAsync(window.__fbGameReady,!0);case 3:return e.next=5,FBInstant.context.createAsync(""+t);case 5:case 15:return e.abrupt("return",FBInstant.context.getID());case 8:if(e.prev=8,e.t0=e.catch(0),!(e.t0 instanceof Object&&GameCore.Utils.Object.hasOwn(e.t0,"code"))){e.next=16;break}e.t1=e.t0.code,e.next="USER_INPUT"===e.t1?14:"SAME_CONTEXT"===e.t1?15:16;break;case 14:return e.abrupt("return",!1);case 16:return e.abrupt("return",null);case 17:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),t.getPlayerToken=function(){var e=(0,i.Z)(u().mark((function e(){var t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,FBInstant.player.getSignedPlayerInfoAsync();case 2:return t=e.sent,e.abrupt("return",t.getSignature());case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),t.getContextPlayers=function(){var e=(0,i.Z)(u().mark((function e(t){var n,i;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,FBInstant.context.getPlayersAsync();case 3:return n=e.sent,i=[],n.forEach((function(e){var n=e.getID();if(n!==t){var a=e.getName();if(a){var r=e.getPhoto();i.push(new h.Z(n,a,r).toObject())}}})),e.abrupt("return",GameCore.Utils.Array.unique(i));case 9:return e.prev=9,e.t0=e.catch(0),console.warn("getPlayersAsync",{error:e.t0}),e.abrupt("return",[]);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),t.shareAsync=function(){var e=(0,i.Z)(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,FBInstant.shareAsync(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.sendMessage=function(){var e=(0,i.Z)(u().mark((function e(t){var n,i,a,r,s,o;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.data,i=t.image,a=t.template,r=t.cta,s=t.text,o={data:n,image:i,action:"CUSTOM",template:a,cta:r,text:s,strategy:"IMMEDIATE",notification:"PUSH"},e.next=4,FBInstant.updateAsync(o);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.inviteAsync=function(){var e=(0,i.Z)(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,FBInstant.inviteAsync(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.postSessionScoreAsync=function(){var e=(0,i.Z)(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,FBInstant.postSessionScoreAsync(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.getRewardedVideoAsync=function(){var e=(0,i.Z)(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,FBInstant.getRewardedVideoAsync(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.getInterstitialAdAsync=function(){var e=(0,i.Z)(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,FBInstant.getInterstitialAdAsync(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.getContextID=function(){return FBInstant.context.getID()},t.attemptToAddShortcut=function(){var e=(0,i.Z)(u().mark((function e(){var t,n,i,a,s,o;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isCalledCreateShortcut){e.next=2;break}return e.abrupt("return",!1);case 2:return e.prev=2,e.next=5,FBInstant.player.getDataAsync(["lastCallCreateShortcut"]);case 5:if(e.t0=e.sent,e.t0){e.next=8;break}e.t0={};case 8:if(n=e.t0,!(i=n.lastCallCreateShortcut||0)||!(0,d.Gm)(+i)){e.next=12;break}return e.abrupt("return",!1);case 12:if(a=Date.now(),FBInstant.player.setDataAsync({lastCallCreateShortcut:a}),r()(t=FBInstant.getSupportedAPIs()).call(t,"canCreateShortcutAsync")){e.next=17;break}return e.abrupt("return",!1);case 17:return e.next=19,FBInstant.canCreateShortcutAsync();case 19:if(!e.sent){e.next=37;break}return s=l._.SHORTCUT_CREATE,o=l._.SHORTCUT_CREATE_POPUP,this.isCalledCreateShortcut=!0,window.game.analytics.event(o),e.prev=24,e.next=27,GameCore.Utils.Valid.isValueChangeAsync(window.__fbGameReady,!0);case 27:return e.next=29,FBInstant.createShortcutAsync();case 29:return window.game.analytics.event(s,{success:!0}),e.abrupt("return",!0);case 33:return e.prev=33,e.t1=e.catch(24),window.game.analytics.event(s,{success:!1}),e.abrupt("return",!1);case 37:return e.abrupt("return",!1);case 40:return e.prev=40,e.t2=e.catch(2),e.abrupt("return",!1);case 43:case"end":return e.stop()}}),e,this,[[2,40],[24,33]])})));return function(){return e.apply(this,arguments)}}(),t.attemptToSubscribeBot=function(){var e=(0,i.Z)(u().mark((function e(){var t,n,i,a,s,o;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isCalledSubscribeBot){e.next=2;break}return e.abrupt("return",!1);case 2:if(e.prev=2,r()(t=FBInstant.getSupportedAPIs()).call(t,"player.canSubscribeBotAsync")){e.next=6;break}return e.abrupt("return",!1);case 6:return e.next=8,FBInstant.player.canSubscribeBotAsync();case 8:if(!e.sent){e.next=37;break}return e.next=12,FBInstant.player.getDataAsync(["lastCallSubscribeBot"]);case 12:if(e.t0=e.sent,e.t0){e.next=15;break}e.t0={};case 15:if(n=e.t0,!(i=n.lastCallSubscribeBot||0)||!(0,d.Gm)(+i)){e.next=19;break}return e.abrupt("return",!1);case 19:return a=Date.now(),FBInstant.player.setDataAsync({lastCallSubscribeBot:a}),s=l._.BOT_SUBSCRIBE,o=l._.BOT_SUBSCRIBE_POPUP,this.isCalledSubscribeBot=!0,window.game.analytics.event(o),e.prev=24,e.next=27,GameCore.Utils.Valid.isValueChangeAsync(window.__fbGameReady,!0);case 27:return e.next=29,FBInstant.player.subscribeBotAsync();case 29:return window.game.analytics.event(s,{success:!0}),e.abrupt("return",!0);case 33:return e.prev=33,e.t1=e.catch(24),window.game.analytics.event(s,{success:!1}),e.abrupt("return",!1);case 37:return e.abrupt("return",!1);case 40:return e.prev=40,e.t2=e.catch(2),e.abrupt("return",!1);case 43:case"end":return e.stop()}}),e,this,[[2,40],[24,33]])})));return function(){return e.apply(this,arguments)}}(),t.matchPlayerAsync=function(){var e=(0,i.Z)(u().mark((function e(t,n,i){var a;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r()(a=FBInstant.getSupportedAPIs()).call(a,"checkCanPlayerMatchAsync")){e.next=4;break}return e.abrupt("return",!1);case 4:return e.next=6,FBInstant.checkCanPlayerMatchAsync();case 6:if(e.sent){e.next=9;break}return e.abrupt("return",!1);case 9:return e.next=11,FBInstant.matchPlayerAsync(t,n,i);case 11:return e.abrupt("return",!0);case 14:return e.prev=14,e.t0=e.catch(0),e.abrupt("return",!1);case 17:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t,n,i){return e.apply(this,arguments)}}(),t.setLoadingProgress=function(e){FBInstant.setLoadingProgress(e)},t.injectTournament=function(){var e=(0,i.Z)(u().mark((function e(){var t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!GameCore.Configs.Tournament.UseMock){e.next=8;break}return e.next=4,n.e(543).then(n.bind(n,518));case 4:t=e.sent.default,this.facebook.tournament=new t,e.next=9;break;case 8:this.facebook.tournament=new m;case 9:this.facebook.getTournamentAsync=this.getTournamentAsync,this.facebook.requestTournamentAsync=this.requestTournamentAsync;case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.getTournamentAsync=function(){var e=(0,i.Z)(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,FBInstant.getTournamentAsync();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),t.sendNotificationAsync=function(){var e=(0,i.Z)(u().mark((function e(t){var n,i;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("\ud83e\udd16 ? sendNotificationAsync",t),n=t.message,i=t.delayTime,e.next=5,FBInstant.graphApi.requestAsync("/me/notifications","POST",{message:o()({title:p,body:n,media_url:g}),schedule_interval:i});case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("\ud83e\udd16 ? sendNotificationAsync",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),e}();t.Z=v},556:function(e,t,n){"use strict";var i=n(1),a=n(0),r=n(2),s=n.n(r),o=n(543),c=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).instance=void 0,i.placementId=void 0,i.instance=null,i.placementId=n,i}(0,a.Z)(t,e),t.setGame=function(e){self.game=e};var n=t.prototype;return n.loadAsync=function(){var e=(0,i.Z)(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.status===GameCore.Ads.Status.IDLE){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,this.status=GameCore.Ads.Status.LOADING,e.next=6,this.createInstanceByType(this.type);case 6:if(this.instance=e.sent,null!==this.instance){e.next=9;break}throw new GameCore.Ads.AdError("AD_INSTANCE_NOT_INITIATED","Ad instance didn't initiated.");case 9:return e.next=11,this.instance.loadAsync();case 11:this.status=GameCore.Ads.Status.FILLED,e.next=19;break;case 14:throw e.prev=14,e.t0=e.catch(2),this.status=GameCore.Ads.Status.IDLE,this.instance=null,e.t0;case 19:case"end":return e.stop()}}),e,this,[[2,14]])})));return function(){return e.apply(this,arguments)}}(),n.showAsync=function(){var e=(0,i.Z)(s().mark((function e(){var t,n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,this.status===GameCore.Ads.Status.FILLED){e.next=3;break}throw new GameCore.Ads.AdError("AD_NOT_FILLED","Ads no fill.");case 3:if(this.status=GameCore.Ads.Status.SHOWING,null!==this.instance){e.next=6;break}throw new GameCore.Ads.AdError("AD_INSTANCE_NOT_INITIATED","Ad instance didn't initiated.");case 6:return e.next=8,this.instance.showAsync();case 8:t=this.getSceneName(),this.type===GameCore.Ads.Types.INTERSTITIAL&&self.game.analytics.showInterstitialAd(t),this.type===GameCore.Ads.Types.REWARDED&&self.game.analytics.showRewardedVideoAd(t),this.status=GameCore.Ads.Status.IDLE,this.instance=null,e.next=21;break;case 15:throw e.prev=15,e.t0=e.catch(0),e.t0 instanceof Object&&GameCore.Utils.Object.hasOwn(e.t0,"code")&&"ADS_NOT_LOADED"===e.t0.code?this.status=GameCore.Ads.Status.FILLED:(this.status=GameCore.Ads.Status.IDLE,this.instance=null),n=this.getSceneName(),self.game.analytics.showAdFail(this.type,n,e.t0),e.t0;case 21:case"end":return e.stop()}}),e,this,[[0,15]])})));return function(){return e.apply(this,arguments)}}(),n.getStatus=function(){return this.status},n.createInstanceByType=function(){var e=(0,i.Z)(s().mark((function e(t){var n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=self.game.facebook,e.t0=t,e.next=e.t0===GameCore.Ads.Types.REWARDED?4:e.t0===GameCore.Ads.Types.INTERSTITIAL?7:10;break;case 4:return e.next=6,n.getRewardedVideoAsync(this.placementId);case 6:case 9:return e.abrupt("return",e.sent);case 7:return e.next=9,n.getInterstitialAdAsync(this.placementId);case 10:return e.abrupt("return",null);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.getSceneName=function(){try{var e=self.game.globalScene;return e instanceof o.Z?e.getCurrentScene().scene.getSceneName():"unknown"}catch(t){return"unknown"}},t}(GameCore.Ads.AdInstance);t.Z=c},536:function(e,t,n){"use strict";n.d(t,{kL:function(){return i},fJ:function(){return a},EH:function(){return r},qj:function(){return s},rh:function(){return o},DW:function(){return c}});var i="CONTEXT_RECEIVED",a="CONTEXT_PROCESSED",r="CONTEXT_GAME_MODE_DETECTED",s="MESSAGES_SENT_UPDATE",o="MESSAGES_SENT_REMOVE",c="SCENE_KEY_UPDATE"},546:function(e,t,n){"use strict";var i=n(523),a=function(){function e(e,t){if(this.scene=void 0,this.config=void 0,this.isStarted=void 0,this.tween=void 0,!(t.targets.length<1)){this.buildConfig(e,t);var n=this.config.targets[0].scene;n&&(this.scene=n,this.isStarted=!1,this.tween=n.tweens.create(this.config))}}var t=e.prototype;return t.buildConfig=function(e,t){this.config=(0,i.TS)(e,t)},t.play=function(){this.tween&&(this.isStarted&&this.tween.hasStarted?this.restart():(this.isStarted||this.tween.hasStarted||this.tween.play(),this.isStarted=!0))},t.restart=function(){var e;null==(e=this.tween)||e.restart()},t.stop=function(){var e;null==(e=this.tween)||e.stop()},t.remove=function(){var e;null==(e=this.tween)||e.remove()},t.next=function(e){return this.tween?(this.tween.off(Phaser.Tweens.Events.TWEEN_COMPLETE,e),this.tween.once(Phaser.Tweens.Events.TWEEN_COMPLETE,e),this.tween):null},e}();t.Z=a},553:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var i=n(0),a=n(546),r=n(170),s={targets:[],yoyo:!0,repeat:-1,duration:600,repeatDelay:50,ease:n.n(r)()(.55,.47,.43,.91),easeParams:[0,.9],props:{scale:{from:1,to:1.2}}},o=function(e){function t(t){return e.call(this,s,t)||this}return(0,i.Z)(t,e),t}(a.Z)},545:function(e,t,n){"use strict";var i=n(170),a=n.n(i)()(.48,1.57,.6,.83);t.Z=a},548:function(e,t,n){"use strict";var i=n(0),a=n(546),r={targets:[],duration:600,ease:Phaser.Math.Easing.Cubic.Out,props:{alpha:{start:0,from:0,to:1}}},s=function(e){function t(t){return e.call(this,r,t)||this}return(0,i.Z)(t,e),t}(a.Z);t.Z=s},549:function(e,t,n){"use strict";var i=n(0),a=n(546),r={targets:[],duration:600,ease:Phaser.Math.Easing.Quadratic.Out,props:{alpha:{start:1,from:1,to:0}}},s=function(e){function t(t){return e.call(this,r,t)||this}return(0,i.Z)(t,e),t}(a.Z);t.Z=s},552:function(e,t,n){"use strict";var i=n(10),a=n(526),r=n(0),s=n(532),o=n(547),c=n(525),u=function(e){function t(t,n,i){var r;return(r=e.call(this,t)||this).useSound=!0,r.isClicked=!1,r.scaleUp=-1,r.scaleDownPress=void 0,r.parentName=void 0,r.disable=void 0,r.handelObjectDestroy=function(){r.scene&&r.scene.events.off(Phaser.Scenes.Events.SLEEP,r.handleSceneSleep)},r.handleSceneSleep=function(){r.scene&&r.scene.tweens.killTweensOf((0,a.Z)(r))},r.handlePointerDown=function(){r.isClicked||(r.animButtonDown(),r.isClicked=!0)},r.handleOnClick=function(e){return function(){r.isClicked&&(r.isClicked=!1,r.animButtonUp(),r.logButtonEvent(),r.addDebugData(),r.processCallback(e))}},r.handlePointerOut=function(){r.isClicked&&(r.isClicked=!1,r.animButtonUp())},r.setDepth(o.Z.BUTTON),r.setSize(n,i),r.listenEvents(),r.scene.add.existing((0,a.Z)(r)),r}(0,r.Z)(t,e);var n=t.prototype;return n.listenEvents=function(){this.scene.events.on(Phaser.Scenes.Events.SLEEP,this.handleSceneSleep),this.once(Phaser.GameObjects.Events.DESTROY,this.handelObjectDestroy)},n.animButtonDown=function(){var e=this;this.scene.add.tween({targets:this,alpha:.75,duration:100,ease:Phaser.Math.Easing.Sine.Out,onStart:function(t){e.disable&&t.remove()},onUpdate:function(t){e.disable&&t.remove()}})},n.animButtonUp=function(){var e=this;this.scene.add.tween({targets:this,alpha:1,duration:200,ease:Phaser.Math.Easing.Sine.In,onStart:function(t){e.disable&&t.remove()},onUpdate:function(t){e.disable&&t.remove()}})},n.processCallback=function(e){-1!==this.scaleUp&&this.setScale(this.scaleUp),e()},n.setDisabled=function(e){this.disable!=e&&(this.disable=e,e?(this.setAlpha(.5),this.disableInteractive()):(this.setAlpha(1),this.setInteractive()))},n.addDebugData=function(){var e=this.getParentName(),t=this.name;(0,c.sw)("ui-click",e+":"+t)},n.logButtonEvent=function(){var e=this.getParentName(),t=this.name;this.scene.analytics.event(s._.BUTTON_CLICK,{button_name:t,screen_name:e})},n.getParentName=function(){if(this.parentName)return this.parentName;for(var e=this.parentContainer;e;){if(e instanceof GameCore.Screen){var t=e;return this.parentName=t.getScreenName(),this.parentName}e=e.parentContainer}return this.parentName=this.scene.getSceneName(),this.parentName},(0,i.Z)(t,[{key:"onClick",set:function(e){this.setInteractive({useHandCursor:!0}),this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,this.handlePointerDown),this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_UP,this.handleOnClick(e)),this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_OUT,this.handlePointerOut)}}]),t}(Phaser.GameObjects.Container);t.Z=u},554:function(e,t,n){"use strict";var i=n(10),a=n(526),r=n(0),s=n(532),o=n(547),c=n(525),u=n(25),l=n(553),h=function(e){function t(t,n,i,r,s){var c;return(c=e.call(this,t)||this).useSound=!0,c.isClicked=!1,c.scaleUp=-1,c.button=void 0,c.buttonDown=void 0,c.hitArea=void 0,c.scaleDownPress=void 0,c.parentName=void 0,c.handelObjectDestroy=function(){c.scene&&c.scene.events.off(Phaser.Scenes.Events.SLEEP,c.handleSceneSleep)},c.handleSceneSleep=function(){c.scene&&c.scene.tweens.killTweensOf((0,a.Z)(c))},c.handlePointerDown=function(){c.isClicked||(c.showButtonDown(),c.isClicked=!0)},c.handleOnClick=function(e){return function(){c.isClicked&&(c.isClicked=!1,c.hideButtonDown(),c.logButtonEvent(),c.addDebugData(),c.processCallback(e))}},c.handlePointerOut=function(){c.isClicked&&(c.isClicked=!1,c.hideButtonDown())},c.buttonsPulsateAnimation=void 0,c.setDepth(o.Z.BUTTON),c.createButton(n,i,r,s),c.updateSize(),c.listenEvents(),c.scene.add.existing((0,a.Z)(c)),c}(0,r.Z)(t,e);var n=t.prototype;return n.listenEvents=function(){this.scene.events.on(Phaser.Scenes.Events.SLEEP,this.handleSceneSleep),this.once(Phaser.GameObjects.Events.DESTROY,this.handelObjectDestroy)},n.showButtonDown=function(){this.scene.tweens.killTweensOf(this.buttonDown),this.scene.add.tween({targets:this.buttonDown,alpha:.4,duration:150,ease:Phaser.Math.Easing.Sine.Out})},n.hideButtonDown=function(){this.scene.tweens.killTweensOf(this.buttonDown),this.scene.add.tween({targets:this.buttonDown,alpha:0,duration:150,ease:Phaser.Math.Easing.Sine.In})},n.processCallback=function(e){-1!==this.scaleUp&&this.setScale(this.scaleUp),e()},n.setDisabled=function(e){var t,n;e?(this.setAlpha(.5),null==(t=this.hitArea)||t.disableInteractive()):(this.setAlpha(1),null==(n=this.hitArea)||n.setInteractive())},n.createButton=function(e,t,n,i){this.button=new u.Z(this.scene,0,0,e,t,n,i),this.buttonDown=new u.Z(this.scene,0,0,e,t,n,13619151),this.buttonDown.setAlpha(0),this.scaleDownPress=this.scale-.1;var a=this.button,r=a.displayWidth,s=a.displayHeight;this.hitArea=this.scene.make.zone({displayWidth:r,displayHeight:s}),this.add([this.button,this.buttonDown,this.hitArea])},n.updateSize=function(){var e=this.button,t=e.width,n=e.height,i=t/100*10,a=n/100*10,r=i<10?i:10,s=a<10?a:10;this.setSize(t+r,n+s),this.hitArea.setSize(t+r,n+s)},n.addDebugData=function(){var e=this.getParentName(),t=this.name;(0,c.sw)("ui-click",e+":"+t)},n.logButtonEvent=function(){var e=this.getParentName(),t=this.name;this.scene.analytics.event(s._.BUTTON_CLICK,{button_name:t,screen_name:e})},n.getParentName=function(){if(this.parentName)return this.parentName;for(var e=this.parentContainer;e;){if(e instanceof GameCore.Screen){var t=e;return this.parentName=t.getScreenName(),this.parentName}e=e.parentContainer}return this.parentName=this.scene.getSceneName(),this.parentName},n.runPulsate=function(){var e,t;null==(e=this.buttonsPulsateAnimation)||e.remove(),this.buttonsPulsateAnimation=new l.Z({targets:[this],props:{scale:{from:1,to:1.05},duration:500}}),null==(t=this.buttonsPulsateAnimation)||t.play()},n.stopPulsate=function(){var e;null==(e=this.buttonsPulsateAnimation)||e.stop(),this.setScale(1)},(0,i.Z)(t,[{key:"onClick",set:function(e){this.hitArea.setInteractive({useHandCursor:!0}),this.hitArea.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,this.handlePointerDown),this.hitArea.on(Phaser.Input.Events.GAMEOBJECT_POINTER_UP,this.handleOnClick(e)),this.hitArea.on(Phaser.Input.Events.GAMEOBJECT_POINTER_OUT,this.handlePointerOut)}}]),t}(Phaser.GameObjects.Container);t.Z=h},544:function(e,t,n){"use strict";var i=n(526),a=n(0),r=n(7),s=n.n(r),o=n(541).Z.GAMEPLAY_DEFAULT,c=o.KEY,u=o.FRAME,l=function(e){function t(t){var n;return(n=e.call(this,t)||this).icons=[],n.originalScale=[],n.canPlayAnimation=!1,n.timeline=void 0,n.setSize(158,32),n.createIcons(),n.runAnimation(),n.scene.add.existing((0,i.Z)(n)),n}(0,a.Z)(t,e);var n=t.prototype;return n.createIcons=function(){var e,t=this.scene.add.image(0,0,c,u.LOADING_CLUB),n=this.scene.add.image(0,0,c,u.LOADING_DIAMOND),i=this.scene.add.image(0,0,c,u.LOADING_HEART),a=this.scene.add.image(0,0,c,u.LOADING_SPADE);t.setWorldSize(25.6,25.6),i.setWorldSize(25.6,25.6),a.setWorldSize(25.6,25.6),n.setWorldSize(25.6,25.6),this.icons=[t,n,i,a],this.add(this.icons),this.alignIcons(),this.originalScale=s()(e=this.icons).call(e,(function(e){return e.scale}))},n.alignIcons=function(){var e=10,t=this.icons[0].displayWidth;Phaser.Display.Align.In.Center(this.icons[0],this,3*-t/2-e-5),Phaser.Display.Align.In.Center(this.icons[1],this,-t/2-5),Phaser.Display.Align.In.Center(this.icons[2],this,t/2+5),Phaser.Display.Align.In.Center(this.icons[3],this,3*t/2+e+5)},n.runAnimation=function(){var e,t=this;if(this.canPlayAnimation){null==(e=this.timeline)||e.stop();var n=function(){t.icons.forEach((function(e,n){return e.setScale(t.originalScale[n])}))},i=this.scene.tweens.createTimeline({loop:-1,onStart:n,onLoop:n});this.icons.forEach((function(e,n){i.add({targets:e,duration:150,ease:Phaser.Math.Easing.Sine.Out,yoyo:!0,offset:150*n,props:{scale:{from:t.originalScale[n],to:t.originalScale[n]/.8*1.1}}})})),i.play(),this.timeline=i}},n.stopAnimation=function(){var e;null==(e=this.timeline)||e.stop()},n.setVisible=function(t){return e.prototype.setVisible.call(this,t),this.canPlayAnimation=t,t?this.runAnimation():this.stopAnimation(),this},n.setTint=function(e){return this.icons.forEach((function(t){return t.setTint(e)})),this},t}(Phaser.GameObjects.Container);t.Z=l},547:function(e,t){"use strict";t.Z={BACKGROUND:1,FOOTER_LOGO:2,FIREWORKS:5,ITEM:10,LOGO:15,BUTTON:20,TILE:25,TEXT:30,ENCOURAGING:31,EFFECT:32,MESSAGE:33,POPUP:40,PRIORITY:80,DEBUG:90,ON_TOP:1e4}},542:function(e,t){"use strict";t.Z={PRIMARY:{KEY:"sf-pro-medium",TEXTURE:"./assets/fonts/sf-pro-medium.png",DATA:"./assets/fonts/sf-pro-medium.xml"},BOLD:{KEY:"sf-pro-bold",TEXTURE:"./assets/fonts/sf-pro-bold.png",DATA:"./assets/fonts/sf-pro-bold.xml"},FONT_FAMILY:"sf-pro"}},529:function(e,t,n){"use strict";var i={AVATAR:{KEY:"avatar",FILE:"./assets/images/others/avatar.png",CONFIG:{}},ICON_EARTH:{KEY:"icon-earth",FILE:"./assets/images/others/icon-earth.png",CONFIG:{}},BACKGROUND:{KEY:"background",FILE:"./assets/images/"+(0,n(530).t)()+"x/bg.jpg",CONFIG:{}}};t.Z=i},541:function(e,t,n){"use strict";var i=(0,n(530).t)(),a={TUTORIAL:{KEY:"tutorial-resources",TEXTURE:"./assets/textures/"+i+"x/tutorial-resources.png",JSON:"./assets/textures/"+i+"x/tutorial-resources.json",FRAME:{TIP:"tip",HAND:"hand",BLANK:"blank",AVATAR_CAT:"avatar-cat",POPUP_TALK:"talk-popup",FIRST_MOVE:"first-move",CURRENT_SCORE:"current-score",TARGET_SCORE:"target-score",HAMMER_ITEM:"hammer-item",PAINT_ITEM:"paint-item",SHUFFLE_ITEM:"shuffle-item",COLORFUL_GEM_1:"colorful-gem-1",COLORFUL_GEM_2:"colorful-gem-2"}},GAMEPLAY_DEFAULT:{KEY:"gameplay-default",TEXTURE:"./assets/textures/"+i+"x/gameplay-default.png",JSON:"./assets/textures/"+i+"x/gameplay-default.json",FRAME:{BLANK:"blank",STATS_CROWN:"crown",STATS_STAR:"star",STATS_CUP:"stats_cup",STATS_MEDAL_START:"stats_medal_star",STATS_TIMER:"stats_timer",STATS_FLASH:"flash",MENU_STATISTIC:"menu_statistics",CUP:"cup",IC_SETTINGS:"ic_setting",IC_PLAY:"ic_play",IC_HINT:"ic_hint",IC_AUTO_HINT:"ic-auto-hint",IC_RELAX:"ic-relax",IC_SUIT_SIZE:"ic-suit-size",IC_UNDO:"ic_undo",IC_SHARE:"ic_share",IC_THEME:"ic_theme",IC_INVITE:"ic_invite",IC_SOUND:"ic_sound",IC_MOVE:"ic_move",IC_STATISTICS:"ic_statistics",IC_NEXT:"ic_next",IC_BOOK:"ic_book",IC_RESTART:"ic_restart",IC_REPLAY:"ic_replay",IC_RECYCLE:"ic_recycle",IC_DRAW_MODE:"ic_draw_mode",IC_AUTO_COMPLETE:"ic_auto_complete",IC_SWITCH_ON:"ic_switch_on",IC_SWITCH_OFF:"ic_switch_off",IC_SQUARE_ON:"ic_square_on",IC_SQUARE_OFF:"ic_square_off",ADD_SQUARE:"add-square",TIMER:"timer",GOLD:"gold",SILVER:"silver",BRONZE:"bronze",CUSTOM_MEDAL:"custom_medal",TOURNAMENT_TIMER:"tournament_timer",MEDAL_STAR:"medal-star",NO_TOURNAMENT:"no-tournament",IC_BG_OFF:"ic_bg_off",ARROW_SWAP_HORIZONTAL:"arrow-swap-horizontal",AVATAR_CROWN:"avatar_crown",WIN_BANNER:"win_banner",LOSE_BANNER:"lose_banner",BEAM:{AXIS:"beam_axis",LOSE_AXIS:"lose_beam_axis"},FLAG:{LEFT:"flags/left/",RIGHT:"flags/right/"},STRING:{LEFT:"string/left",RIGHT:"string/right"},LIGHTNING:{LEFT:"lightning/left_lightning",MIDDLE:"lightning/middle_lightning",RIGHT:"lightning/right_lightning"},HAND:"hand",LOADING_CLUB:"loading_club",LOADING_DIAMOND:"loading_diamond",LOADING_HEART:"loading_heart",LOADING_SPADE:"loading_spade",BOTTOM_BG:"bottom_bg",BOTTOM_LOGO:"bottom_logo",FOOTER_BG:"footer-bg",STOCK_BG:"stock-bg",FOOTER_TEXT:{BACK_TO_GAME:"text/back-to-game",TEXT_GAME:"text/text-game",TEXT_HINT:"text/text-hint",TEXT_SETTINGS:"text/text-settings",TEXT_TOURNAMENTS:"text/text-tournaments",TEXT_UNDO:"text/text-undo"},DEV_TOOLS_BUTTON:"dev-tools-button"}},CARD_BACK:{KEY:"card-back",TEXTURE:"./assets/textures/"+i+"x/card-back.png",JSON:"./assets/textures/"+i+"x/card-back.json"},HOW_TO_PLAY:{KEY:"how-to-play",TEXTURE:"./assets/textures/"+i+"x/how-to-play.jpg",JSON:"./assets/textures/"+i+"x/how-to-play.json"},THEME_PREVIEW:{KEY:"theme-preview",TEXTURE:"./assets/textures/"+i+"x/theme-preview.png",JSON:"./assets/textures/"+i+"x/theme-preview.json"},DEFAULT:{KEY:"default-resources",TEXTURE:"./assets/textures/"+i+"x/default-resources.png",JSON:"./assets/textures/"+i+"x/default-resources.json",FRAME:{LINE:"line",BLANK:"blank",LOGO:"title-logo",GEMS:"title-gems",TEXT_LOADING:"loading",BOTTOM_BG:"bottom-bg",BOTTOM_LINE:"bottom-line",TOP_BG_LONG:"top-bg-long",BLOCK_LEADER_BLUE:"block-blue-bg",BLOCK_LEADER_YELLOW:"block-yellow-bg",PRELOADER:"preloader/dual-ring",LEADERBOARD_TAB_ON:"leaderboards/tab-on",LEADERBOARD_TAB_OFF:"leaderboards/tab-off",LEADERBOARD_BG_DARK:"leaderboards/bg-dark",LEADERBOARD_BG_LIGHT:"leaderboards/bg-light",MISSION_ICON_BG:"dailyMission/bg-icon",MISSION_BLOCK_BG:"dailyMission/bg-block",MISSION_CLOCK_BG:"dailyMission/bg-clock",DAILY_DAY_BG:"dailyRewards/bg",DAILY_DAY_LABEL:"dailyRewards/label",DAILY_DAY_BG_WAIT:"dailyRewards/bg-wait",DAILY_DAY_BG_OPEN:"dailyRewards/bg-open",DAILY_DAY_TITLE_GREY:"dailyRewards/title-grey",DAILY_DAY_TITLE_GREEN:"dailyRewards/title-green",DAILY_DAY_TITLE_ORANGE:"dailyRewards/title-orange",RIBBON_LONG:"ribbon/long",RIBBON_FULL:"ribbon/long-full",RIBBON_SHORT:"ribbon/short",RIBBON_SMALL:"ribbon/small",AVATAR_BG_BLUE:"avatar/blue-bg",AVATAR_FRAME_BLUE:"avatar/blue-frame",AVATAR_BG_BLUE_SMALL:"avatar/blue-bg-small",AVATAR_FRAME_BLUE_SMALL:"avatar/blue-frame-small",AVATAR_BG_BLUE_BIG:"avatar/blue-bg-big",AVATAR_FRAME_BLUE_BIG:"avatar/blue-frame-big",AVATAR_BG_YELLOW:"avatar/yellow-bg",AVATAR_FRAME_YELLOW:"avatar/yellow-frame",AVATAR_BG_YELLOW_SMALL:"avatar/yellow-bg-small",AVATAR_FRAME_YELLOW_SMALL:"avatar/yellow-frame-small",AVATAR_BG_YELLOW_BIG:"avatar/yellow-bg-big",AVATAR_FRAME_YELLOW_BIG:"avatar/yellow-frame-big",THE_CAT:"logo/cat",SAD_CAT:"logo/sad-cat",LOGO_GIFT:"logo/gift",LOGO_GIFT_ADS:"logo/gift-ad",LOGO_GIFT_WHITE:"logo/gift_white",LOGO_DIAMONDS_LIGHT_2:"logo/diamonds-light-2",LOGO_DIAMONDS_LIGHT_3:"logo/diamonds-light-3",LOGO_DIAMONDS_LIGHT_4:"logo/diamonds-light-4",LOGO_DIAMONDS_LIGHT_5:"logo/diamonds-light-5",LOGO_DIAMONDS_LIGHT_6:"logo/diamonds-light-6",LOGO_ADS_DIAMONDS:"logo/ads-diamonds",POPUP_TOP_LEFT:"popup/top-left",POPUP_TOP_MID:"popup/top-middle",POPUP_TOP_RIGHT:"popup/top-right",POPUP_MID_LEFT:"popup/middle-left",POPUP_MID_MID:"popup/middle-middle",POPUP_MID_RIGHT:"popup/middle-right",POPUP_BOTTOM_LEFT:"popup/bottom-left",POPUP_BOTTOM_MID:"popup/bottom-middle",POPUP_BOTTOM_RIGHT:"popup/bottom-right",PROGRESS_BG_LEFT:"progress/bg-left",PROGRESS_BG_MID:"progress/bg-mid",PROGRESS_BG_RIGHT:"progress/bg-right",PROGRESS_BAR_LEFT:"progress/bar-left",PROGRESS_BAR_MID:"progress/bar-mid",PROGRESS_BAR_RIGHT:"progress/bar-right",ICON_DOT:"icons/dot",ICON_CUP:"icons/cup",ICON_GIFT:"icons/gift",ICON_PLUS:"icons/plus",ICON_RANK:"icons/rank",ICON_FLAG:"icons/flag",ICON_CLOCK:"icons/clock",ICON_DAILY:"icons/daily",ICON_ADS:"icons/flat-ad",ICON_CHECK:"icons/check",ICON_CANCEL:"icons/cancel",ICON_SETTING:"icons/setting",ICON_RESUME:"icons/flat-resume",ICON_VIB_ON:"icons/flat-vib-on",ICON_VIB_OFF:"icons/flat-vib-off",ICON_MUSIC_ON:"icons/flat-music-on",ICON_MUSIC_OFF:"icons/flat-music-off",ICON_SOUND_ON:"icons/flat-sound-on",ICON_SOUND_OFF:"icons/flat-sound-off",ICON_FLAT_HOME:"icons/flat-home",ICON_FLAT_RANK:"icons/flat-rank",ICON_FLAT_SHARE:"icons/flat-share",ICON_CROWN:"icons/crown",ICON_CUP_MINI:"icons/cup-mini",ICON_CUP_GOLD:"icons/cup-gold",ICON_CUP_SILVER:"icons/cup-silver",ICON_CUP_COPPER:"icons/cup-bronze",ICON_DIAMOND:"icons/diamond",ICON_DIAMOND_SMALL:"icons/diamond-small",ICON_DIAMOND_GREY:"icons/diamond-grey",ICON_DIAMOND_LIGHT:"icons/diamond-light",BUTTON_CLOSE:"buttons/close",BUTTON_RED_LONG:"buttons/red-long",BUTTON_YELLOW_LONG:"buttons/yellow-long",BUTTON_YELLOW_CIRCLE:"buttons/yellow-circle",BUTTON_BLUE:"buttons/blue",BUTTON_BLUE_SHORT:"buttons/blue-short",BUTTON_BLUE_LONG:"buttons/blue-long",BUTTON_BLUE_CIRCLE:"buttons/blue-circle",BUTTON_GREEN:"buttons/green",BUTTON_GREEN_SHORT:"buttons/green-short",BUTTON_GREEN_LONG:"buttons/green-long",BUTTON_GREEN_MINOR:"buttons/green-minor",BUTTON_GREEN_CIRCLE:"buttons/green-circle",BUTTON_GREEN_MINOR_MINI:"buttons/green-minor-mini",NO_THANK_TEXT:"texts/no-thank",HORIZONTAL_LUCKY_BAR:"lucky-bar/horizontal-lucky-bar",HORIZONTAL_ARROW:"lucky-bar/horizontal-arrow",ARC_LUCKY_BAR:"lucky-bar/arc-lucky-bar",ARC_ARROW:"lucky-bar/arc-arrow"}},EFFECTS:{KEY:"effects-resources",PATH:"./assets/textures/"+i+"x/",JSON:"./assets/textures/"+i+"x/effects-resources.json",FRAME:{BLANK:"blank",FX_COMET:"comet",FX_SPARK:"spark",FX_CIRCLE:"circle",FX_CIRCLE_LIGHT:"circle-light",FX_GLOW_LIGHT:"glow-light",FX_GLOW_SMALL:"glow-small",FX_STAR_WHITE:"star-white",FX_STAR_YELLOW:"star-yellow",TEXT_COOL:"texts/cool",TEXT_GOOD:"texts/good",TEXT_GREAT:"texts/great",TEXT_EXCELLENT:"texts/excellent",TEXT_CONGRATULATION:"texts/congratulation",FX_CONFETTI_SMALL_1:"confetti/small-1",FX_CONFETTI_SMALL_2:"confetti/small-2",FX_CONFETTI_SMALL_3:"confetti/small-3",FX_CONFETTI_SMALL_4:"confetti/small-4",FX_CONFETTI_HEXAGON:"confetti/hexagon-",FX_FIREWORKS_SMALL:"fireworks/small",FX_FIREWORKS_BIG_0:"fireworks/big-explosive-0",FX_FIREWORKS_BIG_1:"fireworks/big-explosive-1",FX_FIREWORKS_SOAR_LINE:"fireworks/soar-line",FX_FIREWORKS_SOAR_CIRCLE:"fireworks/soar-circle",FX_HIGHLIGHT:"fx-items/highlight",FX_PAINT_EXPLOSIVE:"fx-items/paint-explosive-",FX_RED_EXPLOSIVE:"fx-gems/red-explosive-",FX_BLUE_EXPLOSIVE:"fx-gems/blue-explosive-",FX_PINK_EXPLOSIVE:"fx-gems/pink-explosive-",FX_GREEN_EXPLOSIVE:"fx-gems/green-explosive-",FX_YELLOW_EXPLOSIVE:"fx-gems/yellow-explosive-",FX_COLORFUL:"fx-gems/colorful-",FX_COLOR_CHANGE:"fx-gems/color-change-",FX_FREEZE_EXPLOSIVE:"fx-gems/freeze-explosive-",FX_COLORFUL_EXPLOSIVE:"fx-gems/colorful-explosive-",ANIMATION_STAR_X:"star-x/star-",ANIMATION_STAR_Y:"star-y/star-",FX_CONFETTI_RIBBON:"ribbon/ribbon",PREFIX_ANIMATION_RIBBON_CONFETTI_A:"ribbon/falling-confetti/confetti-a/confetti-a-",PREFIX_ANIMATION_RIBBON_CONFETTI_B:"ribbon/falling-confetti/confetti-b/confetti-b-",PREFIX_ANIMATION_RIBBON_CONFETTI_C:"ribbon/falling-confetti/confetti-c/confetti-c-",PREFIX_ANIMATION_RIBBON_CONFETTI_D:"ribbon/falling-confetti/confetti-d/confetti-d-"}},GAMEPLAY:{KEY:"gameplay-resources",TEXTURE:"./assets/textures/"+i+"x/gameplay-resources.png",JSON:"./assets/textures/"+i+"x/gameplay-resources.json",FRAME:{BLANK:"blank"}}};t.Z=a},538:function(e,t,n){"use strict";n.d(t,{C:function(){return a},K:function(){return r}});var i=n(58),a={BOOT_SCENE:"BOOT_SCENE",LOAD_SCENE:"LOAD_SCENE",GAME_SCENE:"GAME_SCENE",GLOBAL_SCENE:"GLOBAL_SCENE",DASHBOARD_SCENE:"DASHBOARD_SCENE",TEST_SCENE:"TEST_SCENE"},r={SWITCH:n.n(i)()("SWITCH")}},540:function(e,t,n){"use strict";n.d(t,{o4:function(){return i},Ks:function(){return a}});var i={PAUSE_SCREEN:"PAUSE_SCREEN",NOTIFY_SCREEN:"NOTIFY_SCREEN",REWARD_SCREEN:"REWARD_SCREEN",RESCUE_SCREEN:"RESCUE_SCREEN",SETTINGS_SCREEN:"SETTINGS_SCREEN",BEST_SCORE_SCREEN:"BEST_SCORE_SCREEN",DAILY_REWARD_SCREEN:"DAILY_REWARD_SCREEN",DAILY_MISSIONS_SCREEN:"DAILY_MISSIONS_SCREEN",LUCKY_REWARD_SCREEN:"LUCKY_REWARD_SCREEN",NO_MORE_MOVES_SCREEN:"NO_MORE_MOVES_SCREEN",VICTORY_SCREEN:"VICTORY_SCREEN",PLAY_SCREEN:"PLAY_SCREEN",GAME_STATS_SCREEN:"GAME_STATS_SCREEN",THEME_SCREEN:"THEME_SCREEN",HOW_TO_PLAY_SCREEN:"HOW_TO_PLAY_SCREEN",AWESOME_SCREEN:"AWESOME_SCREEN",NOTIFICATION_SCREEN:"NOTIFICATION_SCREEN",TOURNAMENTS_SCREEN:"TOURNAMENTS_SCREEN",PLAY_WITH_FRIEND_GAME_OVER_SCREEN:"PLAY_WITH_FRIEND_GAME_OVER_SCREEN",TOURNAMENTS_RESULT_SCREEN:"TOURNAMENTS_RESULT_SCREEN"},a={SCREEN:200,POPUP:300,PRIORITY:999}},550:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var i=n(0),a=n(532),r=function(e){function t(t,n,i){var a;return(a=e.call(this,t,0,0,n,i)||this).setOrigin(0,0),a}return(0,i.Z)(t,e),t}(Phaser.GameObjects.Zone),s=function(e){function t(){var t;return(t=e.call(this,{visible:!1})||this).unsubscribeList=void 0,t.gameZone=void 0,t.background=void 0,t.handleOpenScene=function(){t.logPageviewOnOpen(),t.logEventOpen()},t.removeStateChange=function(){t.unsubscribeList.forEach((function(e){return e()}))},t}(0,i.Z)(t,e);var n=t.prototype;return n.create=function(){this.events.on("wake",this.handleOpenScene),this.events.on("resume",this.handleOpenScene),this.events.on("create",this.handleOpenScene),this.scaleGame(),this.createGameZone()},n.scaleGame=function(){var e=this.getCamera("main"),t=this.world.getZoomRatio(),n=this.world.getWorldSize(),i=n.width,a=n.height;e.setZoom(t),e.centerOn(i/2,a/2)},n.createGameZone=function(){var e=this.world.getWorldSize(),t=e.width,n=e.height;this.gameZone=new r(this,t,n)},n.getCamera=function(e){return"main"===e?this.cameras.main:this.cameras.getCamera(e)},n.createMask=function(e){void 0===e&&(e=1),this.getCamera("main").setBackgroundColor("rgba(0, 0, 0, "+e+")")},n.fontSize=function(e){return Math.round(e/1.01)},n.createBackground=function(e,t,n,i){this.background?(this.background.setTexture(e),t&&this.background.setFrame(t)):this.background=this.make.image({key:e,frame:t}),this.background.setName(e);var a=this.gameZone,r=a.displayWidth,s=a.displayHeight;this.background.setDisplaySize(r,s),GameCore.Utils.Valid.isNumber(n)&&this.background.setAlpha(n),GameCore.Utils.Valid.isNumber(i)&&this.background.setTint(i),Phaser.Display.Align.In.Center(this.background,this.gameZone)},n.handleStateChange=function(e){var t=this;this.unsubscribeList=[],e.forEach((function(e){var n=e.selector,i=e.callback,a=t.storage.watch(n,i);t.unsubscribeList.push(a)})),this.events.once("sleep",this.removeStateChange),this.events.once("destroy",this.removeStateChange),this.events.once("shutdown",this.removeStateChange)},n.logPageviewOnOpen=function(){this.analytics.pageview(this.scene.key)},n.logEventOpen=function(){this.analytics.event(a._.SCREEN_OPEN,{screen_name:this.getSceneName()})},n.getSceneName=function(){return GameCore.Utils.String.toUpperCamelCase(this.scene.key.toLowerCase())},t}(Phaser.Scene)},555:function(e,t,n){"use strict";var i=n(526),a=n(0),r=n(542),s=n(25),o=n(552),c=n(540),u=n(541),l=n(554),h=n(532),d=u.Z.HOW_TO_PLAY,f=u.Z.GAMEPLAY_DEFAULT,p=[{description:"Win Spider Solitaire by forming runs,\nKing to Ace.",frame:"how_to_play_1"},{description:"Unweave the cards by moving them\nonto cards ranked one higher.",frame:"how_to_play_2"},{description:"Use the stockpile to add new cards to\nthe board.",frame:"how_to_play_3"}],g=function(e){function t(t){var n;return(n=e.call(this,t)||this).bg=void 0,n.stepBtnText=void 0,n.currentStep=void 0,n.stepContainers=void 0,n.handleNextStep=function(){n.currentStep==p.length-1?(n.scene.screen.close(c.o4.HOW_TO_PLAY_SCREEN),n.scene.analytics.event(h._.TUTORIAL_COMPLETE)):(n.selectStep(n.currentStep+1),n.scene.analytics.event(h._.TUTORIAL_STEP,{step:n.currentStep}))},n.currentStep=0,n.createBackground(),n.createContent(),n.createGetStartedButton(),n.createCloseButton(),n.selectStep(0),t.add.existing((0,i.Z)(n)),n}(0,a.Z)(t,e);var n=t.prototype;return n.selectStep=function(e){e>=p.length&&(e=p.length-1),e==p.length-1?this.stepBtnText.setText("Done"):this.stepBtnText.setText("Next"),this.stepContainers.forEach((function(e){return e.kill()})),this.stepContainers[e].revive(),this.currentStep=e},n.createBackground=function(){var e=new s.Z(this.scene,0,0,340,420,20,16579837),t=this.scene.add.line(0,0,0,0,e.width,0,3774208);t.setLineWidth(.5),Phaser.Display.Align.In.TopCenter(t,e,0,-60),this.add([e,t]),this.bg=e,this.setSize(e.width,e.height)},n.createContent=function(){var e=this.scene.make.bitmapText({font:r.Z.BOLD.KEY,size:this.scene.fontSize(20),text:"How To Play",origin:{x:.5,y:.5}});e.setTint(1907997),this.add(e),Phaser.Display.Align.In.TopCenter(e,this,0,-20),this.stepContainers=[];for(var t=0;t<p.length;t++){var n=p[t],i=n.description,a=n.frame,s=this.createStepContainer(i,a);this.stepContainers.push(s),Phaser.Display.Align.In.TopCenter(s,this,0,-75)}this.add(this.stepContainers)},n.createStepContainer=function(e,t){var n=this.scene.add.container();n.setSize(300,270);var i=this.scene.make.bitmapText({font:r.Z.PRIMARY.KEY,size:this.scene.fontSize(16),text:e,origin:{x:.5,y:.5}});i.setTint(1907997),i.setCenterAlign();var a=this.scene.add.image(0,0,d.KEY,t);return a.setWorldSize(300,200),n.add([i,a]),Phaser.Display.Align.In.TopCenter(i,n,0,-8),Phaser.Display.Align.In.BottomCenter(a,n,0,-8),n},n.createGetStartedButton=function(){var e=new l.Z(this.scene,192,40,16,3774208);e.setName("GetStated"),e.onClick=this.handleNextStep;var t=this.scene.make.bitmapText({font:r.Z.BOLD.KEY,size:this.scene.fontSize(18),text:"Next",origin:{x:.5,y:.5}});t.setTint(16579837),e.add([t]),Phaser.Display.Align.In.BottomCenter(e,this.bg,0,-20),this.add([e]),this.stepBtnText=t},n.createCloseButton=function(){var e=this,t=new o.Z(this.scene,40,40);t.setName("Close"),t.onClick=function(){e.scene.screen.close(c.o4.HOW_TO_PLAY_SCREEN)};var n=this.scene.add.image(0,0,f.KEY,"ic_close");n.setWorldSize(30,30),n.setTint(8750210),t.add(n),Phaser.Display.Align.In.TopRight(t,this.bg,-6,-9),this.add([t])},t}(Phaser.GameObjects.Container);t.Z=g},543:function(e,t,n){"use strict";n.d(t,{Z:function(){return G}});var i=n(10),a=n(0),r=n(5),s=n.n(r),o=n(548),c=n(549),u=n(541),l=n(538),h=n(540),d=n(539),f=(0,n(537).P1)([function(e){return e.scene.currentSceneKey}],(function(e){return e})),p=n(525),g=n(550),m=n(526),v=n(542),y=n(547),b=u.Z.DEFAULT,S=b.KEY,T=b.FRAME,E=function(e){function t(t){var n;return(n=e.call(this,t,0,0)||this).fps=0,n.fpsString="FPS: %1",n.fpsText=void 0,n.background=void 0,n.lastUpdate=void 0,n.update=function(e){if(!(e-n.lastUpdate<800)){n.lastUpdate=e;var t=Math.floor(n.scene.game.loop.actualFps);n.setFps(t)}},n.createFps(),n.setDepth(y.Z.DEBUG),n.scene.add.existing((0,m.Z)(n)),n.scene.events.on(Phaser.Scenes.Events.UPDATE,n.update),n}(0,a.Z)(t,e);var n=t.prototype;return n.setFps=function(e){this.fps=e;var t=Phaser.Utils.String.Format(this.fpsString,[e]);this.fpsText.setText(t)},n.createFps=function(){this.background=this.scene.make.image({key:S,frame:T.BLANK}),this.background.setName("BG"),this.background.setTint(13801480),this.background.setWorldSize(45,25),this.fpsText=this.scene.make.bitmapText({size:this.scene.fontSize(14),text:this.fpsString,font:v.Z.PRIMARY.KEY,origin:{x:.5,y:.5}}),this.fpsText.setName("FPS Meter"),Phaser.Display.Align.In.Center(this.fpsText,this.background),this.add([this.background,this.fpsText]),this.setFps(0)},t}(Phaser.GameObjects.Container),C=E,A=function(e){function t(t){var n;if((n=e.call(this,t,0,0)||this).performance=void 0,n.memory=0,n.maxMemoryLimit=void 0,n.maxPercentThreshold=void 0,n.normalColor=3459162,n.warningColor=16768343,n.alarmColor=15812200,n.memoryString="Memory: %1MB / %2MB",n.memoryText=void 0,n.lastUpdate=void 0,n.update=function(e){if(!(e-n.lastUpdate<1e3)){n.lastUpdate=e;var t=n.performance.memory.usedJSHeapSize,i=1048576*n.maxMemoryLimit,a=Math.round(t/1048576);n.setMemory(a),n.memoryText.setTint(n.normalColor),t>n.maxPercentThreshold/100*i&&n.memoryText.setTint(n.warningColor),t>i&&n.memoryText.setTint(n.alarmColor)}},n.performance=window.performance,n.createMemory(),n.setDepth(y.Z.DEBUG),n.scene.add.existing((0,m.Z)(n)),!n.isSupport())return n.memoryText.setText("Memory: not supported!"),(0,m.Z)(n);var i=n.performance.memory.jsHeapSizeLimit;return n.maxPercentThreshold=90,n.setMaxMemory(i/1048576),n.scene.events.on(Phaser.Scenes.Events.UPDATE,n.update),n}(0,a.Z)(t,e);var n=t.prototype;return n.isSupport=function(){var e;return this.performance&&!(null==(e=this.performance)||!e.memory)},n.setMaxMemory=function(e){this.maxMemoryLimit=Math.round(e)},n.setMemory=function(e){this.memory=e;var t=Phaser.Utils.String.Format(this.memoryString,[e,this.maxMemoryLimit]);this.memoryText.setText(t)},n.createMemory=function(){this.memoryText=this.scene.make.bitmapText({size:this.scene.fontSize(14),text:this.memoryString,font:v.Z.PRIMARY.KEY,depth:2e3}),this.memoryText.setName("Memory Meter"),this.add(this.memoryText),this.setMemory(0)},t}(Phaser.GameObjects.Container),w=A,I=n(546),P={targets:[],duration:300,ease:n(545).Z,props:{scale:{from:1.2,to:1}}},k=function(e){function t(t){return e.call(this,P,t)||this}return(0,a.Z)(t,e),t}(I.Z),x=n(544),_=function(e){function t(t,n,i,a){var r;return(r=e.call(this,t,n,i,a)||this).loadingIcon=void 0,r.messageText=void 0,r.openAnimation=void 0,r.closeTimerEvent=void 0,r.addLoadingIcon(),r.addMessageText(),r.setDepth(h.Ks.PRIORITY),r.background.setAlpha(.8),r}(0,a.Z)(t,e);var n=t.prototype;return n.open=function(t){var n,i=this;e.prototype.open.call(this,t);var a=this.getData(["message","duration","loading"]),r=a[0],s=void 0===r?"":r,o=a[1],c=void 0===o?0:o,u=a[2],l=void 0!==u&&u;this.setMessage(s),this.showLoading(l),null==(n=this.closeTimerEvent)||n.remove(),c>0&&(this.closeTimerEvent=this.scene.time.addEvent({delay:c,callback:function(){i.visible&&i.scene.screen.close(i.name)}})),this.runOpenAnimation()},n.addLoadingIcon=function(){this.loadingIcon=new x.Z(this.scene),this.add(this.loadingIcon),Phaser.Display.Align.In.Center(this.loadingIcon,this.zone)},n.addMessageText=function(){this.messageText=this.scene.make.bitmapText({size:this.scene.fontSize(16),font:v.Z.PRIMARY.KEY,origin:{x:.5,y:.5}}),this.messageText.setCenterAlign(),this.add(this.messageText)},n.setMessage=function(e){this.messageText.setText(e)},n.showLoading=function(e){this.loadingIcon.setVisible(e);var t=!1===e?15:40;Phaser.Display.Align.In.Center(this.messageText,this.zone,0,t)},n.runOpenAnimation=function(){var e,t;null==(e=this.openAnimation)||e.stop(),null==(t=this.openAnimation)||t.remove(),this.openAnimation=new k({targets:[this.messageText,this.loadingIcon],props:{scale:{getStart:function(e){return e.scale-.3},getEnd:function(e){return e.scale}}}}),this.openAnimation.play()},n.logPageviewOnOpen=function(){},n.logPageviewOnClose=function(){},t}(GameCore.Screen),O=_,D=u.Z.DEFAULT,B=D.KEY,L=D.FRAME,R=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return(n=e.call.apply(e,s()(t=[this]).call(t,a))||this).mask=void 0,n.fadeInAnim=void 0,n.fadeOutAnim=void 0,n.fpsMeter=void 0,n.memoryMeter=void 0,n.switchScene=function(e){n.currentScene.switch(e)},n.emitGameEventStartScene=function(e){var t=e.scene.key;console.info("%cScene start","color: #D27D2D",t),n.updateSceneState(),n.runMaskFadeOutAnimation(),n.updateActiveSceneKey(t),n.game.events.emit(Phaser.Scenes.Events.START,t),(0,p.sw)("scene","Start scene: "+t)},n.emitGameEventSleepScene=function(e){var t=e.scene.scene.key;console.info("%cScene sleep","color: #D27D2D",t),t!==l.C.LOAD_SCENE&&(n.runMaskFadeInAnimation(),n.game.events.emit(Phaser.Scenes.Events.SLEEP,t))},n.emitGameEventWakeScene=function(e){var t=e.scene.scene.key;console.info("%cScene wake","color: #D27D2D",t),t!==l.C.LOAD_SCENE&&(n.updateSceneState(),n.runMaskFadeOutAnimation(),n.updateActiveSceneKey(t),n.game.events.emit(Phaser.Scenes.Events.WAKE,t))},n.emitGameEventPauseScene=function(e){var t=e.scene.scene.key;console.info("%cScene pause","color: #D27D2D",t),n.game.events.emit(Phaser.Scenes.Events.PAUSE,t)},n.emitGameEventResumeScene=function(e){var t=e.scene.key;console.info("%cScene resume","color: #D27D2D",t),n.game.events.emit(Phaser.Scenes.Events.RESUME,t)},n.emitGameEventShutdownScene=function(e){var t=e.scene.scene.key;console.info("%cScene shutdown","color: #D27D2D",t),n.game.events.emit(Phaser.Scenes.Events.SHUTDOWN,t)},n}(0,a.Z)(t,e);var n=t.prototype;return n.init=function(){this.listenScenesEvents(),this.game.globalScene=this},n.setup=function(){this.scaleGame(),this.addMask(),this.addNotifyScreen(),this.addFPS(),this.addMemory()},n.addNotifyScreen=function(){var e=this.screen.add(h.o4.NOTIFY_SCREEN,O);Phaser.Display.Align.In.Center(e,this.gameZone)},n.addMask=function(){this.mask=this.make.image({key:B,frame:L.BLANK});var e=this.gameZone,t=e.width,n=e.height;this.mask.setAlpha(0),this.mask.setOrigin(0,0),this.mask.setTint(859421),this.mask.setWorldSize(t,n)},n.addFPS=function(){GameCore.Configs.Statistics.ShowFPSInGame&&(this.fpsMeter=new C(this),Phaser.Display.Align.In.TopLeft(this.fpsMeter,this.gameZone,-20,-10))},n.addMemory=function(){GameCore.Configs.Statistics.ShowMemoryInGame&&(this.memoryMeter=new w(this),Phaser.Display.Align.In.TopLeft(this.memoryMeter,this.gameZone,-45,-3))},n.updateSceneState=function(){this.setGlobalSceneOnTop()},n.setGlobalSceneOnTop=function(){this.scene.bringToTop(this)},n.runMaskFadeInAnimation=function(){var e,t;this.mask&&GameCore.Configs.EnableEffectSceneTransition&&(null==(e=this.fadeInAnim)||e.remove(),null==(t=this.fadeOutAnim)||t.remove(),this.fadeInAnim=new o.Z({targets:[this.mask],duration:400,ease:Phaser.Math.Easing.Cubic.In,props:{alpha:{start:0,from:0,to:.6}}}),this.mask.setAlpha(0),this.fadeInAnim.play())},n.runMaskFadeOutAnimation=function(){var e,t;this.mask&&GameCore.Configs.EnableEffectSceneTransition&&(null==(e=this.fadeInAnim)||e.remove(),null==(t=this.fadeOutAnim)||t.remove(),this.fadeOutAnim=new c.Z({targets:[this.mask],duration:400,ease:Phaser.Math.Easing.Cubic.Out,props:{alpha:{start:.6,from:.6,to:0}}}),this.mask.setAlpha(1),this.fadeOutAnim.play())},n.listenScenesEvents=function(){var e=this;this.scene.manager.getScenes(!1).forEach((function(t){t.events.on(Phaser.Scenes.Events.CREATE,e.emitGameEventStartScene),t.events.on(Phaser.Scenes.Events.SLEEP,e.emitGameEventSleepScene),t.events.on(Phaser.Scenes.Events.WAKE,e.emitGameEventWakeScene),t.events.on(Phaser.Scenes.Events.PAUSE,e.emitGameEventPauseScene),t.events.on(Phaser.Scenes.Events.RESUME,e.emitGameEventResumeScene),t.events.on(Phaser.Scenes.Events.SHUTDOWN,e.emitGameEventShutdownScene)})),this.events.on(l.K.SWITCH,this.switchScene)},n.getActiveScene=function(){return this.scene.manager.getScenes(!0)[0]},n.getCurrentScene=function(){return this.currentScene},n.updateActiveSceneKey=function(e){e!==l.C.GLOBAL_SCENE&&this.storage.dispatch((0,d.I)(e))},n.logEventOpen=function(){},n.logPageviewOnOpen=function(){},(0,i.Z)(t,[{key:"currentScene",get:function(){var e=this.storage.getState(),t=f(e);return(t?this.scene.manager.getScene(t):this.getActiveScene()).scene}}]),t}(g.Z),G=R},418:function(e,t,n){"use strict";var i=n(52),a=n.n(i),r=n(23),s=n.n(r),o=function(e,t){return void 0===t&&(t=1),a()({length:Math.ceil(e.length/t)},(function(n,i){return s()(e).call(e,i*t,i*t+t)}))},c=n(24),u=n.n(c),l=n(39),h=n.n(l),d=function(e,t){return u()(e).call(e,(function(e){return!h()(t).call(t,e)}))},f=function(e){for(var t=e.length-1;t>0;t--){var n=Math.floor(Math.random()*(t+1)),i=[e[n],e[t]];e[t]=i[0],e[n]=i[1]}},p=n(31),g=n.n(p),m=function(e,t,n){return g()(n).call(n,e)===t&&null!==e&&void 0!==e},v=function(e){return u()(e).call(e,m)},y={chunk:o,difference:d,shuffle:f,unique:v},b=n(38),S=n.n(b),T=n(284),E=n.n(T),C=E()((function(e,t){if("string"===typeof e){var n=t[e.toLowerCase()];if("string"===typeof n)return n}return"?"})),A=E()((function(e){for(var t=null,n=[],i=/:([A-Z0-9?]+)/gm;null!==(t=i.exec(e));)n.push(t[1]);return n})),w=E()((function(e){for(var t=null,n=[],i=/([0-9]+[A-Z?]{1}|[A-Z?]{1})/gm;null!==(t=i.exec(e));){var a=t[0];if(a.length>=2){var r,o=a.length,c=s()(a).call(a,0,o-1),u=a[o-1],l=S()(r=new Array(+c)).call(r,u);n.push.apply(n,l)}else n.push(a)}return n})),I=function(e,t){var n=e,i=GameCore.Utils.Object.invert(t),a={},r=0,s=0;return A(n).forEach((function(e){r=0,s++,a[s]||(a[s]={}),w(e).forEach((function(e){r++,a[s][r]=C(e,i)}))})),a},P=E()((function(e,t){var n=t[e];return"string"===typeof n?""+n.toUpperCase():"?"})),k=function e(t,n,i){void 0===i&&(i=!1);var a="";if(!GameCore.Utils.Valid.isObject(t))return a;var r="",o=1;for(var c in t)if(GameCore.Utils.Object.hasOwn(t,c)){var u=t[c];if(GameCore.Utils.Valid.isObject(u))a+=":"+e(u,n,!0);else if(GameCore.Utils.Valid.isString(u)){var l=P(u,n);l===r?(o++,a=s()(a).call(a,0,-2)):o=1,a+=""+o+l,r=l}}return a=a.replace(/1([A-Z])/g,"$1")},x=function(e,t){try{if(!e)return"";if(t){var n=atob(e),i=btoa(t);return n=n.replace(i,"="),atob(n)}return atob(e)}catch(a){return console.warn("Error in hashToString",a),""}},_=function(e,t){try{if(!e)return"";if(t){var n=btoa(e),i=btoa(t);return n=n.replace("=",i),btoa(n)}return btoa(e)}catch(a){return console.warn("Error in stringToHash",a),""}},O=function(){var e={},t=0;e["="]=t++,e["["]=t++,e["]"]=t++,e[","]=t++,e['"']=t++,e[":"]=t++,e["{"]=t++,e["}"]=t++;for(var n=48;n<=57;n++)e[String.fromCharCode(n)]=t++;e['suits":["']=t++,e.clubs=t++,e.diamonds=t++,e.hearts=t++,e.spades=t++,e.id=t++,e['piles":']=t++,e['type":"prebuilt"']=t++,e['type":"dynamic"']=t++,e['difficulty":"random"']=t++,e['difficulty":"easy"']=t++,e['difficulty":"medium"']=t++,e['difficulty":"hard"']=t++,e['mainMissions":{']=t++,e.win=t++;for(var i=1;i<=8;i++)e["finish"+i+"Run"]=t++;for(var a=1;a<=9;a++)e["clear"+a+"Column"]=t++;e['foundations":']=t++,e['startingCards":']=t++,e['startingLayout":"']=t++,e['difficulty":"dynamic"']=t++,e['type":"journey"']=t++,e['journeyData":{']=t++,e['stock":"']=t++,e['pileData":{']=t++;for(var r=0;r<=9;r++)e["pile"+r+'":"']=t++;return e}(),D=function(){for(var e={},t=5,n=["c","d","h","s"],i=1;i<=13;i++)for(var a=0;a<4;a++)e[""+i+n[a]]=t++,e[","+i+n[a]]=t++;for(var r=1;r<=13;r++)for(var s=0;s<4;s++)e["-"+r+n[s]]=t++,e[",-"+r+n[s]]=t++;return e}(),B=function(){var e=[];e.push('startingLayout":"'),e.push('stock":"');for(var t=0;t<=9;t++)e.push("pile"+t+'":"');return e}(),L=function(e){for(var t=!1,n="",i=[],a=0;a<e.length;a++){var r=e[a],s=n+r;'"'===r&&t&&(t=!1);var o=t?D:O;o[s]?(i.push(o[s]),h()(B).call(B,s)&&(t=!0),n=""):n=s}return i},R=n(94),G=n.n(R),N=n(29),M=n.n(N),F=function(e){var t;return G()(t=M()(e)).call(t,(function(t,n){return t[e[n]]=n,t}),{})},U=F(D),Z=F(O),H=function(e){for(var t=Z,n=U,i=!1,a="",r=0;r<e.length;r++){var s=e[r];4===e[r]&&i&&(i=!1);var o=i?n:t;if(!o[s]){console.warn("Invalid code in LZW decompression: ",s);break}a+=o[s],h()(B).call(B,o[s])&&(i=!0)}return a},W=n(7),z=n.n(W),Y=function(e){for(var t=[],n=0;n<e.length;n++)t.push(e.charCodeAt(n)-48);return t},V={decodeMap:I,encodeMap:k,hashToString:x,stringToHash:_,lzwCompress:L,lzwDecompress:H,encodeLZWCompress:function(e){return z()(e).call(e,(function(e){return String.fromCharCode(e+48)})).join("")},decodeLZWCompress:Y},K=function(e){try{return JSON.parse(e)}catch(t){return null}},j=n(40),X=n.n(j),J=function(e){try{return X()(e,null,0)}catch(t){return""}},q=function(e){return K(J(e))},Q={clone:q,decode:K,encode:J},$=function(e){var t="object"===typeof e||"function"===typeof e,n=Array.isArray(e);return null!==e&&t&&!n},ee=function(e){return void 0===e||null===e},te=function e(t){if(!$(t))return t;for(var n in t){ee(t[n])&&delete t[n];var i=t[n];$(i)&&(t[n]=e(i))}return t},ne=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},ie=function(e){var t={};return M()(e).forEach((function(n){if(ne(e,n)){var i=e[n];"string"===typeof i&&(t[i]=n)}})),t},ae=function(e,t){if(!Array.isArray(e))return{};var n={};return e.forEach((function(e){if(ne(e,t)){var i=e[t];"string"===typeof i&&(n[i]=e)}})),n},re={clear:te,hasOwn:ne,invert:ie,keyBy:ae},se=function(e){return e?e[0].toUpperCase()+s()(e).call(e,1):e},oe=function(e){var t=0;if(0==e.length)return t;for(var n=0;n<e.length;n++){t=(t<<5)-t+e.charCodeAt(n),t&=t}return t},ce=function(e){var t;return G()(t=M()(e)).call(t,(function(t,n){var i=e[n];return void 0!==i&&t.push(n+"="+i),t}),[]).join("&")},ue=function(e){void 0===e&&(e="0x");for(var t=e,n=0;n<6;n++)t+="0123456789ABCDEF"[Math.floor(16*Math.random())];return t},le=function(e,t){var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789*#%&!",i="",a=e;void 0!=t&&(a-=t.length,i+=t);for(var r=0;r<a;r++){var s=Math.floor(Math.random()*n.length);i+=n.charAt(s)}return i},he=function(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[\u0111\u0110]/g,(function(e){return"\u0111"===e?"d":"D"}))},de=n(5),fe=n.n(de),pe=n(430),ge=n.n(pe),me=function(e,t){var n,i=e.split(" "),a=(i.length<=1?fe()(n=[]).call(n,i):[i[0],i.pop()]).join(" "),r=ge()(a).call(a," ")||0,s=r>=0?r:t;return(a.length>t?a.substring(0,s):a).substring(0,t)},ve=n(132),ye=n.n(ve),be=function(e){void 0===e&&(e=16);var t=function(t){return Math.floor(t).toString(e)};return t(Date.now()/1e3)+ye()(" ").call(" ",e).replace(/./g,(function(){return t(Math.random()*e)}))},Se=function(e,t){if(0==t.length)return e;for(var n=e,i=0;i<t.length;i++)n=n.replace(/{}/,""+t[i]);return n},Te={capitalize:se,hashCode:oe,params:ce,toCamelCase:function(e){var t=e.replace(/[-_\s.]+(.)?/g,(function(e,t){return t?t.toUpperCase():""}));return t.substr(0,1).toLowerCase()+t.substr(1)},toUpperCamelCase:function(e){var t=e.replace(/[-_\s.]+(.)?/g,(function(e,t){return t?t.toUpperCase():""}));return t.substr(0,1).toUpperCase()+t.substr(1)},randomColor:ue,random:le,removeDiacritics:he,getShortName:me,generateObjectId:be,replaceVariables:Se},Ee=function(e){return"boolean"===typeof e},Ce=function(){return true},Ae=function(e){return"function"===typeof e},we=function(e){return"number"===typeof e},Ie=function(e){var t;return g()(t=["string","number","symbol"]).call(t,typeof e)>-1},Pe=function(e){return"string"===typeof e},ke=n(16),xe=n.n(ke),_e=function(e,t,n){var i=n||{},a=i.timeout,r=void 0===a?1e3:a,s=i.checkInterval,o=void 0===s?100:s;return new(xe())((function(n){var i=setInterval((function(){("function"===typeof e?e():e)===("function"===typeof t?t():t)&&(clearInterval(i),n(!0))}),o);r>0&&setTimeout((function(){clearInterval(i),n(!1)}),r)}))},Oe=function(e){var t=e.scene,n=e.key,i=e.newKey,a=t.textures.get(n).getSourceImage();if(!a)return!1;var r=Math.min(a.width,a.height);i||t.textures.removeKey(n);var s=t.textures.createCanvas(i||n,r,r),o=s.context;return o.beginPath(),o.arc(r/2,r/2,r/2,0,2*Math.PI,!1),o.clip(),s.draw((a.width-r)/2,(a.height-r)/2,a),!0},De=function(e){var t=e.scene,n=e.key,i=e.newKey,a=e.radius,r=e.width,s=e.height,o=t.textures.get(n).getSourceImage();if(!o)return!1;r||(r=o.width),s||(s=o.height),i||t.textures.removeKey(n);var c=t.textures.createCanvas(i||n,r,s),u=c.context,l=Math.min(r,s)/100*a/2;return u.beginPath(),u.moveTo(0+l,0),u.lineTo(0+r-l,0),u.quadraticCurveTo(0+r,0,0+r,0+l),u.lineTo(0+r,0+s-l),u.quadraticCurveTo(0+r,0+s,0+r-l,0+s),u.lineTo(0+l,0+s),u.quadraticCurveTo(0,0+s,0,0+s-l),u.lineTo(0,0+l),u.quadraticCurveTo(0,0,0+l,0),u.closePath(),u.clip(),c.draw(0,0,o),!0},Be=function(e){if(g()(e).call(e,".")<0)return e;for(var t=e.length-1;t>=0;t--){if("."==e[t])return e.substring(0,t);if("0"!=e[t])return e.substring(0,t+1)}return e},Le=function(e,t){var n=t||{},i=n.fractionalDigits,a=void 0===i?0:i,r=n.startAbbreviate,s=void 0===r?1e3:r,o=n.abbreviateStep,c=void 0===o?3:o,u=n.maxLength,l=void 0===u?-1:u,h=n.removeLastZero,d=void 0===h||h,f=n.suffixes,p=void 0===f?["","k","m","b","t","q"]:f,g=-1===l?99999999:l;if(e>=s){var m=Math.floor(e/Math.pow(10,c)),v=Math.floor((m.toString().length-1)/c)+1,y=(e/Math.pow(Math.pow(10,c),v)).toFixed(a),b=g-p[v].length,S=y.substring(0,b);return(d?Be(S):S)+p[v]}var T=e.toFixed(a),E=g-p[0].length,C=T.substring(0,E);return d?Be(C):C+p[0]},Re=function(e,t,n){void 0===n&&(n="0");for(var i=e.toString(),a=i.length,r=0;r<t-a;r++)i=n+i;return i},Ge=function(e,t,n){void 0===n&&(n="0");for(var i=e.toString(),a=i.length,r=0;r<t-a;r++)i+=n;return i},Ne={Array:y,Hash:V,Json:Q,Object:re,String:Te,Valid:{isBoolean:Ee,isDebugger:Ce,isFunction:Ae,isNumber:we,isObject:$,isPropertyKey:Ie,isString:Pe,isValueChangeAsync:_e},Image:{drawCircle:Oe,drawBorder:De},Number:{toAbbreviatedString:Le,padStart:Re,padEnd:Ge},Device:{isDesktop:function(){var e=navigator.userAgent;return/Windows|Mac OS/i.test(e)&&!/like Mac OS/.test(e)},isMobile:function(){var e=navigator.userAgent;return/Android|iP[ao]d|iPhone/i.test(e)},isAndroid:function(){return"ANDROID"===FBInstant.getPlatform()},isIOS:function(){return"IOS"===FBInstant.getPlatform()},isMobileWeb:function(){return"MOBILE_WEB"===FBInstant.getPlatform()},pixelRatio:function(){return Math.round(window.devicePixelRatio)||1}}},Me=n(12),Fe=n(523),Ue=.8+function(){var e=document,t=e.body,n=e.documentElement,i=t.clientWidth,a=n.clientWidth;return Math.max(a,i)||0}()/function(){var e=document,t=e.body,n=e.documentElement,i=t.clientHeight,a=n.clientHeight;return Math.max(a,i)||0}()/2,Ze={AppId:"1944110049277385",ApiHost:"https://fbig-singleplay-apps-dev.sunstudio.io",OtherHost:"https://leaderboards-dev.sunstudio.io",Ads:{Mockup:{Enable:!0,GiphyApiKey:"VmjHIRsfrwCAssDS4mDo9DoImxJm1lLM"}}},He={ENV:"production",AppId:"962427731841249",ApiHost:"https://fbig-singleplay-apps.citigo.site",OtherHost:"https://fbig-leaderboards.citigo.site",Notification:{Enable:!0,ApiUrl:"https://notifications.sunstudio.io",GameTitle:"Solitaire",GameImage:"https://static-tt.citigo.site/fbig-singleplay-apps/solitaire-classic.jpg"},LeadersBoard:{Prefix:"leaderboards"},Debugger:{ShowInspector:!1,ShowMonitoring:!1,ShowConsole:!1},Statistics:{Enable:!1,ShowFPSInGame:!1,ShowMemoryInGame:!1},Rollbar:{Enable:!1}},We={ENV:"development",AppId:"",ApiHost:"https://fbig-singleplay-apps-dev.sunstudio.io",OtherHost:"https://leaderboards-dev.sunstudio.io",SyncProfileFromAPI:!0,Notification:{Enable:!1,ApiUrl:"https://notifications.sunstudio.io",GameTitle:"Sun Studio",GameImage:"https://sunstudio.io/images/logo.png",DisableSendNotification:!1},PlayerMock:{id:"",signature:""},OpponentMock:{id:"",signature:""},MatchMockFailRate:5,Gameplay:{StartLevel:1,StartScore:0,StartDiamonds:0,LevelDifficultRate:{FromUnder30:1.07,FromUnder35:1.05,FromUnder45:1.05,FromUnder200:1.1},StartAdAtLevel:2,NewUserEasyGameCount:5,GiftTime:10800,AwardDiamonds:100,FreeItems:!1,DelayStart:2e3,DelayLevelUp:1800,DelayFinishGame:2900,EnableVibrate:!0},Tutorial:{ForceUseTutorial:!1,NumberOfTutorial:{FirstMove:3,TargetScore:1,CurrentScore:1,ColorfulGem:1,ItemPaint:1,ItemHammer:1,ItemShuffle:1}},PlayerDataStore:"playerData",Game:{AutoResize:!0,PortraitRatio:375/518,PortraitWidth:375,PortraitHeight:667,LandscapeRatio:760/360,LandscapeWidth:760*Ue,LandscapeHeight:360*Ue,ForcePixelRatio:0,DisableLandscape:!1,FullSizeOnLandscape:!0},Debugger:{ShowInspector:!1,ShowMonitoring:!1,ShowConsole:!1,Expanded:!0,AutoRefresh:!0,InspectorAutoUpdate:!0,Opacity:.8},Statistics:{Enable:!1,DisplayMode:0,FPS:!0,MS:!0,MB:!0,Opacity:.8,ShowFPSInGame:!0,ShowMemoryInGame:!1},ParticleEditor:{Enable:!1,Opacity:.8,Expanded:!0},ProfilerPlugin:{Enable:!1},Match:{MaxRescueCount:1,RescueGamePopupTimeout:15,ContinueSingleMatchEnabled:!1,SingleMatchStore:"singleMatch",LocalSingleMatchDefault:{_id:"12345678890",status:"open",playerId:"",score:0,level:1,startedAt:0,updateAt:0,finishAt:0,data:{}}},Tournament:{UseMock:!1,ForcePlay:!1,UseLeaderboard:!1,TournamentContextIds:[]},LeadersBoard:{UseMock:!1,Prefix:"leaderboards",LeaderboardId:"",Limit:50},LanguageSupport:{en:"en"},EnableEffectSceneTransition:!0,DefaultTheme:"default",ThemeSupport:{default:"default"},Ads:{Enabled:!0,InterstitialPlacementId:"",VideoRewardsPlacementId:"",BannerPlacementId:"",BannerReloadPeriod:60,BannerHeight:{Desktop:70,Mobile:50},Mockup:{Enable:!1,ErrorRate:5,GiphyApiKey:""},InterstitialAdOptions:{secondsFirstTime:0,secondsBetweenAds:60},CompleteStackAdSeconds:300},Network:{MaximumRequest:6,Timeout:15e3,Retries:3},Analytics:{GoogleAnalytics:{consoleLog:!1},FacebookAnalytics:{prefix:"fba",consoleLog:!1}},Sentry:{errorCodes:{accepted:[],ignored:["USER_INPUT","NETWORK_FAILURE"]},errorMessages:{accepted:[],ignored:["Load image failed"]}},Rollbar:{Enable:!1,UseMockup:!1,FilterError:{Codes:{accepted:[],ignored:["USER_INPUT","NETWORK_FAILURE"]},Messages:{accepted:[],ignored:["Load image failed"]}},ListPlayerDevIds:[]},Performance:{Enable:!1,trackingSceneKeys:["DASHBOARD_SCENE","GAME_SCENE"],minQuality:1,maxQuality:2,fpsThreshold:48,checkInterval:2e3,qualityAdjustStep:.1,autoUpgradeQuality:!0,onlyUpdateWhenSwitchScene:!0}};We=(0,Fe.TS)((0,Me.Z)({},We),He);var ze=We=(0,Fe.TS)((0,Me.Z)({},We),Ze),Ye=function(e){return function(t){try{var n=window.game,i=t.module;if(n.scene.getScenes(!0)[0].scene.key!==e)return;var a=i.default;n.scene.remove(e),n.scene.add(e,a,!0),n.scene.bringToTop(n.globalScene),console.log("%c HotScene: ","font-size:12px;background-color: #465975;color:#fff;",e)}catch(s){var r;null==(r=void 0)||r.invalidate()}}},Ve=n(434),Ke=n.n(Ve),je=n(436),Xe=n.n(je),Je=n(438),qe=n.n(Je),Qe=n(524),$e=!1,et=function e(t,n,i){n.forEach((function(n){if(n.name){var a=null;if(a=i?i.getByName(n.name):t.children.getByName(n.name),$e&&console.log("%c Checking object: ","font-size:12px;background-color: #465975;color:#fff;",n.name,n.type),a){if("Container"===n.type){var r=a,s=n.getAll();if(e(t,s,r),!r.hotContainer)return;console.log("%c Update container: ","font-size:12px;background-color: #33A5FF;color:#fff;",r.name)}var o=Ke()(n),c=["_events","_sysEvents","input","localTransform","list","displayList"],l=u()(o).call(o,(function(e){if("string"!==typeof e)return!1;if(g()(c).call(c,e)>=0)return!1;if(!a)return!1;var t=Xe()(n,e);return!(t instanceof Function)&&(!(t instanceof Phaser.Scene)&&(!(t instanceof Phaser.GameObjects.Group)&&(!(t instanceof Phaser.GameObjects.GameObject)&&t===Xe()(a,e))))}));l.length<1||($e&&console.log("%c HotObject: ","font-size:12px;background-color: #2EAFB0;color:#fff;",n.name,l),l.forEach((function(e){if(a){var t=Xe()(n,e),i=Xe()(a,e),r=qe()(a,e,t);$e&&console.log("%c Update property: ","font-size:12px;background-color: #B03734;color:#fff;",r,e,{oldValue:i,newValue:t})}})))}}}))},tt={Configs:ze,Utils:Ne,LiveUpdate:{Scene:Ye,SceneObjects:function(e,t){return void 0===t&&(t=$e),function(n){try{var i=window.game,a=n.module,r=i.scene.getScenes(!0)[0];if(r.scene.key!==e)return;$e=t;var s=a.default,o=e+"-draft";i.scene.remove(o);var c=i.scene.add(o,s);console.log("%c HotSceneObjects: ","font-size:12px;background-color: #465975;color:#fff;",e),r=i.scene.getScene(e),c.events.once(Phaser.Scenes.Events.RENDER,(0,Qe.D)((function(){var e=c.children.getAll();et(r,e),i.scene.remove(o)})),50),i.scene.run(o),i.scene.bringToTop(r),i.scene.bringToTop(i.globalScene)}catch(u){console.warn(u)}}}}};window.GameCore=tt;console.warn("production",{Configs:ze,isDebugger:Ne.Valid.isDebugger()});var nt,it=tt,at=n(525),rt=n(119),st=n(1),ot=n(0),ct=n(2),ut=n.n(ct),lt=n(527),ht=0,dt=0,ft=function(){function e(e){this.game=void 0,this.progressFbTimeEvent=void 0,this.game=e}var t=e.prototype;return t.loadingProgressFbBootScene=function(){var e=this,t=100;dt=30;!function n(){t<=0?clearTimeout(e.progressFbTimeEvent):e.progressFbTimeEvent=setTimeout((function(){e.game.facebook.setLoadingProgress(Math.round(dt)),dt+=30/t,t--,n()}),50)}()},t.finishLoadingProgressFbBootScene=function(){clearTimeout(this.progressFbTimeEvent)},t.loadingProgressFbLoadScene=function(){var e=this;(!dt||dt<30)&&(dt=60),ht=dt;!function t(){e.progressFbTimeEvent=setTimeout((function(){e.game.facebook.setLoadingProgress(Math.round(dt)),dt+=.1,t()}),50)}()},t.onProgress=function(e){var t=100-dt,n=Math.round(e*t+dt);n>ht&&clearTimeout(this.progressFbTimeEvent),this.game.facebook.setLoadingProgress(n)},e}(),pt=ft,gt=function(){function e(e){this.game=void 0,this.game=e}var t=e.prototype;return t.addKillRevive=function(){var e=this;[Phaser.GameObjects.RenderTexture,Phaser.GameObjects.Container,Phaser.GameObjects.Image,Phaser.GameObjects.Sprite,Phaser.GameObjects.Graphics,Phaser.GameObjects.Shape,Phaser.GameObjects.Text,Phaser.GameObjects.BitmapText,Phaser.GameObjects.Particles.ParticleEmitter,Phaser.GameObjects.Particles.ParticleEmitterManager].forEach((function(t){t.prototype.kill=e.kill,t.prototype.revive=e.revive}))},t.addKillReviveGroup=function(){Phaser.GameObjects.Group.prototype.killGroup=this.killGroup,Phaser.GameObjects.Group.prototype.reviveGroup=this.reviveGroup},t.addSetWorldSize=function(){var e=this;[Phaser.GameObjects.RenderTexture,Phaser.GameObjects.Image,Phaser.GameObjects.Sprite].forEach((function(t){t.prototype.setWorldSize=e.setWorldSize}))},t.addSetWorldSizeForContainer=function(){var e=this;[Phaser.GameObjects.Container].forEach((function(t){t.prototype.setWorldSize=e.setWorldSizeForContainer}))},t.addGetWorldPosition=function(){var e=this;[Phaser.GameObjects.RenderTexture,Phaser.GameObjects.Container,Phaser.GameObjects.Image,Phaser.GameObjects.Sprite,Phaser.GameObjects.Graphics,Phaser.GameObjects.Shape,Phaser.GameObjects.Text,Phaser.GameObjects.BitmapText].forEach((function(t){t.prototype.getWorldPosition=e.getWorldPosition}))},t.addDrawDebugBox=function(){var e=this;[Phaser.GameObjects.RenderTexture,Phaser.GameObjects.Container,Phaser.GameObjects.Image,Phaser.GameObjects.Sprite,Phaser.GameObjects.Graphics,Phaser.GameObjects.Shape,Phaser.GameObjects.Text,Phaser.GameObjects.BitmapText,Phaser.GameObjects.Zone].forEach((function(t){t.prototype.drawDebugBox=e.drawDebugBox}))},t.addHighQuality=function(){var e=this;[Phaser.GameObjects.Text].forEach((function(t){t.prototype.setHighQuality=e.setHighQuality}))},t.kill=function(){this.setActive(!1),this.setVisible(!1)},t.revive=function(){this.setActive(!0),this.setVisible(!0)},t.killGroup=function(){this.getChildren().forEach((function(e){e.setActive(!1),e.setVisible(!1)}))},t.reviveGroup=function(){this.getChildren().forEach((function(e){e.setActive(!0),e.setVisible(!0)}))},t.setWorldSize=function(e,t){this.setSize(e,t),this.setDisplaySize(e,t)},t.setWorldSizeForContainer=function(e,t,n){void 0===n&&(n=2),this.setSize(e*n,t*n),this.setDisplaySize(e,t)},t.getWorldPosition=function(){var e=this.getWorldTransformMatrix().decomposeMatrix();return{x:e.translateX,y:e.translateY}},t.drawDebugBox=function(e,t){var n=this.x,i=this.y,a=this.width,r=this.height,s=this.depth,o=this.originX,c=this.originY,u=this.scene.add.rectangle(n,i,a,r,e,t);u.setName("Debug Box"),u.setDepth(s);var l=GameCore.Utils.Valid.isNumber;return l(o)&&l(c)&&u.setOrigin(o,c),u},t.setHighQuality=function(){return this.renderer instanceof Phaser.Renderer.WebGL.WebGLRenderer?this.setResolution(2*this.scene.game.world.getZoomRatio()):this},e}(),mt=gt,vt=n(57),yt=n.n(vt),bt=GameCore.Configs.Ads.Mockup.GiphyApiKey,St=function(){function e(){}return e.loadBannerAdAsync=function(){var e=(0,st.Z)(ut().mark((function e(){var t,n,i,a,r;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getAdContentAsync();case 2:if(t=e.sent,!(n=document.getElementById("mock-banner-ads"))){e.next=11;break}if((i=n.getElementsByTagName("img"))&&!(i.length<=0)){e.next=8;break}return e.abrupt("return");case 8:i[0].src=t,e.next=27;break;case 11:(a=document.createElement("div")).id="mock-banner-ads",a.style.width="100%",a.style.height="50px",a.style.bottom="var(--sab)",a.style.position="fixed",a.style.background="#fff url("+t+") center center/auto no-repeat",a.style.outline="2px solid #ffffff40",a.style.outlineOffset="-2px",r=document.createElement("style"),(document.head||document.getElementsByTagName("head")[0]).appendChild(r),"@keyframes fake-gif {\n                0%,10% {\n                    background-position-y: top\n                }\n                60% {\n                    background-position-y: center\n                }\n                100% {\n                    background-position-y: bottom\n                }\n            }",r.appendChild(document.createTextNode("@keyframes fake-gif {\n                0%,10% {\n                    background-position-y: top\n                }\n                60% {\n                    background-position-y: center\n                }\n                100% {\n                    background-position-y: bottom\n                }\n            }")),a.style.animation="fake-gif 6s ease-in-out 0s infinite alternate both",document.body.appendChild(a);case 27:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),e.getAdContentAsync=function(){var e=(0,st.Z)(ut().mark((function e(){var t,n,i,a,r;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="https://api.giphy.com/v1/gifs/trending?api_key="+bt+"&rate=pg&bundle=low_bandwidth",e.next=3,fetch(t,{method:"GET"});case 3:return n=e.sent,e.next=6,n.json();case 6:if(i=e.sent,GameCore.Utils.Valid.isObject(i)){e.next=9;break}return e.abrupt("return","");case 9:return a=i.data,r=Math.floor(Math.random()*a.length),e.abrupt("return",a[r].images.downsized.url);case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),e.hideBannerAdAsync=function(){var e=(0,st.Z)(ut().mark((function e(){var t;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=document.getElementById("mock-banner-ads")){e.next=3;break}return e.abrupt("return");case 3:t.remove();case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),e}(),Tt={LOADED:"loaded",DISPLAYED:"displayed"};!function(e){e.IDLE="idle",e.LOADING="loading",e.FILLED="filled",e.SHOWING="showing"}(nt||(nt={}));var Et,Ct=nt;!function(e){e.REWARDED="rewarded",e.INTERSTITIAL="interstitial"}(Et||(Et={}));var At=Et,wt=n(27),It=function(e){function t(t,n){var i;return(i=e.call(this,n)||this).code=void 0,i.code=t,i.message=n,i}return(0,ot.Z)(t,e),t}((0,wt.Z)(Error)),Pt=function(e){this.type=void 0,this.status=void 0,this.type=e,this.status=Ct.IDLE};GameCore.Ads={Types:At,Status:Ct,Events:Tt,AdError:It,AdInstance:Pt};var kt=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return(n=e.call.apply(e,fe()(t=[this]).call(t,a))||this).events=void 0,n.enabled=void 0,n.config=void 0,n.lastAdShownTime=void 0,n.intervalBannerAd=void 0,n.interstitial=void 0,n.rewardedVideo=void 0,n.safeAreaBottom=void 0,n.loadBannerAdAsync=(0,st.Z)(ut().mark((function e(){var t;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n.enabled){e.next=3;break}return e.abrupt("return");case 3:if(!GameCore.Configs.Ads.Mockup.Enable){e.next=8;break}return e.next=7,St.loadBannerAdAsync();case 7:return e.abrupt("return");case 8:return t=n.config.bannerPID,e.next=11,FBInstant.loadBannerAdAsync(t);case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),console.log(e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,13]])}))),n}(0,ot.Z)(t,e);var n=t.prototype;return n.init=function(){this.events=new Phaser.Events.EventEmitter,this.lastAdShownTime=0,this.calculateSafeAreaBottom()},n.calculateSafeAreaBottom=function(){try{this.safeAreaBottom=yt()(getComputedStyle(document.documentElement).getPropertyValue("--sab")),isNaN(this.safeAreaBottom)&&(this.safeAreaBottom=0)}catch(e){this.safeAreaBottom=0}},n.configure=function(e,t){this.enabled=t.enabled,this.config=t,this.setAdInstance(e)},n.setAdInstance=function(e){var t=this.config,n=t.interstitialPID,i=t.rewardedVideoPID;this.interstitial=new e(At.INTERSTITIAL,n),this.rewardedVideo=new e(At.REWARDED,i)},n.preloadInterstitialAdAsync=function(){var e=(0,st.Z)(ut().mark((function e(){return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.preloadAdAsync(At.INTERSTITIAL);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.showInterstitialAdAsync=function(){var e=(0,st.Z)(ut().mark((function e(){return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.canbeShowInterstitialAd()){e.next=2;break}throw new It("INTERSTITIAL_AD_CAN_NOT_SHOW","Can't show interstitial ad");case 2:return e.next=4,this.showAdAsync(At.INTERSTITIAL);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.preloadRewardedVideoAsync=function(){var e=(0,st.Z)(ut().mark((function e(){return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.preloadAdAsync(At.REWARDED);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.showRewardedVideoAsync=function(){var e=(0,st.Z)(ut().mark((function e(){return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.showAdAsync(At.REWARDED);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.preloadAdAsync=function(){var e=(0,st.Z)(ut().mark((function e(t){var n;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.enabled){e.next=2;break}throw new It("ADS_NOT_ENABLED","Ads is't enabled");case 2:if(null!==(n=this.getAdInstanceByType(t))){e.next=5;break}throw new It("AD_INSTANCE_NOT_INITIATED","The instance ads not yet initiated");case 5:return e.next=7,n.loadAsync();case 7:this.events.emit(Tt.LOADED,t);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.showAdAsync=function(){var e=(0,st.Z)(ut().mark((function e(t){var n;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.enabled){e.next=2;break}throw new It("ADS_NOT_ENABLED","Ads is't enabled");case 2:if(null!==(n=this.getAdInstanceByType(t))){e.next=5;break}throw new It("AD_INSTANCE_NOT_INITIATED","The instance ads not yet initiated");case 5:return this.lastAdShownTime=window.performance.now()/1e3,e.next=8,n.showAsync();case 8:this.events.emit(Tt.DISPLAYED,t);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.getAdStatus=function(e){var t=this.getAdInstanceByType(e);return t?t.getStatus():null},n.getAdInstanceByType=function(e){switch(e){case At.INTERSTITIAL:return this.interstitial;case At.REWARDED:return this.rewardedVideo;default:return null}},n.canbeShowInterstitialAd=function(){return this.canbeShowInterstitialAdByTime()},n.canbeShowInterstitialAdByTime=function(){var e=window.performance.now()/1e3,t=this.config.interstitialAdOptions,n=t.secondsFirstTime,i=t.secondsBetweenAds,a=e-this.lastAdShownTime;return this.lastAdShownTime>0?a>i:a>n},n.showBannerAdAsync=function(){var e=(0,st.Z)(ut().mark((function e(t){var n,i;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(t=!0),this.enabled){e.next=3;break}return e.abrupt("return");case 3:if(GameCore.Configs.Ads.Mockup.Enable||-1!==g()(n=FBInstant.getSupportedAPIs()).call(n,"loadBannerAdAsync")){e.next=6;break}return e.abrupt("return");case 6:return i=this.config.bannerReloadPeriod,this.intervalBannerAd&&clearInterval(this.intervalBannerAd),e.next=10,this.loadBannerAdAsync();case 10:t&&(this.intervalBannerAd=setInterval(this.loadBannerAdAsync,1e3*i));case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.hideBannerAdAsync=function(){var e=(0,st.Z)(ut().mark((function e(){return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,this.enabled){e.next=3;break}return e.abrupt("return");case 3:if(!GameCore.Configs.Ads.Mockup.Enable){e.next=8;break}return e.next=7,St.hideBannerAdAsync();case 7:return e.abrupt("return");case 8:return e.next=10,FBInstant.hideBannerAdAsync();case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.log(e.t0);case 15:return e.prev=15,this.intervalBannerAd&&clearInterval(this.intervalBannerAd),this.intervalBannerAd=null,e.finish(15);case 19:case"end":return e.stop()}}),e,this,[[0,12,15,19]])})));return function(){return e.apply(this,arguments)}}(),n.getBannerHeight=function(){if(!this.enabled)return 0;var e=this.safeAreaBottom,t=GameCore.Configs.Ads.BannerHeight,n=50;if(n=window.game.world.isLandscape()?0:t.Mobile,this.game.world){var i=this.game.world,a=i.getZoomRatio(),r=i.getPixelRatio();return this.game.world.getPhysicPixels(n+e,r/a)}return n+e},t}(Phaser.Plugins.BasePlugin),xt=kt,_t=function(){function e(e,t,n){this.name=void 0,this.color=void 0,this.selfLog=void 0,this.options=void 0,this.name=e,this.color=n||"#FFF",this.options=t,this.selfLog=!0,console.info("%c"+this.name+": init","color: "+this.color,this.options)}var t=e.prototype;return t.event=function(e,t,n){this.processEvent(e,t,n),this.selfLog&&console.info("%c"+this.name+": event","color: "+this.color,{name:e,value:n,payload:t})},t.pageview=function(e){var t=this.getPageByKey(e);this.processPageView(t),this.selfLog&&console.info("%c"+this.name+": pageview","color: "+this.color,{page:t})},t.levelStart=function(e,t,n){this.processLevelStart(e,t,n),this.selfLog&&console.info("%c"+this.name+": level start","color: "+this.color,{level:e,score:t,levelName:n})},t.levelFail=function(e,t,n){this.processLevelFail(e,t,n),this.selfLog&&console.info("%c"+this.name+": level fail","color: "+this.color,{level:e,score:t,levelName:n})},t.levelRescue=function(e,t,n){this.processLevelRescue(e,t,n),this.selfLog&&console.info("%c"+this.name+": level rescue","color: "+this.color,{level:e,score:t,levelName:n})},t.levelComplete=function(e,t,n){this.processLevelComplete(e,t,n),this.selfLog&&console.info("%c"+this.name+": level complete","color: "+this.color,{level:e,score:t,levelName:n})},t.showInterstitialAd=function(e){this.processShowInterstitialAd(e),this.selfLog&&console.info("%c"+this.name+": show interstitial ad","color: "+this.color,{placement:e})},t.showRewardedVideoAd=function(e){this.processShowRewardedVideoAd(e),this.selfLog&&console.info("%c"+this.name+": show rewarded video ad","color: "+this.color,{placement:e})},t.receiveReward=function(e){this.processReceiveReward(e),this.selfLog&&console.info("%c"+this.name+": receive reward","color: "+this.color,{placement:e})},t.showAdFail=function(e,t,n){this.processShowAdFail(e,t,n),this.selfLog&&console.info("%c"+this.name+": show ad fail","color: "+this.color,{type:e,placement:t,reason:n})},t.getPageByKey=function(e){var t=e.replace(/_/g,"-");return t=t.toLowerCase()},t.processLevelStart=function(e,t,n){},t.processLevelFail=function(e,t,n){},t.processLevelRescue=function(e,t,n){},t.processLevelComplete=function(e,t,n){},t.processShowInterstitialAd=function(e){},t.processShowRewardedVideoAd=function(e){},t.processReceiveReward=function(e){},t.processShowAdFail=function(e,t,n){},e}();GameCore.Analytics={BaseAnalytics:_t};var Ot=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return(n=e.call.apply(e,fe()(t=[this]).call(t,a))||this).analytics=void 0,n.pageview=function(e){n.isActive()&&n.analytics.forEach((function(t){t.pageview(e)}))},n}(0,ot.Z)(t,e);var n=t.prototype;return n.init=function(){this.analytics=[]},n.add=function(e){this.analytics.push(e)},n.event=function(e,t,n){this.isActive()&&this.analytics.forEach((function(i){i.event(e,t,n)}))},n.levelStart=function(e,t,n){this.isActive()&&this.analytics.forEach((function(i){i.levelStart(e,t,n)}))},n.levelRescue=function(e,t,n){this.isActive()&&this.analytics.forEach((function(i){i.levelRescue(e,t,n)}))},n.levelFail=function(e,t,n){this.isActive()&&this.analytics.forEach((function(i){i.levelFail(e,t,n)}))},n.levelComplete=function(e,t,n){this.isActive()&&this.analytics.forEach((function(i){i.levelComplete(e,t,n)}))},n.showInterstitialAd=function(e){this.isActive()&&this.analytics.forEach((function(t){t.showInterstitialAd(e)}))},n.showRewardedVideoAd=function(e){this.isActive()&&this.analytics.forEach((function(t){t.showRewardedVideoAd(e)}))},n.receiveReward=function(e){this.isActive()&&this.analytics.forEach((function(t){t.receiveReward(e)}))},n.showAdFail=function(e,t,n){this.isActive()&&this.analytics.forEach((function(i){i.showAdFail(e,t,n)}))},n.isActive=function(){return this.analytics.length>=1},t}(Phaser.Plugins.BasePlugin),Dt=Ot,Bt={BUTTON_CLICK:"button_click",POPUP_OFF:"popup_out",POPUP_SHOW:"popup_in",AUTO_COMPLETE:"auto_complete",CARD_MOVE:"card_move",FINISH_1:"finish1",FINISH_2:"finish2",FINISH_3:"finish3",FINISH_4:"finish4",FINISH_5:"finish5",FINISH_6:"finish6",FINISH_7:"finish7",FINISH_8:"finish8",FINISH_9:"finish9",FINISH_10:"finish10",FINISH_11:"finish11",FINISH_12:"finish12",FINISH_13:"finish13",HINT:"hint",NO_MOVE:"no_move",SHUFFLE:"shuffle",UNDO:"undo",WON:"won",DIAMONDS_EAT:"",FIREWORKS_SOAR:"",FIREWORKS_BIG:"",FIREWORKS_SMALL:"",DAILY_REWARD:"",SCORE_COUNTER:"",CONGRATULATION:"",YOU_WIN:"",YOU_LOSE:"",GIFT_CHARGE:"",GIFT_REVEAL:"",GIFT_EXPLODE:""},Lt=n(98),Rt=n.n(Lt),Gt={BACKGROUND:{KEY:"background",FILE:"./assets/music/bg_music.mp3"},EFFECTS:{KEY:"effects",FILE:"./assets/sounds/effects.mp3",JSON:"./assets/sounds/effects.json",PATH:"./assets/sounds/"}},Nt=function(){function e(e){var t=this;this.game=void 0,this.audios=void 0,this.volume=void 0,this.isMusicEnabled=function(){return!!t.game.player.getPlayerSetting("music")},this.isSoundEnabled=function(){return!!t.game.player.getPlayerSetting("sound")},this.game=e,this.audios=new(Rt())}var t=e.prototype;return t.play=function(e,t){var n=this,i=(0,Me.Z)({volume:this.volume},t||{});i.volume!==this.volume&&(i.volume*=this.volume);var a=this.audios.get(e);a?a.play(void 0,i):(this.game.globalScene.load.audio(e,Gt.EFFECTS.PATH+e+".ogg"),this.game.globalScene.load.on(Phaser.Loader.Events.FILE_KEY_COMPLETE+"audio-"+e,(function(){var t=n.game.sound.add(e);n.audios.set(e,t),t.play(void 0,i)})),this.game.globalScene.load.start())},t.pause=function(e){var t=this.audios.get(e);t&&t.pause()},t.stop=function(e){var t=this.audios.get(e);t&&t.stop()},t.setVolume=function(e){this.volume=e},e}(),Mt=Nt,Ft=function(){function e(e,t,n){var i=this;this.name=void 0,this.game=void 0,this.isSprite=void 0,this.audio=void 0,this.markers=void 0,this.volume=void 0,this.isMusicEnabled=function(){return!!i.game.player.getPlayerSetting("music")},this.isSoundEnabled=function(){return!!i.game.player.getPlayerSetting("sound")},this.name=t,this.game=e,this.markers={},this.isSprite=n,this.isSprite||(this.audio=this.game.sound.add(this.name))}var t=e.prototype;return t.play=function(e,t){var n,i,a,r=(0,Me.Z)({volume:this.volume},t||{});if(r.volume!==this.volume&&(r.volume*=this.volume),!this.isSprite)return(null==(i=this.audio)?void 0:i.seek)>0?void this.audio.resume():void(null==(a=this.audio)||a.play(e,r));this.createMaker(e),null==(n=this.markers[e])||n.play(e,r)},t.pause=function(e){var t,n;this.isSprite?null==(t=this.markers[e])||t.pause():null==(n=this.audio)||n.pause()},t.stop=function(e){var t,n;this.isSprite?null==(t=this.markers[e])||t.stop():null==(n=this.audio)||n.stop()},t.setVolume=function(e){this.volume=e},t.createMaker=function(e){if(!this.markers[e])try{this.markers[e]=this.game.sound.addAudioSprite(this.name)}catch(t){console.warn("createMaker",t)}},e}(),Ut=Ft,Zt=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return(n=e.call.apply(e,fe()(t=[this]).call(t,a))||this).soundManager=void 0,n.musicManager=void 0,n.isMuteAll=void 0,n.initMusic=function(e){n.musicManager=new Ut(n.game,e,!1),n.setMusicVolume(1)},n.initSound=function(){n.soundManager=new Mt(n.game),n.setSoundVolume(1)},n}(0,ot.Z)(t,e);var n=t.prototype;return n.playSound=function(e,t){try{if(!this.soundManager||this.isMuteAll||!this.game.visibility.isGameVisible())return;if(!this.soundManager.isSoundEnabled())return;this.soundManager.play(e,t)}catch(n){}},n.stopSound=function(e){try{this.soundManager.stop(e)}catch(t){}},n.playMusic=function(e){void 0===e&&(e={});try{if(!this.musicManager||this.isMuteAll||!this.game.visibility.isGameVisible())return;if(!this.musicManager.isMusicEnabled())return;this.musicManager.play("",(0,Me.Z)({loop:!0,volume:.2},e))}catch(t){}},n.pauseMusic=function(){try{if(!this.musicManager)return;this.musicManager.pause("")}catch(e){}},n.stopMusic=function(){try{if(!this.musicManager)return;this.musicManager.stop("")}catch(e){}},n.setSoundVolume=function(e){try{if(!this.soundManager)return;this.soundManager.setVolume(e)}catch(t){console.warn("setSoundVolume",t)}},n.setMusicVolume=function(e){try{if(!this.musicManager)return;this.musicManager.setVolume(e)}catch(t){console.warn("setMusicVolume",t)}},n.muteAll=function(){this.isMuteAll=!0,this.game.sound.mute=!0},n.unmuteAll=function(){this.isMuteAll=!1,this.game.sound.mute=!1},t}(Phaser.Plugins.BasePlugin),Ht=Zt,Wt=n(10),zt="AUTH_TOKEN_REQUEST",Yt="AUTH_TOKEN_RECEIVED",Vt=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).payload=void 0,i.name="RequestTokenFail",i.message=t||"Request token fail",i.payload=n||{},i}return(0,ot.Z)(t,e),t}((0,wt.Z)(Error)),Kt=n(537),jt=(0,Kt.P1)([function(e){return e.auth.token}],(function(e){return e})),Xt=(0,Kt.P1)([function(e){return e.auth.isRequesting}],(function(e){return e})),Jt=function(e){return{type:Yt,payload:{token:e}}},qt=function(e){function t(){return e.apply(this,arguments)||this}(0,ot.Z)(t,e);var n=t.prototype;return n.requestToken=function(){var e=(0,st.Z)(ut().mark((function e(){var t;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.game.storage,e.next=3,t.dispatch(function(){var e=(0,st.Z)(ut().mark((function e(t,n){var i,a,r,s;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,i=window.game.facebook,a=n(),r=jt(a),!Xt(a)&&""===r){e.next=7;break}return e.abrupt("return");case 7:return t({type:zt,payload:{}}),e.next=10,i.getPlayerToken();case 10:s=e.sent,t(Jt(s)),e.next=25;break;case 14:if(e.prev=14,e.t0=e.catch(0),!(e.t0 instanceof Object&&GameCore.Utils.Object.hasOwn(e.t0,"code"))){e.next=19;break}if("PENDING_REQUEST"!==e.t0.code){e.next=19;break}return e.abrupt("return");case 19:if(t(Jt("")),!(e.t0 instanceof Object&&GameCore.Utils.Object.hasOwn(e.t0,"message"))){e.next=24;break}if("string"!==typeof e.t0.message){e.next=24;break}return(0,at.tO)(new Error(e.t0.message)),e.abrupt("return");case 24:(0,at.tO)(new Vt);case 25:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t,n){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.getToken=function(){return jt(this.state)},(0,Wt.Z)(t,[{key:"state",get:function(){return this.game.storage.getState()}}]),t}(Phaser.Plugins.BasePlugin),Qt=qt,$t=function(e,t){void 0===t&&(t=1);var n=new Image;n.onload=function(){var n,i,a=(n=this.width*t,i=this.height*t,{string:"+",style:"font-size: 1px; padding: "+Math.floor(i/2)+"px "+Math.floor(n/2)+"px;"});console.info("%c "+a.string,a.style+" background: transparent url("+e+") no-repeat center center; background-size: "+this.width*t+"px "+this.height*t+"px;")},n.src=e},en=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return(n=e.call.apply(e,fe()(t=[this]).call(t,a))||this).width=void 0,n.height=void 0,n.renderOptions=void 0,n.canvas=void 0,n}(0,ot.Z)(t,e);var n=t.prototype;return n.preload=function(e){var t=this,n=M()(e);n.length<1||(n.forEach((function(n){t.scene.load.image(n,e[n])})),this.scene.load.start())},n.capture=function(){var e=(0,st.Z)(ut().mark((function e(t){var n,i,a;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.width,i=t.height,a=t.renderOptions,this.width=n,this.height=i,this.renderOptions=a,this.createCanvas(),e.next=7,this.loadImages();case 7:return this.drawObjects(),e.abrupt("return",this.snapshotFrame());case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.createCanvas=function(){this.canvas||(this.canvas=this.game.textures.createCanvas("FrameCaptureCanvas")),this.canvas.clear(),this.canvas.setSize(this.width,this.height)},n.loadImages=function(){var e=this;return new(xe())((function(t,n){for(var i in e.renderOptions){var a=e.renderOptions[i],r=a.name,s=a.image;if(s)e.scene.textures.get(r).key!==r&&e.scene.load.image(r,s)}e.scene.load.on(Phaser.Loader.Events.COMPLETE,t),e.scene.load.on(Phaser.Loader.Events.FILE_LOAD_ERROR,(function(){var e=new Error("Load image failed");n(e)})),e.scene.load.start()}))},n.drawObjects=function(){for(var e in this.renderOptions){var t=this.renderOptions[e];switch(t.type){case"text":this.drawText(t);break;case"image":this.drawImage(t)}}},n.drawText=function(e){var t=this.canvas.context,n=e.x,i=e.y,a=e.font,r=e.text,s=e.fillStyle,o=e.lineWidth,c=e.textAlign;t.font=a+' "Be Vietnam Pro",nunito,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",sans-serif',t.fillStyle=s||"#ffffff",o&&(t.lineWidth=o),c&&(t.textAlign=c),t.fillText(r,n,i)},n.drawImage=function(e){var t=this.canvas.context,n=e.x,i=e.y,a=e.name,r=e.frame,s=e.width,o=e.height,c=e.fallbackWithImage,u=this.scene.textures.get(a),l=u.getSourceImage(r);"__MISSING"===u.key&&c&&(l=(u=this.scene.textures.get(c)).getSourceImage()),t.drawImage(l,n,i,s,o)},n.snapshotFrame=function(){var e=this.canvas.getCanvas().toDataURL("image/jpeg",.85);return GameCore.Utils.Valid.isDebugger()&&$t(e),e},t}(Phaser.Plugins.ScenePlugin),tn=en,nn=function(e){function t(t,n,i){var a;return(a=e.call(this)||this).game=void 0,a.options=void 0,a.performance=void 0,a.isRunning=!1,a.checkTimer=void 0,a.fpsHistory=void 0,a.start=function(){if(!a.isRunning){a.isRunning=!0;var e=a.options.checkInterval;a.checkTimer=e,a.fpsHistory=[],a.game.events.on(Phaser.Core.Events.POST_STEP,a.onPostStep)}},a.stop=function(){a.isRunning&&(a.isRunning=!1,a.game.events.off(Phaser.Core.Events.POST_STEP,a.onPostStep),a.options.onlyUpdateWhenSwitchScene&&a.checkFps())},a.onPostStep=function(e,t){if(a.checkTimer-=t,!(a.checkTimer>0)){var n=a.options,i=n.checkInterval,r=n.onlyUpdateWhenSwitchScene;a.checkTimer+=i,a.fpsHistory.push(a.game.loop.actualFps),!1===r&&a.fpsHistory.length>=5&&a.checkFps()}},a.game=t,a.options=i,a.performance=n,a}(0,ot.Z)(t,e);var n=t.prototype;return n.checkFps=function(){if(0!==this.fpsHistory.length){var e=this.options.autoUpgradeQuality,t=!1;this.isLowFps()?t=this.performance.downgradeGraphicsQuality():e&&this.isHighFps()&&(t=this.performance.upgradeGraphicsQuality()),t&&(this.fpsHistory=[])}},n.getFpsMedian=function(){return Phaser.Math.Median(this.fpsHistory)},n.isLowFps=function(){return this.getFpsMedian()<this.options.fpsThreshold},n.isHighFps=function(){return this.getFpsMedian()>1.2*this.options.fpsThreshold},t}(Phaser.Events.EventEmitter),an=nn,rn=["pixelRatio","minQuality","maxQuality","qualityAdjustStep","trackingSceneKeys"],sn=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return(n=e.call.apply(e,fe()(t=[this]).call(t,a))||this).fpsTracker=void 0,n.pixelRatio=void 0,n.minQuality=void 0,n.maxQuality=void 0,n.qualityAdjustStep=void 0,n.trackingSceneKeys=[],n.trackingScene=function(e){var t;if(h()(t=n.trackingSceneKeys).call(t,e)){var i=n.game.scene.getScene(e);i.events.once(Phaser.Scenes.Events.UPDATE,n.fpsTracker.start),i.events.once(Phaser.Scenes.Events.SLEEP,n.fpsTracker.stop)}},n}(0,ot.Z)(t,e);var n=t.prototype;return n.configure=function(e){var t=e.pixelRatio,n=e.minQuality,i=e.maxQuality,a=e.qualityAdjustStep,r=e.trackingSceneKeys,s=(0,rt.Z)(e,rn);this.pixelRatio=t,this.minQuality=n,this.maxQuality=i,this.qualityAdjustStep=a,this.trackingSceneKeys=r,this.fpsTracker=new an(this.game,this,s)},n.active=function(){this.game.events.on(Phaser.Scenes.Events.WAKE,this.trackingScene),this.game.events.on(Phaser.Scenes.Events.START,this.trackingScene)},n.downgradeGraphicsQuality=function(){var e=this.pixelRatio;if(e<=this.minQuality)return!1;var t=+(e-this.qualityAdjustStep).toFixed(2);return!(t<this.minQuality)&&(this.pixelRatio=t,this.game.world.resize(this.pixelRatio),console.warn("\ud83d\udcab Graphics quality was downgraded! ("+e+" -> "+t+")"),!0)},n.upgradeGraphicsQuality=function(){var e=this.pixelRatio;if(e>=this.maxQuality)return!1;var t=+(e+this.qualityAdjustStep).toFixed(2);return!(t>this.maxQuality)&&(this.pixelRatio=t,this.game.world.resize(this.pixelRatio),console.warn("\ud83d\ude80 Graphics quality was upgraded! ("+e+" -> "+t+")"),!0)},t}(Phaser.Plugins.BasePlugin),on=sn,cn=n(67),un=n.n(cn),ln={sound:!0,music:!0,vibrate:!0,language:"en",theme:GameCore.Configs.DefaultTheme,tapToMove:!0,autoHints:!0,autoComplete:!0,relaxedSpider:!0,suitSize:"one",difficulty:"easy",backgroundIdx:0,cardFaceIdx:0,cardBackIdx:1,backgroundDesktopIdx:0,cardFaceDesktopIdx:0,cardBackDesktopIdx:1},hn=ln.sound,dn=ln.music,fn=ln.vibrate,pn=ln.language,gn=ln.theme,mn=ln.tapToMove,vn=ln.autoHints,yn=ln.autoComplete,bn=ln.backgroundIdx,Sn=ln.suitSize,Tn=ln.difficulty,En=ln.cardFaceIdx,Cn=ln.cardBackIdx,An=ln.backgroundDesktopIdx,wn=ln.cardFaceDesktopIdx,In=ln.cardBackDesktopIdx,Pn=function(){function e(e){this.sound=void 0,this.music=void 0,this.vibrate=void 0,this.language=void 0,this.theme=void 0,this.tapToMove=void 0,this.autoHints=void 0,this.autoComplete=void 0,this.relaxedSpider=void 0,this.suitSize=void 0,this.difficulty=void 0,this.backgroundIdx=void 0,this.cardFaceIdx=void 0,this.cardBackIdx=void 0,this.backgroundDesktopIdx=void 0,this.cardFaceDesktopIdx=void 0,this.cardBackDesktopIdx=void 0;var t=e||{},n=t.sound,i=t.music,a=t.vibrate,r=t.language,s=t.theme,o=t.tapToMove,c=t.autoHints,u=t.relaxedSpider,l=t.autoComplete,h=t.suitSize,d=t.difficulty,f=t.backgroundIdx,p=t.cardFaceIdx,g=t.cardBackIdx,m=t.backgroundDesktopIdx,v=t.cardFaceDesktopIdx,y=t.cardBackDesktopIdx;this.sound=GameCore.Utils.Valid.isBoolean(n)?n:hn,this.music=GameCore.Utils.Valid.isBoolean(i)?i:dn,this.vibrate=GameCore.Utils.Valid.isBoolean(a)?a:fn,this.language=GameCore.Utils.Valid.isString(r)?r:pn,this.theme=GameCore.Utils.Valid.isString(s)?s:gn,this.tapToMove=GameCore.Utils.Valid.isBoolean(o)?o:mn,this.autoHints=GameCore.Utils.Valid.isBoolean(c)?c:vn,this.autoComplete=GameCore.Utils.Valid.isBoolean(l)?l:yn,this.relaxedSpider=!GameCore.Utils.Valid.isBoolean(u)||u,this.suitSize=GameCore.Utils.Valid.isString(h)?h:Sn,this.difficulty=GameCore.Utils.Valid.isString(d)?d:Tn,this.backgroundIdx=GameCore.Utils.Valid.isNumber(f)?f:bn,this.cardFaceIdx=GameCore.Utils.Valid.isNumber(p)?p:En,this.cardBackIdx=GameCore.Utils.Valid.isNumber(g)?g:Cn,this.backgroundDesktopIdx=GameCore.Utils.Valid.isNumber(m)?m:An,this.cardFaceDesktopIdx=GameCore.Utils.Valid.isNumber(v)?v:wn,this.cardBackDesktopIdx=GameCore.Utils.Valid.isNumber(y)?y:In}return e.prototype.toObject=function(){return{sound:this.sound,music:this.music,vibrate:this.vibrate,language:this.language,theme:this.theme,tapToMove:this.tapToMove,autoHints:this.autoHints,autoComplete:this.autoComplete,relaxedSpider:this.relaxedSpider,suitSize:this.suitSize,difficulty:this.difficulty,backgroundIdx:this.backgroundIdx,cardFaceIdx:this.cardFaceIdx,cardBackIdx:this.cardBackIdx,backgroundDesktopIdx:this.backgroundDesktopIdx,cardFaceDesktopIdx:this.cardFaceDesktopIdx,cardBackDesktopIdx:this.cardBackDesktopIdx}},e}(),kn=Pn,xn=GameCore.Utils,_n=xn.Valid,On=xn.Object,Dn=function(){function e(e){this.score=void 0,this.settings=void 0,this.gameData=void 0,this.userGuideDisplays=void 0,this.setupDefaultData(),this.updateScore(e),this.updateSettings(e),this.updateGameData(e),this.updateUserGuideDisplays(e)}var t=e.prototype;return t.setupDefaultData=function(){this.score=0,this.settings=(0,Me.Z)({},ln),this.gameData={coins:0,gameStats:{},tournaments:[],newUserEasyGameCount:-1},this.userGuideDisplays=0},t.updateScore=function(e){var t=e.score;!1!==_n.isNumber(t)&&(this.score=t)},t.updateSettings=function(e){var t=e.settings;if(!1!==_n.isObject(t)){var n=new kn(t).toObject();this.settings=n}},t.updateGameData=function(e){var t=e.gameData;!1!==_n.isObject(t)&&(On.hasOwn(t,"coins")&&_n.isNumber(t.coins)&&(this.gameData.coins=t.coins),this.gameData.gameStats=t.gameStats,this.gameData.tournaments=t.tournaments,this.gameData.newUserEasyGameCount=t.newUserEasyGameCount)},t.updateUserGuideDisplays=function(e){var t=e.userGuideDisplays;!1!==_n.isNumber(t)&&(this.userGuideDisplays=t)},t.toObject=function(){return{score:this.score,settings:this.settings,gameData:this.gameData,userGuideDisplays:this.userGuideDisplays}},t.convertToPlayerData=function(){var e=this.gameData,t=e.coins,n=e.gameStats,i=e.tournaments,a=e.newUserEasyGameCount;return{score:this.score,settings:this.settings,customFields:{coins:t,gameStats:n,tournaments:i,newUserEasyGameCount:a},userGuideDisplays:this.userGuideDisplays}},t.convertToFacebookData=function(e){var t=e.score,n=e.settings,i=e.customFields,a=e.userGuideDisplays;return this.updateScore({score:t}),this.updateSettings({settings:n}),this.updateGameData({gameData:i}),this.updateUserGuideDisplays({userGuideDisplays:a}),this.toObject()},e}(),Bn=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="BadRequest",i.message=t||"This request is bad",i.payload=n,i}return(0,ot.Z)(t,e),t}((0,wt.Z)(Error)),Ln=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="RequestTimeout",i.message=t||"This request is timeout",i.payload=n,i}return(0,ot.Z)(t,e),t}((0,wt.Z)(Error)),Rn=n(531),Gn=GameCore.Configs,Nn=Gn.AppId,Mn=Gn.Network,Fn=function(e){if(!e.ok)throw new Bn(null,{response:e})},Un=function(){var e=window.game.auth.getToken();return{token:e,timeout:Mn.Timeout,headers:{Authorization:"Bearer "+e,"Content-Type":"application/json"}}},Zn=function(e,t,n,i){return(0,st.Z)(ut().mark((function a(){var r,s,o,c,u;return ut().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,r=e+"/apps/"+Nn+"/"+t,s=new AbortController,n.signal=s.signal,o=setTimeout((function(){s.abort()}),n.timeout),GameCore.Utils.Valid.isObject(i)&&(n.body=X()(i)),a.next=8,fetch(r,n);case 8:return c=a.sent,clearTimeout(o),Fn(c),a.next=13,c.json();case 13:if(a.t0=a.sent,a.t0){a.next=16;break}a.t0={};case 16:return u=a.t0,a.abrupt("return",u);case 20:if(a.prev=20,a.t1=a.catch(0),!(a.t1 instanceof Bn)){a.next=24;break}return a.abrupt("return",null);case 24:if(!(a.t1 instanceof Object&&GameCore.Utils.Object.hasOwn(a.t1,"name"))){a.next=27;break}if("AbortError"!==a.t1.name){a.next=27;break}throw new Ln(null);case 27:throw a.t1;case 28:case"end":return a.stop()}}),a,null,[[0,20]])})))},Hn=function(){var e=(0,st.Z)(ut().mark((function e(t,n){return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.abrupt("return",t());case 4:if(e.prev=4,e.t0=e.catch(0),!(e.t0 instanceof Ln&&n>0)){e.next=18;break}return e.prev=7,e.next=10,(0,Rn.qZ)(600);case 10:return e.next=12,Hn(t,n-1);case 12:return e.abrupt("return",e.sent);case 15:return e.prev=15,e.t1=e.catch(7),e.abrupt("return",{});case 18:if(!(e.t0 instanceof Ln)){e.next=20;break}return e.abrupt("return",{});case 20:return console.warn(e.t0),e.abrupt("return",{});case 22:case"end":return e.stop()}}),e,null,[[0,4],[7,15]])})));return function(t,n){return e.apply(this,arguments)}}(),Wn=function(){var e=(0,st.Z)(ut().mark((function e(t,n,i,a){var r,s;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===n&&(n={}),void 0===a&&(a=Mn.Retries),e.prev=2,r=(0,Me.Z)({},Un(),n,{method:"GET"}),s=Zn(i,t,r),e.next=7,Hn(s,a);case 7:return e.abrupt("return",e.sent);case 10:return e.prev=10,e.t0=e.catch(2),console.warn(e.t0),e.abrupt("return",{});case 14:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t,n,i,a){return e.apply(this,arguments)}}(),zn=function(){var e=(0,st.Z)(ut().mark((function e(t,n,i,a,r){var s,o;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===i&&(i={}),void 0===r&&(r=Mn.Retries),e.prev=2,s=(0,Me.Z)({},Un(),i,{method:"POST"}),o=Zn(a,t,s,n),e.next=7,Hn(o,r);case 7:return e.abrupt("return",e.sent);case 10:return e.prev=10,e.t0=e.catch(2),console.warn(e.t0),e.abrupt("return",{});case 14:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t,n,i,a,r){return e.apply(this,arguments)}}(),Yn=GameCore.Configs.ApiHost,Vn=(function(){var e=(0,st.Z)(ut().mark((function e(t){var n,i;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=GameCore.Utils.String.params(t),e.next=3,Wn("players?"+n,{},Yn);case 3:return i=e.sent,e.abrupt("return",(null==i?void 0:i.data)||[]);case 5:case"end":return e.stop()}}),e)})))}(),function(){var e=(0,st.Z)(ut().mark((function e(t){var n;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,zn("players",t,{},Yn,10);case 2:return n=e.sent,e.abrupt("return",(null==n?void 0:n.data)||{});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Kn=function(){var e=(0,st.Z)(ut().mark((function e(t){var n;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,zn("players/"+t+"/user-guide-displays/inc",{},{},Yn);case 2:return n=e.sent,e.abrupt("return",(null==n?void 0:n.data)||{});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),jn="PLAYER_RECEIVED",Xn="PLAYER_DATA_UPDATE",Jn="PLAYER_SCORE_UPDATE",qn="PLAYER_PROFILE_UPDATE",Qn="PLAYER_SETTING_UPDATE",$n="PLAYER_CONNECTED_PLAYERS_UPDATE",ei=n(528),ti=function(e){function t(t,n){var i;return(i=e.call(this,t)||this).payload=void 0,i.name="PlayerDataNameNotSupport",i.message=t||"The name of player data is not supported",i.payload=n||{},i}return(0,ot.Z)(t,e),t}((0,wt.Z)(Error)),ni=(0,Kt.P1)([function(e){return e.player}],(function(e){return e})),ii=(0,Kt.P1)([ni],(function(e){return e.playerId})),ai=(0,Kt.P1)([ni],(function(e){return e.ASID})),ri=(0,Kt.P1)([function(e){return e.player.data}],(function(e){return e})),si=(0,Kt.P1)([function(e){return e.player.connectedPlayers}],(function(e){return e})),oi=(0,Kt.P1)([si,function(e,t){return t.limit},function(e,t){return t.offset}],(function(e,t,n){if("number"!==typeof t)return[];if("number"!==typeof n)return[];var i=M()(e);return s()(i).call(i,n,t+n)||[]})),ci=(0,Kt.P1)([ri],(function(e){return e.score})),ui=(0,Kt.P1)([ri],(function(e){return e.customFields})),li=(0,Kt.P1)([ui],(function(e){return void 0===(null==e?void 0:e.tournaments)?[]:e.tournaments})),hi=GameCore.Configs,di=hi.AppId,fi=hi.Tutorial,pi=function(e,t){return function(n){var i=e.playerId,a=e.name,r=e.photo,s=e.locale;n({type:jn,payload:{playerId:i,name:a,photo:r,locale:s,data:t||{}}})}},gi=function(e){return{type:$n,payload:{connectedPlayers:e}}},mi=function(e,t){return function(){var n=(0,st.Z)(ut().mark((function n(i,a){var r,s,o;return ut().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,i({type:Qn,payload:{name:e,value:t}});case 3:r=a(),s=ri(r),o=new Dn({}).convertToFacebookData(s),FBInstant.player.setDataAsync(o),n.next=12;break;case 9:n.prev=9,n.t0=n.catch(0),(0,at.tO)(n.t0);case 12:case"end":return n.stop()}}),n,null,[[0,9]])})));return function(e,t){return n.apply(this,arguments)}}()},vi=function(e,t){return function(){var n=(0,st.Z)(ut().mark((function n(i,a){var r,s,o,c,u;return ut().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,s={customFields:(r={},r[e]=t,r)},n.next=4,i(bi(s));case 4:o=a(),c=ri(o),u=new Dn({}).convertToFacebookData(c),FBInstant.player.setDataAsync(u),n.next=15;break;case 10:if(n.prev=10,n.t0=n.catch(0),!(n.t0 instanceof ti)){n.next=14;break}return n.abrupt("return");case 14:(0,at.tO)(n.t0);case 15:case"end":return n.stop()}}),n,null,[[0,10]])})));return function(e,t){return n.apply(this,arguments)}}()},yi=function(e){return function(){var t=(0,st.Z)(ut().mark((function t(n,i){var a,r,s,o;return ut().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a={customFields:e},t.next=4,n(bi(a));case 4:r=i(),s=ri(r),o=new Dn({}).convertToFacebookData(s),FBInstant.player.setDataAsync(o),t.next=16;break;case 10:if(t.prev=10,t.t0=t.catch(0),console.log("\ud83e\udd16 ? error",t.t0),!(t.t0 instanceof ti)){t.next=15;break}return t.abrupt("return");case 15:(0,at.tO)(t.t0);case 16:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(e,n){return t.apply(this,arguments)}}()},bi=function(e){return{type:Xn,payload:{data:e}}},Si=function(e){return function(){var t=(0,st.Z)(ut().mark((function t(n,i){var a,r,s;return ut().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,n({type:Jn,payload:{score:e}});case 3:Vn({score:e}),a=i(),r=ri(a),s=new Dn({}).convertToFacebookData(r),FBInstant.player.setDataAsync(s),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),(0,at.tO)(t.t0);case 13:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(e,n){return t.apply(this,arguments)}}()},Ti=function(e){function t(){return e.apply(this,arguments)||this}(0,ot.Z)(t,e);var n=t.prototype;return n.incUserGuideDisplays=function(){var e=(0,st.Z)(ut().mark((function e(){var t;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.game.storage,e.next=3,t.dispatch(function(){var e=(0,st.Z)(ut().mark((function e(t,n){var i,a,r,s;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!fi.ForceUseTutorial){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,t(bi({userGuideDisplays:1}));case 5:i=n(),a=ii(i),r=ri(i),s=new Dn({}).convertToFacebookData(r),FBInstant.player.setDataAsync(s),Kn(a),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),(0,at.tO)(e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t,n){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.receiveData=function(){var e=(0,st.Z)(ut().mark((function e(t,n){var i;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.game.storage,e.next=3,i.dispatch(pi(t,n));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.updateData=function(){var e=(0,st.Z)(ut().mark((function e(){var t;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.game.storage,e.next=3,t.dispatch(function(){var e=(0,st.Z)(ut().mark((function e(t,n){var i,a,r,s,o,c,u,l;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i=n(),a=ni(i),r=a.playerId,s=a.name,o=a.photo,c=a.locale,e.next=6,FBInstant.player.getASIDAsync();case 6:return u=e.sent,l={appId:di,playerId:r,name:s,photo:o,locale:c,ASID:u},e.next=10,t({type:qn,payload:{profile:l}});case 10:return e.next=12,Vn(l);case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),(0,at.tO)(e.t0);case 17:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t,n){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.setBestScore=function(){var e=(0,st.Z)(ut().mark((function e(t){var n;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.game.storage,e.next=3,n.dispatch(Si(t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.setSetting=function(){var e=(0,st.Z)(ut().mark((function e(t,n){var i;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.game.storage,e.next=3,i.dispatch(mi(t,n));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.setCustomData=function(){var e=(0,st.Z)(ut().mark((function e(t,n){var i;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.game.storage,e.next=3,i.dispatch(vi(t,n));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.setMultiCustomData=function(){var e=(0,st.Z)(ut().mark((function e(t){var n;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.game.storage,e.next=3,n.dispatch(yi(t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.requestConnectedPlayers=function(){var e=(0,st.Z)(ut().mark((function e(){var t;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.game.storage,e.next=3,t.dispatch(function(){var e=(0,st.Z)(ut().mark((function e(t){var n,i,a,r,s;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i=window.game.facebook,e.next=4,new(xe())((function(e,t){i.once("players",(function(t){e(t)})),i.once("playersfail",(function(){return t([])})),i.getPlayers()}));case 4:if(a=e.sent,r=function(e){return!!e},s=u()(n=z()(a).call(a,(function(e){var t=e.getID(),n=e.getName(),i=e.getPhoto();return t&&n&&i?new ei.Z(t,n,i).toObject():null}))).call(n,r),!(s.length<1)){e.next=9;break}return e.abrupt("return");case 9:t(gi(s)),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),(0,at.tO)(e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.updateConnectedPlayers=function(){var e=(0,st.Z)(ut().mark((function e(t){var n;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.game.storage,e.next=3,n.dispatch(gi(t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.joinTournament=function(){var e=(0,st.Z)(ut().mark((function e(t){var n,i,a;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.getTournaments(),!un()(i).call(i,(function(e){return e.leaderboardId===t.leaderboardId}))){e.next=3;break}return e.abrupt("return");case 3:return a=fe()(n=[]).call(n,i,[t]),e.next=6,this.setMultiCustomData({tournaments:a});case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.getPlayer=function(){return ni(this.state)},n.getPlayerId=function(){return this.getPlayer().playerId},n.getPlayerASID=function(){return ai(this.state)},n.getPlayerData=function(){return this.getPlayer().data},n.getPlayerSetting=function(e){var t=this.getPlayerSettings();return"string"!==typeof e?null:GameCore.Utils.Object.hasOwn(t,e)?t[e]:GameCore.Utils.Object.hasOwn(ln,e)?ln[e]:null},n.getPlayerSettings=function(){return this.getPlayerData().settings},n.getPlayerIsNew=function(){return this.getPlayer().isUserNew},n.getBestScore=function(){return ci(this.state)},n.getCustomData=function(e){var t=ui(this.state);return GameCore.Utils.Valid.isObject(t)&&GameCore.Utils.Object.hasOwn(t,e)?t[e]:null},n.getConnectedPlayers=function(){return si(this.state)},n.getConnectedPlayerIds=function(e,t){return oi(this.state,{limit:e,offset:t})},n.getTournaments=function(){return li(this.state)},(0,Wt.Z)(t,[{key:"state",get:function(){return this.game.storage.getState()}}]),t}(Phaser.Plugins.BasePlugin),Ei=Ti,Ci=GameCore.Configs.ApiHost,Ai=function(){var e=(0,st.Z)(ut().mark((function e(t){var n,i;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=GameCore.Utils.String.params(t),e.next=3,Wn("players?"+n,{},Ci);case 3:return i=e.sent,e.abrupt("return",(null==i?void 0:i.data)||[]);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),wi="PROFILES_DATA_UPDATE",Ii=(0,Kt.P1)([function(e){return e.profile.data}],(function(e){return e})),Pi=(0,Kt.P1)([function(e){return e.profile.profileIds}],(function(e){return e})),ki=GameCore.Configs,xi=ki.Tournament,_i=ki.LeadersBoard,Oi=function(e){return function(){var t=(0,st.Z)(ut().mark((function t(n,i){var a,r,s,o,c,u;return ut().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,a=i(),r=Pi(a),!((s=GameCore.Utils.Array.difference(e,r)).length<1)){t.next=6;break}return t.abrupt("return");case 6:return t.next=8,Ai({playerIds:s});case 8:o=t.sent,xi.UseMock&&_i.UseMock&&(o=z()(c=S()(u=new Array(s.length)).call(u,null)).call(c,(function(e,t){var n=t+1;return{playerId:"player-0"+n,name:"MPlayer "+n,photo:"./assets/images/others/avatar.png",rank:n,score:Math.floor(17*Math.random()*100/n)}})),console.log("tournament mock data: ",o)),n({type:wi,payload:{data:o}}),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(0),(0,at.tO)(t.t0);case 16:case"end":return t.stop()}}),t,null,[[0,13]])})));return function(e,n){return t.apply(this,arguments)}}()},Di=function(e){function t(){return e.apply(this,arguments)||this}(0,ot.Z)(t,e);var n=t.prototype;return n.requestProfiles=function(){var e=(0,st.Z)(ut().mark((function e(t){var n;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.game.storage,e.next=3,n.dispatch(Oi(t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.getProfiles=function(){return Ii(this.state)},(0,Wt.Z)(t,[{key:"state",get:function(){return this.game.storage.getState()}}]),t}(Phaser.Plugins.BasePlugin),Bi=Di,Li=n(169),Ri=n.n(Li),Gi=["player","match"],Ni="null",Mi=GameCore.Configs.Rollbar,Fi=Mi.UseMockup,Ui=Mi.FilterError,Zi=Mi.ListPlayerDevIds,Hi=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return(n=e.call.apply(e,fe()(t=[this]).call(t,a))||this).enable=void 0,n.rollbar=void 0,n.events=[],n.beforeSend=function(e,t,i){Fi&&n.showPopupError(i)},n.checkIgnore=function(e,t,i){try{return!!n.isErrorIgnore(t)&&(console.warn(t),!0)}catch(a){return!1}},n.showPopupError=function(e){var t,i,a,r,s,o=null==e||null==(t=e.body)||null==(i=t.trace)?void 0:i.exception;o&&n.events.push(o);var c=(null==e||null==(a=e.body)||null==(r=a.trace)?void 0:r.frames)||[];(s=n.events).push.apply(s,c);var u=document.getElementById("popup-error");u||((u=document.createElement("div")).id="popup-error",document.body.appendChild(u)),u.innerHTML='<div style="color: #fff; display: flex; flex-flow: column; align-items: center; ">\n      <pre id="json" style="overflow: auto; background-color: rgb(195 112 97 / 80%); padding: 10px; max-height: 80vh; max-width: 90vw; border: 5px solid #545454;">'+X()(n.events,null,2)+'</pre>\n      <button id="close" style="cursor: pointer; padding: 10px 20px; border-radius: 100px;">Close</button>\n      </div>',u.style="top: 0px; z-index: 10000; width: 100vw; max-height: 100vh; position: absolute; display: flex; align-items: center; justify-content: center;";var l=document.getElementById("close");l&&(l.onclick=n.closePopup)},n.closePopup=function(){n.events=[{}];var e=document.getElementById("popup-error");null==e||e.remove()},n.isNoneErrorEvent=function(e){if(!e||0===e.length)return!1;if(!e[0].message)return!1;return"Non-Error promise rejection captured with keys: code, message"===e[0].message},n.isErrorIgnore=function(e){if(!e||0===e.length)return!1;var t=!1,i=e[0];return i instanceof Object&&(t=n.isIgnoreByCode(i)||n.isIgnoreByMessage(i)),t},n.isIgnoreByCode=function(e){if(GameCore.Utils.Object.hasOwn(e,"code")){var t=e.code,n=Ui.Codes,i=n.accepted,a=n.ignored;if("string"===typeof t){if(g()(i).call(i,t)>=0)return!1;if(g()(a).call(a,t)>=0)return!0}}else if(GameCore.Utils.Object.hasOwn(e,"name")){var r=e.name,s=Ui.Codes,o=s.accepted,c=s.ignored;if("string"===typeof r){if(g()(o).call(o,r)>=0)return!1;if(g()(c).call(c,r)>=0)return!0}}return!1},n.isIgnoreByMessage=function(e){if(GameCore.Utils.Object.hasOwn(e,"message")){var t=e.message,n=Ui.Messages,i=n.accepted,a=n.ignored;if("string"===typeof t){if(g()(i).call(i,t)>=0)return!1;if(g()(a).call(a,t)>=0)return!0}}return!1},n.addExtraState=function(){try{if(!GameCore.Utils.Object.hasOwn(window,"game"))return;if(!GameCore.Utils.Object.hasOwn(window.game,"storage"))return;if(!GameCore.Utils.Object.hasOwn(window.game.storage,"getState"))return;var e=(0,window.game.storage.getState)()||{},t=e.player,i=e.match,a=(0,rt.Z)(e,Gi);n.rollbar.configure({payload:{player:t,match:i,other:a}})}catch(r){console.warn("%c addExtraState: ","font-size:12px;background-color: #42b983;color:#fff;",r)}},n}(0,ot.Z)(t,e);var n=t.prototype;return n.setup=function(){this.rollbar=new(Ri())({accessToken:Ni,checkIgnore:this.checkIgnore,onSendCallback:this.beforeSend,captureUncaught:!0,scrubTelemetryInputs:!0,captureUnhandledRejections:!0,autoInstrument:{dom:!1,navigation:!1},payload:{environment:"production",client:{javascript:{code_version:"1"}},server:{root:"webpack:///./",branch:"master"}}}),this.enable=!0,this.sendTestException()},n.configure=function(e){this.rollbar&&this.rollbar.configure(e)},n.sendTestException=function(){var e=this.game.facebook.getPlayerID();h()(Zi).call(Zi,e)&&this.rollbar.debug(new Error("Test rollbar"),{playerID:e})},n.sendException=function(e,t){e&&(this.enable?this.rollbar&&(this.addExtraState(),this.rollbar.error(e,t)):console.error(e))},t}(Phaser.Plugins.BasePlugin),Wi=Hi,zi=function(e){function t(){return e.apply(this,arguments)||this}return(0,ot.Z)(t,e),t.prototype.emit=function(t,n){return e.prototype.emit.call(this,t,n)},t}(Phaser.Events.EventEmitter),Yi=zi,Vi=n(532),Ki=function(e){function t(t,n,i,a){var r;(r=e.call(this,t)||this).zone=void 0,r.background=void 0,r.setName(n),r.setVisible(!1);var s=r.scene.world.getWorldSize(),o=s.width,c=s.height;return r.setSize(i||o,a||c),r.addZone(),r.addBackground(),r}(0,ot.Z)(t,e);var n=t.prototype;return n.open=function(e){GameCore.Utils.Valid.isObject(e)&&(this.setDataEnabled(),this.setData(e)),this.setBlockInputOutsideEnabled(!0),this.scene.screen.bringToTop(this.name),this.visible||(this.setVisible(!0),this.logPageviewOnOpen(),this.logEventOpen())},n.close=function(){this.visible&&(this.setVisible(!1),this.logPageviewOnClose())},n.incY=function(e){this.y+=e,this.background.y-=e},n.incX=function(e){this.x+=e,this.background.x-=e},n.incScale=function(e){this.scale+=e,this.background.scale-=e^e*(100/e)},n.setBlockInputOutsideEnabled=function(e){this.scene.input.setTopOnly(e)},n.addZone=function(){this.zone=this.scene.add.zone(0,0,this.width,this.height),this.zone.setInteractive({}),this.add(this.zone)},n.addBackground=function(){var e="screen-background";if(!this.scene.textures.exists(e)){var t=this.width+2,n=this.height+2,i=this.scene.add.graphics();i.fillStyle(859421,1),i.fillRect(0,0,t,n),i.generateTexture(e,t,n),i.destroy()}this.background=this.scene.add.image(0,0,e),this.add(this.background)},n.logPageviewOnOpen=function(){this.scene.analytics.pageview(this.name)},n.logPageviewOnClose=function(){this.scene.analytics.pageview(this.scene.scene.key)},n.logEventOpen=function(){this.scene.analytics.event(Vi._.SCREEN_OPEN,{screen_name:this.getScreenName()})},n.getScreenName=function(){return GameCore.Utils.String.toUpperCamelCase(this.name.toLowerCase())},t}(Phaser.GameObjects.Container),ji=Ki,Xi={OPEN:"open",CLOSE:"close",CREATED:"created"};GameCore.Screen=ji,GameCore.Screens={Events:Xi};var Ji=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return(n=e.call.apply(e,fe()(t=[this]).call(t,a))||this).events=void 0,n}(0,ot.Z)(t,e);var n=t.prototype;return n.boot=function(){this.events=new Yi,this.registryScreenFactory()},n.get=function(e){var t=this.scene.children.getByName(e);return null===t?null:t},n.add=function(e,t,n,i){var a=this.get(e);return a||(a=this.scene.add.screen(e,t,n,i),this.events.emit(GameCore.Screens.Events.CREATED,a),a)},n.open=function(e,t){var n=this.get(e);return!!n&&(n.open(t),n.emit(GameCore.Screens.Events.OPEN,n),this.events.emit(GameCore.Screens.Events.OPEN,n),console.log("Screen open",e,t),!0)},n.close=function(e){var t=this.get(e);return!!t&&(t.close(),t.emit(GameCore.Screens.Events.CLOSE,t),this.events.emit(GameCore.Screens.Events.CLOSE,t),console.log("Screen close",e),!0)},n.bringToTop=function(e){var t=this.scene.children.getByName(e);t&&this.scene.children.bringToTop(t)},n.registryScreenFactory=function(){Phaser.GameObjects.GameObjectFactory.register("screen",this.createScreen)},n.createScreen=function(e,t,n,i){var a=new t(this.scene,e,n,i);return Phaser.Display.Align.In.Center(a,this.scene.gameZone),this.existing(a),a},t}(Phaser.Plugins.ScenePlugin),qi=Ji,Qi=n(330),$i=n.n(Qi),ea=n(533),ta=n(534),na=n(536),ia=n(535),aa={currentSceneKey:"",prevSceneKey:""};(0,ia.pV)();var ra,sa,oa,ca,ua,la,ha,da,fa={processed:!1,contextId:"",contextType:"SOLO",entryPointData:{},currentGameMode:""},pa=fa,ga={data:{}},ma={token:"",isRequesting:!1},va=((ra={}).auth=function(e,t){return void 0===e&&(e=ma),(0,ia.ZP)(e,(function(e){var n=t.payload;if(n){var i=n.token;switch(t.type){case zt:e.isRequesting=!0;break;case Yt:e.token=i,e.isRequesting=!1}}}))},ra),ya={ASID:"",playerId:"",name:"",photo:"",locale:"",connectedPlayers:{},data:{score:0,settings:ln,userGuideDisplays:0,customFields:{coins:0,gameStats:{},tournaments:[],newUserEasyGameCount:-1}},isUserNew:!0},ba=((sa={}).player=function(e,t){return void 0===e&&(e=ya),(0,ia.ZP)(e,(function(n){var i=t.payload;if(i){var a=i.name,r=i.value,s=i.data,o=void 0===s?{}:s,c=i.score,u=i.connectedPlayers,l=void 0===u?[]:u,h=i.profile;switch(t.type){case jn:var d=i.playerId,f=i.name,p=i.photo,g=i.locale,m=i.data;if(n.playerId=d,n.name=f,n.photo=p,n.locale=g,GameCore.Utils.Valid.isObject(m)){var v=m;n.data=(0,Fe.TS)(e.data,v)}m.userGuideDisplays>0&&(n.isUserNew=!1);break;case qn:var y=h.playerId,b=h.name,S=h.photo,T=h.locale,E=h.ASID;n.ASID=E,n.playerId=y,n.name=b,n.photo=S,n.locale=T;break;case Jn:n.data.score=c;break;case Qn:if(!GameCore.Utils.Object.hasOwn(n.data.settings,a))break;n.data.settings[a]=r;break;case Xn:n.data=(0,Fe.TS)(e.data,o),o.userGuideDisplays>0&&(n.isUserNew=!1);break;case $n:if(l.length<=0)break;var C=GameCore.Utils.Object.keyBy(l,"playerId");n.connectedPlayers=(0,Fe.TS)(e.connectedPlayers,C)}}}))},sa),Sa=n(507),Ta=n.n(Sa),Ea={data:{},profileIds:[]},Ca=((oa={}).profile=function(e,t){return void 0===e&&(e=Ea),(0,ia.ZP)(e,(function(n){var i=t.payload;if(i){var a=i.data,r=void 0===a?[]:a;if(t.type===wi){var s,o,c=GameCore.Utils.Object.keyBy(r,"playerId"),u=M()(c);n.data=(0,Fe.TS)((0,Me.Z)({},e.data),c),n.profileIds=fe()(s=[]).call(s,new(Ta())(fe()(o=[]).call(o,e.profileIds,u)))}}}))},oa),Aa="MATCH_GAMEPLAY_INITIALIZE",wa="MATCH_GAMEPLAY_START",Ia="MATCH_GAMEPLAY_FINISH",Pa="MATCH_GAMEPLAY_UPDATE",ka="MATCH_STATS_DATA_CLEAR",xa="MATCH_STATS_DATA_UPDATE",_a="MATCH_STATS_CURRENT_UPDATE",Oa="MATCH_SINGLE_CREATE_REQUEST",Da="MATCH_SINGLE_DETAIL_REQUEST",Ba="MATCH_SINGLE_DATA_RECEIVED",La="MATCH_SINGLE_DATA_CLEAR",Ra="MATCH_CHALLENGE_JOIN_REQUEST",Ga="MATCH_CHALLENGE_CREATE_REQUEST",Na="MATCH_CHALLENGE_FINISH_REQUEST",Ma="MATCH_CHALLENGE_CONTINUE_REQUEST",Fa="MATCH_CHALLENGE_DATA_RECEIVED",Ua="MATCH_GROUP_CREATE_REQUEST",Za="MATCH_GROUP_FINISH_REQUEST",Ha="MATCH_ONLINE_CREATE_REQUEST",Wa="MATCH_ONLINE_DATA_RECEIVED",za="open",Ya="active",Va="finished",Ka={mode:"",status:za,rescued:0,startAt:0,finishAt:0},ja={single:{_id:"",data:{fen:""},playerId:"",status:za},group:{status:za,opponentInfo:{playerId:"",name:"",photo:""}},challenge:{_id:"",status:za,whitePlayerId:"",blackPlayerId:"",opponentInfo:{playerId:"",name:"",photo:""}},online:{_id:"",status:za,players:{}},updateAt:0,isRequesting:!1},Xa={current:{updateAt:0},data:{updateAt:0},isRequesting:!1},Ja=((ca={}).match=(0,ea.UY)({gameplay:function(e,t){return void 0===e&&(e=Ka),(0,ia.ZP)(e,(function(n){var i=t.payload;if(i){var a=i.mode,r=i.status;switch(t.type){case Aa:n.status=za,n.mode=Ka.mode,n.rescued=Ka.rescued,n.startAt=Ka.startAt,n.finishAt=Ka.finishAt,n.opponentInfo=Ka.opponentInfo;break;case wa:n.mode=a,n.status=Ya,n.rescued=Ka.rescued,n.startAt=Date.now();break;case Pa:n.mode="string"===typeof a?a:e.mode,n.status=r||e.status;break;case Ia:n.status=Va,n.finishAt=Date.now();break;case"MATCH_GAMEPLAY_RESCUE":n.rescued+=1}}}))},match:function(e,t){return void 0===e&&(e=ja),(0,ia.ZP)(e,(function(n){var i=t.payload;if(i){var a=i.match,r=i.opponentInfo,s=i.players;switch(t.type){case Oa:case Da:case Ra:case Na:case Ha:n.isRequesting=!0;break;case"MATCH_SINGLE_MOVE_UPDATED":n.single=(0,Me.Z)({},e.single,a),n.updateAt=Date.now();break;case Ba:n.isRequesting=!1,n.single=a||ja.single;break;case La:n.isRequesting=!1,n.single=ja.single;break;case Ga:case Ma:n.isRequesting=!0,n.challenge.opponentInfo=r;break;case Fa:n.isRequesting=!1,n.challenge=(0,Me.Z)({},a||ja.challenge),n.challenge.opponentInfo=e.challenge.opponentInfo;break;case"MATCH_CHALLENGE_DATA_CLEAR":n.isRequesting=!1,n.challenge=ja.challenge;break;case Ua:n.group.status=Ya,r&&(n.group.opponentInfo=r);break;case Za:n.group.status=Va;break;case"MATCH_ONLINE_DATA_CLEAR":n.online.status=ja.online.status,n.online.players=ja.online.players;break;case Wa:n.online.status=Ya,n.online.players=s;break;case"MATCH_ONLINE_FINISH_REQUEST":n.online.status=Va}}}))},stats:function(e,t){return void 0===e&&(e=Xa),(0,ia.ZP)(e,(function(n){var i=t.payload;if(i){var a=i.playerId,r=i.stats,s=i.match,o=i.current,c=i.players,u=i.leaders;switch(t.type){case ka:delete n.data[a],n.current=Xa.current;break;case"MATCH_STATS_CONTEXT_REQUEST":n.data=Xa.data,n.isRequesting=!0;break;case"MATCH_STATS_CONTEXT_RECEIVED":n.data=r,n.isRequesting=!1;break;case xa:n.data[a]=r;break;case _a:n.current=(0,Fe.TS)((0,Me.Z)({},e.current),r);break;case Wa:M()(c).forEach((function(e){n.data[e]={score:0}}));break;case"MATCH_ONLINE_STATS_UPDATE":u.forEach((function(e){var t=e.playerId,i=e.score,a=e.rank;n.data[t]={score:i,rank:a}}));break;case Fa:var l=s||{},h=l.blackPlayerId,d=l.blackPlayerScore,f=l.whitePlayerId,p=l.whitePlayerScore,g=l.whitePlayerLevel,m=l.blackPlayerLevel;if(!h||!f)break;o&&(n.current=o),n.data[h]={score:d,level:m},n.data[f]={score:p,level:g}}}}))}}),ca),qa="TOURNAMENT_ACTIVE",Qa="TOURNAMENT_REQUEST",$a="TOURNAMENT_RECEIVED",er={active:!1,tournamentId:null,leaderboardId:null,bestSessionScore:0,isRequesting:!1},tr=((ua={}).tournament=function(e,t){return void 0===e&&(e=er),(0,ia.ZP)(e,(function(n){var i=t.payload;if(i){var a=i.score,r=void 0===a?0:a,s=i.tournamentId,o=i.leaderboardId;switch(t.type){case qa:n.active=!0,n.tournamentId=s,n.leaderboardId=o;break;case Qa:n.isRequesting=!0;break;case $a:n.isRequesting=!1,r>e.bestSessionScore&&(n.bestSessionScore=r)}}}))},ua),nr=n(120),ir=n.n(nr),ar=n(66),rr=n.n(ar),sr={leaderboardId:"",type:"",limit:0,offset:0,leaders:{},isRequesting:!1},or=((la={}).leaderboards=function(e,t){return void 0===e&&(e=sr),(0,ia.ZP)(e,(function(n){var i=t.payload;if(i){var a=i.leaderboardId,r=i.type,s=i.limit,o=i.offset,c=i.leaders;switch(t.type){case"LEADERBOARD_DATA_REQUEST":e.type!==r&&0===o&&(n.leaders=sr.leaders),n.isRequesting=!0,n.leaderboardId=a,n.type=r,n.limit=s,n.offset=o;break;case"LEADERBOARD_DATA_UPDATE":if(n.isRequesting=!1,e.type!==r)break;var l=GameCore.Utils.Json.clone((0,Me.Z)({},e.leaders,c)),h=ir()(l),d=u()(h).call(h,(function(e){return!!e.name&&!!e.photo}));rr()(d).call(d,(function(e,t){return+t.score-+e.score})),d.forEach((function(t,i){t.rank=i+1,e.leaders[t.playerId]||(n.leaders[t.playerId]=t)}));break;case"LEADERBOARD_DATA_CLEAR":n.isRequesting=!1,n.type=sr.type,n.limit=sr.limit,n.offset=sr.offset,n.leaders=sr.leaders,n.leaderboardId=sr.leaderboardId}}}))},la),cr={mission:null,missions:null,isRequesting:!1},ur=((ha={}).missions=function(e,t){return void 0===e&&(e=cr),(0,ia.ZP)(e,(function(n){var i,a,r=t.payload;if(r){var s=r.name,o=r.type,c=r.value,u=r.missions;switch(t.type){case"MISSIONS_DATA_REQUEST":n.isRequesting=!0;break;case"MISSIONS_DATA_RECEIVE":if(n.isRequesting=!1,u.length<1)return;n.missions={},u.forEach((function(e){n.missions[e.name]=e}));break;case"MISSION_START":if(null===e.missions)break;var l=e.missions[s];n.mission={name:s,process:{},require:l.require,reward:l.reward},M()(l.require).forEach((function(e){n.mission.process[e]=0}));break;case"MISSION_UPDATE":if((null==(i=e.mission)?void 0:i.name)!==s)break;n.mission.process[o]+=c;break;case"MISSION_COMPLETED":if((null==(a=e.mission)?void 0:a.name)!==s)break;n.mission=null}}}))},ha),lr=(0,ea.UY)((0,Me.Z)({scene:function(e,t){return void 0===e&&(e=aa),(0,ia.ZP)(e,(function(n){var i=t.payload;if(i){var a=i.sceneKey;if(t.type===na.DW)n.currentSceneKey=a,n.prevSceneKey=e.currentSceneKey}}))},context:function(e,t){return void 0===e&&(e=fa),(0,ia.ZP)(e,(function(e){var n=t.payload;if(n){var i=n.gameMode,a=n.contextId,r=n.contextType,s=n.entryPointData;switch(t.type){case na.kL:e.contextId=a,e.contextType=r,e.entryPointData=s;break;case na.fJ:e.contextId=a,e.contextType=r,e.processed=!0;break;case na.EH:e.currentGameMode=i}}}))},messages:function(e,t){return void 0===e&&(e=ga),(0,ia.ZP)(e,(function(n){var i=t.payload;if(i){var a=i.opponentId;if("string"===typeof a)switch(t.type){case na.qj:e.data[a]?n.data[a].sent=!0:n.data[a]={sent:!0};break;case na.rh:e.data[a]?n.data[a].sent=!1:n.data[a]={sent:!1}}}}))}},va,ba,Ca,Ja,tr,or,ur)),hr=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__,dr=ea.qC,fr=function(e){hr&&(dr=hr({trace:!0,traceLimit:25})||ea.qC);var t=dr((0,ea.md)(ta.Z));return(0,ea.MT)(lr,e,t)},pr=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return(n=e.call.apply(e,fe()(t=[this]).call(t,a))||this).store=void 0,n.initiator=void 0,n.dispatch=function(e){return n.store.dispatch(e)},n.getState=function(){return n.store.getState()},n.subscribe=function(e){return n.store.subscribe(e)},n.watch=function(e,t){var i=$i()((function(){var t=n.getState();return e(t)}));return n.subscribe(i((function(e){t(e)})))},n}(0,ot.Z)(t,e);var n=t.prototype;return n.init=function(){this.store=fr({})},n.setInitiator=function(e){this.initiator=e},n.syncStore=function(){var e=(0,st.Z)(ut().mark((function e(){return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.initiator.initContext(),e.next=3,this.initiator.initPlayer();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t}(Phaser.Plugins.BasePlugin),gr=pr,mr=n(498),vr=n.n(mr),yr=function(e){function t(t,n){var i;return(i=e.call(this,t,{type:"webfont",key:n.type})||this).payload=void 0,i.payload=n,i}(0,ot.Z)(t,e);var n=t.prototype;return n.load=function(){var e;switch(this.payload.type){case"google":e=this.getGoogleFontConfig(this.payload);break;case"local":e=this.getLocalFontConfig(this.payload)}vr().load(e)},n.getGoogleFontConfig=function(e){var t=this,n=e.character,i=e.fontName,a=e.fontWeight;return{google:{families:[i+":"+(void 0===a?400:a)],text:n},active:function(){t.loader.nextFile(t,!0)},timeout:15e3}},n.getLocalFontConfig=function(e){var t=this,n=e.fontName,i=e.fontType,a=document.createElement("style");document.head.appendChild(a);var r=a.sheet;if(r){var s="";switch(i){case"opentype":case"woff":s=".woff";break;case"truetype":s=".ttf"}var o='@font-face { font-family: "'+n+'"; src: url("assets/fonts/'+n+s+'") format("'+i+'"); }';r.insertRule(o,0)}return{custom:{families:[n]},active:function(){t.loader.nextFile(t,!0)},timeout:15e3}},t}(Phaser.Loader.File),br=yr,Sr=function(e){function t(){return e.apply(this,arguments)||this}return(0,ot.Z)(t,e),t.prototype.addFont=function(e){var t=new br(this.scene.load,e);this.scene.load.addFile(t)},t}(Phaser.Plugins.ScenePlugin),Tr=Sr,Er={Mobile:{Background:["bg-0","bg-1","bg-2","bg-3","bg-4"],CardFace:["card-style-0","card-style-1","card-style-2","card-style-3"],CardBack:["card-back-0","card-back-1","card-back-2","card-back-3","card-back-4","card-back-5"]},Desktop:{Background:["bg-desktop-0","bg-desktop-1","bg-desktop-2","bg-desktop-3","bg-desktop-4"],CardFace:["card-style-0","card-style-desktop-0","card-style-2","card-style-3"],CardBack:["card-back-0","card-back-1","card-back-2","card-back-3","card-back-4","card-back-5"]}},Cr=n(530),Ar=(0,Cr.t)(),wr={Background:{File:"./assets/images/"+Ar+"x/{}.jpg"},CardFaceAtlas:{Texture:"./assets/textures/"+Ar+"x/{}.png",JSON:"./assets/textures/"+Ar+"x/{}.json"}},Ir=wr.Background,Pr=wr.CardFaceAtlas,kr=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return(n=e.call.apply(e,fe()(t=[this]).call(t,a))||this).events=void 0,n.device=void 0,n.backgroundIdx=void 0,n.cardFaceIdx=void 0,n.cardBackIdx=void 0,n}(0,ot.Z)(t,e);var n=t.prototype;return n.init=function(t){e.prototype.init.call(this,t),this.events=new Phaser.Events.EventEmitter,this.device=GameCore.Utils.Device.isDesktop()?"desktop":"mobile"},n.getCurrentThemeResources=function(){var e=this.getCurrentIdxConfig(),t=e.backgroundIdx,n=e.cardFaceIdx;return this.getThemeResources(t,n)},n.getThemeResources=function(e,t){var n="desktop"===this.device?Er.Desktop:Er.Mobile,i=n.Background[e]||n.Background[0],a=Se(Ir.File,[i]),r=n.CardFace[t]||n.CardFace[0];return{backgroundKey:i,backgroundFile:a,cardFaceKey:r,cardFaceTexture:Se(Pr.Texture,[r]),cardFaceJSON:Se(Pr.JSON,[r])}},n.getBackgroundConfigs=function(){var e,t="desktop"===this.device?Er.Desktop:Er.Mobile;return z()(e=t.Background).call(e,(function(e){return{key:e,url:Se(Ir.File,[e])}}))},n.getCardStyleAtlasConfigs=function(){var e,t="desktop"===this.device?Er.Desktop:Er.Mobile;return z()(e=t.CardFace).call(e,(function(e){return{key:e,textureURL:Se(Pr.Texture,[e]),atlasURL:Se(Pr.JSON,[e])}}))},n.getCurrentThemeConfig=function(){var e=this.backgroundIdx,t=this.cardFaceIdx,n=this.cardBackIdx;return"desktop"==this.device?{backgroundKey:Er.Desktop.Background[e],cardFaceKey:Er.Desktop.CardFace[t],cardBackFrame:Er.Desktop.CardBack[n]}:{backgroundKey:Er.Mobile.Background[e],cardFaceKey:Er.Mobile.CardFace[t],cardBackFrame:Er.Mobile.CardBack[n]}},n.getCurrentIdxConfig=function(){var e=this.game.player.getPlayerSettings(),t=e.backgroundDesktopIdx,n=e.cardFaceDesktopIdx,i=e.cardBackDesktopIdx,a=e.backgroundIdx,r=e.cardFaceIdx,s=e.cardBackIdx;return"desktop"==this.device?{backgroundIdx:t,cardFaceIdx:n,cardBackIdx:i}:{backgroundIdx:a,cardFaceIdx:r,cardBackIdx:s}},n.getThemePreview=function(){return"desktop"===this.device?Er.Desktop:Er.Mobile},n.changeBackground=function(e){"desktop"==this.device?this.game.player.setSetting("backgroundDesktopIdx",e):this.game.player.setSetting("backgroundIdx",e),this.backgroundIdx=e},n.changeCardFace=function(e){"desktop"==this.device?this.game.player.setSetting("cardFaceDesktopIdx",e):this.game.player.setSetting("cardFaceIdx",e),this.cardFaceIdx=e},n.changeCardBack=function(e){"desktop"==this.device?this.game.player.setSetting("cardBackDesktopIdx",e):this.game.player.setSetting("cardBackIdx",e),this.cardBackIdx=e},n.updateCurrentCardStyle=function(){var e=this.getCurrentIdxConfig(),t=e.backgroundIdx,n=e.cardFaceIdx,i=e.cardBackIdx;this.setCurrentStyle(t,n,i)},n.setCurrentStyle=function(e,t,n){this.backgroundIdx=e,this.cardFaceIdx=t,this.cardBackIdx=n},t}(Phaser.Plugins.BasePlugin),xr=kr,_r=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return(n=e.call.apply(e,fe()(t=[this]).call(t,a))||this).isVisible=!0,n.browserPrefixes=["moz","ms","o","","webkit"],n.visibleCallbacks=[],n.hiddenCallbacks=[],n.handleVisibilityChange=function(e){if("boolean"===typeof e)return e?n.onVisibleEvent():n.onHiddenEvent();var t=n.getBrowserPrefix(),i=n.getHiddenPropertyName(t);return document[i]?n.onHiddenEvent():n.onVisibleEvent()},n}(0,ot.Z)(t,e);var n=t.prototype;return n.configure=function(){var e=this,t=this.getBrowserPrefix(),n=this.getVisibilityEvent(t);document.addEventListener(n,this.handleVisibilityChange,!1),document.addEventListener("focus",(function(){e.handleVisibilityChange(!0)}),!1),document.addEventListener("blur",(function(){e.handleVisibilityChange(!1)}),!1),window.addEventListener("focus",(function(){e.handleVisibilityChange(!0)}),!1),window.addEventListener("blur",(function(){e.handleVisibilityChange(!1)}),!1)},n.addEventVisible=function(e){this.visibleCallbacks.push(e)},n.addEventHidden=function(e){this.hiddenCallbacks.push(e)},n.isGameVisible=function(){return this.isVisible},n.getHiddenPropertyName=function(e){return e?e+"Hidden":"hidden"},n.getVisibilityEvent=function(e){return(e||"")+"visibilitychange"},n.getBrowserPrefix=function(){for(var e=0;e<this.browserPrefixes.length;e++)if(this.getHiddenPropertyName(this.browserPrefixes[e])in document)return this.browserPrefixes[e];return""},n.onVisibleEvent=function(){this.isVisible||(this.isVisible=!0,this.visibleCallbacks.forEach((function(e){e()})))},n.onHiddenEvent=function(){this.isVisible&&(this.isVisible=!1,this.hiddenCallbacks.forEach((function(e){e()})))},t}(Phaser.Plugins.BasePlugin),Or=_r,Dr=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return(n=e.call.apply(e,fe()(t=[this]).call(t,a))||this).portraitRatio=void 0,n.portraitWidth=void 0,n.portraitHeight=void 0,n.landscapeRatio=void 0,n.landscapeWidth=void 0,n.landscapeHeight=void 0,n.worldWidth=void 0,n.worldHeight=void 0,n.worldRatio=void 0,n.autoResize=void 0,n.disableLandscape=void 0,n.fullSizeOnLandscape=void 0,n.forcePixelRatio=void 0,n.handleResize=(0,Qe.D)((function(){n.resize()}),300),n}(0,ot.Z)(t,e);var n=t.prototype;return n.configure=function(e){var t=e.autoResize,n=e.portraitRatio,i=e.portraitWidth,a=e.portraitHeight,r=e.landscapeWidth,s=e.landscapeHeight,o=e.landscapeRatio,c=e.disableLandscape,u=e.fullSizeOnLandscape;this.autoResize=t,this.disableLandscape=c,this.fullSizeOnLandscape=u,this.portraitRatio=n,this.portraitWidth=i,this.portraitHeight=a,this.landscapeRatio=o,this.landscapeWidth=r,this.landscapeHeight=s,this.initWorldSize(),this.addEventResize()},n.resize=function(e){var t=this;e&&e>0&&(this.forcePixelRatio=e);var n=this.getCanvasSizeFixedRatio(this.worldRatio),i=n.width,a=n.height;this.resizeCanvas(i,a),this.game.scene.scenes.forEach((function(e){var n=e.cameras.main;if(n){var i=t.getZoomRatio(),a=t.getWorldSize(),r=a.width,s=a.height;n.setZoom(i),n.centerOn(r/2,s/2)}}))},n.resizeCanvas=function(e,t){this.game.canvas.width=e,this.game.canvas.height=t,this.game.scale.resize(e,t)},n.getWorldSize=function(){return{width:this.worldWidth,height:this.worldHeight}},n.initWorldSize=function(){if(this.worldWidth=this.portraitWidth,this.worldHeight=this.portraitHeight,this.isScreenSmallerRatio(this.portraitRatio))this.worldHeight=this.worldWidth/this.getScreenRatio();else if(!this.disableLandscape&&(this.worldWidth=this.landscapeWidth,this.worldHeight=this.landscapeHeight,this.fullSizeOnLandscape)){this.worldRatio=this.worldWidth/this.worldHeight,this.landscapeRatio=this.getScreenRatio();var e=this.getCanvasSizeFixedRatio(this.landscapeRatio),t=e.width,n=e.height,i=this.getZoomRatio();this.worldWidth=t/i,this.worldHeight=n/i}this.worldRatio=this.worldWidth/this.worldHeight,console.info("\ud83d\ude80 > this.worldRatio",this.worldRatio)},n.getZoomRatio=function(){var e=this.getWorldSize().width;return this.getCanvasSizeFixedRatio(this.worldRatio).width/e},n.getPixelRatio=function(){if(this.forcePixelRatio>0)return this.forcePixelRatio;if(GameCore.Utils.Device.isDesktop())return 2;var e=GameCore.Utils.Device.pixelRatio();return e>2&&(e=2),e},n.getPhysicPixels=function(e,t){return e*t},n.getCanvasSizeFixedRatio=function(e){var t=this.getPixelRatio(),n=this.getScreenWidth()*t,i=this.getScreenHeight()*t;return this.isScreenSmallerRatio(e)?i=n/e:n=i*e,{width:n,height:i}},n.getScreenRatio=function(){return this.getScreenWidth()/this.getScreenHeight()},n.getScreenHeight=function(){var e=document,t=e.body,n=e.documentElement,i=t.clientHeight,a=n.clientHeight;return Math.max(a,i)||0},n.getScreenWidth=function(){var e=document,t=e.body,n=e.documentElement,i=t.clientWidth,a=n.clientWidth;return Math.max(a,i)||0},n.isScreenSmallerRatio=function(e){return this.getScreenRatio()<e},n.addEventResize=function(){this.autoResize&&window.addEventListener("resize",this.handleResize)},n.isLandscape=function(){return!this.disableLandscape&&this.worldRatio>this.portraitRatio},t}(Phaser.Plugins.BasePlugin),Br=Dr,Lr=function(){function e(e,t,n){this.contextId=void 0,this.contextType=void 0,this.entryPointData=void 0,this.contextId=e||pa.contextId,this.contextType=t||pa.contextType,this.entryPointData=n||pa.entryPointData}return e.prototype.toObject=function(){return{contextId:this.contextId,contextType:this.contextType,entryPointData:this.entryPointData}},e}(),Rr=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="InvalidPlayerId",i.message=t||"The playerId is not valid",i.payload=n,i}return(0,ot.Z)(t,e),t}((0,wt.Z)(Error)),Gr={score:0,settings:(0,Me.Z)({},ln),userGuideDisplays:0,customFields:{coins:0,gameStats:{},tournaments:[],newUserEasyGameCount:-1}},Nr=Gr.userGuideDisplays,Mr=Gr.customFields,Fr=Gr.settings,Ur=function(){function e(e){this.data=void 0;var t=e.settings,n=e.score,i=e.customFields,a=e.userGuideDisplays,r=GameCore.Utils.Valid.isNumber(n)&&n>0?n:0,s=GameCore.Utils.Valid.isNumber(a)?a:Nr,o=GameCore.Utils.Valid.isObject(i)?i:Mr,c=Fr;GameCore.Utils.Valid.isObject(t)&&(c=new kn(t).toObject()),this.data={score:r,userGuideDisplays:s,settings:c,customFields:o}}return e.prototype.toObject=function(){return this.data},e}(),Zr="share_invite",Hr="tournament",Wr="challenge_friend_match",zr="matching_group_match",Yr=n(529),Vr=new ei.Z("10","Your Friend",Yr.Z.AVATAR.FILE).toObject(),Kr="single",jr="challenge-friends",Xr="matching-group",Jr="tournaments",qr=(0,Kt.P1)([function(e){return e.context}],(function(e){return e})),Qr=(0,Kt.P1)([function(e){return e.context.currentGameMode}],(function(e){return e}));!function(e){e.GAME_MODE_CHANGED="game-mode-changed",e.BACKGROUND_CHANGED="background-changed",e.GAME_START="game-start"}(da||(da={}));var $r,es=da;!function(e){e.SINGLE="single",e.CHALLENGE_FRIENDS="challenge-friends",e.TOURNAMENT="tournaments"}($r||($r={}));var ts=$r,ns=function(e){function t(){var t;return(t=e.call(this)||this).gameMode=void 0,t.autoPlaySingleMode=void 0,t.friendsChallenged=void 0,t.isGameLoadedInTournament=!1,t.gameMode=ts.SINGLE,t.autoPlaySingleMode=!0,t.friendsChallenged=[],t}(0,ot.Z)(t,e);var n=t.prototype;return n.setGameMode=function(e){this.gameMode=e,console.log("\ud83e\udd16 ? Set game mode:",this.gameMode),this.emit(es.GAME_MODE_CHANGED)},n.getGameMode=function(){return this.gameMode},n.isSingleMode=function(){return this.gameMode==ts.SINGLE},n.isChallengeMode=function(){return this.gameMode==ts.CHALLENGE_FRIENDS},n.isTournamentMode=function(){return this.gameMode===ts.TOURNAMENT},(0,Wt.Z)(t,null,[{key:"instance",get:function(){return this._instance||(this._instance=new t)}}]),t}(Phaser.Events.EventEmitter);ns._instance=void 0;var is,as=ns,rs=function(e,t){return{type:na.fJ,payload:{contextId:e,contextType:t}}},ss=function(e){return function(t){t({type:na.EH,payload:{gameMode:e}}),(0,at.sw)("game-mode",e)}},os={score:"score",settings:"settings",gameData:"gameData",userGuideDisplays:"userGuideDisplays"},cs=GameCore.Configs,us=cs.AppId,ls=cs.SyncProfileFromAPI,hs=function(e){var t=this;this.game=void 0,this.initContext=function(){var e=window.FBInstant.context.getID(),n=window.FBInstant.context.getType(),i=window.FBInstant.getEntryPointData(),a=new Lr(e,n,i).toObject(),r=a.contextId,s=a.contextType,o=a.entryPointData;t.game.storage.dispatch(function(e,t,n){return{type:na.kL,payload:{contextId:e,contextType:t,entryPointData:n}}}(r,s,o))},this.initPlayer=(0,st.Z)(ut().mark((function e(){var n,i,a,r,s;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.game.player,i=t.getPlayerInfo(),a=ir()(os),e.next=5,FBInstant.player.getDataAsync(a);case 5:return r=e.sent,console.info("\ud83d\ude80 > rawData",r),s=new Dn(r),console.info("\ud83d\ude80 > playerData",s),e.next=11,t.syncDataFromAPI(s);case 11:return s=e.sent,!0===s.toObject().settings.music&&window.game.audio.playMusic(),e.next=16,n.receiveData(i,s.convertToPlayerData());case 16:case"end":return e.stop()}}),e)}))),this.syncDataFromAPI=function(){var e=(0,st.Z)(ut().mark((function e(n){var i,a,r,s,o,c;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,ls){e.next=3;break}return e.abrupt("return",n);case 3:return e.next=5,FBInstant.player.getDataAsync(["isSynced"]);case 5:if(e.t0=e.sent,e.t0){e.next=8;break}e.t0={};case 8:if(i=e.t0,!0!==(i.isSynced||!1)){e.next=12;break}return e.abrupt("return",n);case 12:if(a=t.getPlayerInfo(),r=window.FBInstant.player.getID(),a.playerId===r){e.next=16;break}return e.abrupt("return",n);case 16:return e.next=18,Vn({appId:us,playerId:r,name:a.name,photo:a.photo,locale:a.locale});case 18:return s=e.sent,o=new Ur(s).toObject(),c=new Dn({}).convertToFacebookData(o),FBInstant.player.setDataAsync((0,Me.Z)({},c,{isSynced:!0})),e.abrupt("return",new Dn(c));case 25:return e.prev=25,e.t1=e.catch(0),console.warn(e.t1),e.abrupt("return",n);case 29:case"end":return e.stop()}}),e,null,[[0,25]])})));return function(t){return e.apply(this,arguments)}}(),this.getPlayerInfo=function(){try{var e=window.FBInstant.player.getID(),t=window.FBInstant.player.getName(),n=window.FBInstant.player.getPhoto(),i=window.FBInstant.getLocale();if(!GameCore.Utils.Valid.isString(e))throw new Rr(null,{playerId:e});return GameCore.Utils.Valid.isString(t)||(t="You"),new ei.Z(e,t,n,i).toObject()}catch(a){return new ei.Z("123","You").toObject()}},this.game=e},ds=n(448),fs=n(538),ps=function(e){function t(t){var n;return(n=e.call(this,{game:t,fragShader:"\nprecision mediump float;\n\nuniform sampler2D uMainSampler[%count%];\nuniform float gray;\n\nvarying vec2 outTexCoord;\nvarying float outTexId;\nvarying vec4 outTint;\nvarying vec2 fragCoord;\n\nvoid main()\n{\n    vec4 texture;\n\n    %forloop%\n\n    gl_FragColor = texture;\n    gl_FragColor.rgb = mix(gl_FragColor.rgb, vec3(0.2126 * gl_FragColor.r + 0.7152 * gl_FragColor.g + 0.0722 * gl_FragColor.b), gray);\n}",uniforms:["uProjectionMatrix","uMainSampler","gray"]})||this).gray=void 0,n.gray=.8,n}return(0,ot.Z)(t,e),t.prototype.onPreRender=function(){this.set1f("gray",this.gray)},t}(Phaser.Renderer.WebGL.Pipelines.MultiPipeline),gs=[Vi._.BUTTON_CLICK,Vi._.SCREEN_OPEN],ms=function(e){function t(t,n,i){var a;return(a=e.call(this,"FacebookAnalytics",{prefix:n},"#0F52BA")||this).game=void 0,a.game=t,a.selfLog=!!i,a}(0,ot.Z)(t,e);var n=t.prototype;return n.processEvent=function(e,t,n){var i;if(!(g()(gs).call(gs,e)>=0)){var a=this.getEventName(e),r={};z()(i=M()(t||{})).call(i,(function(e){t&&"string"===typeof t[e]&&(r[e]=t[e])})),FBInstant.logEvent(a,n,r)}},n.processPageView=function(e){},n.processLevelStart=function(e,t,n){this.processEvent(Vi._.LEVEL_START,{level:e,score:t,level_name:n})},n.processLevelRescue=function(e,t,n){this.processEvent(Vi._.LEVEL_RESCUE,{level:e,score:t,level_name:n})},n.processLevelFail=function(e,t,n){this.processEvent(Vi._.LEVEL_END,{level:e,score:t,level_name:n,success:!1})},n.processLevelComplete=function(e,t,n){this.processEvent(Vi._.LEVEL_END,{level:e,score:t,level_name:n,success:!0})},n.processShowInterstitialAd=function(e){this.processEvent(Vi._.AD_SHOW,{ad_type:"interstitial",screen_name:""+e})},n.processShowRewardedVideoAd=function(e){this.processEvent(Vi._.AD_SHOW,{ad_type:"rewarded_video",screen_name:""+e})},n.processShowAdFail=function(e,t){var n=e===GameCore.Ads.Types.REWARDED?"rewarded_video":"interstitial";this.processEvent(Vi._.AD_SHOW_FAILED,{ad_type:n,screen_name:""+t})},n.getEventName=function(e){return this.options.prefix+"_"+e},t}(GameCore.Analytics.BaseAnalytics),vs=[Vi._.SCREEN_OPEN],ys=(function(e){function t(t,n){var i;(i=e.call(this,"GoogleAnalytics",(0,Me.Z)({},n),"#E35335")||this).game=void 0,i.trackingId=void 0,i.currentPath="/";var a=n.trackingId;i.game=t;var r=(GameCore.Configs.Analytics.GoogleAnalytics||{}).consoleLog;return i.selfLog=!!r,i.trackingId=a,i}(0,ot.Z)(t,e);var n=t.prototype;n.processEvent=function(e,t,n){if(!(g()(vs).call(vs,e)>=0)){var i=this.formatEventName(e),a=t?(0,Me.Z)({},t):{};a=n?(0,Me.Z)({},a,{value:n}):a,a=(0,Me.Z)({},a,{page_path:this.currentPath,send_to:"GA"}),gtag("event",i,a)}},n.processLevelStart=function(e,t,n){this.processEvent(Vi._.LEVEL_START,{level:e,score:t,level_name:n})},n.processLevelRescue=function(e,t,n){this.processEvent(Vi._.LEVEL_RESCUE,{level:e,score:t,level_name:n})},n.processLevelFail=function(e,t,n){this.processEvent(Vi._.LEVEL_END,{level:e,score:t,level_name:n,success:!1})},n.processLevelComplete=function(e,t,n){this.processEvent(Vi._.LEVEL_END,{level:e,score:t,level_name:n,success:!0})},n.processShowInterstitialAd=function(e){this.processEvent(Vi._.AD_SHOW,{ad_type:"interstitial",screen_name:""+e}),this.processEvent(Vi._.AD_IMPRESSION,{ad_format:"Interstitial"})},n.processShowRewardedVideoAd=function(e){this.processEvent(Vi._.AD_SHOW,{ad_type:"rewarded_video",screen_name:""+e}),this.processEvent(Vi._.AD_IMPRESSION,{ad_format:"Rewarded"})},n.processShowAdFail=function(e,t){var n=e===GameCore.Ads.Types.REWARDED?"rewarded_video":"interstitial";this.processEvent(Vi._.AD_SHOW_FAILED,{ad_type:n,screen_name:""+t})},n.processPageView=function(e){var t=this.getGameplayMode(),n="/"+t+"/"+e;this.currentPath=n,document.title=this.formatPageTitle(t,e),gtag("event","page_view",{page_path:this.currentPath,send_to:["GA",this.trackingId]})},n.getGameplayMode=function(){var e=this.game.storage.getState();return Qr(e)},n.formatEventName=function(e){return e.toLowerCase().replace(/:/g,"_")},n.formatPageTitle=function(e,t){return this.toUpperCamelCaseWithSpace(e)+"::"+this.toUpperCamelCaseWithSpace(t)},n.toUpperCamelCaseWithSpace=function(e){var t=e.replace(/[-_\s.]+(.)?/g,(function(e,t){return t?" "+t.toUpperCase():""}));return t.substr(0,1).toUpperCase()+t.substr(1)}}(GameCore.Analytics.BaseAnalytics),function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return(n=e.call.apply(e,fe()(t=[this]).call(t,a))||this).startGame=(0,st.Z)(ut().mark((function e(){return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.auth.requestToken();case 3:return e.next=5,n.storage.syncStore();case 5:return n.configureSentry(),n.configureRollbar(),e.next=9,n.detectGameMode();case 9:n.initGoogleAnalytics(),n.initFacebookAnalytics(),n.analytics.event(Vi._.LOAD_START),n.scene.launch(fs.C.GLOBAL_SCENE),n.scene.start(fs.C.LOAD_SCENE),n.analytics.pageview(fs.C.LOAD_SCENE),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(0),(0,at.tO)(e.t0);case 20:return e.prev=20,n.facebook.progressLoading.finishLoadingProgressFbBootScene(),n.scene.sleep(fs.C.BOOT_SCENE),e.finish(20);case 24:case"end":return e.stop()}}),e,null,[[0,17,20,24]])}))),n}(0,ot.Z)(t,e);var n=t.prototype;return n.create=function(){this.facebook.progressLoading.loadingProgressFbBootScene(),this.startGame()},n.configureSentry=function(){var e=this.player.getPlayer();(0,at.Tv)({id:e.playerId,username:e.name})},n.configureRollbar=function(){if(this.rollbar){var e=this.player.getPlayer();this.rollbar.configure({payload:{person:{id:e.playerId,name:e.name}}})}},n.detectGameMode=function(){var e=(0,st.Z)(ut().mark((function e(){return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.storage.dispatch(function(){var e=(0,st.Z)(ut().mark((function e(t,n){var i,a,r,s,o,c,u,l,d,f,p,g,m,v,y,b,S,T;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n(),r=qr(a),s=window.game.player,o=s.getPlayerId(),c=r.contextId,u=r.entryPointData,d=(l=u||{}).type,f=l.matchId,p=l.playerId,g=l.opponentId,m=void 0===g?Vr.playerId:g,v=l.tournamentContextId,y=o===p,b=m===Vr.playerId,S=b||h()(i=[m,p]).call(i,o),T=Kr,e.prev=10,e.next=13,window.game.facebook.getTournamentAsync();case 13:T=Jr,e.next=18;break;case 16:e.prev=16,e.t0=e.catch(10);case 18:c&&(void 0===d||d===Hr)&&as.instance.isGameLoadedInTournament&&(T=Jr),d===Hr&&v&&(T=Jr),c&&d===Zr&&!y&&(T=jr),f&&c&&S&&d===Wr&&(T=jr),c&&d===zr&&(T=Xr),t(ss(T));case 24:case"end":return e.stop()}}),e,null,[[10,16]])})));return function(t,n){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.initGoogleAnalytics=function(){},n.initFacebookAnalytics=function(){var e=GameCore.Configs.Analytics.FacebookAnalytics||{},t=e.prefix,n=e.consoleLog;"string"===typeof t?this.analytics.add(new ms(this.game,t,n)):console.error("FacebookAnalytics: prefix is not defined")},t}(Phaser.Scene)),bs=ys,Ss=n(550),Ts=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return(n=e.call.apply(e,fe()(t=[this]).call(t,a))||this).run=function(){n.scene.switch(fs.C.GAME_SCENE),n.facebook.attemptToAddShortcut()},n}(0,ot.Z)(t,e);var n=t.prototype;return n.preload=function(){this.events.on("wake",this.run),this.events.on("resume",this.run),this.events.on("create",this.run)},n.create=function(){e.prototype.create.call(this)},t}(Ss.Z),Es=Ts,Cs=n(526),As=n(540),ws=n(501),Is=n.n(ws);!function(e){e[e.NONE=0]="NONE",e[e.DEALING=1]="DEALING",e[e.IDLE=2]="IDLE",e[e.PLAYING=3]="PLAYING",e[e.AUTO_COMPLETING=4]="AUTO_COMPLETING",e[e.OUT_OF_MOVE=5]="OUT_OF_MOVE",e[e.GAME_OVER=6]="GAME_OVER"}(is||(is={}));var Ps,ks,xs,_s,Os,Ds=n(541),Bs=Ds.Z.GAMEPLAY_DEFAULT,Ls=Bs.KEY,Rs=Bs.FRAME,Gs=function(e){function t(t){var n;return(n=e.call(this,t)||this).hand=void 0,n.handScaleDefault=1,n.name="TutorialHand",n.addHand(),n.hand.scale,n.scene.add.existing((0,Cs.Z)(n)),n}(0,ot.Z)(t,e);var n=t.prototype;return n.addHand=function(){this.hand=this.scene.make.image({key:Ls,frame:Rs.HAND,origin:{x:.5,y:.5}}),this.hand.setWorldSize(65.5,55.5),this.handScaleDefault=this.hand.scale,this.resetHandPosition(),this.add(this.hand)},n.doubleTap=function(e,t,n){var i=this;this.setHandPositionOnDoubleClick(),this.scene.tweens.add({delay:e,targets:[this.hand],ease:Phaser.Math.Easing.Cubic.In,props:{scale:{duration:100,from:this.handScaleDefault,to:.8*this.handScaleDefault},angle:{from:0,value:-10,duration:100}},loop:1,yoyo:!0,onComplete:function(){t&&i.hide(),n&&n()}})},n.tapAndHold=function(e,t){this.scene.tweens.add({delay:e,targets:[this.hand],ease:Phaser.Math.Easing.Cubic.Out,props:{scale:{duration:200,from:this.handScaleDefault,to:.8*this.handScaleDefault},angle:{from:0,value:-10,duration:200}},onComplete:t})},n.unHold=function(e,t,n){var i=this;this.scene.tweens.add({delay:e,targets:[this.hand],ease:Phaser.Math.Easing.Cubic.Out,props:{scale:{duration:200,from:.8*this.handScaleDefault,to:this.handScaleDefault},angle:{from:-10,value:0,duration:200}},onComplete:function(){t&&i.hide(),n&&n()}})},n.show=function(){this.hand.setVisible(!0)},n.hide=function(){this.hand.setVisible(!1)},n.preDestroy=function(){this.scene.tweens.killTweensOf(this.hand)},n.kill=function(){e.prototype.kill.call(this),this.resetHandPosition()},n.setHandPositionOnDoubleClick=function(){this.hand.setPosition(5,5)},n.resetHandPosition=function(){this.hand.setPosition(20,20)},t}(Phaser.GameObjects.Container),Ns=Gs,Ms=n(171),Fs=n.n(Ms),Us=n(91),Zs=n.n(Us);!function(e){e[e.ACE=301]="ACE",e[e.TWO=302]="TWO",e[e.THREE=303]="THREE",e[e.FOUR=304]="FOUR",e[e.FIVE=305]="FIVE",e[e.SIX=306]="SIX",e[e.SEVEN=307]="SEVEN",e[e.EIGHT=308]="EIGHT",e[e.NINE=309]="NINE",e[e.TEN=310]="TEN",e[e.JACK=311]="JACK",e[e.QUEEN=312]="QUEEN",e[e.KING=313]="KING"}(Ps||(Ps={})),function(e){e[e.ACE=201]="ACE",e[e.TWO=202]="TWO",e[e.THREE=203]="THREE",e[e.FOUR=204]="FOUR",e[e.FIVE=205]="FIVE",e[e.SIX=206]="SIX",e[e.SEVEN=207]="SEVEN",e[e.EIGHT=208]="EIGHT",e[e.NINE=209]="NINE",e[e.TEN=210]="TEN",e[e.JACK=211]="JACK",e[e.QUEEN=212]="QUEEN",e[e.KING=213]="KING"}(ks||(ks={})),function(e){e[e.ACE=101]="ACE",e[e.TWO=102]="TWO",e[e.THREE=103]="THREE",e[e.FOUR=104]="FOUR",e[e.FIVE=105]="FIVE",e[e.SIX=106]="SIX",e[e.SEVEN=107]="SEVEN",e[e.EIGHT=108]="EIGHT",e[e.NINE=109]="NINE",e[e.TEN=110]="TEN",e[e.JACK=111]="JACK",e[e.QUEEN=112]="QUEEN",e[e.KING=113]="KING"}(xs||(xs={})),function(e){e[e.ACE=401]="ACE",e[e.TWO=402]="TWO",e[e.THREE=403]="THREE",e[e.FOUR=404]="FOUR",e[e.FIVE=405]="FIVE",e[e.SIX=406]="SIX",e[e.SEVEN=407]="SEVEN",e[e.EIGHT=408]="EIGHT",e[e.NINE=409]="NINE",e[e.TEN=410]="TEN",e[e.JACK=411]="JACK",e[e.QUEEN=412]="QUEEN",e[e.KING=413]="KING"}(_s||(_s={})),function(e){e[e.ACE=1]="ACE",e[e.TWO=2]="TWO",e[e.THREE=3]="THREE",e[e.FOUR=4]="FOUR",e[e.FIVE=5]="FIVE",e[e.SIX=6]="SIX",e[e.SEVEN=7]="SEVEN",e[e.EIGHT=8]="EIGHT",e[e.NINE=9]="NINE",e[e.TEN=10]="TEN",e[e.JACK=11]="JACK",e[e.QUEEN=12]="QUEEN",e[e.KING=13]="KING"}(Os||(Os={}));var Hs,Ws={DEPTH:{REMAINING_STOCK:12,HINT:11,CARD:10,CARD_SLOT:9},FOUNDATION_Y:70,VERTICAL_PILE_SPACE:20,MAX_HORIZONTAL_PILE_SPACE:52,SPACE_BETWEEN_PILE_AND_FOUNDATION:65,CARD_WIDTH:49,CARD_HEIGHT:72,NUMBER_OF_TARGET:4,NUMBER_OF_PILE:7},zs=function(){var e=window.game.globalScene.gameZone.width,t=1.3*Ws.CARD_WIDTH,n=e/11>t?t:e/11,i=n/Ws.CARD_WIDTH>1.3?1.3:n/Ws.CARD_WIDTH;Ws.CARD_HEIGHT*=i,Ws.CARD_WIDTH=n,Ws.VERTICAL_PILE_SPACE*=i,Ws.MAX_HORIZONTAL_PILE_SPACE*=i,window.game.world.isLandscape()&&(Ws.SPACE_BETWEEN_PILE_AND_FOUNDATION=85)},Ys=function(e){Ws.FOUNDATION_Y=e},Vs=Ws,Ks=n(499),js=function(e){function t(t,n){var i;return(i=e.call(this,t,0,0,Ds.Z.GAMEPLAY_DEFAULT.KEY,"card-bg")||this).parent=void 0,i.updateFromParent=function(){i.setPosition(i.parent.x,i.parent.y+1),i.setScale(i.parent.scaleX,i.parent.scaleY),i.setVisible(i.parent.visible)},i.parent=n,i.setDepth(Vs.DEPTH.CARD_SLOT),i.updateFromParent(),t.add.existing((0,Cs.Z)(i)),i}return(0,ot.Z)(t,e),t}(Phaser.GameObjects.Image),Xs=js,Js=Ds.Z.CARD_BACK,qs=function(e){function t(t,n){var i;return(i=e.call(this,t,0,0,"")||this).scene=void 0,i.bg=void 0,i.tag=void 0,i.facingUp=void 0,i.oldX=void 0,i.oldY=void 0,i.shakePosition=void 0,i.facingTween=void 0,i.movingTween=void 0,i.moves=void 0,i.placement=void 0,i.originalCardIdx=void 0,i.setFacing=function(e){i.facingUp=e,e?(i.setCardFace(),i.clearTint()):(i.setCardBack(),i.setTint(13684944))},i.scene=t,i.createBackground(),i.tag=n,i.moves=[],i.facingUp=!1,i.originalCardIdx=-1,t.add.existing((0,Cs.Z)(i)),i.addBehavior(),i}(0,ot.Z)(t,e);var n=t.prototype;return n.createBackground=function(){var e=new Xs(this.scene,this);this.bg=e,this.scene.events.on(Phaser.Scenes.Events.POST_UPDATE,e.updateFromParent)},n.updateCardStyle=function(){this.setFacing(this.facingUp),this.input||(this.setInteractive({useHandCursor:!0,draggable:!0}),this.disableInteractive()),this.updateSize()},n.setPlacement=function(e){this.placement=e},n.setOriginalCardIdx=function(e){this.originalCardIdx=e},n.shake=function(){var e,t;null!=(e=this.movingTween)&&e.isPlaying()||(null!=(t=this.shakePosition)&&t.isPaused&&(this.shakePosition.stop(),this.shakePosition=new Ks.Z(this)),this.shakePosition.setMagnitude(1.2),this.shakePosition.setDuration(500),this.shakePosition.shake())},n.setFacingWithFlippingAnim=function(e,t){var n,i=this;void 0===t&&(t=0),this.facingUp!==e&&(this.facingUp=e,null==(n=this.facingTween)||n.remove(),this.updateSize(),this.facingTween=this.scene.tweens.add({targets:this,delay:t,scaleX:0,yoyo:!0,duration:150,onYoyo:function(){return i.setFacing(e)}}))},n.isFacingUp=function(){return this.facingUp},n.getTag=function(){return this.tag},n.getSavingData=function(){return this.tag+"|"+this.originalCardIdx},n.isAce=function(){return this.tag%100===Os.ACE},n.isKing=function(){return this.tag%100===Os.KING},n.moveTo=function(e,t,n,i,a,r){var s,o=this;void 0===n&&(n=0),void 0===i&&(i=0),this.shakePosition.isRunning&&this.shakePosition.pause(),null==(s=this.movingTween)||s.remove(),e==this.x&&t==this.y||(this.movingTween=this.scene.tweens.add({targets:this,delay:i,x:e,y:t,duration:n,ease:Phaser.Math.Easing.Sine.Out,onStart:function(){a&&a()},onComplete:function(){o.setPosition(e,t),r&&r()}}))},n.isMoving=function(){return this.movingTween&&(this.movingTween.isPlaying()||!this.movingTween.hasStarted)},n.reset=function(){var e,t;null==(e=this.movingTween)||e.remove(),null==(t=this.facingTween)||t.complete(),this.updateSize(),this.disableInteractive(),this.setFacing(!1)},n.setTag=function(e){this.tag=e},n.setCardFace=function(){var e=this.scene.theme.getCurrentThemeConfig().cardFaceKey,t=this.tag;this.setTexture(e,""+t)},n.setCardBack=function(){var e=this.scene.theme.getCurrentThemeConfig().cardBackFrame;this.setTexture(Js.KEY,e)},n.updateSize=function(){var e=Vs.CARD_WIDTH,t=Vs.CARD_HEIGHT;this.setWorldSize(e,t)},n.addBehavior=function(){this.shakePosition=new Ks.Z(this,{duration:500,magnitude:2})},n.setNotAvailableToMoveTint=function(){this.setTint(13684944)},n.resetCardTint=function(){this.clearTint()},t}(Phaser.GameObjects.Image),Qs=qs,$s=function(){var e=(0,st.Z)(ut().mark((function e(t,n){return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new(xe())((function(e){t.time.delayedCall(n,e)})));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),eo=$s,to=Ds.Z.GAMEPLAY_DEFAULT.KEY,no=function(e){function t(t,n){var i;(i=e.call(this,t,0,0,to,"ic_slot")||this).placement=void 0;var a=Vs.CARD_WIDTH,r=Vs.CARD_HEIGHT,s=Vs.DEPTH;return i.placement=n,i.setInteractive(),i.disableInteractive(),i.setAlpha(.6).setWorldSize(a,r),i.setInteractive({useHandCursor:!0}),i.setDepth(s.CARD_SLOT),i.scene.add.existing((0,Cs.Z)(i)),i}(0,ot.Z)(t,e);var n=t.prototype;return n.onClick=function(e){var t=!1;this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,(function(){t=!0})),this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_UP,(function(){t&&e(),t=!1})),this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_OUT,(function(){t=!1}))},n.offClick=function(){this.off(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN),this.off(Phaser.Input.Events.GAMEOBJECT_POINTER_UP),this.off(Phaser.Input.Events.GAMEOBJECT_POINTER_OUT)},t}(Phaser.GameObjects.Image),io=no,ao=function(e){function t(t){var n;return(n=e.call(this)||this).boardGame=void 0,n.slot=void 0,n.cards=void 0,n.x=void 0,n.y=void 0,n.name=void 0,n.idx=void 0,n.active=void 0,n.boardGame=t,n.cards=[],n.active=!0,n.slot=new io(t.scene,(0,Cs.Z)(n)),n.setIdx(-1),n}(0,ot.Z)(t,e);var n=t.prototype;return n.setName=function(e){this.name=e},n.setIdx=function(e){this.idx=e},n.getIdx=function(){return this.idx},n.getname=function(){return this.name},n.setPosition=function(e,t){this.x=e,this.y=t,this.slot.setPosition(e,t)},n.addCard=function(e,t){if(e instanceof Qs){if(e.scene.gameplay.cardsLayer.bringToTop(e.bg),e.scene.gameplay.cardsLayer.bringToTop(e),e.setPlacement(this),t){var n=this.getPlacingPosition(this.cards.length),i=n.x,a=n.y;e.moveTo(i,a,300)}this.cards.push(e)}else for(var r=this.getPlacingPosition(this.cards.length),s=r.x,o=r.y,c=0;c<e.length;c++){var u=e[c];if(u.scene.gameplay.cardsLayer.bringToTop(u.bg),u.scene.gameplay.cardsLayer.bringToTop(u),u.setPlacement(this),t){var l=o+c*this.boardGame.getVerticalSpacePile();u.moveTo(s,l,300)}this.cards.push(u)}},n.pickTopCards=function(e){var t,n=this.cards.length;return 0==n?[]:Zs()(t=this.cards).call(t,Math.max(n-e,0))},n.getLastCard=function(){return this.cards[this.cards.length-1]},n.getPlacingPosition=function(e){return{x:this.x,y:this.y}},n.getPlacingPositionForContinueGame=function(e){return{x:this.x,y:this.y}},n.addCardsFromSaveData=function(){var e=(0,st.Z)(ut().mark((function e(t,n){var i,a,r,s,o,c,u,l;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=this.boardGame,a=i.deck,r=i.scene,s=0;case 2:if(!(s<t.length)){e.next=14;break}return o=t[s].split("|"),c=yt()(o[0]),u=yt()(o[1]),(l=a.setUpCardWhenContinueGame(c,this,t.length,u)).setFacingWithFlippingAnim(!0),l.setInteractive(),e.next=11,eo(r,30);case 11:s++,e.next=2;break;case 14:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.getCardVerticalSpaceForContinueGame=function(e){return 0},n.canBePlace=function(e){return!1},n.update=function(e){},n.clear=function(){this.cards=[]},n.isEmpty=function(){return 0===this.cards.length},n.pickAllCards=function(){var e;return Zs()(e=this.cards).call(e,0)},n.kill=function(){this.active=!1,this.slot.kill(),this.clear()},n.revive=function(){this.active=!0,this.slot.revive()},t}(Phaser.Events.EventEmitter),ro=ao;!function(e){e.Stock="stock",e.Waste="waste",e.Pile="pile",e.Foundation="foundation"}(Hs||(Hs={}));var so=Hs,oo=function(e){function t(t){var n;return(n=e.call(this,t)||this).setName(so.Pile),n}(0,ot.Z)(t,e);var n=t.prototype;return n.addCardsFromSaveData=function(){var e=(0,st.Z)(ut().mark((function e(t,n){var i,a,r,s,o,c,u,l,h;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=this.boardGame,a=i.deck,r=i.scene,s=this.boardGame.scene.levelHandler.replayCardStatus,o=0;case 3:if(!(o<t.length)){e.next=15;break}return c=t[o].split("|"),u=yt()(c[0]),l=yt()(c[1]),u<100&&s[l]>100&&(u=s[l]),h=a.setUpCardWhenContinueGame(u,this,t.length,l),o>=n&&(h.setFacingWithFlippingAnim(!0),h.setInteractive()),e.next=12,eo(r,30);case 12:o++,e.next=3;break;case 15:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.getPlacingPosition=function(){var e=this.x,t=this.y,n=this.checkIfResizeNeeded(),i=this.boardGame.getVerticalSpacePile();if(!n){for(var a=0;a<this.cards.length;a++)this.cards[a].isFacingUp()?t+=i:t+=.5*i;return{x:e,y:t}}var r=this.cards.length-this.getMaximumRevealedCards(),s=r-4>0?r-4:0,o=this.getSpacesBetweenHiddenCards(r);o>.5*i&&0==s&&(o=.5*i);for(var c=0;c<this.cards.length;c++)c<s||(c>r&&this.cards[c].isFacingUp()?t+=i:t+=o);return{x:e,y:t}},n.getPlacingPositionForContinueGame=function(e){var t=this.getCardVerticalSpaceForContinueGame(e);t>this.boardGame.getVerticalSpacePile()&&(t=this.boardGame.getVerticalSpacePile());for(var n=this.y,i=1;i<this.cards.length;i++){this.cards[i].isFacingUp()?n+=t:n+=.5*t}return{x:this.x,y:n}},n.getCardVerticalSpaceForContinueGame=function(e){return(this.getPileHeightLimit()-Vs.CARD_HEIGHT)/e},n.resizePile=function(){var e=this.x,t=this.y,n=this.checkIfResizeNeeded(),i=this.boardGame.getVerticalSpacePile();if(n){var a=this.cards.length-this.getMaximumRevealedCards(),r=a-4>0?a-4:0,s=this.getSpacesBetweenHiddenCards(a);s>.5*i&&0==r&&(s=.5*i);for(var o=0;o<this.cards.length;o++){var c=this.cards[o];if(o>r){var u=this.cards[o-1];o>a&&u.isFacingUp()?t+=i:t+=s}c.x===e&&c.y===t||c.moveTo(e,t,100)}}else for(var l=0;l<this.cards.length;l++){var h=this.cards[l];if(0!==l)this.cards[l-1].isFacingUp()?t+=i:t+=.5*i;h.x===e&&h.y===t||h.moveTo(e,t,100)}},n.getPileHeight=function(){var e=this.cards.length;if(0==e)return 0;for(var t=this.cards[0].height,n=this.boardGame.getVerticalSpacePile(),i=1;i<e;i++){this.cards[i].isFacingUp()?t+=n:t+=.5*n}return t},n.getPileHeightLimit=function(){return.7*this.boardGame.scene.gameZone.height},n.getMaximumRevealedCards=function(){var e=this.cards[0].height,t=this.getPileHeightLimit(),n=this.boardGame.getVerticalSpacePile(),i=t-e+n;return Math.floor(i/n)-1},n.getSpacesBetweenHiddenCards=function(e){var t=this.cards[0].height,n=this.getMaximumRevealedCards(),i=this.boardGame.getVerticalSpacePile(),a=(this.getPileHeightLimit()-t+i-n*i)/e;return Math.max(a,i/6)},n.checkIfResizeNeeded=function(){var e=this.getPileHeightLimit();return this.getPileHeight()>e},n.getSubCards=function(e){var t,n,i=Fs()(t=this.cards).call(t,(function(t){return t===e}));return s()(n=this.cards).call(n,i)},n.pickSubCards=function(e){var t,n,i=Fs()(t=this.cards).call(t,(function(t){return t===e}));return Zs()(n=this.cards).call(n,i)},n.removeLastCard=function(){if(this.cards.length>0)return this.cards.pop()},n.getFacingUpCards=function(){var e,t;if(0===this.cards.length)return[];var n=Fs()(e=this.cards).call(e,(function(e){return e.isFacingUp()}));return n<0?[]:s()(t=this.cards).call(t,n)},n.faceUpLast=function(e){void 0===e&&(e=0);var t=this.cards.length;if(t>0){var n=this.cards[t-1];if(n.isFacingUp())return;return n.getTag()<100&&this.boardGame.difficultyHandler.setDynamicTagForBackfaceCard(n),n.setFacingWithFlippingAnim(!0,e),n.setInteractive(),n}this.slot.setInteractive()},n.faceDownLast=function(){var e=this.cards.length;if(e>0){var t=this.cards[e-1];return t.setFacingWithFlippingAnim(!1),t.disableInteractive(),t}this.slot.setInteractive()},n.canBePlace=function(e){var t=e.getTag()%100;return 0===this.cards.length||t==this.cards[this.cards.length-1].getTag()%100-1},n.getTopCardStackData=function(){var e=this.cards.length;if(0===e)return null;var t=Math.floor(this.cards[e-1].getTag()/100);if(1===e)return{color:t,length:1};for(var n=1,i=this.cards[e-1].getTag()%100,a=e-2;a>=0;a--){var r=this.cards[a],s=Math.floor(r.getTag()/100),o=r.getTag()%100;if(!1===r.isFacingUp())break;if(s!==t||o-1!==i)break;n++,i=o}return{color:t,length:n}},n.updateCardTintByAvailability=function(){var e=this.cards.length;if(0!==e){var t=this.getTopCardStackData();if(null!==t)for(var n=t.length,i=1;e-i>=0;i++){var a=this.cards[e-i];if(!1===a.isFacingUp())break;i<=n?a.resetCardTint():a.setNotAvailableToMoveTint()}}},n.canBeHint=function(e){var t=e.getTag()%100;return 0===this.cards.length||t==this.cards[this.cards.length-1].getTag()%100-1},n.isLastCard=function(e){return this.cards[this.cards.length-1]===e},n.getFaceDownCardAmount=function(){for(var e=0,t=0;t<this.cards.length;t++){if(!1!==this.cards[t].isFacingUp())break;e++}return e},n.clear=function(){this.cards=[]},t}(ro),co=oo,uo=Ds.Z.CARD_BACK,lo=Vs.DEPTH,ho=function(){function e(e){this.boardGame=void 0,this.bg=void 0,this.hintContainer=void 0,this.group=void 0,this.hintTween=void 0,this.hand=void 0,this.boardGame=e,this.group=e.scene.add.group({defaultKey:Ds.Z.GAMEPLAY_DEFAULT.KEY}),this.createBg(),this.createContainer(),this.createTutorialHand()}var t=e.prototype;return t.createBg=function(){var e=this.boardGame.scene.add.image(0,0,Ds.Z.GAMEPLAY_DEFAULT.KEY,"blank"),t=this.boardGame.scene.world.getWorldSize(),n=t.width,i=t.height;e.setOrigin(0,0),e.setWorldSize(n,i),e.setAlpha(.5),e.setTint(859421),e.setDepth(lo.HINT),e.kill(),this.bg=e},t.createContainer=function(){this.hintContainer=this.boardGame.scene.add.container(),this.hintContainer.setDepth(lo.HINT)},t.showDealerHint=function(){var e,t=this;if((null==(e=this.hintTween)||!e.isPlaying())&&!(this.hintTween&&this.hintTween.countdown>0)&&!this.hand.visible){if(this.boardGame.stock.cards.length>0){var n=this.createCardBack();this.hintContainer.add([n])}var i=this.createHintGlow(),a=this.boardGame.stock.getPlacingPosition(0),r=a.x,s=a.y;this.hintContainer.add(i),this.hintContainer.setPosition(r,s),this.bg.revive(),this.hintContainer.revive(),this.hintContainer.add(this.hand),this.hand.revive(),this.hintTween=this.boardGame.scene.tweens.addCounter({duration:800,onStart:function(){t.hand.doubleTap(0,!1,(function(){console.log("complete double tap")}))},onComplete:function(){t.hintContainer.getAll().forEach((function(e){return t.group.killAndHide(e)})),t.hintContainer.removeAll(),t.hintContainer.kill(),t.bg.kill(),t.hand.kill()}})}},t.showMoveHintAnimation=function(e,t){var n,i=this;if((null==(n=this.hintTween)||!n.isPlaying())&&!(this.hintTween&&this.hintTween.countdown>0)&&!this.hand.visible){var a=e.getWorldPosition(),r=a.x,s=a.y,o=t.getPlacingPosition(t.cards.length),c=o.x,u=o.y;if(t instanceof co){var l=t.getLastCard();if(l){var h=l.getWorldPosition();c=h.x,u=h.y+this.boardGame.getVerticalSpacePile()}}if(e.placement instanceof co)for(var d=e.placement.getSubCards(e),f=0;f<d.length;f++){var p=this.createHintCard(d[f].frame.name);p.setY(this.boardGame.getVerticalSpacePile()*f);var g=this.createHintGlow();g.setY(this.boardGame.getVerticalSpacePile()*f),this.hintContainer.add([g,p])}else{var m=this.createHintCard(e.frame.name),v=this.createHintGlow();this.hintContainer.add([v,m])}this.hintContainer.add(this.hand),this.boardGame.scene.tweens.killTweensOf(this.hand),this.hand.revive(),this.bg.revive(),this.hand.tapAndHold(0),this.hintContainer.revive(),this.hintTween=this.boardGame.scene.tweens.add({targets:this.hintContainer,x:{start:r,from:r,to:c},y:{start:s,from:s,to:u},delay:300,duration:600,completeDelay:500,ease:Phaser.Math.Easing.Sine.Out,onComplete:function(){i.hand.unHold(0,!1,(function(){i.hintContainer.getAll().forEach((function(e){return i.group.killAndHide(e)})),i.hintContainer.removeAll(),i.hintContainer.kill(),i.bg.kill(),i.hand.kill()}))}})}},t.createHintGlow=function(){var e=Vs.CARD_WIDTH,t=Vs.CARD_HEIGHT,n=this.group.get();return n.setTexture(Ds.Z.GAMEPLAY_DEFAULT.KEY,"hint"),n.setWorldSize(1.2*e,1.15*t),n.revive(),n},t.createHintCard=function(e){var t=this.boardGame.scene.theme.getCurrentThemeConfig().cardFaceKey,n=this.group.get();n.setTexture(t),n.revive(),n.setFrame(e);var i=Vs.CARD_WIDTH,a=Vs.CARD_HEIGHT;return n.setWorldSize(i,a),n},t.createCardBack=function(){var e=this.boardGame.scene.theme.getCurrentThemeConfig().cardBackFrame,t=this.group.get();t.setTexture(uo.KEY,e),t.revive();var n=Vs.CARD_WIDTH,i=Vs.CARD_HEIGHT;return t.setWorldSize(n,i),t},t.createTutorialHand=function(){this.hand=new Ns(this.boardGame.scene),this.hand.kill()},e}(),fo=ho,po=1/(0,Cr.t)(),go=Ds.Z.GAMEPLAY_DEFAULT.KEY,mo=function(e){function t(t){var n;return(n=e.call(this,t,go)||this).emitZone=void 0,n.particleEmitters=void 0,n.particleEmitters=[],n.emitZone=new Phaser.Geom.Rectangle(-15,-20,30,40),n.createSuitEmitter("suit_clubs"),n.createSuitEmitter("suit_diamonds"),n.createSuitEmitter("suit_heart"),n.createSuitEmitter("suit_spades"),n.scene.add.existing((0,Cs.Z)(n)),n.setDepth(1e3),n}(0,ot.Z)(t,e);var n=t.prototype;return n.createSuitEmitter=function(e){this.particleEmitters.push(this.createEmitter({on:!1,frame:e,emitZone:{source:this.emitZone,type:"random"},speed:40,frequency:100,alpha:{start:1,end:0,ease:Phaser.Math.Easing.Expo.Out},scale:.5*po,lifespan:1200,rotate:{start:0,end:40,random:!0}}))},n.explode=function(e,t,n,i){this.particleEmitters[e].explode(t,n,i)},t}(Phaser.GameObjects.Particles.ParticleEmitterManager),vo=mo,yo=function(e){function t(t){var n;return(n=e.call(this,t)||this).cards=[],n.suitExplosive=void 0,n.createAce(),n.suitExplosive=new vo(t.scene),n.slot.setVisible(!1),n.setName(so.Foundation),n}(0,ot.Z)(t,e);var n=t.prototype;return n.createAce=function(){this.slot.setFrame("ic_slot_a")},n.setPosition=function(t,n){e.prototype.setPosition.call(this,t,n)},n.addCardsFromSaveData=function(){var t=(0,st.Z)(ut().mark((function t(n){return ut().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.prototype.addCardsFromSaveData.call(this,n,0);case 1:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.addCard=function(e,t){var n=this;if(e instanceof Qs){if(e.scene.gameplay.cardsLayer.bringToTop(e.bg),e.scene.gameplay.cardsLayer.bringToTop(e),e.setPlacement(this),t){var i=this.getPlacingPosition(this.cards.length),a=i.x,r=i.y;e.moveTo(a,r,300)}this.cards.push(e)}else for(var s=this.getPlacingPosition(this.cards.length),o=s.x,c=s.y,u=function(i){var a=e[i];if(a.setPlacement(n),t){var r=e[0].getTag(),s=(r-r%100)/100-1;a.moveTo(o,c,300,650-50*i,(function(){a.scene.gameplay.cardsLayer.bringToTop(a.bg),a.scene.gameplay.cardsLayer.bringToTop(a)}),(function(){n.suitExplosive.explode(s,i,o,c)}))}n.cards.push(a)},l=e.length-1;l>=0;l--)u(l)},n.canBePlace=function(e){return e.getTag()%100==Os.KING&&13!==this.cards.length},n.isFull=function(){return 13===this.cards.length},n.kill=function(){this.active=!1,this.clear()},n.revive=function(){this.active=!0},t}(ro),bo=yo,So=function(){function e(e){this.scene=void 0,this.boardGame=void 0,this.availableHints=void 0,this.outOfMove=void 0,this.hintAnimation=void 0,this.hintClicked=void 0,this.currentAvailableHintMoves=void 0,this.currentBoardStateHash=void 0,this.currentHintIdx=void 0,this.timeToAutoHint=void 0,this.outOfMoverTimer=void 0,this.boardGame=e,this.scene=e.scene,this.outOfMove=!0,this.hintClicked=0,this.timeToAutoHint=0,this.currentAvailableHintMoves=[],this.currentBoardStateHash="",this.currentHintIdx=0,this.hintAnimation=new fo(e)}var t=e.prototype;return t.canHint=function(){return this.boardGame.bestMoveFinder.findMoveableCards(!0).length>0},t.showHint=function(){var e=(0,st.Z)(ut().mark((function e(){var t,n,i,a;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.boardGame.isIdle()&&(this.boardGame.boardState=is.PLAYING),this.boardGame.boardState===is.PLAYING){e.next=3;break}return e.abrupt("return");case 3:if(this.boardGame.scene.audio.playSound(Bt.HINT),this.hintClicked+=1,t=this.boardGame.generateBoardStateHash(),this.currentBoardStateHash!==t){e.next=10;break}return this.resetAutoHintTime(),this.showDifferentPossibleMoves(),e.abrupt("return");case 10:if(this.currentBoardStateHash=t,this.currentAvailableHintMoves=this.boardGame.bestMoveFinder.findBestMoves(),this.currentHintIdx=0,this.resetAutoHintTime(),!(this.currentAvailableHintMoves.length>0)){e.next=18;break}return n=this.currentAvailableHintMoves[0],i=n.targetCard,a=n.targetPlacement,this.hintAnimation.showMoveHintAnimation(i,a),e.abrupt("return");case 18:if(!(this.boardGame.stock.cards.length>0)){e.next=21;break}return this.hintAnimation.showDealerHint(),e.abrupt("return");case 21:this.boardGame.outOfMove();case 22:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.showDifferentPossibleMoves=function(){if(0!==this.currentAvailableHintMoves.length){this.currentHintIdx+=1,this.currentHintIdx>=this.currentAvailableHintMoves.length&&(this.currentHintIdx=0);var e=this.currentAvailableHintMoves[this.currentHintIdx],t=e.targetCard,n=e.targetPlacement;this.hintAnimation.showMoveHintAnimation(t,n)}else this.boardGame.stock.cards.length>0?this.hintAnimation.showDealerHint():this.boardGame.outOfMove()},t.autoPlayStep=function(){var e,t,n=this.boardGame.bestMoveFinder,i=z()(e=n.findMoveableCards()).call(e,(function(e){return e.card}));if(i.length>0){this.outOfMove=!1;var a=this.getAutoMove();if(a)return void this.autoPlayMove(a)}this.boardGame.stock.cards.length<=0?un()(t=this.boardGame.foundations).call(t,(function(e){return e.isEmpty()}))?this.boardGame.outOfMove():this.boardGame.isAutoPlay=!1:this.handleDealCards()},t.handleDealCards=function(){this.boardGame.getCurrentGameRelaxedSpiderSetting()?this.boardGame.mover.deal():this.boardGame.bestMoveFinder.handleNonRelaxedDealCards()},t.getAutoMove=function(){var e,t=this.boardGame.bestMoveFinder.findBestMoves(),n=this.boardGame.getCurrentGameRelaxedSpiderSetting(),i=null==(e=t[0])?void 0:e.targetPlacement;if(!(i instanceof co)&&!(i instanceof bo))return null;var a=n?-300:-100;if(t[0].movePriority<a)return null;var r=this.randomizeAutoMove(t);return 0===r.length?null:(this.boardGame.bestMoveFinder.addMoveToAcceptedList(r[0]),console.log("Accepted Move",r[0]),r[0])},t.randomizeAutoMove=function(e){var t=e[0].movePriority,n=t>0?Math.floor(.9*t):Math.floor(1.1*t),i=u()(e).call(e,(function(e){return e.movePriority>=n}));return rr()(i).call(i,(function(){return Math.random()-.5})),i},t.resetAutoHintTime=function(){this.timeToAutoHint=0},t.resetOutOfMoveTimer=function(){this.outOfMoverTimer=0},t.clear=function(){this.hintClicked=0},t.update=function(e){if(this.boardGame.isPlaying()){if(this.boardGame.scene.player.getPlayerSettings().autoHints?this.timeToAutoHint+=e:this.timeToAutoHint=0,this.outOfMove&&this.boardGame.stock.isEmpty()){if(this.outOfMoverTimer+=e,this.outOfMoverTimer>2e3)return this.boardGame.outOfMove(),this.resetOutOfMoveTimer(),void(this.outOfMove=!1)}else this.resetOutOfMoveTimer();this.timeToAutoHint>1e4&&this.showHint()}},t.autoPlayMove=function(e){var t,n=this.boardGame.mover;if(!n.isPicked()){var i=e.targetCard,a=e.targetPlacement,r=i.placement,s=g()(t=i.placement.cards).call(t,i);n.pickCard(r,r.cards.length-s),n.movePickedToNewPlacement(a),n.donePick()}},e}(),To=So,Eo=n(134),Co=n.n(Eo),Ao=n(58),wo=n.n(Ao),Io=n(68),Po=n.n(Io);function ko(e,t){var n="undefined"!==typeof wo()&&Po()(e)||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){var n;if(!e)return;if("string"===typeof e)return xo(e,t);var i=s()(n=Object.prototype.toString.call(e)).call(n,8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return a()(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return xo(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function xo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var _o=Phaser.Input.Events,Oo=_o.GAMEOBJECT_DOWN,Do=_o.DRAG,Bo=_o.POINTER_UP,Lo=function(){function e(e){var t=this;this.boardGame=void 0,this.undos=void 0,this.picked=void 0,this.dragX=void 0,this.dragY=void 0,this.pickedPlacement=void 0,this.undoClicked=void 0,this.handlePointerDown=function(e,n){if(!t.isPicked()){var i=t.boardGame,a=i.isDevToolAddingCards,r=i.isDevToolRemovingCards,s=i.isDevToolChangingCards,o=a||r||s;if(n instanceof Qs){var c;t.boardGame.boardState=is.PLAYING;var u=n;if(u.placement instanceof co&&o)return s&&t.handleDevToolChangeCard(u),r&&t.handleDevToolRemoveCard(u),a&&t.handleDevToolAddCard(u.placement),u.placement.resizePile(),u.placement.faceUpLast(),void u.placement.updateCardTintByAvailability();if(u.isMoving())return;if(!t.checkIfCardIsValidToMove(u))return;var l=g()(c=u.placement.cards).call(c,u);t.pickCard(u.placement,u.placement.cards.length-l)}}},this.isDragged=void 0,this.dragPicked=function(e,n,i,a){!t.isDragged&&e.getDistanceX()+e.getDistanceY()<15||(t.isDragged=!0,t.dragX=i,t.dragY=a)},this.handlePointerUp=function(e){if(t.isPicked()){var n=t.picked[0],i=t.findFirstDestination(e,t.picked);if(i&&t.movePickedToNewPlacement(i),!t.isDragged&&e.upTime-e.downTime<1e3){if(t.donePick(),t.boardGame.scene.player.getPlayerSettings().tapToMove){if(n.isMoving())return;t.donePick(),t.handleClickOnCard(n)}}else t.donePick();t.boardGame.hint.resetAutoHintTime(),t.boardGame.hint.outOfMove=!t.boardGame.hint.canHint()}},this.deal=function(){if(!t.boardGame.stock.isEmpty()){if(!1===t.boardGame.getCurrentGameRelaxedSpiderSetting()){for(var e=!1,n=0,i=0;i<t.boardGame.piles.length;i++){var a=t.boardGame.piles[i];n+=a.cards.length,a.isEmpty()&&(e=!0)}var r=t.boardGame.piles.length;if(e&&n>=r)return void t.boardGame.stock.getLastCard().shake()}var s=t.boardGame.scene.levelHandler.getConfigs();if(s){var o=s.piles;t.boardGame.isPlaying()&&t.boardGame.scene.audio.playSound(Bt.CARD_MOVE);var c=t.boardGame.stock.pickTopCards(o);if(c.length>0){t.boardGame.difficultyHandler.setDynamicTagForDealingCards(c);for(var u=0;u<c.length;u++){var l=c[u],h=t.boardGame.piles.length,d=t.boardGame.piles[u%h];d.addCard(l,!0),d.faceUpLast(),t.resizePile(d),t.autoCompleteCardStack(d)}t.boardGame.scene.time.delayedCall(310,(function(){t.boardGame.piles.forEach((function(e){e.updateCardTintByAvailability()}))})),t.undos.push({type:"deal",numOfCards:c.length,srcName:t.boardGame.stock.getname(),srcIdx:t.boardGame.stock.getIdx(),destName:t.boardGame.stock.getname(),destIdx:t.boardGame.stock.getIdx()}),t.boardGame.hint.canHint()&&(t.boardGame.hint.outOfMove=!1),t.boardGame.stock.isEmpty()&&t.boardGame.hint.outOfMove&&t.boardGame.outOfMove(),t.boardGame.decreaseScore(5),t.boardGame.increaseMoves()}}}},this.boardGame=e,this.undos=[],this.picked=[],this.undoClicked=0}var t=e.prototype;return t.enableInput=function(){var e=this,t=this.boardGame.scene;t.input.on(Oo,this.handlePointerDown),t.input.on(Do,this.dragPicked),t.input.on(Bo,this.handlePointerUp),this.boardGame.stock.slot.onClick((function(){e.boardGame.boardState=is.PLAYING,e.deal()}))},t.disableInput=function(){var e=this.boardGame.scene;e.input.off(Oo,this.handlePointerDown),e.input.off(Do,this.dragPicked),e.input.off(Bo,this.handlePointerUp),this.boardGame.stock.slot.offClick()},t.isPicked=function(){return this.picked.length>0},t.movePickedToNewPlacement=function(e){var t=this;e.addCard(this.picked,!0),e instanceof co&&(this.boardGame.decreaseScore(5),e.updateCardTintByAvailability(),this.resizePile(e),this.autoCompleteCardStack(e));var n=0;if(e instanceof bo){this.boardGame.increaseScore(650),this.boardGame.isPlaying()&&this.boardGame.scene.audio.playSound("finish"+e.cards.length,{delay:.1});var i=this.boardGame.isAutoPlay,a=i?400:1250;n=i?0:700,this.boardGame.scene.time.delayedCall(a,(function(){t.boardGame.scene.gameplay.handleShowCompleteStackAd()}))}else this.boardGame.isPlaying()&&this.boardGame.scene.audio.playSound(Bt.CARD_MOVE);var r=this.pickedPlacement instanceof co&&!!this.pickedPlacement.faceUpLast(n);this.pickedPlacement instanceof co&&(this.pickedPlacement.updateCardTintByAvailability(),this.resizePile(this.pickedPlacement)),this.undos.push({type:"move",numOfCards:this.picked.length,srcName:this.pickedPlacement.getname(),srcIdx:this.pickedPlacement.getIdx(),destName:e.getname(),destIdx:e.getIdx(),faceLast:!!r}),this.boardGame.increaseMoves(),this.boardGame.checkGameWin(),this.picked=[]},t.unMovePickedToPlacement=function(e,t,n){void 0===n&&(n=!1),e instanceof co&&t&&e.faceDownLast(),e.addCard(this.picked,!0),e instanceof co&&(e.updateCardTintByAvailability(),this.resizePile(e)),this.pickedPlacement instanceof co&&(this.pickedPlacement.updateCardTintByAvailability(),this.resizePile(this.pickedPlacement)),n||this.boardGame.increaseMoves(),this.picked=[]},t.handleDevToolRemoveCard=function(e){var t,n;if(e.placement instanceof co){var i=e.placement,a=g()(t=i.cards).call(t,e);Zs()(n=i.cards).call(n,a,1).forEach((function(e){e.kill()}))}},t.handleDevToolChangeCard=function(e){var t=this.boardGame,n=t.devToolChangeCardValue+t.devToolChangeSuitValue;e.setTag(n),e.updateCardStyle(),e.resetCardTint()},t.handleDevToolAddCard=function(e){var t=this.boardGame,n=t.devToolAddCardValue+t.devToolAddSuitValue,i=this.boardGame.deck.requestNewCard(n);i.updateCardStyle(),i.resetCardTint(),i.setFacing(!0),i.setDepth(10),this.boardGame.gameplay.cardsLayer.add(i.bg),this.boardGame.gameplay.cardsLayer.add(i),e.addCard(i,!0)},t.checkIfCardIsValidToMove=function(e){var t,n,i=e.placement;if(i instanceof bo)return!1;var a=g()(t=i.cards).call(t,e),r=i.cards.length;if(a===r-1)return!0;for(var o,c=s()(n=i.cards).call(n,a,r),u=!0,l=!0,h=e.getTag(),d=h%100,f=Math.floor(h/100),p=ko(c);!(o=p()).done;){var m=o.value;if(m!==e){var v=m.getTag(),y=v%100,b=Math.floor(v/100);if(d-y!==1&&(u=!1),f!==b&&(l=!1),!u&&!l)break;d=y,f=b}}return u&&l},t.pickCard=function(e,t,n){var i;(void 0===n&&(n=!1),this.pickedPlacement=e,this.picked=e.pickTopCards(t),n)&&Co()(i=this.picked).call(i);this.isDragged=!1},t.donePick=function(){this.isPicked()&&(this.pickedPlacement.addCard(this.picked,this.isDragged),this.pickedPlacement instanceof co&&(this.pickedPlacement.updateCardTintByAvailability(),this.resizePile(this.pickedPlacement)),this.picked=[],this.isDragged=!1)},t.autoCompleteCardStack=function(e){var t=this;if(!this.boardGame.isAutoPlay){var n=e.getTopCardStackData();if(n&&13===n.length){this.disableInput();this.boardGame.scene.time.delayedCall(450,(function(){var n=e.cards[e.cards.length-13];t.handleClickOnCard(n),t.enableInput()}))}}},t.resizePile=function(e){this.boardGame.isAutoPlay?e.resizePile():this.boardGame.scene.time.delayedCall(350,(function(){e.resizePile()}))},t.findFirstDestination=function(e,t){if(13==t.length){var n=this.detectFoundation(e,t[0]);if(n)return n}return this.detectPile(e,t[0])},t.detectFoundation=function(e,t){var n,i=u()(n=this.boardGame.foundations).call(n,(function(e){return Phaser.Geom.Intersects.RectangleToRectangle(t.getBounds(),e.slot.getBounds())&&e.canBePlace(t)}));if(2==i.length)return e.worldX-i[0].x<i[1].x-e.worldX?i[0]:i[1];if(1==i.length){if(i[0]==this.pickedPlacement)return;return i[0]}},t.detectPile=function(e,t){var n,i=this,a=u()(n=this.boardGame.piles).call(n,(function(e){var n,a=(null==(n=e.getLastCard())?void 0:n.getBounds())||e.slot.getBounds();return e!==i.pickedPlacement&&Phaser.Geom.Intersects.RectangleToRectangle(t.getBounds(),a)&&e.canBePlace(t)}));return 2==a.length?(e.worldX,a[0].x,a[1].x,e.worldX,a[1]):1==a.length?a[0]:void 0},t.checkIfCanMoveToFoundation=function(){var e=this,t=this.boardGame.foundations,n=[];return 13==this.picked.length?(n.push.apply(n,u()(t).call(t,(function(t){return t!==e.pickedPlacement&&t.canBePlace(e.picked[0])}))),n):[]},t.getAvailableDestinations=function(e){var t=[],n=this.boardGame.bestMoveFinder.findAllAvailableMoves([{card:e,priority:0}]);return 0===n.length?t:t=z()(n).call(n,(function(e){return{pile:e.targetPlacement,priority:e.movePriority}}))},t.handleClickOnCard=function(e){var t;if(!this.isPicked()&&e){var n=this.getAvailableDestinations(e),i=g()(t=e.placement.cards).call(t,e);if(this.pickCard(e.placement,e.placement.cards.length-i),0!==n.length)this.movePickedToNewPlacement(n[0].pile),this.donePick();else{this.boardGame.scene.audio.playSound(Bt.NO_MOVE);for(var a,r=ko(this.picked);!(a=r()).done;){a.value.shake()}this.donePick()}}},t.undo=function(e){if(void 0===e&&(e=!1),this.boardGame.boardState!==is.GAME_OVER){var t=this.undos.pop();if(t){this.boardGame.scene.audio.playSound(Bt.UNDO),this.boardGame.boardState=is.PLAYING,e||(this.undoClicked+=1),this.boardGame.bestMoveFinder.rollbackOneMoveFromAcceptedList();var n=t.numOfCards,i=t.srcName,a=t.srcIdx,r=t.destName,s=t.destIdx,o=t.faceLast,c=void 0!==o&&o,u=this.getPlacement(i,a),l=this.getPlacement(r,s);if("deal"===t.type){var h=[];for(var d in this.boardGame.piles){var f=this.boardGame.piles[d],p=f.removeLastCard();p&&h.push(p),f.updateCardTintByAvailability(),this.resizePile(f)}for(var g=0,m=h;g<m.length;g++){var v=m[g];u.addCard(v,!0)}e||this.boardGame.increaseMoves()}else"move"===t.type&&(this.pickCard(l,n,l instanceof bo),l instanceof bo&&this.boardGame.decreaseScore(650),this.unMovePickedToPlacement(u,c,e),this.donePick(),this.boardGame.hint.outOfMove=!1);e||this.boardGame.decreaseScore(20),this.boardGame.setAutoCompleteStatus(),l instanceof bo&&this.undo(!0)}}},t.clear=function(){this.undos=[],this.undoClicked=0},t.update=function(){if(this.isDragged)for(var e=0;e<this.picked.length;e++){var t=this.picked[e];t.setPosition(this.dragX,this.dragY+e*this.boardGame.getVerticalSpacePile()),t.scene.gameplay.cardsLayer.bringToTop(t)}},t.getPlacement=function(e,t){if(e===so.Stock)return this.boardGame.stock;if(e===so.Pile)return this.boardGame.piles[t];if(e===so.Foundation)return this.boardGame.foundations[t];throw new Error("Placement not found!!!")},e}(),Ro=Lo,Go=n(542),No=Ds.Z.GAMEPLAY_DEFAULT,Mo=No.KEY,Fo=No.FRAME,Uo=function(e){function t(t){var n;return(n=e.call(this,t)||this).restartIcon=void 0,n.remainContainer=void 0,n.remainText=void 0,n.slot.input.cursor="pointer",n.createRecycle(),n.createStockCountText(),n.setName(so.Stock),n}(0,ot.Z)(t,e);var n=t.prototype;return n.createRecycle=function(){var e=this.boardGame.scene,t=this.boardGame.scene.world.isLandscape()?1.2:.8;this.restartIcon=e.add.image(0,0,Mo,Fo.IC_RECYCLE),this.restartIcon.setWorldSize(36*t,36*t)},n.addCardsFromSaveData=function(){var e=(0,st.Z)(ut().mark((function e(t){var n,i,a,r,s,o;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=this.boardGame.deck,i=this.boardGame.scene.levelHandler.replayCardStatus,a=0;a<t.length;a++)r=t[a].split("|"),s=yt()(r[0]),o=yt()(r[1]),s<100&&i[o]>100&&(s=i[o]),n.setUpCardWhenContinueGame(s,this,t.length,o);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.createStockCountText=function(){var e=this.boardGame.scene,t=e.add.container();t.setDepth(Vs.DEPTH.REMAINING_STOCK),this.remainText=e.make.bitmapText({font:Go.Z.PRIMARY.KEY,size:e.fontSize(12),origin:{x:.5,y:.5},text:"0"}),this.remainText.setCenterAlign(),this.remainText.setTint(16579837),this.remainText.setPosition(9,-9);var n=e.add.image(9,-9,Mo,Fo.STOCK_BG);n.setWorldSize(18,18),t.add([n,this.remainText]),this.remainContainer=t,this.remainContainer.kill()},n.setPosition=function(t,n){e.prototype.setPosition.call(this,t,n),this.restartIcon.setPosition(t,n);var i=this.slot,a=i.displayWidth/2,r=i.displayHeight/2;this.remainContainer.setPosition(t-a,n+r)},n.addCard=function(t,n){e.prototype.addCard.call(this,t,n),t.setFacingWithFlippingAnim(!1),t.disableInteractive()},n.canBePlace=function(e){return!1},n.clear=function(){this.cards=[]},n.update=function(t){e.prototype.update.call(this,t),this.cards.length>0?(this.remainContainer.revive(),this.remainText.setText(""+this.cards.length)):this.remainContainer.kill()},t}(ro),Zo=Uo,Ho=n(552),Wo=function(){function e(e){this.boardGame=void 0,this.cards=void 0,this.cardGroup=void 0,this.boardGame=e,this.cards=[],this.cardGroup=this.boardGame.scene.add.group()}var t=e.prototype;return t.init=function(){var e=this.boardGame.scene.levelHandler.getConfigs().type;"dynamic"===e&&this.initDynamicLevel(),"prebuilt"===e&&this.initPrebuiltLevel()},t.initDynamicLevel=function(){for(var e=this,t=this.boardGame.scene.levelHandler.getConfigs(),n=this.boardGame.scene.levelHandler.replayCardStatus,i=t,a=i.foundations,r=i.piles,s=i.startingCards,o=13*a,c=i.startingLayout.split(","),u=0;u<o;u++){var l=void 0,h=o-s;if(u>=h&&u<=o-s+r-1){var d=c[u-h];l=this.requestNewCard(this.getCardTag(d)),this.removeCardFromDiffHandler(d),this.boardGame.scene.levelHandler.setReplayCardStatus(u,l.getTag())}else n[u]>100?(l=this.requestNewCard(n[u]),this.removeCardFromDiffHandler(n[u])):l=this.requestNewCard(0);l.setOriginalCardIdx(u),this.cards.push(l)}var f=this.boardGame.stock.getPlacingPosition(0),p=f.x,g=f.y;this.cards.forEach((function(t){t.updateCardStyle(),t.resetCardTint(),t.setFacing(!1),t.kill(),t.setPosition(p,g),t.setDepth(10),e.boardGame.gameplay.cardsLayer.add(t.bg),e.boardGame.gameplay.cardsLayer.add(t)}))},t.initPrebuiltLevel=function(){for(var e=this,t=this.boardGame.scene.levelHandler.getConfigs().startingLayout.split(","),n=0;n<t.length;n++){var i=t[n],a=this.requestNewCard(this.getCardTag(i));this.removeCardFromDiffHandler(i),this.boardGame.scene.levelHandler.setReplayCardStatus(n,a.getTag()),a.setOriginalCardIdx(n),this.cards.push(a)}var r=this.boardGame.stock.getPlacingPosition(0),s=r.x,o=r.y;this.cards.forEach((function(t){t.updateCardStyle(),t.resetCardTint(),t.setFacing(!1),t.kill(),t.setPosition(s,o),t.setDepth(10),e.boardGame.gameplay.cardsLayer.add(t.bg),e.boardGame.gameplay.cardsLayer.add(t)}))},t.createCardForJourneyMode=function(e){var t=e;"-"===e[0]&&(t=e.substring(1,e.length));var n=this.getCardTag(t),i=this.requestNewCard(n);i.setOriginalCardIdx(-1),this.cards.push(i);var a=this.boardGame.stock.getPlacingPosition(0),r=a.x,s=a.y;return i.updateCardStyle(),i.resetCardTint(),i.setFacing(!1),i.setPosition(r,s),i.setDepth(10),this.boardGame.gameplay.cardsLayer.add(i.bg),this.boardGame.gameplay.cardsLayer.add(i),i},t.getCardTag=function(e){var t=e.length,n=e.substring(0,t-1),i=100;switch(e.substring(t-1,t)){case"c":i=xs.ACE-1;break;case"d":i=ks.ACE-1;break;case"h":i=Ps.ACE-1;break;case"s":i=_s.ACE-1}return i+yt()(n)},t.removeCardFromDiffHandler=function(e){if("number"!==typeof e){var t=e.length,n=e.substring(0,t-1),i=-1;switch(e.substring(t-1,t)){case"c":i=1;break;case"d":i=2;break;case"h":i=3;break;case"s":i=4}this.boardGame.difficultyHandler.manualRemoveCardHash(i,yt()(n))}else{var a=e%13==0?13:e%13,r=Math.floor(e/100);this.boardGame.difficultyHandler.manualRemoveCardHash(r,a)}},t.requestNewCard=function(e){var t=this.cardGroup.getFirstDead();if(t&&t instanceof Qs)return t.setTag(e),t.revive(),t.resetCardTint(),t.setOriginalCardIdx(-1),t;var n=new Qs(this.boardGame.scene,e);return this.cardGroup.add(n),n},t.setUpCardWhenContinueGame=function(e,t,n,i){var a=this.requestNewCard(e);if(e>100&&this.removeCardFromDiffHandler(e),t.addCard(a,!1),!(t instanceof Zo)){t.cards.pop();var r=t.getPlacingPositionForContinueGame(n),s=r.x,o=r.y;a.moveTo(s,o,300),t.cards.push(a)}a.setOriginalCardIdx(i);var c=this.boardGame.stock.getPlacingPosition(0),u=c.x,l=c.y;return a.updateCardStyle(),a.resetCardTint(),a.setFacing(!1),a.setPosition(u,l),a.setDepth(10),this.boardGame.gameplay.cardsLayer.add(a.bg),this.boardGame.gameplay.cardsLayer.add(a),a},t.reset=function(){var e=this.boardGame.stock.getPlacingPosition(0),t=e.x,n=e.y;this.cards.forEach((function(e){e.reset(),e.revive(),e.moveTo(t,n,200)}))},t.killAllCards=function(){this.cardGroup.getChildren().forEach((function(e){e instanceof Qs&&e.active&&e.kill()})),this.cards=[]},t.align=function(){var e=this.boardGame.stock.getPlacingPosition(0),t=e.x,n=e.y;this.cards.forEach((function(e){e.reset(),e.setPosition(t,n,200)}))},t.getDeck=function(){return this.cards},e}(),zo=Wo,Yo=function(){function e(e){this.boardGame=void 0,this.remainingCards=[],this.remainingCardsHash=[],this.curFaceUpCards=[],this.levelHandler=void 0,this.boardGame=e,this.levelHandler=e.scene.levelHandler}var t=e.prototype;return t.init=function(){var e;this.remainingCards=[],this.remainingCardsHash=S()(e=Array(53)).call(e,0),this.curFaceUpCards=[];var t=this.levelHandler.getConfigs().suits.length,n=this.getCardIdxList();if(1===t)for(var i=0;i<n.length;i++){for(var a=1;a<=8;a++)this.remainingCards.push(n[i]);this.remainingCardsHash[n[i]]=8}else if(2===t)for(var r=0;r<n.length;r++){for(var s=1;s<=4;s++)this.remainingCards.push(n[r]);this.remainingCardsHash[n[r]]=4}else for(var o=0;o<n.length;o++){for(var c=1;c<=2;c++)this.remainingCards.push(n[o]);this.remainingCardsHash[n[o]]=2}},t.getCardIdxList=function(){for(var e=this.boardGame.scene.levelHandler.getConfigs().suits,t=e.length,n=[],i=0;i<t;i++){var a=0;switch(e[i][0]){case"c":a=0;break;case"d":a=1;break;case"h":a=2;break;case"s":a=3}for(var r=1;r<=13;r++)n.push(r+13*a)}return n},t.randomCardIdAndValue=function(){var e,t=0,n=0;if(Math.random()<.9){var i,a=[],r=0;this.remainingCardsHash.forEach((function(e,t){e>r?(a=[t],r=e):e===r&&a.push(t)})),t=a[Math.floor(Math.random()*a.length)],n=g()(i=this.remainingCards).call(i,t)}else n=Math.floor(Math.random()*this.remainingCards.length),t=this.remainingCards[n];var s=t%13===0?13:t%13,o=Math.ceil(this.remainingCards[n]/13);return this.remainingCardsHash[t]-=1,Zs()(e=this.remainingCards).call(e,n,1),this.curFaceUpCards.push(t),{cardId:o,cardValue:s}},t.manualRemoveCardHash=function(e,t){var n,i,a=this.getCardHashIdx(e,t),r=g()(n=this.remainingCards).call(n,a);this.remainingCardsHash[a]-=1,Zs()(i=this.remainingCards).call(i,r,1),this.curFaceUpCards.push(a)},t.getCardHashIdx=function(e,t){return 13*(e-1)+t},t.getCardIdAndValueFromCard=function(e){var t=e.getTag(),n=t%100;return{cardId:Math.floor(t/100),cardValue:n}},t.getGoodInitCardIdAndValue=function(){var e=this,t=[];if(this.curFaceUpCards.forEach((function(n){e.remainingCardsHash[n+1]>0&&t.push(n+1),e.remainingCardsHash[n-1]>0&&t.push(n-1)})),0===t.length)return this.randomCardIdAndValue();var n,i,a=t[Math.floor(Math.random()*t.length)],r=g()(n=this.remainingCards).call(n,a),s=a%13===0?13:a%13,o=Math.ceil(this.remainingCards[r]/13);return this.remainingCardsHash[a]-=1,Zs()(i=this.remainingCards).call(i,r,1),this.curFaceUpCards.push(a),{cardId:o,cardValue:s}},t.setCardTagOnReplay=function(e){var t=this.boardGame.scene.levelHandler.replayCardStatus;if(t[e.originalCardIdx]>100){var n=t[e.originalCardIdx];e.setTag(n);var i=Math.floor(n/100),a=n%100%13===0?13:n%100%13;return this.manualRemoveCardHash(i,a),!0}return!1},t.setDynamicTagForBackfaceCard=function(e){if(!this.setCardTagOnReplay(e)){var t=this.boardGame.scene.levelHandler,n=0;switch(this.boardGame.scene.levelHandler.getConfigs().difficulty){case"easy":n=.6;break;case"medium":n=.4;break;case"hard":n=.1}if(Math.random()<=n){for(var i=[],a=0;a<this.boardGame.piles.length;a++){for(var r=this.boardGame.piles[a],s=null,o=r.cards.length-1;o>=0;o--){var c=r.cards[o];if(!c.isFacingUp()||!this.boardGame.mover.checkIfCardIsValidToMove(c)){if(!s)break;var u=this.getCardIdAndValueFromCard(s),l=u.cardId,h=u.cardValue,d=this.getCardHashIdx(l,h);this.remainingCardsHash[d+1]>0&&i.push(d+1)}s=c}if(r.cards.length>0){var f=r.getLastCard();if(f.isFacingUp()){var p=this.getCardIdAndValueFromCard(f),m=p.cardId,v=p.cardValue,y=this.getCardHashIdx(m,v);this.remainingCardsHash[y-1]>0&&i.push(y-1)}}}if(0===(i=GameCore.Utils.Array.unique(i)).length){var b=this.randomCardIdAndValue(),S=b.cardId,T=b.cardValue;e.setTag(100*S+T),t.setReplayCardStatus(e.originalCardIdx,e.getTag()),console.log("%c cardId, cardValue: ","font-size:12px;background-color: #111111;color:#fff;",S,T,e.getTag())}else{var E,C,A=i[Math.floor(Math.random()*i.length)],w=g()(E=this.remainingCards).call(E,A),I=A%13===0?13:A%13,P=Math.ceil(this.remainingCards[w]/13);this.remainingCardsHash[A]-=1,Zs()(C=this.remainingCards).call(C,w,1),this.curFaceUpCards.push(A),e.setTag(100*P+I),t.setReplayCardStatus(e.originalCardIdx,e.getTag()),console.log("%c cardId, cardValue: ","font-size:12px;background-color: #AAC9AB;color:#fff;",P,I,e.getTag())}}else{var k=this.randomCardIdAndValue(),x=k.cardId,_=k.cardValue;e.setTag(100*x+_),t.setReplayCardStatus(e.originalCardIdx,e.getTag()),console.log("%c cardId, cardValue: ","font-size:12px;background-color: #BAAC9A;color:#fff;",x,_,e.getTag())}}},t.setDynamicTagForDealingCards=function(e){var t=this;if(0!==e.length)for(var n=[],i=this.boardGame.scene.levelHandler,a=(i.getConfigs().difficulty,0);a<e.length;a++){var r=e[a];if(!this.setCardTagOnReplay(r)&&r.getTag()<100){var s=Math.floor(3*e.length/5/2);if(a<e.length-s){this.setDynamicTagForBackfaceCard(r);var o=this.getCardIdAndValueFromCard(r),c=o.cardId,u=o.cardValue;n.push(this.getCardHashIdx(c,u))}else!function(){var e=[];if(n.forEach((function(n){t.remainingCardsHash[n+1]>0&&e.push(n+1),t.remainingCardsHash[n-1]>0&&e.push(n-1)})),0===e.length){var a=t.randomCardIdAndValue(),s=a.cardId,o=a.cardValue;r.setTag(100*s+o),i.setReplayCardStatus(r.originalCardIdx,r.getTag()),console.log("%c cardId * 100 + cardValue: ","font-size:12px;background-color: #C5C4BC;color:#fff;",100*s+o)}else{var c,u,l=e[Math.floor(Math.random()*e.length)],h=g()(c=t.remainingCards).call(c,l),d=l%13===0?13:l%13,f=Math.ceil(t.boardGame.difficultyHandler.remainingCards[h]/13);t.remainingCardsHash[l]-=1,Zs()(u=t.remainingCards).call(u,h,1),t.curFaceUpCards.push(l),r.setTag(100*f+d),i.setReplayCardStatus(r.originalCardIdx,r.getTag()),console.log("%c cardId * 100 + cardValue: ","font-size:12px;background-color: #42b983;color:#fff;",100*f+d);var p=un()(n).call(n,(function(e){return e===l-1||e===l+1}));p&&Zs()(n).call(n,p,1)}}()}}},e}(),Vo=Yo,Ko=n(551),jo=function(e){var t=window.game.world.getPixelRatio(),n=e.scene,i=e.key,a=e.newKey,r=e.radius,s=e.alpha,o=e.width*t,c=e.height*t,u=e.border||0,l=n.textures.get(i).getSourceImage(),h=l.width/2-o/2,d=l.height/2-c/2+e.y*t;if(!l)return!1;if(n.textures.exists(a))return!0;var f=n.textures.createCanvas(a||i,o,c),p=f.context,g=u*t,m=document.createElement("canvas");m.width=o,m.height=c;var v=m.getContext("2d");return v.drawImage(l,-h,-d),Ko.r_(m,0,0,f.canvas.width,f.canvas.height,r),v.globalAlpha=s,v.fillStyle="#ffffff",null==v||v.fillRect(0,0,o,c),v.globalAlpha=1,p.beginPath(),p.moveTo(g,0),p.lineTo(o-g,0),p.quadraticCurveTo(o,0,o,0+g),p.lineTo(o,0+c-g),p.quadraticCurveTo(o,0+c,o-g,0+c),p.lineTo(g,0+c),p.quadraticCurveTo(0,0+c,0,0+c-g),p.lineTo(0,0+g),p.quadraticCurveTo(0,0,g,0),p.closePath(),p.clip(),f.draw(0,0,m),!0},Xo=function(e){function t(t,n){var i,a=n.key,r=n.width,s=n.height,o=n.border,c=n.radius,u=n.y,l=void 0===u?0:u,h=n.alpha,d=void 0===h?.15:h,f=t.theme.getCurrentThemeConfig().backgroundKey,p=f+a;return jo({scene:t,key:f,newKey:p,radius:c,border:o,width:r,height:s,alpha:d,y:l}),(i=e.call(this,t,0,0,p)||this).setTexture(p),i.scene.events.on(es.BACKGROUND_CHANGED,(function(e){var n=e+a;jo({scene:t,key:e,newKey:n,radius:c,border:o,width:r,height:s,alpha:d,y:l}),i.setTexture(n),i.setWorldSize(r,s)})),i.setWorldSize(r,s),i}return(0,ot.Z)(t,e),t}(Phaser.GameObjects.Image),Jo=Xo,qo=n(553),Qo={UNCOVER_NEW_CARDS:500,HELPS_COMPLETE_SUIT:5e3,CARD_VALUE_MULTIPLIER:5,FACE_DOWN_CARD_COUNT_PENALTY:-10,EMPTY_PILE_PENALTY:-1e3},$o={UNCOVER_POTENTIAL_STACK:200},ec={SAME_SUIT_MOVE:200,MOVE_KING_TO_EMPTY_PILE:300,MOVE_CARD_TO_EMPTY_PILE:100,MOVING_ONE_PILE_TO_ANOTHER:-5e3,CAPTURING_FULL_STACK:5e3},tc={DIFFERENT_SUIT_MOVE:-500},nc=function(){function e(e,t){this.scene=void 0,this.boardGame=void 0,this.acceptedMoveList=void 0,this.scene=e,this.boardGame=t,this.acceptedMoveList=[]}var t=e.prototype;return t.addMoveToAcceptedList=function(e){var t=this.generateMoveHash(e);this.acceptedMoveList.push(t)},t.rollbackOneMoveFromAcceptedList=function(){this.acceptedMoveList.pop()},t.resetAcceptedList=function(){this.acceptedMoveList=[]},t.findBestMoves=function(){var e=this.findMoveableCards(!0),t=this.findAllAvailableMoves(e,!0);return t.length>=15?s()(t).call(t,0,15):t},t.findMoveableCards=function(e){void 0===e&&(e=!1);for(var t=[],n=this.boardGame,i=0;i<n.piles.length;i++){var a=n.piles[i];t.push.apply(t,this.calculateTopCardStackPriority(a,e))}return rr()(t).call(t,(function(e,t){return t.priority-e.priority})),t},t.findAllAvailableMoves=function(e,t){var n=this;void 0===t&&(t=!1);var i=[];if(0===e.length)return i;for(var a=this.boardGame,r=a.piles,s=a.foundations,o=this.scene.levelHandler.getConfigs().suits,c=function(a){var c,u=e[a],l=u.card,d=u.priority;if(!(l.placement instanceof co))return"continue";var f=g()(c=l.placement.cards).call(c,l),p=l.placement.cards.length-f,m=l.placement.cards;if(l.isKing()&&13===p){var v=un()(s).call(s,(function(e){return e.canBePlace(l)}));if(!v)return"continue";var y={targetCard:l,targetPlacement:v,movePriority:d+ec.CAPTURING_FULL_STACK};return i.push(y),"continue"}r.forEach((function(e){var a;if(e.canBePlace(l)&&e!==l.placement){var r=d,s=e.getTopCardStackData();if(s){var c=e.cards[e.cards.length-1].getTag()-l.getTag()===1;c?r+=ec.SAME_SUIT_MOVE:o.length>1&&(r+=tc.DIFFERENT_SUIT_MOVE),c&&s.length+p===13?r+=ec.CAPTURING_FULL_STACK:r+=s.length}else p===m.length?r+=ec.MOVING_ONE_PILE_TO_ANOTHER:l.isKing()?r+=ec.MOVE_KING_TO_EMPTY_PILE:r+=ec.MOVE_CARD_TO_EMPTY_PILE;var u={targetCard:l,targetPlacement:e,movePriority:r};t&&h()(a=n.acceptedMoveList).call(a,n.generateMoveHash(u))||i.push(u)}}))},u=0;u<e.length;u++)c(u);return rr()(i).call(i,(function(e,t){return t.movePriority-e.movePriority})),i},t.calculateTopCardStackPriority=function(e,t){var n=this;void 0===t&&(t=!1);var i=e.getTopCardStackData(),a=[];if(!i)return a;for(var r=this.boardGame.piles.some((function(e){return e.isEmpty()})),s=this.boardGame.stock.isEmpty(),o=function(o){var c;if(o===i.length){var u,l,h=e.cards.length-i.length,d=e.cards[h],f=e.cards[h-1],p=un()(u=n.boardGame.piles).call(u,(function(e){return e.canBePlace(d)&&e!==d.placement}));if(!p)return{v:a};var g=0;if(f&&!f.isFacingUp())g+=Qo.UNCOVER_NEW_CARDS,g+=e.getFaceDownCardAmount()*Qo.FACE_DOWN_CARD_COUNT_PENALTY;g+=d.getTag()%100*Qo.CARD_VALUE_MULTIPLIER,g+=h,0===h&&r&&!s&&(g+=Qo.EMPTY_PILE_PENALTY);var m=un()(l=n.boardGame.piles).call(l,(function(e){var t=e.getTopCardStackData();return!!t&&(e.getLastCard().getTag()-d.getTag()===1&&t.length+i.length===13)})),v=13===i.length;m&&(g+=Qo.HELPS_COMPLETE_SUIT),v&&(g+=ec.CAPTURING_FULL_STACK);var y=n.scene.levelHandler.getConfigs().suits;return t&&y.length>1&&(g+=n.extraPriorityCalculationForMultipleSuits(h,e)),a.push({card:d,priority:g}),"continue"}var b=e.cards.length-o,S=e.cards[b],T=un()(c=n.boardGame.piles).call(c,(function(e){var t=e.getTopCardStackData();return!!t&&(e.cards[e.cards.length-1].getTag()-S.getTag()===1&&t.length+o===13)}));if(!T)return"continue";a.push({card:S,priority:Qo.HELPS_COMPLETE_SUIT})},c=1;c<=i.length;c++){var u=o(c);if("continue"!==u&&"object"===typeof u)return u.v}return a},t.extraPriorityCalculationForMultipleSuits=function(e,t){var n=0;if(0===e)return 0;var i=this.findStackAfterCardForMulitpleSuit(e,t);if(!i)return 0;var a=t.cards[e-i.length],r=!1,s=!1;return this.boardGame.piles.forEach((function(e){if(e!==t){e.canBePlace(a)&&(s=!0);var n=e.getTopCardStackData();if(n){var i=e.cards[e.cards.length-n.length];a.getTag()-i.getTag()===1&&(r=!0)}}})),(r||s)&&(n+=$o.UNCOVER_POTENTIAL_STACK),n},t.findStackAfterCardForMulitpleSuit=function(e,t){if(0===e)return null;var n=t.cards[e-1],i=Math.floor(n.getTag()/100),a=n.getTag()%100,r=1;if(!n.isFacingUp())return{color:i,length:r};for(var s=e-2;s>=0;s--){var o=t.cards[s],c=o.getTag()%100;if(Math.floor(o.getTag()/100)!==i)break;if(c-1!==a)break;if(!o.isFacingUp())break;a=c,r++}return{color:i,length:r}},t.generateMoveHash=function(e){var t,n,i,a=e.targetCard,r=e.targetPlacement,s=a.placement,o=""+s.getIdx(),c=""+r.getIdx();e.targetPlacement instanceof bo&&(c+="foundation"+r.getIdx());var u=""+g()(t=s.cards).call(t,e.targetCard),l=z()(n=s.cards).call(n,(function(e){return e.getTag()})),h=z()(i=r.cards).call(i,(function(e){return e.getTag()}));return o+"-"+c+"-"+u+"-"+l.join(",")+"-"+h.join(",")},t.handleNonRelaxedDealCards=function(){var e=[],t=[];if(this.boardGame.piles.forEach((function(n){n.isEmpty()?e.push(n):n.cards.length>=2&&t.push(n)})),0!==e.length){rr()(t).call(t,(function(e,t){return e.cards.length-t.cards.length}));for(var n=[],i=0;i<t.length;i++){var a,r=t[i],s=fe()(a=[]).call(a,r.cards);s.shift(),Co()(s).call(s),n.push.apply(n,s)}if(n.length<e.length)this.boardGame.mover.deal();else{for(var o=0;o<e.length;o++){var c=n.shift(),u=e[o];if(!c)break;this.boardGame.hint.autoPlayMove({targetCard:c,targetPlacement:u,movePriority:0})}this.boardGame.mover.deal()}}else this.boardGame.mover.deal()},e}(),ic=nc,ac=function(e){try{var t=localStorage.getItem(e);return null===t?null:GameCore.Utils.Json.decode(t)}catch(n){return null}},rc=function(e,t){try{var n=ac(e),i={};GameCore.Utils.Valid.isObject(n)&&(i=n);var a=GameCore.Utils.Json.clone(t);if(!GameCore.Utils.Valid.isObject(a))return!1;var r=GameCore.Utils.Object.clear(a),s=(0,Fe.TS)(i,r),o=GameCore.Utils.Json.encode(s);return localStorage.setItem(e,o),!0}catch(c){return!1}},sc=function(e){try{return localStorage.removeItem(e),!0}catch(t){return!1}},oc=function(e){function t(t){var n;return(n=e.call(this,t,0,0)||this).scene=void 0,n.suitInfo=void 0,n.difficultyInfo=void 0,n.scene=t,n.createLevelInfo(),n}(0,ot.Z)(t,e);var n=t.prototype;return n.createLevelInfo=function(){this.createSuitInfo(),this.createDifficultyInfo()},n.createSuitInfo=function(){this.suitInfo=this.scene.make.bitmapText({text:"Suit: ",font:Go.Z.BOLD.KEY,size:this.scene.fontSize(16),origin:{x:0,y:0}}),this.add(this.suitInfo),this.suitInfo.setPosition(0,0)},n.createDifficultyInfo=function(){this.difficultyInfo=this.scene.make.bitmapText({text:"Difficulty: ",font:Go.Z.BOLD.KEY,size:this.scene.fontSize(16),origin:{x:0,y:0}}),this.add(this.difficultyInfo),Phaser.Display.Align.In.Center(this.difficultyInfo,this,0,0),this.difficultyInfo.setPosition(0,-20)},n.setSuitInfo=function(e,t){this.suitInfo.setText("Suit: "+e),this.difficultyInfo.setText("Difficulty: "+t)},t}(Phaser.GameObjects.Container),cc=oc,uc=n(546),lc={targets:[],duration:400,ease:n(545).Z,props:{scale:"-=0.1"}},hc=function(e){function t(t){return e.call(this,lc,t)||this}return(0,ot.Z)(t,e),t}(uc.Z),dc=hc,fc=n(547),pc=function(e){function t(t,n,i,a,r,s){var o;return void 0===s&&(s=!1),(o=e.call(this,t)||this).useSound=!0,o.isClicked=!1,o.scaleUp=-1,o.scaleDown=-1,o.button=void 0,o.upAnimation=void 0,o.downAnimation=void 0,o.isUsePixelPerfect=!1,o.hitArea=void 0,o.hitZone=void 0,o.scaleDownPress=void 0,o.parentName=void 0,o.handelObjectDestroy=function(){o.scene&&o.scene.events.off(Phaser.Scenes.Events.SLEEP,o.handleSceneSleep)},o.handleSceneSleep=function(){o.scene&&o.scene.tweens.killTweensOf((0,Cs.Z)(o))},o.handlePointerDown=function(){var e,t;o.isClicked||null!=(e=o.upAnimation)&&null!=(t=e.tween)&&t.isPlaying()||(o.isClicked=!0,o.runDownAnimation())},o.handleOnClick=function(e){return function(){var t,n,i,a;o.isClicked&&(null!=(t=o.upAnimation)&&null!=(n=t.tween)&&n.isPlaying()||(o.isClicked=!1,o.runUpAnimation(),null==(i=o.upAnimation)||null==(a=i.tween)||a.once(Phaser.Tweens.Events.TWEEN_COMPLETE,(function(){o.logButtonEvent(),o.addDebugData(),o.processCallback(e)}))))}},o.handlePointerOut=function(){var e,t;o.isClicked&&(null!=(e=o.upAnimation)&&null!=(t=e.tween)&&t.isPlaying()||(o.isClicked=!1,o.runUpAnimation()))},o.runDownAnimation=function(){var e;-1===o.scaleDown&&(o.scaleUp=o.scale,o.scaleDown=o.scaleDownPress),o.useSound&&o.scene.audio.playSound(Bt.BUTTON_CLICK),null==(e=o.downAnimation)||e.remove(),o.downAnimation=new dc({targets:[(0,Cs.Z)(o)],duration:150,props:{scale:o.scaleDown},onUpdate:function(){o.hitZone.scale=1/o.scale}}),o.downAnimation.play()},o.runUpAnimation=function(){var e;-1!==o.scaleUp&&(null==(e=o.upAnimation)||e.remove(),o.upAnimation=new dc({targets:[(0,Cs.Z)(o)],duration:150,props:{scale:o.scaleUp},onUpdate:function(){o.hitZone.scale=1/o.scale}}),o.upAnimation.play())},o.isUsePixelPerfect=s,o.setDepth(fc.Z.BUTTON),o.createButton(n,i,a,r),o.updateSize(),o.listenEvents(),o.scene.add.existing((0,Cs.Z)(o)),o}(0,ot.Z)(t,e);var n=t.prototype;return n.listenEvents=function(){this.scene.events.on(Phaser.Scenes.Events.SLEEP,this.handleSceneSleep),this.once(Phaser.GameObjects.Events.DESTROY,this.handelObjectDestroy)},n.processCallback=function(e){var t,n,i;null==(t=this.upAnimation)||t.stop(),null==(n=this.downAnimation)||n.stop(),null==(i=this.scene)||i.tweens.killTweensOf(this),-1!==this.scaleUp&&this.setScale(this.scaleUp),e()},n.setDisabled=function(e){var t,n;e?(this.setAlpha(.5),null==(t=this.hitArea)||t.disableInteractive()):(this.setAlpha(1),null==(n=this.hitArea)||n.setInteractive())},n.createButton=function(e,t,n,i){this.button=this.scene.add.image(0,0,e,t),n&&i&&this.button.setWorldSize(n,i),this.scaleDownPress=this.scale-.1;var a=this.button,r=a.displayWidth,s=a.displayHeight;this.hitZone=this.scene.make.zone({displayWidth:r,displayHeight:s}),this.add([this.button,this.hitZone])},n.updateSize=function(){var e=this.button,t=e.width,n=e.height,i=t/100*10,a=n/100*10,r=i<10?i:10,s=a<10?a:10;this.setSize(t+r,n+s),this.hitZone.setSize(t+r,n+s)},n.addDebugData=function(){var e=this.getParentName(),t=this.name;(0,at.sw)("ui-click",e+":"+t)},n.logButtonEvent=function(){var e=this.getParentName(),t=this.name;this.scene.analytics.event(Vi._.BUTTON_CLICK,{button_name:t,screen_name:e})},n.getParentName=function(){if(this.parentName)return this.parentName;for(var e=this.parentContainer;e;){if(e instanceof GameCore.Screen){var t=e;return this.parentName=t.getScreenName(),this.parentName}e=e.parentContainer}return this.parentName=this.scene.getSceneName(),this.parentName},(0,Wt.Z)(t,[{key:"onClick",set:function(e){this.isUsePixelPerfect?(this.hitArea=this.button,this.hitArea.setInteractive({useHandCursor:!0,pixelPerfect:!0})):(this.hitArea=this.hitZone,this.updateSize(),this.hitArea.setInteractive({useHandCursor:!0})),this.hitArea.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,this.handlePointerDown),this.hitArea.on(Phaser.Input.Events.GAMEOBJECT_POINTER_UP,this.handleOnClick(e)),this.hitArea.on(Phaser.Input.Events.GAMEOBJECT_POINTER_OUT,this.handlePointerOut)}},{key:"isUsePixelPerFect",get:function(){return this.isUsePixelPerfect}}]),t}(Phaser.GameObjects.Container),gc=pc,mc=Ds.Z.GAMEPLAY_DEFAULT,vc=mc.KEY,yc=mc.FRAME,bc=function(e){function t(t,n){var i;return t.world.isLandscape()?(i=e.call(this,t,vc,yc.DEV_TOOLS_BUTTON,122,33)||this).label=void 0:(i=e.call(this,t,vc,yc.DEV_TOOLS_BUTTON,90,33)||this).label=void 0,i.createLabel(n),(0,Cs.Z)(i)}(0,ot.Z)(t,e);var n=t.prototype;return n.createLabel=function(e){this.label=this.scene.make.bitmapText({text:e,font:Go.Z.BOLD.KEY,size:this.scene.fontSize(16),origin:{x:.5,y:.5}}),this.add(this.label),Phaser.Display.Align.In.Center(this.label,this,0,0)},n.setLabelTint=function(e){this.label.setTint(e)},t}(gc),Sc=bc;function Tc(e,t){var n="undefined"!==typeof wo()&&Po()(e)||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){var n;if(!e)return;if("string"===typeof e)return Ec(e,t);var i=s()(n=Object.prototype.toString.call(e)).call(n,8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return a()(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Ec(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Ec(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var Cc=function(e){function t(t){var n,i=t.scene;return(n=e.call(this,i,0,0)||this).scene=void 0,n.devToolbar=void 0,n.mainButton=void 0,n.subButtons=void 0,n.isEnabled=void 0,n.scene=i,n.devToolbar=t,n.subButtons=[],n.isEnabled=!1,n.createMainButton(),n.createSubButtons(),n.alignButtons(),n}(0,ot.Z)(t,e);var n=t.prototype;return n.createButton=function(e){return new Sc(this.scene,e)},n.alignButtons=function(){this.scene.world.isLandscape()?this.alignButtonsLandscape():this.alignButtonsPortrait()},n.alignButtonsLandscape=function(){for(var e=this.mainButton,n=e.x,i=e.y,a=this.mainButton.button,r=a.height,s=a.width,o=0;o<this.subButtons.length;o++){var c=this.subButtons[o];if(0===o)c.setPosition(n+.25*s,i+r);else{var u=this.subButtons[o-1],l=u.x,h=u.y,d=u instanceof t?u.getHeight():r;c.setPosition(l,h+d)}c instanceof Sc&&c.setDisabled(!this.isEnabled),c.setVisible(this.isEnabled)}},n.alignButtonsPortrait=function(){for(var e=this.mainButton,n=e.x,i=e.y,a=this.mainButton.button.height,r=0;r<this.subButtons.length;r++){var s=this.subButtons[r];if(0===r)s.setPosition(n,i-a);else{var o=this.subButtons[r-1],c=o.x,u=o.y,l=o instanceof t?o.getHeight():a;s.setPosition(c,u-l)}s instanceof Sc&&s.setDisabled(!this.isEnabled),s.setVisible(this.isEnabled)}},n.updateButtons=function(){this.alignButtons(),this.parentContainer instanceof t?this.parentContainer.updateButtons():this.devToolbar.updateButtons()},n.getHeight=function(){if(!this.isEnabled)return this.mainButton.button.height;for(var e,n=this.mainButton.button.height,i=n,a=Tc(this.subButtons);!(e=a()).done;){var r=e.value;i+=r instanceof t?r.getHeight():n}return i},t}(Phaser.GameObjects.Container),Ac=Cc,wc=100,Ic=200,Pc=300,kc=400,xc=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return(n=e.call.apply(e,fe()(t=[this]).call(t,a))||this).suitTypeButton=void 0,n.cardTypeButton=void 0,n}(0,ot.Z)(t,e);var n=t.prototype;return n.createMainButton=function(){var e=this,t=this.scene.world.isLandscape()?"Add Card":"Add";this.mainButton=this.createButton(t),this.mainButton.onClick=function(){var t=e.scene.gameplay.boardGame;e.isEnabled=!e.isEnabled,e.mainButton.setLabelTint(e.isEnabled?16711680:16777215),t.isDevToolAddingCards=e.isEnabled,e.updateButtons()},this.add(this.mainButton)},n.createSubButtons=function(){this.createSuitTypeButton(),this.createCardTypeButton(),this.subButtons=[this.suitTypeButton,this.cardTypeButton],this.add(this.subButtons)},n.createSuitTypeButton=function(){this.suitTypeButton=this.createButton("Clubs");var e=this.scene.gameplay.boardGame,t=this.suitTypeButton.label;this.suitTypeButton.onClick=function(){switch(e.devToolAddSuitValue){case wc:e.devToolAddSuitValue=Ic,t.setText("Diamonds");break;case Ic:e.devToolAddSuitValue=Pc,t.setText("Hearts");break;case Pc:e.devToolAddSuitValue=kc,t.setText("Spades");break;case kc:e.devToolAddSuitValue=wc,t.setText("Clubs")}}},n.createCardTypeButton=function(){this.cardTypeButton=this.createButton("A");var e=this.scene.gameplay.boardGame,t=this.cardTypeButton.label;this.cardTypeButton.onClick=function(){var n=e.devToolAddCardValue;switch(e.devToolAddCardValue=13===n?1:n+1,n){case 10:t.setText("J");break;case 11:t.setText("Q");break;case 12:t.setText("K");break;case 13:t.setText("A");break;default:t.setText(""+(n+1))}}},t}(Ac),_c=xc,Oc=100,Dc=200,Bc=300,Lc=400,Rc=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return(n=e.call.apply(e,fe()(t=[this]).call(t,a))||this).suitTypeButton=void 0,n.cardTypeButton=void 0,n}(0,ot.Z)(t,e);var n=t.prototype;return n.createMainButton=function(){var e=this,t=this.scene.world.isLandscape()?"Change Card":"Change";this.mainButton=this.createButton(t),this.mainButton.onClick=function(){var t=e.scene.gameplay.boardGame;e.isEnabled=!e.isEnabled,e.mainButton.setLabelTint(e.isEnabled?16711680:16777215),t.isDevToolChangingCards=e.isEnabled,e.updateButtons()},this.add(this.mainButton)},n.createSubButtons=function(){this.createSuitTypeButton(),this.createCardTypeButton(),this.subButtons=[this.suitTypeButton,this.cardTypeButton],this.add(this.subButtons)},n.createSuitTypeButton=function(){this.suitTypeButton=this.createButton("Clubs");var e=this.scene.gameplay.boardGame,t=this.suitTypeButton.label;this.suitTypeButton.onClick=function(){switch(e.devToolChangeSuitValue){case Oc:e.devToolChangeSuitValue=Dc,t.setText("Diamonds");break;case Dc:e.devToolChangeSuitValue=Bc,t.setText("Hearts");break;case Bc:e.devToolChangeSuitValue=Lc,t.setText("Spades");break;case Lc:e.devToolChangeSuitValue=Oc,t.setText("Clubs")}}},n.createCardTypeButton=function(){this.cardTypeButton=this.createButton("A");var e=this.scene.gameplay.boardGame,t=this.cardTypeButton.label;this.cardTypeButton.onClick=function(){var n=e.devToolChangeCardValue;switch(e.devToolChangeCardValue=13===n?1:n+1,n){case 10:t.setText("J");break;case 11:t.setText("Q");break;case 12:t.setText("K");break;case 13:t.setText("A");break;default:t.setText(""+(n+1))}}},t}(Ac),Gc=Rc,Nc=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return(n=e.call.apply(e,fe()(t=[this]).call(t,a))||this).addCardButton=void 0,n.removeCardButton=void 0,n.changeCardButton=void 0,n}(0,ot.Z)(t,e);var n=t.prototype;return n.createMainButton=function(){var e=this;this.mainButton=this.createButton("Card Utils"),this.mainButton.onClick=function(){e.isEnabled=!e.isEnabled,e.updateButtons()},this.add(this.mainButton)},n.createSubButtons=function(){this.createAddCardButton(),this.createRemoveCardButton(),this.createChangeCardButton(),this.subButtons=[this.addCardButton,this.removeCardButton,this.changeCardButton],this.add(this.subButtons)},n.createAddCardButton=function(){this.addCardButton=new _c(this.devToolbar)},n.createRemoveCardButton=function(){var e=this.scene.world.isLandscape()?"Remove Card":"Remove";this.removeCardButton=this.createButton(e);var t=this.scene.gameplay.boardGame,n=this.removeCardButton.label;this.removeCardButton.onClick=function(){t.isDevToolRemovingCards?(n.setTint(16777215),t.isDevToolRemovingCards=!1):(n.setTint(16711680),t.isDevToolRemovingCards=!0)}},n.createChangeCardButton=function(){this.changeCardButton=new Gc(this.devToolbar)},t}(Ac),Mc=Nc,Fc=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return(n=e.call.apply(e,fe()(t=[this]).call(t,a))||this).stepButton=void 0,n.autoplayButton=void 0,n.suitButton=void 0,n.diffButton=void 0,n.levelTypeButton=void 0,n}(0,ot.Z)(t,e);var n=t.prototype;return n.createMainButton=function(){var e=this;this.mainButton=this.createButton("Gameplay"),this.mainButton.onClick=function(){e.isEnabled=!e.isEnabled,e.updateButtons()},this.add(this.mainButton)},n.createSubButtons=function(){this.createStepButton(),this.createAutoplayButton(),this.createLevelTypeButton(),this.createSuitButton(),this.createDiffButton(),this.subButtons=[this.stepButton,this.autoplayButton,this.levelTypeButton,this.suitButton,this.diffButton],this.add(this.subButtons)},n.createStepButton=function(){this.stepButton=this.createButton("Step");var e=this.scene.gameplay.boardGame;this.stepButton.onClick=function(){e.isIdle()&&(e.boardState=is.PLAYING),e.isPlaying()&&e.hint.autoPlayStep()}},n.createAutoplayButton=function(){this.autoplayButton=this.createButton("Autoplay");var e=this.scene.gameplay.boardGame,t=this.autoplayButton.label,n=this.scene.time.addEvent({delay:100,repeat:-1,callback:function(){return e.isAutoPlay?(e.isIdle()&&(e.boardState=is.PLAYING),e.canAutoComplete?(n.paused=!0,void t.setText("Autoplay")):void e.hint.autoPlayStep()):(e.isAutoPlay=!0,void i())},paused:!0}),i=function(){e.isAutoPlay?(t.setText("Autoplay"),n.paused=!0,e.isAutoPlay=!1):(t.setText("Stop"),n.paused=!1,e.isAutoPlay=!0)};this.autoplayButton.onClick=i},n.createSuitButton=function(){var e=this;this.suitButton=this.createButton("Suits: 1");var t=this.scene.gameplay.boardGame,n=this.suitButton.label;this.suitButton.onClick=function(){"one"===t.levelSuit?(t.levelSuit="two",n.setText("Suits: 2")):"two"===t.levelSuit?(t.levelSuit="four",n.setText("Suits: 4")):"four"===t.levelSuit&&(t.levelSuit="one",n.setText("Suits: 1")),e.scene.gameplay.startGame({suitSize:t.levelSuit,difficulty:t.levelType})}},n.createDiffButton=function(){var e=this;this.diffButton=this.createButton("Easy");var t=this.scene.gameplay.boardGame,n=this.diffButton.label;this.diffButton.onClick=function(){"easy"===t.levelDifficulty?(t.levelDifficulty="medium",n.setText("Medium")):"medium"===t.levelDifficulty?(t.levelDifficulty="hard",n.setText("Hard")):"hard"===t.levelDifficulty&&(t.levelDifficulty="easy",n.setText("Easy")),t.levelType=t.levelDifficulty,e.scene.gameplay.startGame({suitSize:t.levelSuit,difficulty:t.levelType})}},n.createLevelTypeButton=function(){var e=this;this.levelTypeButton=this.createButton("Static");var t=this.scene.gameplay.boardGame,n=this.levelTypeButton.label;this.levelTypeButton.onClick=function(){"dynamic"!==t.levelType?(t.levelType="dynamic",n.setText("Dynamic")):(t.levelType=t.levelDifficulty,n.setText("Static")),e.scene.gameplay.startGame({suitSize:t.levelSuit,difficulty:t.levelType})}},t}(Ac),Uc=Fc,Zc=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return(n=e.call.apply(e,fe()(t=[this]).call(t,a))||this).winGameButton=void 0,n.loseGameButton=void 0,n.newGameButton=void 0,n.restartButton=void 0,n.journeyButton=void 0,n}(0,ot.Z)(t,e);var n=t.prototype;return n.createMainButton=function(){var e=this;this.mainButton=this.createButton("Level"),this.mainButton.onClick=function(){e.isEnabled=!e.isEnabled,e.updateButtons()},this.add(this.mainButton)},n.createSubButtons=function(){this.createWinGameButton(),this.createLoseGameButton(),this.createNewGameButton(),this.createRestartButton(),this.createJourneyButton(),this.subButtons=[this.winGameButton,this.loseGameButton,this.newGameButton,this.restartButton,this.journeyButton],this.add(this.subButtons)},n.createWinGameButton=function(){var e=this;this.winGameButton=this.createButton("Win"),this.winGameButton.onClick=function(){e.scene.gameplay.boardGame.handleGameWon()}},n.createLoseGameButton=function(){var e=this;this.loseGameButton=this.createButton("Lose"),this.loseGameButton.onClick=function(){e.scene.gameplay.boardGame.outOfMove()}},n.createNewGameButton=function(){var e=this;this.newGameButton=this.createButton("New"),this.newGameButton.onClick=(0,st.Z)(ut().mark((function t(){return ut().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.scene.screen.close(As.o4.PLAY_SCREEN),t.next=3,e.scene.handlePlaySingle();case 3:case"end":return t.stop()}}),t)})))},n.createRestartButton=function(){var e=this;this.restartButton=this.createButton("Restart"),this.restartButton.onClick=function(){e.scene.gameplay.replayGame(),e.scene.screen.close(As.o4.PLAY_SCREEN)}},n.createJourneyButton=function(){var e=this;this.journeyButton=this.createButton("Journey"),this.journeyButton.onClick=function(){e.scene.gameplay.startGame("journey")}},t}(Ac),Hc=Zc,Wc=n(213),zc=n.n(Wc),Yc=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="WideFrameRenderFail",i.message=t||"Wide frame render fail",i.payload=n,i}return(0,ot.Z)(t,e),t}((0,wt.Z)(Error)),Vc=Yc,Kc="global",jc="friend",Xc=GameCore.Configs,Jc=Xc.OtherHost,qc=Xc.LeadersBoard,Qc=qc.Prefix,$c=qc.LeaderboardId,eu=Qc+"/"+$c+"/leaders",tu=Qc+"/"+$c+"/players",nu=function(e){var t="";return $c?(e===Kc?t=eu:e===jc&&(t=tu),t):t},iu=(function(){var e=(0,st.Z)(ut().mark((function e(t){var n,i,a,r,s;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(t={}),n=[],i=nu(Kc)){e.next=5;break}return e.abrupt("return",n);case 5:return a=GameCore.Utils.String.params(t),e.next=8,Wn(i+"?"+a,{},Jc);case 8:if(r=e.sent,!((s=(null==r?void 0:r.data)||[]).length<1)){e.next=12;break}return e.abrupt("return",n);case 12:return n=s,e.abrupt("return",n);case 14:case"end":return e.stop()}}),e)})))}(),function(){var e=(0,st.Z)(ut().mark((function e(t){var n,i,a,r,s;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(t={}),n=[],i=nu(jc)){e.next=5;break}return e.abrupt("return",n);case 5:return a=GameCore.Utils.String.params(t),e.next=8,Wn(i+"?"+a,{},Jc);case 8:if(r=e.sent,!((s=(null==r?void 0:r.data)||[]).length<1)){e.next=12;break}return e.abrupt("return",n);case 12:return n=s,e.abrupt("return",n);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),au=(function(){var e=(0,st.Z)(ut().mark((function e(t){var n,i,a,r,s;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=null,t){e.next=3;break}return e.abrupt("return",n);case 3:if(i=nu(jc)){e.next=6;break}return e.abrupt("return",n);case 6:return a=GameCore.Utils.String.params({playerIds:t}),e.next=9,Wn(i+"?"+a,{},Jc);case 9:if(r=e.sent,!((s=(null==r?void 0:r.data)||[]).length<1)){e.next=13;break}return e.abrupt("return",n);case 13:return n=s[0],e.abrupt("return",n);case 15:case"end":return e.stop()}}),e)})))}(),function(){var e=(0,st.Z)(ut().mark((function e(t,n){var i;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,zn("leaderboards/"+$c+"/players/"+t,{score:n},{},Jc);case 2:return i=e.sent,e.abrupt("return",(null==i?void 0:i.data)||{});case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),ru=function(e){return e.match},su=function(e,t){return t.playerId},ou=function(e){return ru(e).match.challenge},cu=(0,Kt.P1)([function(e){return ru(e).match.single}],(function(e){return e})),uu=(0,Kt.P1)([function(e){return ru(e).match.single._id}],(function(e){return e})),lu=(0,Kt.P1)([function(e){return ru(e).match.single.score}],(function(e){return e||0})),hu=(0,Kt.P1)([ou],(function(e){return e})),du=(0,Kt.P1)([function(e){return ru(e).match.challenge._id}],(function(e){return e})),fu=(0,Kt.P1)([function(e){return ru(e).match.challenge.status}],(function(e){return e})),pu=(0,Kt.P1)([function(e){return ru(e).match.challenge.opponentInfo}],(function(e){return e})),gu=(0,Kt.P1)([hu,su],(function(e,t){var n=e.whitePlayerId,i=e.blackPlayerId;return n===t?n:i===t?i:Vr.playerId})),mu=(0,Kt.P1)([hu,su],(function(e,t){var n=e.whitePlayerId,i=e.blackPlayerId,a=e.whitePlayerFinish,r=e.blackPlayerFinish;return t&&n===t?a:!(!t||i!==t)&&r})),vu=(0,Kt.P1)([hu,function(e,t){return t.opponentId}],(function(e,t){var n=e.whitePlayerId,i=e.blackPlayerId,a=e.whitePlayerFinish,r=e.blackPlayerFinish;return t&&n===t?a:!(!t||i!==t)&&r})),yu=(0,Kt.P1)([ou],(function(e){return e.extraData})),bu=(0,Kt.P1)([function(e){return ru(e).match.group.opponentInfo}],(function(e){return e})),Su=(0,Kt.P1)([function(e){return ru(e).stats.data}],(function(e){return e})),Tu=(0,Kt.P1)([function(e){return ru(e).stats.current}],(function(e){return e})),Eu=function(e){if("string"!==typeof e||!e)throw new Vc(null,{imageShare:e})},Cu=(function(){var e=(0,st.Z)(ut().mark((function e(){var t,n,i,a,r,s,o,c;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=window.game,n=t.player,i=t.globalScene,a=n.getPlayer(),r=a.playerId,s=a.photo,o=Cu({playerId:r,playerPhoto:s})){e.next=6;break}return console.warn("getRenderOptionsBestScore"),e.abrupt("return");case 6:return c={name:"share-best-score",width:750,height:1e3,renderOptions:o},e.next=9,i.frameCapture.capture(c);case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}}),e)})))}(),function(e){var t=e.playerId,n=void 0===t?"10":t,i=e.playerPhoto,a=void 0===i?"":i;return"string"!==typeof n||"string"!==typeof a?null:{avatar:{name:""+n,type:"image",x:253,y:73,image:a,width:250,height:250,fallbackWithImage:Yr.Z.AVATAR.KEY},wideFrame:{name:"wide-frame-share",type:"image",x:0,y:0,image:"./assets/wideframes/wide-frame-share.png",width:750,height:1e3}}}),Au=function(){return(0,st.Z)(ut().mark((function e(){var t,n,i,a,r,s,o,c,u,l;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=window.game,n=t.player,i=t.analytics,a=t.facebook,r=t.globalScene,e.prev=1,r.screen.open(As.o4.NOTIFY_SCREEN,{message:"Loading...",loading:!0}),e.next=5,wu();case 5:return s=e.sent,Eu(s),o=n.getPlayer(),c=o.playerId,u=o.name,l=o.photo,e.next=10,a.shareAsync({text:"Great! I have a best score!",intent:"SHARE",image:s||"",data:{playerId:c,playerName:u,playerPhoto:l,type:Zr}});case 10:i.event(Vi._.SHARE,{share_content_type:"BestScore",success:!0}),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),i.event(Vi._.SHARE,{share_content_type:"BestScore",success:!1}),(0,at.tO)(e.t0);case 17:return e.prev=17,r.screen.close(As.o4.NOTIFY_SCREEN),e.finish(17);case 20:case"end":return e.stop()}}),e,null,[[1,13,17,20]])})))},wu=function(){var e=(0,st.Z)(ut().mark((function e(){var t,n,i,a,r,s,o,c,u,l;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=window.game,n=t.player,i=t.globalScene,a=n.getPlayer(),r=a.playerId,s=a.photo,o=a.data,c=(o||{}).score,u=Pu({playerId:r,playerPhoto:s,playerScore:c})){e.next=7;break}return console.warn("getRenderOptionsBestScore"),e.abrupt("return");case 7:return l={name:"share-best-score",width:952,height:492,renderOptions:u},e.next=10,i.frameCapture.capture(l);case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Iu=function(){var e=(0,st.Z)(ut().mark((function e(t){var n,i,a,r,s,o,c,u,l,h,d;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=window.game,i=n.player,a=n.globalScene,r=Su(t),s=i.getPlayer(),o=s.playerId,c=s.photo,u=r[o]||{},l=u.score,h=Pu({playerId:o,playerPhoto:c,playerScore:l})){e.next=8;break}return console.warn("getRenderOptionsCurrentScore"),e.abrupt("return");case 8:return d={name:"share-current-score",width:952,height:492,renderOptions:h},e.next=11,a.frameCapture.capture(d);case 11:return e.abrupt("return",e.sent);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Pu=function(e){var t=e.playerId,n=void 0===t?"10":t,i=e.playerPhoto,a=void 0===i?"":i,r=e.playerScore,s=void 0===r?0:r;return"string"!==typeof n||"string"!==typeof a||"number"!==typeof s?null:{avatar:{name:""+n,type:"image",x:66,y:73,image:a,width:190,height:190,fallbackWithImage:Yr.Z.AVATAR.KEY},wideFrame:{name:"wide-frame-message-win",type:"image",x:0,y:0,image:"./assets/wideframes/wide-frame-message-win.png",width:952,height:492},playerScoreShadow:{type:"text",x:156,y:323,font:"600 60px",fillStyle:"#f2a62e",text:""+s,textAlign:"center"},playerScore:{type:"text",x:156,y:323,font:"600 60px",fillStyle:"#ffd10d",text:""+s,textAlign:"center"}}},ku=(function(){var e=(0,st.Z)(ut().mark((function e(){var t,n,i,a,r,s,o,c,u,l,h,d,f,p,g,m,v,y,b,S;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=window.game,n=t.player,i=t.profile,a=t.globalScene,r=n.getPlayer(),s=r.playerId,o=r.name,c=r.photo,(u=n.getConnectedPlayerIds(99,0)).push(s),l=[],e.next=7,iu({playerIds:GameCore.Utils.Array.unique(u),limit:u.length});case 7:h=e.sent,d=GameCore.Utils.Object.keyBy(h,"playerId"),f={playerId:s,name:o,photo:c,score:0},GameCore.Utils.Object.hasOwn(d,s)&&(f=d[s]),l.push(f),e.t0=zc()(ut()).call(ut(),d);case 14:if((e.t1=e.t0()).done){e.next=27;break}if(p=e.t1.value,!GameCore.Utils.Object.hasOwn(d,p)){e.next=25;break}if(g=d[p],3!==l.length){e.next=20;break}return e.abrupt("break",27);case 20:if(g.playerId!==s){e.next=22;break}return e.abrupt("continue",14);case 22:if(!(Number(g.score)>Number(f.score))){e.next=24;break}return e.abrupt("continue",14);case 24:l.push(g);case 25:e.next=14;break;case 27:return m=GameCore.Utils.Array.unique(u),e.next=30,i.requestProfiles(m);case 30:if(v=i.getProfiles(),l.forEach((function(e,t){var n=e.playerId;if(GameCore.Utils.Object.hasOwn(v,n)){var i=v[n],a=i.name,r=i.photo;l[t].name=a,l[t].photo=r}})),l.length<3)for(y=0;y<=3-l.length;)l.push({playerId:"bot"+y,name:"???",score:0,photo:"./assets/images/others/avatar.png"}),y++;if(b=ku({playerId:s,playerName:o,playerPhoto:c,listLeaders:l})){e.next=37;break}return console.warn("getRenderOptionsLeaderboard"),e.abrupt("return");case 37:return S={name:"share-leaderboard",width:1500,height:2e3,renderOptions:b},e.next=40,a.frameCapture.capture(S);case 40:return e.abrupt("return",e.sent);case 41:case"end":return e.stop()}}),e)})))}(),function(e){var t=e.playerId,n=void 0===t?"10":t,i=e.playerPhoto,a=void 0===i?"":i,r=e.listLeaders,s=void 0===r?[]:r;if(!Array.isArray(s))return null;if("string"!==typeof n)return null;if("string"!==typeof a)return null;var o={avatar:{name:""+n,type:"image",x:510,y:278,image:a,width:510,height:510,fallbackWithImage:Yr.Z.AVATAR.KEY}};return s.forEach((function(e,t){var n=e.playerId,i=e.photo;o["photo_"+n]={name:""+n,type:"image",x:436,y:1294+180*t,image:i,width:96,height:96,fallbackWithImage:Yr.Z.AVATAR.KEY}})),o.wideFrame={name:"wide-frame-share",type:"image",x:0,y:0,image:"./assets/wideframes/wide-frame-share.png",width:1500,height:2e3},s.forEach((function(e,t){var n=e.playerId,i=e.name,a=e.score;o["name_"+n]={type:"text",x:600,y:1360+180*t,font:"600 48px",text:i,fillStyle:"#b18151"},o["score_"+n]={type:"text",x:1e3,y:1360+180*t,font:"600 48px",text:a,fillStyle:"#b18151"}})),o}),xu=function(){var e=(0,st.Z)(ut().mark((function e(t){var n,i,a,r,s,o,c,u,l,h,d,f,p,g,m,v,y,b;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=window.game,i=n.player,a=n.globalScene,r=Su(t),s=i.getPlayer(),o=s.photo,c=s.playerId,u=pu(t),l=u.playerId,h=u.photo,d=mu(t,{playerId:c}),f=vu(t,{opponentId:l}),p=r[c]||{},g=p.score,m=r[l]||{},v=m.score,y=Ou({playerId:c,playerPhoto:o,playerScore:g,opponentId:l,opponentPhoto:h,opponentScore:v,isPlayerFinished:d,isOpponentFinished:f})){e.next=12;break}return console.warn("getRenderOptionsLeaderboard"),e.abrupt("return");case 12:return b={name:"share-game-result",width:952,height:492,renderOptions:y},e.next=15,a.frameCapture.capture(b);case 15:return e.abrupt("return",e.sent);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_u=function(){var e=(0,st.Z)(ut().mark((function e(t){var n,i,a,r,s,o,c,u,l,h,d,f,p,g,m;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=window.game,i=n.player,a=n.globalScene,r=Su(t),s=i.getPlayer(),o=s.photo,c=s.playerId,u=bu(t),l=u.playerId,h=u.photo,d=u.score,f=r[c]||{},p=f.score,g=Ou({playerId:c,playerPhoto:o,playerScore:p,opponentId:l,opponentPhoto:h,opponentScore:d})){e.next=9;break}return console.warn("getRenderOptionsGroupResult"),e.abrupt("return");case 9:return m={name:"share-group-match-result",width:952,height:492,renderOptions:g},e.next=12,a.frameCapture.capture(m);case 12:return e.abrupt("return",e.sent);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ou=function(e){var t=e.playerId,n=void 0===t?"10":t,i=e.playerPhoto,a=void 0===i?"":i,r=e.playerScore,s=void 0===r?0:r,o=e.opponentId,c=void 0===o?"20":o,u=e.opponentPhoto,l=void 0===u?"":u,h=e.opponentScore,d=void 0===h?0:h,f=e.isPlayerFinished,p=e.isOpponentFinished;if("string"!==typeof n)return null;if("string"!==typeof a)return null;if("number"!==typeof s)return null;if("string"!==typeof c)return null;if("string"!==typeof l)return null;if("number"!==typeof d)return null;if("boolean"!==typeof f)return null;if("boolean"!==typeof p)return null;var g=s===d,m=s>d,v=f||p,y=f&&p,b={leftPhoto:{name:""+n,type:"image",x:93,y:229,image:a,width:180,height:180,fallbackWithImage:Yr.Z.AVATAR.KEY},rightPhoto:{name:""+c,type:"image",x:682,y:229,image:l,width:180,height:180,fallbackWithImage:Yr.Z.AVATAR.KEY},wideFrame:{name:"wide-frame-game-result",type:"image",x:0,y:0,image:"./assets/wideframes/wide-frame-game-result.png",width:952,height:492}};return v&&(b.leftScoreShadow={type:"text",x:182,y:465,font:"600 50px",fillStyle:"#c4683f",text:f?""+s:"???",textAlign:"center"},b.leftScore={type:"text",x:182,y:465,font:"600 50px",fillStyle:"#f2a62e",text:f?""+s:"???",textAlign:"center"},b.rightScoreShadow={type:"text",x:771,y:465,font:"600 50px",fillStyle:"#c4683f",text:p?""+d:"???",textAlign:"center"},b.rightScore={type:"text",x:771,y:465,font:"600 50px",fillStyle:"#f2a62e",text:p?""+d:"???",textAlign:"center"}),!g&&y&&(m?b.leftCrown={name:"crown-icon",type:"image",x:40,y:315,image:"./assets/images/others/crown-icon.png",width:105,height:112}:b.rightCrown={name:"crown-icon",type:"image",x:628,y:315,image:"./assets/images/others/crown-icon.png",width:105,height:112}),b},Du=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return(n=e.call.apply(e,fe()(t=[this]).call(t,a))||this).inviteButton=void 0,n.shareButton=void 0,n}(0,ot.Z)(t,e);var n=t.prototype;return n.createMainButton=function(){var e=this;this.mainButton=this.createButton("Friend"),this.mainButton.onClick=function(){e.isEnabled=!e.isEnabled,e.updateButtons()},this.add(this.mainButton)},n.createSubButtons=function(){this.createInviteButton(),this.createShareButton(),this.subButtons=[this.inviteButton,this.shareButton],this.add(this.subButtons)},n.createInviteButton=function(){var e=this;this.inviteButton=this.createButton("Invite"),this.inviteButton.onClick=(0,st.Z)(ut().mark((function t(){return ut().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.scene.handlePlayWithFriend();case 1:case"end":return t.stop()}}),t)})))},n.createShareButton=function(){this.shareButton=this.createButton("Share"),this.shareButton.onClick=(0,st.Z)(ut().mark((function e(){return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Au();case 2:case"end":return e.stop()}}),e)})))},t}(Ac),Bu=Du,Lu=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="InvalidContextId",i.message=t||"This contextId is not valid",i.payload=n,i}return(0,ot.Z)(t,e),t}((0,wt.Z)(Error)),Ru=Lu,Gu=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="NewScoreIsBad",i.message=t||"The new score is bad",i.payload=n,i}return(0,ot.Z)(t,e),t}((0,wt.Z)(Error)),Nu=Gu,Mu=function(e){return e.tournament},Fu=(0,Kt.P1)([function(e){return Mu(e).tournamentId}],(function(e){return e})),Uu=(0,Kt.P1)([function(e){return Mu(e).leaderboardId}],(function(e){return e})),Zu=(0,Kt.P1)([function(e){return ru(e).gameplay.mode}],(function(e){return e})),Hu=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="LeaderboardNotFound",i.message=t||"Leaderboard not found",i.payload=n,i}return(0,ot.Z)(t,e),t}((0,wt.Z)(Error)),Wu=Hu,zu=GameCore.Configs,Yu=zu.AppId,Vu=zu.OtherHost,Ku=zu.LeadersBoard,ju=function(){var e=(0,st.Z)(ut().mark((function e(t){var n,i;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n={appId:Yu,resetScore:0,numberOfLeaders:15,timezone:"utc+0",sortOrder:"desc",statistics:"max",resettable:"manually",description:"no description"},!Ku.UseMock){e.next=5;break}return e.next=4,(0,Rn.qZ)(1e3);case 4:return e.abrupt("return",(0,Me.Z)({},n,t,{_id:Ku.LeaderboardId,type:"app_leaderboard",description:"mockup_leaderboard",createdAt:new Date(Date.now()).toISOString(),updatedAt:new Date(Date.now()).toISOString()}));case 5:return"leaderboards",e.next=8,zn("leaderboards",(0,Me.Z)({},n,t),{},Vu);case 8:return i=e.sent,e.abrupt("return",(null==i?void 0:i.data)||{});case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Xu=function(){var e=(0,st.Z)(ut().mark((function e(t,n){var i,a,r,s,o,c,u,l,h,d,f,p;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===n&&(n={}),i=[],!Ku.UseMock){e.next=7;break}return e.next=5,(0,Rn.qZ)(1e3);case 5:return o=(s=n).limit,c=void 0===o?10:o,u=s.offset,l=void 0===u?0:u,e.abrupt("return",z()(a=S()(r=new Array(c)).call(r,null)).call(a,(function(e,t){var n=(t+1)*(l+1);return{playerId:"player-0"+n,name:"MPlayer "+n,photo:"./assets/images/others/avatar.jpg",rank:n,score:Math.floor(1e5/n+1e4*Math.random()).toString()}})));case 7:return h=GameCore.Utils.String.params(n),d="leaderboards/"+t+"/leaders",e.next=11,Wn(d+"?"+h,{},Vu);case 11:if((f=e.sent)&&(null==f||!f.error)){e.next=14;break}throw new Error((null==f?void 0:f.error)||"Leaderboard not found");case 14:if(!((p=(null==f?void 0:f.data)||[]).length<1)){e.next=17;break}return e.abrupt("return",i);case 17:return i=p,e.abrupt("return",i);case 19:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Ju=function(){var e=(0,st.Z)(ut().mark((function e(t){var n,i;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="leaderboards/"+t,e.next=3,Wn(""+n,{},Vu);case 3:if((i=e.sent)&&(null==i||!i.error)){e.next=6;break}return e.abrupt("return",null);case 6:return e.abrupt("return",null==i?void 0:i.data);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),qu=function(){var e=(0,st.Z)(ut().mark((function e(t,n,i){var a;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,zn("leaderboards/"+t+"/players/"+n,{score:i},{},Vu);case 2:return a=e.sent,e.abrupt("return",(null==a?void 0:a.data)||{});case 4:case"end":return e.stop()}}),e)})));return function(t,n,i){return e.apply(this,arguments)}}(),Qu=function(){var e=(0,st.Z)(ut().mark((function e(){var t,n,i,a,r,s,o,c,u;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=GameCore.Utils.String.params({limit:100,type:"world_tournament_leaderboard"}),"leaderboards",e.next=4,Wn("leaderboards?"+t,{},Vu);case 4:if((n=e.sent)&&(null==n||!n.error)){e.next=7;break}throw new Wu;case 7:i=(null==n?void 0:n.data)||[],a=[],r=0;case 10:if(!(r<i.length)){e.next=26;break}s=null,e.prev=12,s=JSON.parse(i[r].description),e.next=19;break;case 16:return e.prev=16,e.t0=e.catch(12),e.abrupt("continue",23);case 19:o=new Date(i[r].createdAt).getTime(),c=Math.round((6048e5+o)/1e3),u={id:s.tournamentID,title:i[r].name,endTime:c,contextID:s.contextID,payload:{playerId:"",playerName:"",leaderboardId:i[r]._id,level:s.level,suitSize:s.suitSize,difficulty:s.difficulty}},a.push(u);case 23:r++,e.next=10;break;case 26:return e.abrupt("return",a);case 27:case"end":return e.stop()}}),e,null,[[12,16]])})));return function(){return e.apply(this,arguments)}}(),$u=function(){var e=(0,st.Z)(ut().mark((function e(t,n){var i,a,r,s,o;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=null,t){e.next=3;break}return e.abrupt("return",i);case 3:if(a=Ku.Prefix+"/"+n+"/players"){e.next=6;break}return e.abrupt("return",i);case 6:return r=GameCore.Utils.String.params({playerIds:t}),e.next=9,Wn(a+"?"+r,{},Vu);case 9:if(s=e.sent,!((o=(null==s?void 0:s.data)||[]).length<1)){e.next=13;break}return e.abrupt("return",i);case 13:return i=o[0],e.abrupt("return",i);case 15:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),el=GameCore.Configs.Tournament.UseLeaderboard,tl=function(e,t){return void 0===t&&(t=""),{type:qa,payload:{tournamentId:e,leaderboardId:t}}},nl=function(e){return function(){var t=(0,st.Z)(ut().mark((function t(n){var i,a,r,s,o,c,u,l,h,d,f,p,g;return ut().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,i=window.game.facebook,a=e.playerId,r=e.playerName,s=e.score,o=e.level,c=e.autoStartGame,u=r+"'s Tournament",l=GameCore.Utils.String.generateObjectId(),h=window.game.player.getPlayerSettings(),d=h.suitSize,f=h.difficulty,t.next=8,i.tournament.createAsync({initialScore:s,config:{title:u,tournamentTitle:u},data:{playerId:a,playerName:r,leaderboardId:l,level:o,suitSize:d,difficulty:f}});case 8:return p=t.sent,g=p.getID(),c&&n(tl(g,l)),t.next=13,ju({_id:l,createdBy:a,name:u,description:X()({contextID:g,tournamentID:g,suitSize:d,difficulty:f}),type:"tournament_leaderboard",expireTime:604800});case 13:if(t.sent._id!==l){t.next=17;break}return t.next=17,qu(l,a,s);case 17:window.game.player.joinTournament({leaderboardId:l,endTime:p.getEndTime(),level:o}),e.success=!0,t.next=25;break;case 21:throw t.prev=21,t.t0=t.catch(0),e.success=!1,t.t0;case 25:case"end":return t.stop()}}),t,null,[[0,21]])})));return function(e){return t.apply(this,arguments)}}()},il=function(e){return(0,st.Z)(ut().mark((function t(){var n,i,a,r,s;return ut().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=window.game.facebook,i=e.playerId,a=e.playerName,r=e.score,s={score:r,data:{type:Hr,playerId:i,playerName:a}},t.next=5,n.tournament.shareAsync(s);case 5:case"end":return t.stop()}}),t)})))},al=function(e){return function(){var t=(0,st.Z)(ut().mark((function t(n,i){var a,r,s,o;return ut().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=window.game.globalScene,s=i(),o=Zu(s),h()(a=[Kr,Jr]).call(a,o)){t.next=5;break}return t.abrupt("return");case 5:if(n({type:Qa,payload:{}}),r.screen.open(As.o4.NOTIFY_SCREEN,{message:"Loading...",loading:!0}),!el){t.next=12;break}return t.next=10,ul(e,s);case 10:t.next=14;break;case 12:return t.next=14,dl(e);case 14:r.screen.close(As.o4.NOTIFY_SCREEN),n(fl(e));case 16:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()},rl=0,sl=!1,ol=0,cl=!1,ul=function(){var e=(0,st.Z)(ut().mark((function e(t,n){var i,a,r,s,o,c,u,l,h,d;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=window.game,a=i.player,r=i.facebook,s=a.getPlayer(),o=s.playerId,c=s.name,u=a.getBestScore(),e.prev=3,e.next=6,r.getTournamentAsync();case 6:if(l=Uu(n),!hl(t,u)){e.next=15;break}return rl+=1,h={playerId:o,playerName:c,score:t,leaderboardId:l},e.next=12,window.game.storage.dispatch(il(h)).then((function(){sl=!0}));case 12:sl=!0,e.next=17;break;case 15:return e.next=17,r.tournament.postScoreAsync(t);case 17:e.next=28;break;case 19:if(e.prev=19,e.t0=e.catch(3),"TOURNAMENT_NOT_FOUND"!==(null==e.t0?void 0:e.t0.code)){e.next=28;break}if(ll(t,u)){e.next=24;break}return e.abrupt("return");case 24:return ol+=1,d={playerId:o,playerName:c,score:t,autoStartGame:!1},e.next=28,window.game.storage.dispatch(nl(d)).then((function(){cl=!0})).catch((function(){}));case 28:return e.prev=28,e.finish(28);case 30:case"end":return e.stop()}}),e,null,[[3,19,28,30]])})));return function(t,n){return e.apply(this,arguments)}}(),ll=function(e,t){return!window.game.player.getPlayerIsNew()&&e>t||!(cl||ol>1)&&Math.random()<.5},hl=function(){return!(sl||rl>1)},dl=function(){var e=(0,st.Z)(ut().mark((function e(t){var n,i,a,r,s,o;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=window.game,i=n.player,a=n.facebook,r=i.getBestScore(),e.prev=2,e.next=5,a.getTournamentAsync();case 5:if(!hl(t,r)){e.next=12;break}return rl+=1,e.next=9,a.tournament.shareAsync({score:t});case 9:sl=!0,e.next=14;break;case 12:return e.next=14,a.tournament.postScoreAsync(t);case 14:e.next=25;break;case 16:if(e.prev=16,e.t0=e.catch(2),"TOURNAMENT_NOT_FOUND"!==e.t0.code){e.next=25;break}if(ll(t,r)){e.next=21;break}return e.abrupt("return");case 21:return ol+=1,s=i.getPlayer(),o=s.name,e.next=25,a.tournament.createAsync({initialScore:t,config:{tournamentTitle:o+"'s Tournament"}}).then((function(){cl=!0})).catch((function(e){}));case 25:case"end":return e.stop()}}),e,null,[[2,16]])})));return function(t){return e.apply(this,arguments)}}(),fl=function(e){return{type:$a,payload:{score:e}}},pl=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="InvalidOpponentId",i.message=t||"This opponentId is not valid",i.payload=n,i}return(0,ot.Z)(t,e),t}((0,wt.Z)(Error)),gl=pl,ml=(0,Kt.P1)([function(e){return e.messages.data}],(function(e){return e})),vl=(0,Kt.P1)([ml,function(e,t){return t.opponentId}],(function(e,t){return!!GameCore.Utils.Valid.isString(t)&&(!!GameCore.Utils.Object.hasOwn(e,t)&&e[t].sent)})),yl=function(e){var t=e.contextId;if(""===t||"string"!==typeof t)throw new Ru(null,{contextId:t})},bl=function(e){var t=e.opponentId,n=e.contextId;if(""===t||"string"!==typeof t)throw new gl(null,{opponentId:t});if(""===n||"string"!==typeof n)throw new Ru(null,{contextId:n})},Sl=function(e){if(null===e.imageShare)throw new Vc},Tl=function(e,t){return void 0===t&&(t=!0),function(n,i){var a,r=i(),s=ml(r);if(t){var o;if(null!=(o=s[e])&&o.sent)return;n(El(e))}null!=(a=s[e])&&a.sent&&n(Cl(e))}},El=function(e){return{type:na.qj,payload:{opponentId:e}}},Cl=function(e){return{type:na.rh,payload:{opponentId:e}}},Al=function(){var e=(0,st.Z)(ut().mark((function e(t,n){var i,a;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,i=window.game.facebook,bl({opponentId:t,contextId:n}),(a=FBInstant.context.getID())!==n||""===n){e.next=6;break}return e.abrupt("return",a);case 6:if("10"!==t||""===n){e.next=8;break}return e.abrupt("return",n);case 8:if(!n){e.next=12;break}return e.next=11,i.switchAsync(n);case 11:return e.abrupt("return",FBInstant.context.getID());case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),(0,at.tO)(e.t0);case 17:return e.abrupt("return","");case 18:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t,n){return e.apply(this,arguments)}}(),wl=function(e,t){return function(){var n=(0,st.Z)(ut().mark((function n(i,a){var r,s,o,c,u,l,h,d,f,p,g,m,v,y;return ut().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=window.game,s=r.player,o=r.analytics,c=r.facebook,n.prev=1,u=t.matchId,l=t.contextId,h=t.suitSize,d=t.difficulty,n.next=5,Al(e,l);case 5:return f=n.sent,yl({contextId:f}),p=a(),n.next=10,xu(p);case 10:return g=n.sent,Sl({imageShare:g}),m=s.getPlayer(),v=m.name,y=m.playerId,n.next=15,c.sendMessage({cta:{default:"Play",localizations:{en_US:"Play",vi_VN:"Ch\u01a1i ngay"}},text:{default:v+" challenges you",localizations:{en_US:v+" challenges you",vi_VN:v+" th\u1eed th\xe1ch b\u1ea1n trong tr\u1eadn \u0111\u1ea5u n\xe0y. Ch\u01a1i ngay!"}},image:g||"",template:"challenge",data:{type:Wr,matchId:u,playerId:y,opponentId:e,status:Ya,suitSize:h,difficulty:d}});case 15:i(Tl(e)),o.event(Vi._.MESSAGE,{message_content_type:"Invite",success:!0}),n.next=23;break;case 19:n.prev=19,n.t0=n.catch(1),o.event(Vi._.MESSAGE,{message_content_type:"Invite",success:!1}),(0,at.tO)(n.t0);case 23:case"end":return n.stop()}}),n,null,[[1,19]])})));return function(e,t){return n.apply(this,arguments)}}()},Il=function(e,t){return function(){var n=(0,st.Z)(ut().mark((function n(i,a){var r,s,o,c,u,l,h,d,f,p,g,m,v,y;return ut().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=window.game,s=r.player,o=r.analytics,c=r.facebook,n.prev=1,u=t.matchId,l=t.contextId,h=t.suitSize,d=t.difficulty,n.next=5,Al(e,l);case 5:return f=n.sent,yl({contextId:f}),p=a(),n.next=10,xu(p);case 10:return g=n.sent,Sl({imageShare:g}),m=s.getPlayer(),v=m.name,y=m.playerId,n.next=15,c.sendMessage({cta:{default:"See result",localizations:{en_US:"See result",vi_VN:"Xem k\u1ebft qu\u1ea3"}},text:{default:v+" just finished. Check them now.",localizations:{en_US:v+" just finished. Check them now.",vi_VN:v+" v\u1eeba ho\xe0n th\xe0nh m\xe0n ch\u01a1i. Nh\u1ea5n \u0111\u1ec3 xem k\u1ebft qu\u1ea3 tr\u1eadn \u0111\u1ea5u."}},image:g||"",template:"finished",data:{type:Wr,matchId:u,playerId:y,opponentId:e,suitSize:h,difficulty:d,status:Va}});case 15:i(Tl(e)),o.event(Vi._.MESSAGE,{message_content_type:"FinishMatch",success:!0}),n.next=23;break;case 19:n.prev=19,n.t0=n.catch(1),o.event(Vi._.MESSAGE,{message_content_type:"FinishMatch",success:!1}),(0,at.tO)(n.t0);case 23:case"end":return n.stop()}}),n,null,[[1,19]])})));return function(e,t){return n.apply(this,arguments)}}()},Pl=function(e,t){return function(){var n=(0,st.Z)(ut().mark((function n(i,a){var r,s,o,c,u,l,h,d,f,p,g,m,v,y,b,S,T,E,C;return ut().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=window.game,s=r.player,o=r.analytics,c=r.facebook,n.prev=1,u=t.matchId,l=t.contextId,h=t.suitSize,d=t.difficulty,n.next=5,Al(e,l);case 5:return f=n.sent,yl({contextId:f}),p=a(),n.next=10,xu(p);case 10:return g=n.sent,Sl({imageShare:g}),m=s.getPlayer(),v=m.name,y=m.playerId,b=Su(p),S=b[y]||{},T=S.score,E=void 0===T?0:T,C=window.FBInstant.getEntryPointData(),n.next=18,c.sendMessage({cta:{default:"See result",localizations:{en_US:"See result",vi_VN:"Xem k\u1ebft qu\u1ea3"}},text:{default:v+" beat your high score. Their score: "+E,localizations:{en_US:v+" beat your high score. Their score: "+E,vi_VN:v+" \u0111\xe3 v\u01b0\u1ee3t qua \u0111i\u1ec3m s\u1ed1 c\u1ee7a b\u1ea1n, v\u1edbi "+E+" \u0111i\u1ec3m!"}},image:g||"",template:"pass_score",data:(0,Me.Z)({},C,{type:Wr,matchId:u,playerId:y,opponentId:e,suitSize:h,difficulty:d,status:Va})});case 18:i(Tl(e)),o.event(Vi._.MESSAGE,{message_content_type:"BestScore",success:!0}),n.next=26;break;case 22:n.prev=22,n.t0=n.catch(1),o.event(Vi._.MESSAGE,{message_content_type:"BestScore",success:!1}),(0,at.tO)(n.t0);case 26:case"end":return n.stop()}}),n,null,[[1,22]])})));return function(e,t){return n.apply(this,arguments)}}()},kl=function(e,t){return function(){var n=(0,st.Z)(ut().mark((function n(i,a){var r,s,o,c,u,l,h,d,f,p,g,m,v,y,b,S;return ut().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=window.game,s=r.player,o=r.analytics,c=r.facebook,n.prev=1,u=t.matchId,l=t.contextId,h=t.score,d=t.suitSize,f=t.difficulty,n.next=5,Al(e,l);case 5:return p=n.sent,yl({contextId:p}),g=a(),n.next=10,xu(g);case 10:return m=n.sent,Sl({imageShare:m}),v=s.getPlayer(),y=v.name,b=v.playerId,S=window.FBInstant.getEntryPointData(),n.next=16,c.sendMessage({cta:{default:"Play",localizations:{en_US:"Play",vi_VN:"Ch\u01a1i ngay"}},text:{default:y+" got "+h+" scores. So easy! Can you?",localizations:{en_US:y+" got "+h+" scores. So easy! Can you?",vi_VN:y+" \u0111\xe3 \u0111\u1ea1t "+h+" \u0111i\u1ec3m! Nh\u1ea5n Ch\u01a1i \u0111\u1ec3 so t\xe0i!"}},image:m||"",template:"play_turn",data:(0,Me.Z)({},S,{type:Wr,matchId:u,playerId:b,opponentId:e,suitSize:d,difficulty:f,status:Ya})});case 16:i(Tl(e)),o.event(Vi._.MESSAGE,{message_content_type:"FinishTurn",success:!0}),n.next=26;break;case 20:if(n.prev=20,n.t0=n.catch(1),o.event(Vi._.MESSAGE,{message_content_type:"FinishTurn",success:!1}),!(n.t0 instanceof Ru)){n.next=25;break}return n.abrupt("return");case 25:(0,at.tO)(n.t0);case 26:case"end":return n.stop()}}),n,null,[[1,20]])})));return function(e,t){return n.apply(this,arguments)}}()},xl=function(){var e=(0,st.Z)(ut().mark((function e(t,n){var i,a,r,s,o,c,u,l,h,d;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i=window.game,a=i.player,r=i.facebook,s=a.getPlayer(),o=s.playerId,c=s.name,u=s.photo,l=Tu(n),h=l.score,d={type:zr,playerId:o,playerName:c,playerPhoto:u,playerScore:h},e.next=7,r.sendMessage({cta:{default:"Play",localizations:{en_US:"Play",vi_VN:"Ch\u01a1i"}},text:{default:c+" beats your high score. Their score: "+h+".",localizations:{en_US:c+" beats your high score. Their score: "+h+".",vi_VN:c+" v\u1eeba v\u01b0\u1ee3t \u0111i\u1ec3m s\u1ed1 cao nh\u1ea5t c\u1ee7a b\u1ea1n! Ch\u01a1i l\u1ea7n n\u1eefa ch\u1ee9?"}},image:t||"",template:"play_turn",data:d});case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),(0,at.tO)(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t,n){return e.apply(this,arguments)}}(),_l=function(){var e=(0,st.Z)(ut().mark((function e(t,n){var i,a,r,s,o,c,u,l,h,d;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=window.game,a=i.player,r=i.facebook,e.prev=1,s=a.getPlayer(),o=s.playerId,c=s.name,u=s.photo,l=Tu(n),h=l.score,d={type:zr,playerId:o,playerName:c,playerPhoto:u,playerScore:h},e.next=7,r.sendMessage({cta:{default:"Play",localizations:{en_US:"Play",vi_VN:"Ch\u01a1i ngay"}},text:{default:c+" got "+h+" scores. So easy! Can you?",localizations:{en_US:c+" got "+h+" scores. So easy! Can you?",vi_VN:c+" \u0111\xe3 \u0111\u1ea1t "+h+" \u0111i\u1ec3m! Qu\xe1 d\u1ec5 lu\xf4n. Ch\u01a1i l\u1ea1i n\xe0o!"}},image:t||"",template:"play_turn",data:d});case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),(0,at.tO)(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t,n){return e.apply(this,arguments)}}(),Ol=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="InvalidMatchId",i.message=t||"Invalid match id",i.payload=n,i}return(0,ot.Z)(t,e),t}((0,wt.Z)(Error)),Dl=Ol,Bl=GameCore.Configs.ApiHost,Ll=function(){var e=(0,st.Z)(ut().mark((function e(t,n){var i;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"matches",e.next=3,zn("matches",{opponentPlayerId:t,extraData:n},{},Bl);case 3:return i=e.sent,e.abrupt("return",(null==i?void 0:i.data)||{});case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Rl=function(){var e=(0,st.Z)(ut().mark((function e(t){var n,i;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="matches/"+t+"/join",e.next=3,zn(n,{},{},Bl);case 3:return i=e.sent,e.abrupt("return",(null==i?void 0:i.data)||{});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Gl=function(){var e=(0,st.Z)(ut().mark((function e(t){var n,i;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="matches/"+t,e.next=3,Wn(n,{},Bl);case 3:return i=e.sent,e.abrupt("return",(null==i?void 0:i.data)||{});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Nl=function(){var e=(0,st.Z)(ut().mark((function e(t,n,i,a){var r,s;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="matches/"+t+"/finish",e.next=3,zn(r,{matchId:t,score:n,level:i,extraData:a},{},Bl);case 3:return s=e.sent,e.abrupt("return",(null==s?void 0:s.data)||{});case 5:case"end":return e.stop()}}),e)})));return function(t,n,i,a){return e.apply(this,arguments)}}(),Ml=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="InvalidMatchStatus",i.message=t||"The match status is not valid",i.payload=n,i}return(0,ot.Z)(t,e),t}((0,wt.Z)(Error)),Fl=Ml,Ul=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="InvalidOpponentId",i.message=t||"Invalid opponent id",i.payload=n,i}return(0,ot.Z)(t,e),t}((0,wt.Z)(Error)),Zl=Ul,Hl=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="InvalidBlackPlayerId",i.message=t||"Invalid black player id",i.payload=n,i}return(0,ot.Z)(t,e),t}((0,wt.Z)(Error)),Wl=Hl,zl=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="InvalidRequestedMatchId",i.message=t||"The matchId in match data not matched with requested matchId",i.payload=n,i}return(0,ot.Z)(t,e),t}((0,wt.Z)(Error)),Yl=zl,Vl=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="InvalidWhitePlayerId",i.message=t||"Invalid white player id",i.payload=n,i}return(0,ot.Z)(t,e),t}((0,wt.Z)(Error)),Kl=Vl,jl=function(e){var t=e.matchId,n=e.currentMatchId;if(""===t||"string"!==typeof t)throw new Dl(null,{matchId:t});if(""===n||"string"!==typeof n)throw new Dl(null,{currentMatchId:n});if(t!==n)throw new Yl(null,{matchId:t,currentMatchId:n})},Xl=function(e){var t=e.playerId,n=e.match,i=n._id,a=n.playerId,r=n.status;if(""===i||"string"!==typeof i)throw new Dl(null,{matchId:i});if("finished"===r||"string"!==typeof r)throw new Fl("This match is finished",{status:r});if(a!==t)throw new Rr(null,{playerId:a,currentPlayerId:t})},Jl=function(e){var t=e.opponentId;if(""===t||"string"!==typeof t)throw new Zl(null,{opponentId:t})},ql=function(e){var t=e.matchId;if(""===t||"string"!==typeof t)throw new Dl(null,{matchId:t})},Ql=function(e){var t=e.match,n=t._id,i=t.whitePlayerId,a=t.blackPlayerId;if(""===n||"string"!==typeof n)throw new Dl(null,{matchId:n});if(""===i||"string"!==typeof i)throw new Kl(null,{whitePlayerId:i});if(""===a||"string"!==typeof a)throw new Wl(null,{blackPlayerId:a})},$l=GameCore.Configs.Match,eh=function(e){try{return GameCore.Utils.Hash.stringToHash(X()(e))}catch(t){return""}},th=function(){return function(e){try{var t=window.game.player;e({type:Da,payload:{}});var n=t.getPlayerId(),i=ac($l.SingleMatchStore)||{},a=i.data;i.data=function(e){try{return JSON.parse(GameCore.Utils.Hash.hashToString(e))}catch(t){return""}}(a),Xl({playerId:n,match:i}),e(ih(i))}catch(r){if(e(ih(null)),r instanceof Dl)return;if(r instanceof Rr)return;if(r instanceof Fl)return;(0,at.tO)(r)}}},nh=function(e){return function(){var t=(0,st.Z)(ut().mark((function t(n,i){var a,r,s,o,c,u,l,h;return ut().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.prev=0,a=window.game.player,ql({matchId:e}),r=i(),s=uu(r),o=a.getPlayerId(),jl({matchId:e,currentMatchId:s}),n({type:"MATCH_SINGLE_FINISH_REQUEST",payload:{matchId:e}}),c=cu(r),Xl({playerId:o,match:c}),u=(0,Me.Z)({},$l.LocalSingleMatchDefault,c,{_id:e,status:"finished",playerId:o,finishAt:Date.now()}),n(ih(u)),l=u.data,(h=(0,Me.Z)({},u)).data=eh(l),rc($l.SingleMatchStore,h),t.next=26;break;case 18:if(t.prev=18,t.t0=t.catch(0),n(ih(null)),!(t.t0 instanceof Dl)){t.next=23;break}return t.abrupt("return");case 23:if(!(t.t0 instanceof Fl)){t.next=25;break}return t.abrupt("return");case 25:(0,at.tO)(t.t0);case 26:case"end":return t.stop()}}),t,null,[[0,18]])})));return function(e,n){return t.apply(this,arguments)}}()},ih=function(e){return{type:Ba,payload:{match:e}}},ah=function(){return{type:La,payload:{}}},rh=function(e,t){return function(){var n=(0,st.Z)(ut().mark((function n(i){var a,r,s,o;return ut().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,a=window.game,r=a.profile,a.globalScene.screen.open(As.o4.NOTIFY_SCREEN,{message:"Loading...",loading:!0}),s=e.playerId,Jl({opponentId:s}),i({type:Ga,payload:{opponentInfo:e,extraData:t}}),n.next=8,Ll(s,t);case 8:return o=n.sent,Ql({match:o}),n.next=12,r.requestProfiles([s]);case 12:i(uh(o)),n.next=23;break;case 15:if(n.prev=15,n.t0=n.catch(0),i(uh(null)),!(n.t0 instanceof Dl)){n.next=20;break}return n.abrupt("return");case 20:if(!(n.t0 instanceof Zl)){n.next=22;break}return n.abrupt("return");case 22:(0,at.tO)(n.t0);case 23:case"end":return n.stop()}}),n,null,[[0,15]])})));return function(e){return n.apply(this,arguments)}}()},sh=function(e){return function(){var t=(0,st.Z)(ut().mark((function t(n){var i,a,r,s,o,c,u,l,h;return ut().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,i=window.game,a=i.player,r=i.profile,i.globalScene.screen.open(As.o4.NOTIFY_SCREEN,{message:"Loading...",loading:!0}),ql({matchId:e}),n({type:Ra,payload:{matchId:e}}),t.next=7,Rl(e);case 7:if(s=t.sent,Ql({match:s}),o=s.status,c=s.whitePlayerId,u=s.blackPlayerId,o!==Ya){t.next=16;break}return l=a.getPlayerId(),h=l===c?u:c,t.next=16,r.requestProfiles([h]);case 16:n(uh(s)),t.next=25;break;case 19:if(t.prev=19,t.t0=t.catch(0),n(uh(null)),!(t.t0 instanceof Dl)){t.next=24;break}return t.abrupt("return");case 24:(0,at.tO)(t.t0);case 25:case"end":return t.stop()}}),t,null,[[0,19]])})));return function(e){return t.apply(this,arguments)}}()},oh=function(e,t){return function(){var n=(0,st.Z)(ut().mark((function n(i){var a,r,s,o,c,u,l,h,d;return ut().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,a=window.game,r=a.player,a.globalScene.screen.open(As.o4.NOTIFY_SCREEN,{message:"Loading...",loading:!0}),ql({matchId:e}),i({type:Ma,payload:{matchId:e,opponentInfo:t}}),n.next=7,Gl(e);case 7:s=n.sent,Ql({match:s}),o=s.whitePlayerId,c=s.whitePlayerScore,u=s.blackPlayerScore,l=r.getPlayerId(),h=r.getPlayerData(),d=h.score,i(uh(s,{score:l===o?c:u,bestScore:d})),n.next=23;break;case 17:if(n.prev=17,n.t0=n.catch(0),i(uh(null)),!(n.t0 instanceof Dl)){n.next=22;break}return n.abrupt("return");case 22:(0,at.tO)(n.t0);case 23:case"end":return n.stop()}}),n,null,[[0,17]])})));return function(e){return n.apply(this,arguments)}}()},ch=function(e,t,n){return function(){var i=(0,st.Z)(ut().mark((function i(a){var r,s;return ut().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,window.game.globalScene.screen.open(As.o4.NOTIFY_SCREEN,{message:"Loading...",loading:!0}),ql({matchId:e}),a({type:Na,payload:{matchId:e,score:t,extraData:n}}),r=n.level,i.next=8,Nl(e,t,r,n);case 8:return s=i.sent,Ql({match:s}),i.next=12,a(uh(s));case 12:i.next=20;break;case 14:if(i.prev=14,i.t0=i.catch(0),a(uh(null)),!(i.t0 instanceof Dl)){i.next=19;break}return i.abrupt("return");case 19:(0,at.tO)(i.t0);case 20:case"end":return i.stop()}}),i,null,[[0,14]])})));return function(e){return i.apply(this,arguments)}}()},uh=function(e,t,n){return void 0===n&&(n=null),{type:Fa,payload:{match:e,opponentInfo:t,current:n}}},lh=function(e){return{type:Ua,payload:{opponentInfo:e}}},hh=function(e,t){return{type:Wa,payload:{matchId:e,players:t}}},dh=function(e){return{type:ka,payload:{playerId:e}}},fh=function(e,t){return{type:xa,payload:{playerId:e,stats:t}}},ph=function(e){return{type:_a,payload:{stats:e}}},gh=function(e){var t=e.contextId;if(""===t||"string"!==typeof t)throw new Ru(null,{contextId:t})},mh=null,vh=function(e){clearTimeout(mh),mh=setTimeout((function(){window.game.globalScene.screen.close(As.o4.NOTIFY_SCREEN)}),e)},yh=function(e){return function(t){try{if(t(ah()),e){var n=e.getPayload(),i=e.getID();if(n){var a=JSON.parse(n).leaderboardId;t(tl(i.toString(),a))}}t(wh(Jr))}catch(r){(0,at.tO)(r)}}},bh=function(){return function(){var e=(0,st.Z)(ut().mark((function e(t){return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{t(ah()),t(wh(Kr))}catch(n){(0,at.tO)(n)}case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},Sh=function(e,t){return void 0===e&&(e="10"),void 0===t&&(t=!1),function(n){try{n(Th("reset",e,t))}catch(i){(0,at.tO)(i)}}},Th=function(e,t,n){return void 0===t&&(t="10"),void 0===n&&(n=!1),function(){var i=(0,st.Z)(ut().mark((function i(a){var r,s,o,c,u,l,h,d,f,p,g,m,v,y,b,S,T,E;return ut().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(i.prev=0,r=window.game,s=r.player,o=r.facebook,(c=r.globalScene).screen.open(As.o4.NOTIFY_SCREEN,{message:"Loading...",loading:!0}),u=e,l=o.contextType,t||(h=GameCore.Configs.PlayerIdMock,d=GameCore.Configs.PlayerIdMock2,t=s.getPlayerId()===h?d:h),e){i.next=30;break}return i.next=9,o.chooseAsync();case 9:if(!1!==(u=i.sent)){i.next=18;break}if(n&&c.events.emit(fs.K.SWITCH,fs.C.DASHBOARD_SCENE),!as.instance.autoPlaySingleMode){i.next=17;break}return i.next=15,Ph();case 15:return a(bh()),i.abrupt("return");case 17:return i.abrupt("return");case 18:return i.prev=18,i.next=21,window.game.facebook.getTournamentAsync();case 21:return f=i.sent,a(yh(f)),i.abrupt("return");case 26:i.prev=26,i.t0=i.catch(18);case 28:i.next=45;break;case 30:if(!t||t===Vr.playerId){i.next=43;break}return i.next=33,o.createAsync(t);case 33:if(!1!==(u=i.sent)){i.next=37;break}return n&&c.events.emit(fs.K.SWITCH,fs.C.DASHBOARD_SCENE),i.abrupt("return");case 37:if(!as.instance.autoPlaySingleMode){i.next=42;break}return i.next=40,Ph();case 40:return a(bh()),i.abrupt("return");case 42:u||"reset"===e||(u=e);case 43:l=o.contextType,a(rs(u,l));case 45:return gh({contextId:u}),p=s.getPlayerId(),g=s.getConnectedPlayers(),i.next=50,o.getContextPlayers(p);case 50:return m=i.sent,t!==(v=Vr).playerId&&g[t]?v=g[t]:1===m.length&&(v=m[0]),a(dh()),b=(y=v).playerId,S=y.name,T=y.photo,E={playerId:b,name:S,photo:T},i.next=58,a(wh(jr,E));case 58:a(rs(u,l)),i.next=70;break;case 61:if(i.prev=61,i.t1=i.catch(0),!(i.t1 instanceof Ru)){i.next=65;break}return i.abrupt("return");case 65:if("USER_INPUT"!==(null==i.t1?void 0:i.t1.code)){i.next=67;break}return i.abrupt("return");case 67:if("INVALID_OPERATION"!==(null==i.t1?void 0:i.t1.code)){i.next=69;break}return i.abrupt("return");case 69:(0,at.tO)(i.t1);case 70:return i.prev=70,vh(10),i.finish(70);case 73:case"end":return i.stop()}}),i,null,[[0,61,70,73],[18,26]])})));return function(e){return i.apply(this,arguments)}}()},Eh=function(){return function(){var e=(0,st.Z)(ut().mark((function e(t){var n,i,a,r,s,o,c,l,h,d,f,p,m,v,y,b;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n=window.game,i=n.player,a=n.facebook,n.globalScene.screen.open(As.o4.NOTIFY_SCREEN,{message:"Loading...",loading:!0}),r=i.getPlayerId(),s=i.getConnectedPlayerIds(100,0),o=i.getConnectedPlayers(100,0),0==(c=u()(s).call(s,(function(e){var t;return g()(t=as.instance.friendsChallenged).call(t,e)<0&&e!=r}))).length&&(c.push.apply(c,s),as.instance.friendsChallenged=[]),console.log({friendListCanBeChallenged:c}),l="",h="",d=a.contextType,f=null,c.length>0&&(p=Phaser.Math.RND.between(0,c.length-1),l=c[p],o[l]&&(f=o[l],as.instance.friendsChallenged.push(l))),!l||"string"!==typeof l){e.next=18;break}return e.next=17,a.createAsync(l);case 17:h=e.sent;case 18:if(f&&h){e.next=22;break}return e.next=21,t(Th());case 21:return e.abrupt("return");case 22:return gh({contextId:h}),t(dh()),v=(m=f).name,y=m.photo,b={playerId:l,name:v,photo:y},e.next=28,t(wh(jr,b));case 28:t(rs(h,d)),vh(100),e.next=38;break;case 32:if(e.prev=32,e.t0=e.catch(0),vh(100),!(e.t0 instanceof Ru)){e.next=37;break}return e.abrupt("return");case 37:(0,at.tO)(e.t0);case 38:return e.prev=38,e.finish(38);case 40:case"end":return e.stop()}}),e,null,[[0,32,38,40]])})));return function(t){return e.apply(this,arguments)}}()},Ch=function(e,t){return function(){var n=(0,st.Z)(ut().mark((function n(i,a){var r,s,o,c,u,l,h,d,f,p,g,m,v,y,b;return ut().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,r=window.game,s=r.player,o=r.profile,c=r.facebook,(u=r.globalScene).screen.open(As.o4.NOTIFY_SCREEN,{message:"Loading...",loading:!0}),l=a(),h=s.getPlayerId(l),!((d=s.getConnectedPlayers(l)).length>0)||d[t]){n.next=10;break}return i(kh({mode:Kr})),u.events.emit(fs.K.SWITCH,fs.C.GAME_SCENE),n.abrupt("return");case 10:return f=Vr,n.next=13,c.getContextPlayers(h);case 13:if(p=n.sent,t===h||t===f.playerId||!d[t]){n.next=18;break}f=d[t],n.next=26;break;case 18:if(1!==p.length){n.next=22;break}f=p[0],n.next=26;break;case 22:return n.next=24,o.requestProfiles([t]);case 24:(g=o.getProfiles())[t]&&(f=g[t]);case 26:return n.next=28,i(oh(e,f));case 28:if(l=a(),gu(l,{playerId:h})!==Vr.playerId){n.next=33;break}return n.next=33,i(sh(e));case 33:if(l=a(),gu(l,{playerId:h})===h||!d[t]){n.next=38;break}return i(Sh(t,!0)),n.abrupt("return");case 38:if(du(l)===e){n.next=42;break}return u.events.emit(fs.K.SWITCH,fs.C.DASHBOARD_SCENE),n.abrupt("return");case 42:m=fu(l),v=mu(l,{playerId:h}),y=c.getContextID(),b=c.contextType,i(rs(y,b)),window.isFinishingFriendMatch=!1,v||i(kh({mode:jr,status:m})),v&&(i(kh({mode:Kr})),window.isFinishingFriendMatch=!0),u.events.emit(fs.K.SWITCH,fs.C.GAME_SCENE),n.next=56;break;case 53:n.prev=53,n.t0=n.catch(0),(0,at.tO)(n.t0);case 56:return n.prev=56,vh(500),n.finish(56);case 59:case"end":return n.stop()}}),n,null,[[0,53,56,59]])})));return function(e,t){return n.apply(this,arguments)}}()},Ah=function(e){return function(t){try{var n=window.game.player,i=n.getPlayerId();au(i,e).catch((function(e){(0,at.tO)(new Error(e))}));var a=n.getPlayerData(),r=a.score,s=void 0===r?0:r,o=a.level;s<e&&n.setBestScore(e);var c={score:e,level:o};t(fh(i,c)),t(ph(c))}catch(u){if(u instanceof Nu)return;(0,at.tO)(u)}}},wh=function(e,t){return void 0===t&&(t=null),function(){var n=(0,st.Z)(ut().mark((function n(i,a){var r,s,o,c,u,l,d,f,p,g,m,v,y,b,T,E,C,A,w;return ut().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,s=window.game,o=s.player,c=s.analytics,u=s.facebook,l=s.globalScene,d=u.getContextID(),f=0,p=a(),c.event(Vi._.MATCH_START,{game_mode:GameCore.Utils.String.toUpperCamelCase(e),level:1,level_name:"level_1"}),i({type:Aa,payload:{}}),!h()(r=[Kr,Jr]).call(r,e)){n.next=16;break}return n.next=10,i(th());case 10:if(p=a(),uu(p)){n.next=15;break}return n.next=15,i(function(){var e=(0,st.Z)(ut().mark((function e(t){var n,i,a,r;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,n=window.game,i=n.player,n.globalScene.screen.open(As.o4.NOTIFY_SCREEN,{message:"Loading...",loading:!0}),t({type:Oa,payload:{}}),a=i.getPlayerId(),r=(0,Me.Z)({},$l.LocalSingleMatchDefault,{status:"active",playerId:a,startedAt:Date.now()}),Xl({playerId:a,match:r}),t(ih(r)),rc($l.SingleMatchStore,r),e.next=19;break;case 11:if(e.prev=11,e.t0=e.catch(0),t(ih(null)),!(e.t0 instanceof Dl)){e.next=16;break}return e.abrupt("return");case 16:if(!(e.t0 instanceof Fl)){e.next=18;break}return e.abrupt("return");case 18:(0,at.tO)(e.t0);case 19:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t){return e.apply(this,arguments)}}());case 15:f=lu(p);case 16:if(e===Xr&&i(lh(t)),e!==jr){n.next=29;break}return g=o.getPlayerSettings(),m=g.suitSize,v=g.difficulty,y={suitSize:m,difficulty:v},n.next=23,i(rh(t,y));case 23:p=a(),b=du(p),T=pu(p),E=T.playerId,d||(d=window.FBInstant.context.getID()),C=vl(p,{opponentId:E}),d&&E&&!C&&i(wl(E,{contextId:d,matchId:b,suitSize:m,difficulty:v}));case 29:"online"===e&&i(function(){var e=(0,st.Z)(ut().mark((function e(t){var n,i,a,r,s,o,c,u;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=window.game.player,r=a.getPlayer(),s=r.playerId,o=r.name,c=r.photo,t({type:Ha,payload:{playerId:s}}),u={},z()(n=S()(i=new Array(20)).call(i,null)).call(n,(function(e,t){var n="0"+(t+1);u[n]={playerId:n,name:"MPlayer "+n,photo:"./assets/images/others/avatar.png"}})),u[s]={playerId:s,name:o,photo:c},t(hh("mock",u));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),A=o.getPlayerData(p),w=A.score,i(ph({score:f,bestScore:void 0===w?0:w})),i({type:wa,payload:{mode:e,contextId:d}}),as.instance.setGameMode(e),i(ss(e)),l.events.emit(fs.K.SWITCH,fs.C.GAME_SCENE),n.next=45;break;case 38:if(n.prev=38,n.t0=n.catch(0),!(n.t0 instanceof Dl)){n.next=44;break}return window.game.globalScene.screen.open(As.o4.NOTIFY_SCREEN,{message:"Sorry!, you can now\ncreate this match!",duration:2500,loading:!1}),n.abrupt("return");case 44:(0,at.tO)(n.t0);case 45:return n.prev=45,vh(0),n.finish(45);case 48:case"end":return n.stop()}}),n,null,[[0,38,45,48]])})));return function(e,t){return n.apply(this,arguments)}}()},Ih=function(e,t){return function(){var n=(0,st.Z)(ut().mark((function n(i,a){var r,s,o,c,u,l,h,d,f,p,m,v,y,b,S,T,E,C,A,w,I;return ut().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(s=window.game.player,o=t.score,c=void 0===o?0:o,u=t.level,l=void 0===u?0:u,h=t.time,d=void 0===h?0:h,f=t.moves,p=void 0===f?0:f,m=a(),!(g()(r=[Kr,Jr]).call(r,e)>=0)){n.next=7;break}return v=uu(m),n.next=7,i(nh(v));case 7:if(e!==Jr){n.next=12;break}if(!(y=Uu(m))){n.next=12;break}return n.next=12,qu(y,s.getPlayerId(),c);case 12:if(e===Xr&&(i({type:Za,payload:{}}),b=s.getPlayerId(),i(fh(b,t))),e!==jr){n.next=23;break}return S=du(m),T=hu(m),E=T.whitePlayerId,C=T.extraData,A=window.game.player.getPlayerId(),w=A===E,I=(0,Me.Z)({},C),w?I.whitePlayerData={score:c,time:d,moves:p}:I.blackPlayerData={score:c,time:d,moves:p},n.next=23,i(ch(S,c,(0,Me.Z)({level:l},I)));case 23:i({type:Ia,payload:{mode:e}});case 24:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}()},Ph=function(){var e=(0,st.Z)(ut().mark((function e(){return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("SOLO"!=window.FBInstant.context.getType()){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,new(xe())((function(e){try{if("SOLO"==window.FBInstant.context.getType())return e();var t=setInterval((function(){"SOLO"==window.FBInstant.context.getType()&&(clearInterval(t),e())}),200),n=function(){var n=(0,st.Z)(ut().mark((function n(){return ut().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,window.FBInstant.context.switchAsync("SOLO",!0);case 3:window.game.analytics.event(Vi._.SWITCH_SOLO_CONTEXT,{success:!0}),n.next=11;break;case 6:n.prev=6,n.t0=n.catch(0),window.game.analytics.event(Vi._.SWITCH_SOLO_CONTEXT,{success:!1}),clearInterval(t),e();case 11:case"end":return n.stop()}}),n,null,[[0,6]])})));return function(){return n.apply(this,arguments)}}();n()}catch(i){console.log("same context"),e()}})).then((function(){}));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),kh=function(e){return function(t){var n=e.mode,i=e.status;t({type:Pa,payload:{mode:n,status:i}}),as.instance.setGameMode(n),(0,at.sw)("game-mode",n)}},xh=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return(n=e.call.apply(e,fe()(t=[this]).call(t,a))||this).createTournamentButton=void 0,n}(0,ot.Z)(t,e);var n=t.prototype;return n.createMainButton=function(){var e=this;this.mainButton=this.createButton("Tournament"),this.mainButton.onClick=function(){e.isEnabled=!e.isEnabled,e.updateButtons()},this.add(this.mainButton)},n.createSubButtons=function(){this.createCreateTournamentButton(),this.subButtons=[this.createTournamentButton],this.add(this.subButtons)},n.createCreateTournamentButton=function(){var e=this;this.createTournamentButton=this.createButton("Create"),this.createTournamentButton.onClick=(0,st.Z)(ut().mark((function t(){var n,i,a,r,s;return ut().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.scene.game.globalScene,t.prev=1,i=e.scene.player.getPlayer(),a=i.playerId,r=i.name,s={playerId:a,playerName:r,score:0,autoStartGame:!0,success:!0},n.screen.open(As.o4.NOTIFY_SCREEN,{message:"Creating tournament...",loading:!0}),t.next=7,(0,Rn.qZ)(500);case 7:return t.next=9,Ph();case 9:return t.next=11,e.scene.storage.dispatch(nl(s));case 11:return t.next=13,e.scene.storage.dispatch(yh());case 13:e.scene.screen.close(As.o4.TOURNAMENTS_SCREEN),e.scene.gameplay.startNewGame(),t.next=21;break;case 18:t.prev=18,t.t0=t.catch(1),n.screen.open(As.o4.NOTIFY_SCREEN,{message:"Oops!\n You are not able to create\ntournaments right now.\n\nPlease try again later.",duration:2e3,loading:!1});case 21:return t.prev=21,n.screen.close(As.o4.NOTIFY_SCREEN),t.finish(21);case 24:case"end":return t.stop()}}),t,null,[[1,18,21,24]])})))},t}(Ac),_h=xh,Oh=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return(n=e.call.apply(e,fe()(t=[this]).call(t,a))||this).friendGroup=void 0,n.tournamentGroup=void 0,n}(0,ot.Z)(t,e);var n=t.prototype;return n.createMainButton=function(){var e=this;this.mainButton=this.createButton("Match"),this.mainButton.onClick=function(){e.isEnabled=!e.isEnabled,e.updateButtons()},this.add(this.mainButton)},n.createSubButtons=function(){this.createFriendGroup(),this.createTournamentGroup(),this.subButtons=[this.friendGroup,this.tournamentGroup],this.add(this.subButtons)},n.createFriendGroup=function(){this.friendGroup=new Bu(this.devToolbar)},n.createTournamentGroup=function(){this.tournamentGroup=new _h(this.devToolbar)},t}(Ac),Dh=Oh,Bh=function(e){function t(t,n){var i;return(i=e.call(this,t,0,0)||this).scene=void 0,i.boardGame=void 0,i.mainButton=void 0,i.levelInfo=void 0,i.levelGroup=void 0,i.gameplayGroup=void 0,i.matchGroup=void 0,i.cardUtilsGroup=void 0,i.clearDataButton=void 0,i.isEnabled=void 0,i.scene=t,i.boardGame=n,i.createDevToolButton(),i.createLevelInfo(),i.createLevelGroup(),i.createGameplayGroup(),i.createMatchGroup(),i.createCardUtilsGroup(),i.createClearDataButton(),i.updateButtons(),i}(0,ot.Z)(t,e);var n=t.prototype;return n.createDevToolButton=function(){var e=this;this.mainButton=new Sc(this.scene,"DevTools"),this.mainButton.onClick=function(){e.isEnabled=!e.isEnabled,e.updateButtons()},this.mainButton.setLabelTint(16711680),this.add(this.mainButton)},n.createLevelInfo=function(){this.levelInfo=new cc(this.scene),this.add(this.levelInfo)},n.createLevelGroup=function(){this.levelGroup=new Hc(this),this.add(this.levelGroup)},n.createGameplayGroup=function(){this.gameplayGroup=new Uc(this),this.add(this.gameplayGroup)},n.createMatchGroup=function(){this.matchGroup=new Dh(this),this.add(this.matchGroup)},n.createCardUtilsGroup=function(){this.cardUtilsGroup=new Mc(this),this.add(this.cardUtilsGroup)},n.createClearDataButton=function(){this.clearDataButton=new Sc(this.scene,"Clear Data"),this.clearDataButton.onClick=function(){sc("current-level"),sc("singleMatch"),sc("current-board");var e=new Dn({}).toObject();FBInstant.player.setDataAsync(e)},this.add(this.clearDataButton)},n.updateButtons=function(){this.scene.world.isLandscape()?this.updateButtonLandscape():this.updateButtonPortrait()},n.updateButtonLandscape=function(){var e=this.mainButton,t=e.x,n=e.y,i=this.mainButton.button,a=i.width,r=i.height;this.levelInfo.setPosition(t+.6*a,n),this.levelGroup.setPosition(t,n+r);var s=this.levelGroup,o=s.x,c=s.y;this.gameplayGroup.setPosition(o,c+this.levelGroup.getHeight());var u=this.gameplayGroup,l=u.x,h=u.y;this.matchGroup.setPosition(l,h+this.gameplayGroup.getHeight());var d=this.matchGroup,f=d.x,p=d.y;this.cardUtilsGroup.setPosition(f,p+this.matchGroup.getHeight());var g=this.cardUtilsGroup,m=g.x,v=g.y;this.clearDataButton.setPosition(m,v+this.cardUtilsGroup.getHeight()),this.levelInfo.setVisible(this.isEnabled),this.levelGroup.setVisible(this.isEnabled),this.gameplayGroup.setVisible(this.isEnabled),this.matchGroup.setVisible(this.isEnabled),this.cardUtilsGroup.setVisible(this.isEnabled),this.clearDataButton.setVisible(this.isEnabled)},n.updateButtonPortrait=function(){var e=this.mainButton,t=e.x,n=e.y,i=this.mainButton.button,a=i.width,r=i.height;this.levelGroup.setPosition(t+a,n),this.levelInfo.setPosition(t-a/2,n-1.5*r);var s=this.levelGroup,o=s.x,c=s.y;this.gameplayGroup.setPosition(o+a,c);var u=this.gameplayGroup,l=u.x,h=u.y;this.matchGroup.setPosition(l+a,h);var d=this.matchGroup,f=d.x,p=d.y;this.cardUtilsGroup.setPosition(f+a,p);var g=this.cardUtilsGroup,m=g.x,v=g.y;this.clearDataButton.setPosition(m+a,v),this.levelInfo.setVisible(this.isEnabled),this.levelGroup.setVisible(this.isEnabled),this.gameplayGroup.setVisible(this.isEnabled),this.matchGroup.setVisible(this.isEnabled),this.cardUtilsGroup.setVisible(this.isEnabled),this.clearDataButton.setVisible(this.isEnabled)},n.updateLevelInfo=function(e,t){this.levelInfo.setSuitInfo(e,t)},t}(Phaser.GameObjects.Container),Lh=Bh,Rh=function(e){function t(t,n){var i;return(i=e.call(this,t,0,0)||this).scene=void 0,i.boardGame=void 0,i.hitZone=void 0,i.scene=t,i.boardGame=n,i.createHitZone(),i.scene.add.existing((0,Cs.Z)(i)),i}return(0,ot.Z)(t,e),t.prototype.createHitZone=function(){var e=this,t=Vs.CARD_HEIGHT,n=Vs.CARD_WIDTH;this.hitZone=this.scene.add.zone(0,0,n,t),this.hitZone.setOrigin(.5,.5),this.hitZone.setInteractive({useHandCursor:!0}),this.hitZone.on("pointerdown",(function(){var t=e.scene,n=t.header,i=t.footer,a=e.boardGame.marketingButton,r=n.visible,s=i.visible,o=a.isActive;n.setVisible(!r),i.setVisible(!s),a.setVisible(!o)})),this.add(this.hitZone)},t}(Phaser.GameObjects.Container),Gh=Rh,Nh=Ds.Z.GAMEPLAY_DEFAULT,Mh=Nh.KEY,Fh=Nh.FRAME,Uh=function(e){function t(t,n){var i;return(i=e.call(this,t,0,0)||this).hitZone=void 0,i.icon=void 0,i.text=void 0,i.createIcon(),i.createText(n),i.createHitZone(),i}(0,ot.Z)(t,e);var n=t.prototype;return n.createIcon=function(){this.icon=this.scene.add.image(0,0,Mh,Fh.DEV_TOOLS_BUTTON),this.icon.setWorldSize(70,40),this.add(this.icon)},n.createText=function(e){this.text=this.scene.make.bitmapText({text:e,font:Go.Z.BOLD.KEY,size:this.scene.fontSize(16),origin:{x:.5,y:.5}}),this.add(this.text)},n.createHitZone=function(){this.hitZone=this.scene.add.zone(0,0,70,40),this.hitZone.setOrigin(.5,.5),this.hitZone.setInteractive({useHandCursor:!0}),this.add(this.hitZone)},n.addCallback=function(e){this.hitZone.on("pointerdown",e)},n.setVisible=function(e){return this.icon.setVisible(e),this.text.setVisible(e),this},t}(Phaser.GameObjects.Container),Zh=Uh,Hh=function(e){function t(t,n){var i;return(i=e.call(this,t,0,0)||this).scene=void 0,i.boardGame=void 0,i.winButton=void 0,i.loseButton=void 0,i.newButton=void 0,i.stepButton=void 0,i.isActive=void 0,i.scene=t,i.boardGame=n,i.scene.add.existing((0,Cs.Z)(i)),i.createButtons(),i.isActive=i.visible,i}(0,ot.Z)(t,e);var n=t.prototype;return n.createButtons=function(){this.createWinButton(),this.createLoseButton(),this.createNewButton(),this.createStepButton(),this.alignButtons()},n.createWinButton=function(){var e=this;this.winButton=new Zh(this.scene,"Win"),this.winButton.addCallback((function(){e.scene.gameplay.boardGame.handleGameWon()})),this.add(this.winButton)},n.createLoseButton=function(){var e=this;this.loseButton=new Zh(this.scene,"Lose"),this.loseButton.addCallback((function(){e.scene.gameplay.boardGame.outOfMove()})),this.add(this.loseButton)},n.createNewButton=function(){var e=this;this.newButton=new Zh(this.scene,"New"),this.newButton.addCallback((0,st.Z)(ut().mark((function t(){return ut().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.scene.screen.close(As.o4.PLAY_SCREEN),t.next=3,e.scene.handlePlaySingle();case 3:case"end":return t.stop()}}),t)})))),this.add(this.newButton)},n.createStepButton=function(){this.stepButton=new Zh(this.scene,"Step");var e=this.scene.gameplay.boardGame;this.stepButton.addCallback((function(){e.isIdle()&&(e.boardState=is.PLAYING),e.isPlaying()&&e.hint.autoPlayStep()})),this.add(this.stepButton)},n.alignButtons=function(){this.winButton.setPosition(0,0),this.loseButton.setPosition(80,0),this.newButton.setPosition(0,60),this.stepButton.setPosition(80,60)},n.setVisible=function(e){return this.winButton.setVisible(e),this.loseButton.setVisible(e),this.newButton.setVisible(e),this.stepButton.setVisible(e),this.isActive=e,this},t}(Phaser.GameObjects.Container),Wh=Hh,zh=267,Yh=48,Vh=Ds.Z.GAMEPLAY_DEFAULT,Kh=(Vh.KEY,Vh.FRAME,function(e){function t(t){var n;return(n=e.call(this)||this).scene=void 0,n.gameplay=void 0,n.deck=void 0,n.stock=void 0,n.piles=void 0,n.foundations=void 0,n.updateScoreTimer=void 0,n.hint=void 0,n.mover=void 0,n.boardState=void 0,n.bestMoveFinder=void 0,n.difficultyHandler=void 0,n.isAutoPlay=void 0,n.isDevToolRemovingCards=void 0,n.devTools=void 0,n.isDevToolAddingCards=void 0,n.devToolAddSuitValue=void 0,n.devToolAddCardValue=void 0,n.isDevToolChangingCards=void 0,n.devToolChangeSuitValue=void 0,n.devToolChangeCardValue=void 0,n.autoCompleteBtn=void 0,n.levelType="easy",n.levelTypeBtn=void 0,n.levelSuit="one",n.levelSuitBtn=void 0,n.levelDifficulty="easy",n.levelDifficultyBtn=void 0,n.newLevelButton=void 0,n.restartButton=void 0,n.canAutoComplete=void 0,n.isRelaxedSpider=void 0,n.score=void 0,n.moves=void 0,n.time=void 0,n.timeToSaveBoardData=void 0,n.timeScoreBonusTween=void 0,n.autoCompleteData=void 0,n.hideUIButton=void 0,n.marketingButton=void 0,n.gameplay=t,n.scene=t.scene,n.difficultyHandler=new Vo((0,Cs.Z)(n)),n.bestMoveFinder=new ic(n.scene,(0,Cs.Z)(n)),n.deck=new zo((0,Cs.Z)(n)),n.stock=new Zo((0,Cs.Z)(n)),n.piles=[],n.foundations=[],n.score=0,n.time=0,n.moves=0,n.timeToSaveBoardData=0,n.autoCompleteData={kingPiles:null,nonKingPiles:null},n.hint=new To((0,Cs.Z)(n)),n.mover=new Ro((0,Cs.Z)(n)),n.boardState=is.NONE,n.canAutoComplete=!1,n.isDevToolRemovingCards=!1,n.isDevToolAddingCards=!1,n.devToolAddSuitValue=100,n.devToolAddCardValue=1,n.isDevToolChangingCards=!1,n.devToolChangeSuitValue=100,n.devToolChangeCardValue=1,n.isRelaxedSpider=!0,n.hideUIButton=new Gh(n.scene,(0,Cs.Z)(n)),n.listenEvents(),n.createAutoWinButton(),n.scene.screen.events.on(GameCore.Screens.Events.OPEN,(function(){n.boardState===is.PLAYING&&(n.boardState=is.IDLE)})),n}(0,ot.Z)(t,e);var n=t.prototype;return n.getStatistics=function(){return{score:this.score,time:this.time,moves:this.moves}},n.getCurrentGameRelaxedSpiderSetting=function(){return this.isRelaxedSpider},n.setUpBoard=function(e){void 0===e&&(e=!1);for(var t=this.scene,n=t.levelHandler,i=t.placementManager,a=n.getConfigs(),r=a.foundations,s=a.piles,o=a.suits,c=0;c<r;c++){var u=i.requestNewFoundation(c);this.foundations.push(u)}for(var l=0;l<s;l++){var h=i.requestNewPile(l);this.piles.push(h)}if(!e){switch(this.score=1e3,o.length){case 2:this.score=1500;break;case 4:this.score=2e3}this.deck.init()}},n.increaseScore=function(e){this.score+=e},n.decreaseScore=function(e){this.score=Math.max(0,this.score-e)},n.increaseMoves=function(){this.hint.resetAutoHintTime(),this.moves+=1,this.gameplay.saveSystem.saveCurrentBoardData()},n.getScore=function(){return this.score},n.getTime=function(){return Math.round(this.time)},n.getMoves=function(){return this.moves},n.createAutoWinButton=function(){var e=this,t=zh,n=Yh,i=new Ho.Z(this.scene,t,n);i.setName("AutoComplete");var a=new Jo(this.scene,{key:"auto-complete-button",radius:10,border:16,width:t,height:n,alpha:.24}),r=this.scene.add.graphics();r.lineStyle(1,16777215),r.strokeRoundedRect(-t/2,-n/2,t,n,n/4);var s=this.scene.time.addEvent({delay:50,repeat:-1,callback:function(){e.boardState===is.AUTO_COMPLETING?e.autoCompleteGame():s.paused=!0},paused:!0});i.onClick=function(){i.kill(),e.mover.disableInput(),e.boardState=is.AUTO_COMPLETING,s.paused=!1,e.gameplay.scene.footer.hintBtn.setDisabled(!0),e.gameplay.scene.footer.playBtn.setDisabled(!0),e.scene.audio.playSound(Bt.AUTO_COMPLETE)};var o=this.scene.make.bitmapText({font:Go.Z.PRIMARY.KEY,size:this.scene.fontSize(16),text:"Auto Complete",origin:{x:.5,y:.5}});i.add([a,r,o]),Phaser.Display.Align.To.TopCenter(i,this.scene.footer,0,24),new qo.Z({targets:[i],duration:500,props:{scale:"*=0.98"}}).play(),i.kill(),this.autoCompleteBtn=i},n.listenEvents=function(){var e=this;this.scene.events.on("settings-changed",(function(t){"autoComplete"===t&&e.setAutoCompleteStatus()}))},n.autoCompleteGame=function(){var e=(0,st.Z)(ut().mark((function e(){var t,n,i,a,r,s,o,c,u,l;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.autoCompleteData,n=t.kingPiles,i=t.nonKingPiles,a=[],r=[],null!==n&&a.push.apply(a,n),null!==i&&r.push.apply(r,i),s=0;case 6:if(!(s<a.length)){e.next=16;break}if(o=a[s],!(c=o.getTopCardStackData())||13!==c.length){e.next=13;break}return this.mover.handleClickOnCard(o.cards[0]),e.next=13,eo(this.scene,30);case 13:s++,e.next=6;break;case 16:u=0;case 17:if(!(u<r.length)){e.next=25;break}return(l=r[u].cards[0])&&this.mover.handleClickOnCard(l),e.next=22,eo(this.scene,30);case 22:u++,e.next=17;break;case 25:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.alignBoard=function(){if(0!==this.piles.length){var e=this.scene.world.getWorldSize().width/2,t=Vs.FOUNDATION_Y+30,n=this.getHorizontalPileSpace();this.placeCenter([this.stock],e,t,n,3.5);var i=this.scene.world.isLandscape()?1.3:1,a=Vs.SPACE_BETWEEN_PILE_AND_FOUNDATION*i;this.placeCenter(this.piles,e,t+a,n);var r=this.piles[0],s=this.piles[this.piles.length-1];this.stock.setPosition(s.x,t),this.hideUIButton.setPosition(s.x-Vs.CARD_WIDTH,t),this.placeFoundations(this.foundations,r.x,t),this.deck.align()}},n.getHorizontalPileSpace=function(){var e=Math.floor((this.scene.gameZone.width-10*Vs.CARD_WIDTH)/11)+Vs.CARD_WIDTH;return Math.min(e,Vs.MAX_HORIZONTAL_PILE_SPACE)},n.placeCenter=function(e,t,n,i,a){void 0===a&&(a=0);for(var r=e.length,s=t-(r/2-.5-a)*i,o=0;o<r;o++)e[o].setPosition(s+o*i,n)},n.placeFoundations=function(e,t,n){for(var i=e.length,a=t,r=.4*Vs.CARD_WIDTH,s=0;s<i;s++)e[s].setPosition(a+s*r,n)},n.startGame=function(){var e=(0,st.Z)(ut().mark((function e(t){var n,i,a,r,s,o,c;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isDealing()){e.next=2;break}return e.abrupt("return");case 2:if((n=this.scene.levelHandler).setConfig(t),GameCore.Utils.Object.hasOwn(t,"levelConfig")?(i=t,this.clearOldBoard({isRelaxedSpider:i.settings.relaxedSpider})):(a=!0===this.scene.player.getPlayerSetting("relaxedSpider"),this.clearOldBoard({isRelaxedSpider:a})),r=n.getConfigs(),s=r.suits,GameCore.Utils.Valid.isDebugger()&&this.devTools.updateLevelInfo(s.length.toString(),this.scene.gameplay.difficulty),console.log("StartGame with config: ",t),this.setUpBoard(),this.alignBoard(),o=n.getConfigs(),"dynamic"!==(c=o.type)&&"prebuilt"!==c){e.next=15;break}return e.next=15,this.startClassicGame();case 15:if("journey"!==c){e.next=18;break}return e.next=18,this.startJourneyGame();case 18:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.startClassicGame=function(){var e=(0,st.Z)(ut().mark((function e(){var t,n,i,a,r,s,o,c,u,l,h=this;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.scene.levelHandler,n=t.getConfigs(),a=(i=n).startingCards,r=i.piles,this.scene.events.emit(es.GAME_START),this.boardState=is.DEALING,this.deck.reset(),s=this.deck.getDeck(),e.next=9,eo(this.scene,300);case 9:this.scene.audio.playSound(Bt.SHUFFLE),o=0;case 11:if(!(o<a)){e.next=21;break}if(c=s.pop(),u=o%r,!c){e.next=18;break}return this.piles[u].addCard(c,!0),e.next=18,eo(this.scene,30);case 18:o++,e.next=11;break;case 21:return s.forEach((function(e){return h.stock.addCard(e,!1)})),e.next=24,eo(this.scene,100);case 24:for(l=0;l<r;l++)this.piles[l].faceUpLast();return e.next=27,eo(this.scene,400);case 27:this.boardState=is.IDLE,this.checkGameWin(),this.gameplay.scene.footer.hintBtn.setDisabled(!1),this.mover.enableInput();case 31:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.startJourneyGame=function(){var e=(0,st.Z)(ut().mark((function e(){var t,n,i,a,r,s,o,c,u,l,h,d,f,p,g,m,v,y,b;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.scene.levelHandler,n=t.getConfigs(),i=n.journeyData,a=i.pileData,r=i.stock,this.scene.events.emit(es.GAME_START),this.boardState=is.DEALING,this.deck.reset(),e.next=9,eo(this.scene,300);case 9:for(this.scene.audio.playSound(Bt.SHUFFLE),s=r.split(","),o=[],c=0;c<s.length;c++)u=s[c],(l=this.deck.createCardForJourneyMode(u))&&(this.stock.addCard(l,!1),l.setFacing(!1));h=M()(a),d=Math.max.apply(Math,z()(h).call(h,(function(e){return a[e].length}))),f=0;case 16:if(!(f<d)){e.next=37;break}p=0;case 18:if(!(p<h.length)){e.next=34;break}if(g=yt()(h[p].substring(4)),!((m=a[h[p]].split(",")).length-1<f)){e.next=23;break}return e.abrupt("continue",31);case 23:if(v=m[f],y="-"!==v[0],!(b=this.deck.createCardForJourneyMode(v))){e.next=31;break}return this.piles[g].addCard(b,!0),y&&o.push(b),e.next=31,eo(this.scene,30);case 31:p++,e.next=18;break;case 34:f++,e.next=16;break;case 37:return e.next=39,eo(this.scene,100);case 39:return o.forEach((function(e){return e.setFacingWithFlippingAnim(!0)})),this.piles.forEach((function(e){e.updateCardTintByAvailability(),e.resizePile()})),e.next=43,eo(this.scene,400);case 43:this.boardState=is.IDLE,this.checkGameWin(),this.gameplay.scene.footer.hintBtn.setDisabled(!1),this.mover.enableInput();case 47:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.continueGame=function(){var e=(0,st.Z)(ut().mark((function e(t){var n,i,a,r,s,o,c,u,l,h,d,f,p,g,m,v,y,b,S,T,E,C,A,w,I;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.scene.analytics.event(Vi._.LEVEL_CONTINUE),!this.isDealing()){e.next=3;break}return e.abrupt("return");case 3:return n=t.difficulty,i=t.suitSize,this.gameplay.suitSize=i,this.gameplay.difficulty=n,(a=this.scene.levelHandler.getLevelConfigLocalStorage())?(r=this.scene.player.getPlayerSettings(),s=r.relaxedSpider,o=r.suitSize,c=a.settings,u=c.relaxedSpider,l=c.suitSize,h="",o!==l&&(d=1,"two"===l?d=2:"four"===l&&(d=4),h+="\nSuit size: "+d),s!==u&&(h+="\nRelaxed Spider:"+(!0===u?"On":"Off")),""!==h&&this.scene.screen.open(As.o4.NOTIFICATION_SCREEN,{message:"Continue a game with old settings!\n"+h}),this.scene.levelHandler.setConfig(a)):(console.error("Continue Board found but init board not found"),this.scene.levelHandler.setConfig({suitSize:"one"})),this.clearOldBoard({isRelaxedSpider:(null==a?void 0:a.settings.relaxedSpider)||!0}),this.setUpBoard(!0),this.alignBoard(),f=this.scene.levelHandler.getConfigs(),GameCore.Utils.Valid.isDebugger()&&this.devTools.updateLevelInfo(f.suits.length.toString(),this.scene.gameplay.difficulty),this.boardState=is.DEALING,p=t.stock,g=t.piles,m=t.faceBackOfPiles,v=t.foundations,y=t.time,b=t.score,S=t.moves,T=t.movesData,E=t.replayCardStatus,this.deck.reset(),this.scene.levelHandler.replayCardStatus=E,e.next=19,eo(this.scene,300);case 19:return this.time=y,this.score=b,this.moves=S,this.scene.audio.playSound(Bt.SHUFFLE),e.next=25,this.stock.addCardsFromSaveData(p);case 25:C=0;case 26:if(!(C<v.length)){e.next=33;break}return A=v[C],e.next=30,this.foundations[C].addCardsFromSaveData(A);case 30:C++,e.next=26;break;case 33:w=0;case 34:if(!(w<g.length)){e.next=41;break}return I=g[w],e.next=38,this.piles[w].addCardsFromSaveData(I,m[w]);case 38:w++,e.next=34;break;case 41:return e.next=43,eo(this.scene,300);case 43:return this.piles.forEach((function(e){e.updateCardTintByAvailability(),e.resizePile()})),e.next=46,eo(this.scene,100);case 46:this.mover.undos=T,this.boardState=is.IDLE,this.gameplay.scene.footer.hintBtn.setDisabled(!1),this.checkGameWin(),this.mover.enableInput();case 51:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.checkAutoCompletePossible=function(){var e=[],t=[],n={canWin:!1,autoCompleteData:{kingPiles:null,nonKingPiles:null}};if(this.stock.cards.length>0)return n;for(var i=0;i<this.piles.length;i++){var a=this.piles[i],r=a.cards.length;if(0!=r){var s=a.cards[0],o=a.getTopCardStackData();if(o){if(o.length!==r)return n;s&&s.isKing()?e.push(a):t.push(a)}}else t.push(a)}return 0==e.length||(n.canWin=!0,n.autoCompleteData={kingPiles:e,nonKingPiles:t}),n},n.setAutoCompleteStatus=function(){if(!this.scene.player.getPlayerSettings().autoComplete)return this.canAutoComplete=!1,void this.autoCompleteBtn.kill();var e=this.checkAutoCompletePossible(),t=e.canWin,n=e.autoCompleteData;t?(this.canAutoComplete=!0,this.autoCompleteBtn.revive()):(this.canAutoComplete=!1,this.autoCompleteBtn.kill()),this.autoCompleteData=n},n.checkGameWin=function(){var e=this;this.isGameWon()?this.scene.time.delayedCall(1e3,(function(){e.handleGameWon()})):(this.isIdle()||this.isPlaying())&&this.setAutoCompleteStatus()},n.isGameWon=function(){var e;return!un()(e=this.foundations).call(e,(function(e){return!e.isFull()}))},n.outOfMove=function(){this.boardState=is.GAME_OVER,this.isAutoPlay=!1,this.gameplay.updateGameOverStats(!0),this.gameplay.handleGameOver(!1),this.gameplay.saveSystem.clearLastGame()},n.clearOldBoard=function(e){this.boardState=is.NONE,this.canAutoComplete=!1,this.isAutoPlay=!1,this.isRelaxedSpider=e.isRelaxedSpider,this.moves=0,this.time=0,this.mover.disableInput(),this.gameplay.scene.footer.hintBtn.setDisabled(!0),this.gameplay.boardGame.autoCompleteBtn.kill(),this.piles.forEach((function(e){return e.kill()})),this.foundations.forEach((function(e){return e.kill()})),this.stock.clear(),this.mover.clear(),this.hint.clear(),this.deck.killAllCards(),this.difficultyHandler.init(),this.piles=[],this.foundations=[],this.bestMoveFinder.resetAcceptedList()},n.handleGameWon=function(){this.autoCompleteBtn.kill(),this.gameplay.scene.footer.hintBtn.setDisabled(!0),this.boardState=is.GAME_OVER,this.scene.audio.playSound(Bt.WON),this.gameplay.saveSystem.clearLastGame(),this.scene.levelHandler.clearLevelConfigLocalStorage(),this.boardState=is.GAME_OVER,this.handleNewUserEasyGameCount(),this.handleTimeScoreBonus()},n.handleNewUserEasyGameCount=function(){var e=this.scene.player.getCustomData("newUserEasyGameCount");!GameCore.Utils.Valid.isNumber(e)||e<=0?this.scene.player.setMultiCustomData({newUserEasyGameCount:0}):this.scene.player.setMultiCustomData({newUserEasyGameCount:e-1})},n.handleTimeScoreBonus=function(){var e,t=this,n=Math.floor(7e5/this.time*1e3),i=this.time,a=this.score;null==(e=this.timeScoreBonusTween)||e.stop(),this.timeScoreBonusTween=this.scene.tweens.addCounter({from:0,to:1500,duration:1500,onUpdate:function(e){var r=e.getValue(),s=a+r/1500*n,o=i*(1500-r)/1500;t.time=Math.floor(o),t.score=Math.floor(s)},onComplete:function(){t.scene.time.delayedCall(300,(function(){t.gameplay.handleGameOver(!0)}))}}),this.gameplay.scene.gameStats.updateCurrentGameStats({score:a+n,playedTime:i,currentMoves:this.moves,usedUndo:this.mover.undoClicked>0}),this.gameplay.scene.gameStats.makeWin()},n.update=function(e){(this.isPlaying()||this.isAutoCompleting())&&(this.time+=e),this.isPlaying()&&(this.timeToSaveBoardData+=e,this.timeToSaveBoardData>2e3&&(this.gameplay.saveSystem.saveCurrentBoardData(),this.timeToSaveBoardData-=1e3)),this.stock.update(e),this.mover.update(),this.hint.update(e),this.mover.isPicked()&&this.hint.resetAutoHintTime(),this.scene.footer.undoBtn.setDisabled(0==this.mover.undos.length||this.isAutoCompleting()),this.scene.footer.playBtn.setDisabled(this.isDealing()||this.isAutoCompleting())},n.isDealing=function(){return this.boardState==is.DEALING},n.isPlaying=function(){return this.boardState==is.PLAYING},n.isAutoCompleting=function(){return this.boardState==is.AUTO_COMPLETING},n.isIdle=function(){return this.boardState==is.IDLE},n.isOutOfMove=function(){return this.boardState==is.OUT_OF_MOVE},n.isGameOver=function(){return this.boardState==is.GAME_OVER},n.isNone=function(){return this.boardState==is.NONE},n.createDevTools=function(){var e=new Lh(this.scene,this);this.scene.add.existing(e),Phaser.Display.Align.In.TopLeft(e,this.scene.gameZone,-70,-40),this.devTools=e,this.scene.world.isLandscape()||(this.devTools.setScale(.75),Phaser.Display.Align.In.TopLeft(this.devTools,this.scene.footer,-40,20)),this.devTools.setDepth(fc.Z.POPUP)},n.createMarketingContainer=function(){var e=new Wh(this.scene,this);this.scene.add.existing(e),Phaser.Display.Align.In.TopLeft(e,this.scene.gameZone,-70,-40),this.marketingButton=e,this.scene.world.isLandscape()||(this.marketingButton.setScale(.75),Phaser.Display.Align.In.TopLeft(this.marketingButton,this.scene.footer,-40,90)),this.marketingButton.setDepth(fc.Z.POPUP)},n.getVerticalSpacePile=function(){return Vs.VERTICAL_PILE_SPACE},n.generateBoardStateHash=function(){var e="";return this.piles.forEach((function(t){0===t.cards.length?e+="EP":t.cards.forEach((function(t){e+=t.getTag().toString()}))})),e+="-",this.foundations.forEach((function(t){0!==t.cards.length?e+="1":e+="0"})),e+="-",0===this.stock.cards.length?e+="ES":(this.stock.cards.forEach((function(t){e+=t.getTag().toString()})),e)},t}(Phaser.Events.EventEmitter)),jh=Kh,Xh=function(){function e(e){this.gameplay=void 0,this.gameplay=e}var t=e.prototype;return t.saveCurrentBoardData=function(){var e,t,n,i;if(as.instance.isSingleMode()){var a=this.gameplay,r=a.scene,s=a.boardGame,o=a.suitSize,c=a.difficulty,u=r.levelHandler.replayCardStatus,l=z()(e=s.stock.cards).call(e,(function(e){return e.getSavingData()})),h=z()(t=s.piles).call(t,(function(e){var t;return z()(t=e.cards).call(t,(function(e){return e.getSavingData()}))})),d=z()(n=s.piles).call(n,(function(e){var t;return Fs()(t=e.cards).call(t,(function(e){return e.isFacingUp()}))})),f=z()(i=s.foundations).call(i,(function(e){var t;return z()(t=e.cards).call(t,(function(e){return e.getSavingData()}))})),p=s.getTime(),g={stock:l,piles:h,faceBackOfPiles:d,foundations:f,score:s.getScore(),time:p,moves:s.getMoves(),suitSize:o,difficulty:c,movesData:s.mover.undos,updatedAt:(new Date).getTime(),replayCardStatus:u,settings:{relaxedSpider:s.getCurrentGameRelaxedSpiderSetting()}};rc("current-board",{boardData:g})}else this.clearLastGame()},t.clearLastGame=function(){sc("current-board")},t.getLastGameData=function(){var e=ac("current-board");if(!e)return null;if(!GameCore.Utils.Object.hasOwn(e,"boardData"))return null;var t=e.boardData;return this.isBoardDataValid(t)?t:null},t.isBoardDataValid=function(e){return!0},e}(),Jh=Xh,qh=Ds.Z.EFFECTS,Qh=qh.KEY,$h=qh.FRAME,ed=function(e){function t(t,n){var i;return(i=e.call(this,t,Qh,$h.BLANK)||this).config=void 0,i.emitter=void 0,i.config=n||{},i.scene.add.existing((0,Cs.Z)(i)),i}(0,ot.Z)(t,e);var n=t.prototype;return n.createEmitters=function(){var e=$h.FX_CONFETTI_SMALL_1,t=$h.FX_CONFETTI_SMALL_2,n=$h.FX_CONFETTI_SMALL_3,i=$h.FX_CONFETTI_SMALL_4,a=1/(0,Cr.t)(),r={on:!1,particleBringToTop:!0,frame:[e,t,n,i],tint:[14223402,1021804,5420529,16702052],timeScale:1,frequency:400,maxParticles:120,gravityY:-10,speedX:{min:-100,max:100},speedY:{min:80,max:250},alpha:{start:1,end:0,ease:Phaser.Math.Easing.Expo.In},rotate:{start:0,end:1080},scale:{min:.8*a,max:2*a},angle:{min:20,max:160},lifespan:{min:8e3,max:12e3}},s=(0,Fe.TS)(r,this.config);this.emitter=this.createEmitter(s)},n.run=function(e,t,n){this.stop(),this.emitter.setQuantity(e),this.emitter.setPosition(t,n),this.emitter.start()},n.explode=function(e,t,n){this.emitter||this.createEmitters(),this.emitter.explode(e,t,n)},n.stop=function(){var e,t,n;null==(e=this.emitter)||e.killAll(),null==(t=this.emitter)||t.stop(),null==(n=this.emitter)||n.remove(),this.createEmitters()},t}(Phaser.GameObjects.Particles.ParticleEmitterManager),td=ed,nd=GameCore.Configs.Ads.CompleteStackAdSeconds,id=function(){function e(e){this.scene=void 0,this.lastCompleteStackAdTime=void 0,this.isShowingAds=void 0,this.scene=e,this.lastCompleteStackAdTime=0,this.isShowingAds=!1}var t=e.prototype;return t.canShowCompleteStackAd=function(){var e=this.scene.game.ads.canbeShowInterstitialAd(),t=Date.now()-this.lastCompleteStackAdTime>1e3*nd;return e&&t&&!this.isShowingAds},t.handleShowAds=function(){var e=(0,st.Z)(ut().mark((function e(){var t,n;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.scene.audio,this.canShowCompleteStackAd()){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,this.isShowingAds=!0,this.lastCompleteStackAdTime=Date.now(),t.pauseMusic(),t.muteAll(),this.scene.scene.pause(),n="\nYou played very well!\n Take a break and watch\nthe upcoming ad\u2026",this.scene.world.isLandscape()&&(n="\nYou played very well!\n Take a break and watch the upcoming ad\u2026"),this.scene.game.globalScene.screen.open(As.o4.NOTIFY_SCREEN,{message:n,duration:0,loading:!0}),e.next=14,new(xe())((function(e){return setTimeout(e,1800)}));case 14:return e.next=16,this.scene.game.ads.showInterstitialAdAsync();case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(3),console.info("\ud83d\ude80 > showInterstitialAdAsync",e.t0);case 21:return e.prev=21,t.unmuteAll(),t.playMusic(),this.scene.scene.resume(),this.scene.game.ads.preloadInterstitialAdAsync().catch((function(){})),this.isShowingAds=!1,this.scene.game.globalScene.screen.close(As.o4.NOTIFY_SCREEN),e.finish(21);case 29:case"end":return e.stop()}}),e,this,[[3,18,21,29]])})));return function(){return e.apply(this,arguments)}}(),e}(),ad=id,rd=GameCore.Utils.Valid,sd=function(e){function t(t){var n;return(n=e.call(this)||this).scene=void 0,n.suitSize=void 0,n.difficulty=void 0,n.boardGame=void 0,n.saveSystem=void 0,n.confettiSmallFallDown=void 0,n.cardsLayer=void 0,n.completeStackAdHandler=void 0,n.scene=t,n.cardsLayer=t.add.layer(),n.cardsLayer.setDepth(Vs.DEPTH.CARD),n.boardGame=new jh((0,Cs.Z)(n)),n.saveSystem=new Jh((0,Cs.Z)(n)),n.completeStackAdHandler=new ad(t),n.createConfetti(),n}(0,ot.Z)(t,e);var n=t.prototype;return n.startNewGame=function(e,t){if(void 0===e&&(e=!1),void 0===t&&(t=!1),!this.boardGame.isDealing()){e||this.updateGameOverStats(e),this.scene.levelHandler.resetReplayCardStatus();var n=this.scene.player.getPlayerSettings(),i=n.suitSize,a=n.relaxedSpider,r=this.scene.levelHandler.getLevelConfigLocalStorage(),s=as.instance.getGameMode();if(this.isEasyGameForNewUserAvailable())return this.startGame({suitSize:i,difficulty:"dynamic"}),void this.scene.checkNewUser();t&&r&&s===ts.SINGLE&&s===r.settings.gameMode&&r.settings.suitSize===i&&r.settings.relaxedSpider===a?this.startGame(r):this.startGame({suitSize:i}),this.scene.checkNewUser()}},n.updateGameOverStats=function(e){if(!(this.boardGame.isGameWon()||this.boardGame.getMoves()<=0)){var t=this.scene.gameStats.getCurrentGameStats(),n=t.score,i=t.currentMoves,a=t.playedTime,r=t.suitSize,s=t.difficulty,o=this.boardGame.getStatistics(),c=o.score,u=o.time,l=o.moves;this.scene.gameStats.updateCurrentGameStats({score:c,playedTime:u,currentMoves:l,usedUndo:this.boardGame.mover.undoClicked>0}),this.scene.gameStats.makeLose(e);var h=this.scene.gameStats.getGameStats(r,s),d=h.winRate,f=h.totalGame;this.scene.analytics.event(Vi._.LEVEL_GIVE_UP,{score:n,moves:i,win_rate:d,suit_size:r,difficulty:s,total_game:f,time_played:a})}},n.startGame=function(e){if("replay"===e||"journey"===e);else if(GameCore.Utils.Object.hasOwn(e,"levelConfig")){var t=e;this.suitSize=t.settings.suitSize,this.difficulty=t.settings.difficulty}else if(e.suitSize&&GameCore.Utils.Object.hasOwn(e,"difficulty")){var n=e;this.suitSize=n.suitSize,this.difficulty=n.difficulty}else{var i=e;this.suitSize=i.suitSize,this.difficulty="easy"}console.log("> Raw start game. Suit size: "+this.suitSize+". Difficulty: "+this.difficulty),this.scene.gameStats.updateCurrentGameStats({suitSize:this.suitSize,difficulty:this.difficulty}),this.saveSystem.clearLastGame(),this.boardGame.startGame(e)},n.replayGame=function(e){void 0===e&&(e=!1),this.boardGame.isDealing()||(e||this.updateGameOverStats(e),this.saveSystem.clearLastGame(),this.boardGame.startGame("replay"))},n.getGameOverScreenKey=function(e){return as.instance.isChallengeMode()?As.o4.PLAY_WITH_FRIEND_GAME_OVER_SCREEN:as.instance.isTournamentMode()?As.o4.TOURNAMENTS_RESULT_SCREEN:e?As.o4.VICTORY_SCREEN:As.o4.NO_MORE_MOVES_SCREEN},n.handleGameOver=function(){var e=(0,st.Z)(ut().mark((function e(t){var n,i,a,r,s,o,c,u,l,h,d,f,p,g,m;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.handleShowInterstitialAd();case 2:if(null==(n=this.boardGame.updateScoreTimer)||n.remove(),i=this.scene.storage.getState(),!(a=du(i))){e.next=10;break}return e.next=8,Gl(a);case 8:r=e.sent,this.scene.storage.dispatch(uh(r));case 10:return s=this.scene.gameStats.getGameStats(this.suitSize,this.difficulty),o=s.wins,c=s.totalGame,u=this.scene.gameStats.getCurrentGameStats(),l=u.score,h=u.currentMoves,d=u.playedTime,f=u.suitSize,p=u.difficulty,g=u.usedUndo,this.scene.storage.dispatch(ph({score:l,level:o,moves:h,suit_size:f,difficulty:p,total_game:c,time_played:d,success:t})),e.next=15,this.scene.storage.dispatch(function(){var e=(0,st.Z)(ut().mark((function e(t,n){var i,a,r,s,o,c,u,l,h,d,f,p,g,m,v,y,b,S,T,E,C,A,w,I,P,k,x,_,O,D,B;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i=window.game,a=i.analytics,r=i.facebook,i.globalScene.screen.open(As.o4.NOTIFY_SCREEN,{message:"Loading...",loading:!0}),s=n(),o=Zu(s),c=Tu(s),u=c.level,l=void 0===u?0:u,h=c.score,d=void 0===h?0:h,f=c.moves,p=void 0===f?0:f,g=c.total_game,m=c.difficulty,v=c.time_played,y=c.success,b=c.suit_size,console.log(Tu(s)),t(Ah(d)),e.next=10,t(Ih(o,{score:d,level:l,time:v,moves:p}));case 10:if(t(al(d)),s=n(),a.event(Vi._.MATCH_END,{game_mode:GameCore.Utils.String.toUpperCamelCase(b),total_game:g,difficulty:m,level:l,level_name:"level_"+l,score:d,moves:p,time_played:v,success:y}),S=r.getContextID(),o===Xr&&S&&t(function(){var e=(0,st.Z)(ut().mark((function e(t,n){var i,a,r,s,o,c,u,l,h;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=window.game.analytics,e.prev=1,a=FBInstant.context.getID(),yl({contextId:a}),r=n(),s=bu(r),o=s.playerId,c=s.score,u=Tu(r),l=u.score,!o||o===Vr.playerId){e.next=25;break}if(!(l>c)){e.next=18;break}return e.next=13,_u(r);case 13:return h=e.sent,e.next=16,xl(h,r);case 16:e.next=23;break;case 18:return e.next=20,Iu(r);case 20:return h=e.sent,e.next=23,_l(h,r);case 23:e.next=30;break;case 25:return e.next=27,Iu(r);case 27:return h=e.sent,e.next=30,_l(h,r);case 30:Sl({imageShare:h}),i.event(Vi._.MESSAGE,{message_content_type:"InviteGroup",success:!0}),e.next=38;break;case 34:e.prev=34,e.t0=e.catch(1),i.event(Vi._.MESSAGE,{message_content_type:"InviteGroup",success:!0}),(0,at.tO)(e.t0);case 38:case"end":return e.stop()}}),e,null,[[1,34]])})));return function(t,n){return e.apply(this,arguments)}}()),!S||o!==jr){e.next=25;break}if(T=pu(s),(E=T.playerId)&&E!==Vr.playerId){e.next=19;break}return e.abrupt("return");case 19:C=Su(s),A=C[E]||{},w=A.score,I=void 0===w?0:w,P=hu(s),k=P._id,x=P.whitePlayerFinish,_=P.blackPlayerFinish,O=P.extraData,D=O.suitSize,B=O.difficulty,t(x&&_?d>I?Pl(E,{matchId:k,contextId:S,suitSize:D,difficulty:B}):Il(E,{matchId:k,contextId:S,suitSize:D,difficulty:B}):kl(E,{matchId:k,contextId:S,score:d,suitSize:D,difficulty:B}));case 25:e.next=30;break;case 27:e.prev=27,e.t0=e.catch(0),(0,at.tO)(e.t0);case 30:return e.prev=30,vh(200),e.finish(30);case 33:case"end":return e.stop()}}),e,null,[[0,27,30,33]])})));return function(t,n){return e.apply(this,arguments)}}());case 15:m=this.getGameOverScreenKey(t),this.scene.screen.open(m,{score:l,currentMoves:h,playedTime:d,suitSize:f,difficulty:p,usedUndo:g}),this.scene.analytics.event(Vi._.LEVEL_END,{total_game:c,suit_size:this.suitSize,difficulty:this.difficulty,level:o,score:l,moves:h,time_played:d,success:t});case 18:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.loadAndPlayGame=function(){var e=(0,st.Z)(ut().mark((function e(){var t,n,i,a,r,s,o,c,u;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.scene.storage.getState(),n=this.scene.player.getPlayerId(),mu(t,{playerId:n})){e.next=10;break}if(i=window.FBInstant.getEntryPointData(),!GameCore.Utils.Valid.isObject(i)){e.next=10;break}if(a=i.suitSize,r=i.difficulty,!rd.isString(a)||!rd.isString(r)){e.next=10;break}return this.startGame({suitSize:a,difficulty:r}),e.abrupt("return");case 10:if(!as.instance.isTournamentMode()){e.next=25;break}return e.prev=11,e.next=14,FBInstant.getTournamentAsync();case 14:if(s=e.sent,o=s.getPayload(),!((c=JSON.parse(o))&&c.suitSize&&c.difficulty)){e.next=20;break}return this.startGame({suitSize:c.suitSize,difficulty:c.difficulty}),e.abrupt("return");case 20:e.next=25;break;case 22:e.prev=22,e.t0=e.catch(11),console.error(e.t0);case 25:if(u=this.saveSystem.getLastGameData()){e.next=29;break}return this.startNewGame(!0,!0),e.abrupt("return");case 29:this.suitSize=u.suitSize,this.difficulty=u.difficulty,this.boardGame.continueGame(u);case 32:case"end":return e.stop()}}),e,this,[[11,22]])})));return function(){return e.apply(this,arguments)}}(),n.update=function(e){this.boardGame.update(e)},n.isEasyGameForNewUserAvailable=function(){var e=this.scene.player.getCustomData("newUserEasyGameCount");return console.log("currentEasyGameCount",e),!(!GameCore.Utils.Valid.isNumber(e)||e<=0)},n.handleShowInterstitialAd=function(){var e=(0,st.Z)(ut().mark((function e(){var t,n,i,a,r=this;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.scene,n=t.audio,t.ads.canbeShowInterstitialAd()){e.next=3;break}return e.abrupt("return");case 3:return i=null,e.prev=4,n.pauseMusic(),n.muteAll(),this.scene.scene.pause(),i=this.scene.game.globalScene.time.delayedCall(200,(function(){r.scene.game.globalScene.screen.open(As.o4.NOTIFY_SCREEN,{message:"Loading ads...",duration:0,loading:!0})})),e.next=11,this.scene.game.ads.showInterstitialAdAsync();case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(4),console.info("\ud83d\ude80 > showInterstitialAdAsync",e.t0);case 16:return e.prev=16,n.unmuteAll(),n.playMusic(),this.scene.scene.resume(),null==(a=i)||a.remove(),this.scene.game.ads.preloadInterstitialAdAsync().catch((function(){})),this.scene.game.globalScene.screen.close(As.o4.NOTIFY_SCREEN),e.finish(16);case 24:case"end":return e.stop()}}),e,this,[[4,13,16,24]])})));return function(){return e.apply(this,arguments)}}(),n.handleShowCompleteStackAd=function(){var e=(0,st.Z)(ut().mark((function e(){return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.completeStackAdHandler.handleShowAds();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.createConfetti=function(){var e,t,n=this.scene.gameZone.width,i=new Phaser.Geom.Rectangle(n/2-187.5,-100,375,50),a=z()(e=S()(t=Array(40)).call(t,0)).call(e,(function(e,t){var n;return"confetti/papers/"+Is()(n=GameCore.Utils.Number).call(n,t,4,"0")}));this.confettiSmallFallDown=new td(this.scene,{rotate:{start:-720,end:0},lifespan:{min:1500,max:2e3},emitZone:{source:i,type:"random"},particleBringToTop:!0,frame:a,tint:void 0}),this.confettiSmallFallDown.setDepth(fc.Z.ON_TOP)},t}(Phaser.Events.EventEmitter),od=sd,cd={FOOTER:12,TITLE:24,TAB_SELECTOR_LABEL:14,TOURNAMENT_BLOCK:{TITLE:20,JOIN_LABEL:16,LOW_TO_WIN:12}},ud=Ds.Z.GAMEPLAY_DEFAULT,ld=ud.KEY,hd=ud.FRAME,dd=-10,fd=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.settingsBtn=void 0,n.themeBtn=void 0,n.tournamentsButton=void 0,n.playBtn=void 0,n.hintBtn=void 0,n.undoBtn=void 0,n.scene=t,n.setSize(375,68),n.createBackground(),n.createButtons(),t.add.existing((0,Cs.Z)(n)),n}(0,ot.Z)(t,e);var n=t.prototype;return n.createBackground=function(){var e=this.scene.world.isLandscape()?0:40,t=this.scene.add.image(0,0,ld,hd.FOOTER_BG);t.setWorldSize(this.width+e,this.height),this.add(t)},n.createButtons=function(){this.createSettingsBtn(),this.createTournamentsButton(),this.createPlayBtn(),this.createHintBtn(),this.createUndoBtn(),this.alignButtons()},n.createSettingsBtn=function(){var e=this;this.settingsBtn=new Ho.Z(this.scene,40,40),this.settingsBtn.setName("Settings");var t=this.scene.add.image(0,dd,ld,hd.IC_SETTINGS).setTint(16579837);t.setWorldSize(28,28);var n=this.scene.add.image(0,14,ld,hd.FOOTER_TEXT.TEXT_SETTINGS);n.setWorldSize(50,16),this.settingsBtn.add([t,n]),this.settingsBtn.onClick=function(){e.scene.screen.open(As.o4.SETTINGS_SCREEN)}},n.createTournamentsButton=function(){var e=this;this.tournamentsButton=new Ho.Z(this.scene,40,40),this.tournamentsButton.setName("Tournaments");var t=this.scene.add.image(0,dd,ld,hd.CUP).setTint(16579837);t.setWorldSize(28,28);var n=this.scene.add.image(0,14,ld,hd.FOOTER_TEXT.TEXT_TOURNAMENTS);n.setWorldSize(76,16),this.tournamentsButton.add([t,n]),this.tournamentsButton.onClick=function(){e.scene.screen.open(As.o4.TOURNAMENTS_SCREEN)}},n.createPlayBtn=function(){var e=this;this.playBtn=new Ho.Z(this.scene,40,40),this.playBtn.setName("Play");var t=this.scene.add.image(0,dd,ld,hd.ADD_SQUARE).setTint(16579837);t.setWorldSize(28,28);var n=this.scene.add.image(0,14,ld,hd.FOOTER_TEXT.TEXT_GAME);n.setWorldSize(35,16),this.playBtn.add([t,n]),this.playBtn.onClick=function(){e.scene.screen.open(As.o4.PLAY_SCREEN)}},n.createHintBtn=function(){var e=this;this.hintBtn=new Ho.Z(this.scene,40,40),this.hintBtn.setName("Hint");var t=this.scene.add.image(0,dd,ld,hd.IC_HINT).setTint(16579837);t.setWorldSize(28,28);var n=this.scene.add.image(0,14,ld,hd.FOOTER_TEXT.TEXT_HINT);n.setWorldSize(25,16),this.hintBtn.add([t,n]),this.hintBtn.onClick=function(){e.scene.gameplay.boardGame.hint.showHint()},this.hintBtn.setDisabled(!0)},n.createUndoBtn=function(){var e=this;this.undoBtn=new Ho.Z(this.scene,40,40),this.undoBtn.setName("Undo");var t=this.scene.add.image(0,dd,ld,hd.IC_UNDO).setTint(16579837);t.setWorldSize(28,28);var n=this.scene.add.image(0,14,ld,hd.FOOTER_TEXT.TEXT_UNDO);n.setWorldSize(32,16),this.undoBtn.add([t,n]),this.undoBtn.onClick=function(){e.scene.gameplay.boardGame.mover.undo()}},n.createThemeBtn=function(){var e=this;this.themeBtn=new Ho.Z(this.scene,40,40),this.themeBtn.setName("Theme");var t=this.scene.add.image(0,dd,ld,hd.IC_THEME).setTint(16579837);t.setWorldSize(28,28);var n=this.scene.make.bitmapText({font:Go.Z.PRIMARY.KEY,size:this.scene.fontSize(cd.FOOTER),text:"Theme",origin:{x:.5,y:.5}}).setTint(13355979);this.themeBtn.add([t,n]),this.themeBtn.onClick=function(){e.scene.screen.open(As.o4.THEME_SCREEN)}},n.alignButtons=function(){var e=[this.settingsBtn,this.tournamentsButton,this.playBtn,this.hintBtn,this.undoBtn];this.add(e);for(var t=0;t<e.length;t++)e[t].setX(75*(t-e.length/2+.5)),e[t].setY(2)},t}(Phaser.GameObjects.Container),pd=fd,gd={targets:[],duration:600,ease:Phaser.Math.Easing.Linear,props:{angle:{from:0,to:360}}},md=function(e){function t(t){return e.call(this,gd,t)||this}return(0,ot.Z)(t,e),t}(uc.Z),vd=md,yd=Ds.Z.DEFAULT,bd=yd.KEY,Sd=yd.FRAME,Td=function(e){function t(t){var n;return(n=e.call(this,t,0,0,bd,Sd.PRELOADER)||this).anim=void 0,n.runAnimation(),n.setWorldSize(56.5,56.5),n.scene.add.existing((0,Cs.Z)(n)),n}(0,ot.Z)(t,e);var n=t.prototype;return n.runAnimation=function(){var e;null==(e=this.anim)||e.remove(),this.anim=new vd({targets:[this],repeat:-1,duration:1200}),this.anim.play()},n.setVisible=function(t){return e.prototype.setVisible.call(this,t),t?this.runAnimation():this.anim.stop(),this},t}(Phaser.GameObjects.Image),Ed=Td,Cd=function(e){function t(t,n){var i;(i=e.call(this,t)||this).payload=void 0,i.loading=void 0,i.photo=void 0,i.avtFrame=void 0,i.background=void 0,i.loadPhotoTimer=void 0,i.handleLoadPhotoAfterDelay=function(e,t){return function(){var n=i.scene.textures.get(e);n&&n.key===e?i.handleLoadComplete(e):(i.scene.load.once("filecomplete-image-"+e,i.handleLoadComplete),i.scene.load.image(e,t),i.scene.load.start())}},i.handleLoadComplete=function(e){if(i.scene){var t=i.payload,n=t.id,a=t.radius,r=void 0===a?0:a;if(n&&n===e){var s=n+"_bordered_"+r,o=r>0?s:n,c=i.scene.textures.get(o);if(c&&c.key===o)i.setPhoto(c.key);else if(0!=r&&r<100){if(!GameCore.Utils.Image.drawBorder({scene:i.scene,key:n,newKey:s,radius:r}))return void i.showLoading(!1);i.setPhoto(s)}else if(100==r){if(!GameCore.Utils.Image.drawCircle({scene:i.scene,key:n,newKey:s}))return void i.showLoading(!1);i.setPhoto(s)}else i.setPhoto(n)}}},i.handleLoadPhotoFailed=function(e){e.key===i.payload.id&&i.setDefaultAvatar(e.key)},i.scene.add.existing((0,Cs.Z)(i)),i.payload=n,i.setSize(n.width,n.height),i.createBackground(),i.createLoading(),i.createPhoto(),i.createFrame();var a=i.payload,r=a.id,s=a.url,o=a.radius;return r&&s&&i.loadPhoto(r,s,o),i.addDefaultListeners(),i}(0,ot.Z)(t,e);var n=t.prototype;return n.setFrame=function(e){this.avtFrame.setFrame(e),this.avtFrame.setVisible(!0)},n.setBackground=function(e){this.background.setFrame(e)},n.loadPhoto=function(e,t,n){var i;if(void 0===n&&(n=0),this.payload.id=e,this.payload.url=t,this.payload.radius=n,null==(i=this.loadPhotoTimer)||i.remove(),e&&t){var a=this.scene.textures.get(e);if(a&&a.key===e)this.handleLoadComplete(e);else{this.showLoading(!0);var r=this.payload.loadDelay||0;this.loadPhotoTimer=this.scene.time.delayedCall(r,this.handleLoadPhotoAfterDelay(e,t))}}else this.setPhoto(Yr.Z.AVATAR.KEY)},n.addDefaultListeners=function(){var e=this;this.scene.load.on(Phaser.Loader.Events.FILE_LOAD_ERROR,this.handleLoadPhotoFailed),this.on(Phaser.GameObjects.Events.DESTROY,(function(){var t;null==(t=e.loadPhotoTimer)||t.remove(),e.scene.load.off(Phaser.Loader.Events.FILE_LOAD_ERROR,e.handleLoadPhotoFailed)}))},n.setDefaultAvatar=function(e){this.loadPhoto(e,Yr.Z.AVATAR.FILE,this.payload.radius)},n.createBackground=function(){var e=this.payload,t=e.key,n=e.background;this.background=this.scene.make.image({key:t,frame:n}),this.background.setWorldSize(this.width,this.height),this.add(this.background)},n.createLoading=function(){this.loading=new Ed(this.scene),this.loading.setWorldSize(.75*this.width,.75*this.height),this.loading.setVisible(!1),this.add(this.loading)},n.createPhoto=function(){this.photo=this.scene.make.image({x:0,y:0,origin:{x:.5,y:.5},visible:!1}),this.add(this.photo)},n.createFrame=function(){var e=this.payload,t=e.key,n=e.frame,i=e.width,a=e.height;n?(this.avtFrame=this.scene.make.image({key:t,frame:n}),this.avtFrame.setWorldSize(i,a)):this.avtFrame=this.scene.make.image({x:0,y:0,origin:{x:.5,y:.5},visible:!1}),this.add(this.avtFrame)},n.showLoading=function(e){this.photo.setVisible(!e),this.loading.setVisible(e)},n.setPhoto=function(e){this.showLoading(!1),this.photo.setTexture(e),this.photo.setFrame(0);var t=this.payload,n=t.width,i=t.height,a=Math.min(n,i)-10;this.photo.setWorldSize(a,a),Phaser.Display.Align.In.Center(this.photo,this.background)},n.addBackground=function(){var e="avatar-background";if(!this.scene.textures.exists(e)){var t=this.width,n=this.height,i=this.scene.add.graphics();i.fillStyle(65280,.2),i.fillRect(0,0,t,n),i.generateTexture(e,t,n),i.destroy()}var a=this.scene.add.image(0,0,e);this.add(a)},t}(Phaser.GameObjects.Container),Ad=Cd,wd=Ds.Z.GAMEPLAY_DEFAULT.KEY,Id="...",Pd=function(e){function t(t){var n;(n=e.call(this,t)||this).scene=void 0,n.avatar=void 0,n.scoreText=void 0,n.scoreIcon=void 0,n.scoreAnim=void 0,n.hasAnimPlayed=void 0,n.timeText=void 0,n.moveText=void 0,n.scene=t;var i=124;return n.scene.world.isLandscape()&&(i=150),n.setSize(i,40),n.createBackground(),n.createAvatar(),n.createIcon(),n.createText(),n.timeText.kill(),n.moveText.kill(),n}(0,ot.Z)(t,e);var n=t.prototype;return n.alignLeft=function(){Phaser.Display.Align.In.LeftCenter(this.avatar,this),Phaser.Display.Align.In.RightCenter(this.scoreIcon,this.avatar,20),Phaser.Display.Align.In.Center(this.scoreText,this,24)},n.alignRight=function(){Phaser.Display.Align.In.RightCenter(this.avatar,this),Phaser.Display.Align.In.LeftCenter(this.scoreIcon,this.avatar,20),Phaser.Display.Align.In.Center(this.scoreText,this,-24)},n.createBackground=function(){var e=new Jo(this.scene,{key:"challenge-info-block",radius:0,border:20,width:this.width,height:this.height,y:-200});this.add(e)},n.createAvatar=function(){this.avatar=new Ad(this.scene,{width:42,height:42,key:wd,background:"blank"}),this.avatar.background.kill(),this.avatar.loadPhoto("avatar",Yr.Z.AVATAR.FILE,100),this.avatar.setPosition(-38,0),this.add(this.avatar)},n.createIcon=function(){var e=this.scene.add.image(-6,0,wd,"medal-star");e.setWorldSize(20,20),this.add([e]),this.scoreIcon=e},n.createText=function(){var e=this.scene.make.bitmapText({font:Go.Z.PRIMARY.KEY,size:this.scene.fontSize(14),text:"9999999",origin:{x:.5,y:.5}});e.setCenterAlign(),this.add(e);var t=this.scene.make.bitmapText({font:Go.Z.PRIMARY.KEY,size:this.scene.fontSize(14),text:"00:00",origin:{x:.5,y:.5},y:0,x:6});e.setCenterAlign(),this.add(t);var n=this.scene.make.bitmapText({font:Go.Z.PRIMARY.KEY,size:this.scene.fontSize(14),text:"0",origin:{x:0,y:.5},y:18,x:6});this.add(n),this.scoreText=e,this.timeText=t,this.moveText=n},n.updateData=function(e,t,n){this.scoreAnim&&(this.scoreAnim.remove(),this.scoreAnim=null,this.hasAnimPlayed=!1),this.scoreText.setText(""+(null!=e?e:Id)),this.timeText.setText(t?(0,Rn.F0)(t,!1):Id),this.moveText.setText(""+(null!=n?n:Id))},n.runScoreAnimation=function(e,t){var n=this;this.hasAnimPlayed||(this.hasAnimPlayed=!0,this.scoreAnim=this.scene.tweens.addCounter({from:e,to:t,duration:2e3,ease:Phaser.Math.Easing.Expo.InOut,onUpdate:function(e){var t=Math.floor(e.getValue());n.scoreText.setText(""+t)}}))},t}(Phaser.GameObjects.Container),kd=Pd,xd=16762624,_d=120,Od=function(e){function t(t){var n;(n=e.call(this,t)||this).scene=void 0,n.leftBlock=void 0,n.rightBlock=void 0,n.scene=t;var i=n.scene.world.getWorldSize().width;return n.scene.world.isLandscape()&&(i=710),n.setSize(i,62),n.createBlocks(),n.createVSText(),n}(0,ot.Z)(t,e);var n=t.prototype;return n.createBlocks=function(){this.leftBlock=new kd(this.scene),this.leftBlock.alignRight(),this.rightBlock=new kd(this.scene),this.rightBlock.alignLeft(),this.leftBlock.setX(-120),this.leftBlock.setY(-3),this.rightBlock.setX(_d),this.rightBlock.setY(-3),this.add([this.leftBlock,this.rightBlock])},n.createVSText=function(){var e=this.scene.make.bitmapText({font:Go.Z.BOLD.KEY,size:this.scene.fontSize(18),text:"VS",origin:{x:.5,y:.5}});e.setTint(11632207),this.add(e),e.setTint(11222016,xd,xd,xd),Phaser.Display.Align.In.Center(e,this)},n.alignChildren=function(){GameCore.Utils.Device.isMobile(),this.leftBlock.setX(-120),this.rightBlock.setX(_d)},t}(Phaser.GameObjects.Container),Dd=Od,Bd=function(e){function t(t){var n;return(n=e.call(this,t)||this).label=void 0,n.text=void 0,n.createLabel(),n.createText(),n.setTintComponents(),n.alignComponents(),n}(0,ot.Z)(t,e);var n=t.prototype;return n.createLabel=function(){this.label=this.scene.make.bitmapText({font:Go.Z.BOLD.KEY,size:this.scene.fontSize(16),text:"Label",origin:{x:.5,y:.5}}),this.add(this.label)},n.createText=function(){this.text=this.scene.make.bitmapText({font:Go.Z.BOLD.KEY,size:this.scene.fontSize(16),text:"99999999999",origin:{x:0,y:.5}}),this.add(this.text)},n.setTintComponents=function(){this.label.setTint(15527148),this.text.setTint(15527148)},n.alignComponents=function(){Phaser.Display.Align.In.LeftCenter(this.label,this),Phaser.Display.Align.To.RightCenter(this.text,this.label,7)},t}(Phaser.GameObjects.Container),Ld=Bd,Rd=function(e){function t(t){var n;return(n=e.call(this,t)||this).label.setText("Moves"),n.text.setOrigin(1,.5),Phaser.Display.Align.In.RightCenter(n.text,(0,Cs.Z)(n),0),Phaser.Display.Align.To.LeftCenter(n.label,n.text,7),n.scene.events.on(Phaser.Scenes.Events.UPDATE,(function(){n.label.setX(-35-9*n.text.text.length)})),n}return(0,ot.Z)(t,e),t}(Ld),Gd=function(e){function t(t){var n;return(n=e.call(this,t)||this).label.setText("Score"),n}return(0,ot.Z)(t,e),t}(Ld),Nd=function(e){function t(t){var n;return(n=e.call(this,t)||this).label.kill(),n.text.setOrigin(.5,.5),Phaser.Display.Align.In.Center(n.text,(0,Cs.Z)(n)),n}(0,ot.Z)(t,e);var n=t.prototype;return n.alignComponents=function(){Phaser.Display.Align.In.Center(this.text,this)},n.createText=function(){e.prototype.createText.call(this),this.text.setText("00:00")},t}(Ld),Md=function(e){function t(t){var n;(n=e.call(this,t)||this).scene=void 0,n.movesBlock=void 0,n.timeBlock=void 0,n.scoreBlock=void 0,n.scene=t;var i=n.scene.world.getWorldSize().width;return n.scene.world.isLandscape()&&(i=710),n.setSize(i,62),n.createContent(),n}(0,ot.Z)(t,e);var n=t.prototype;return n.createContent=function(){this.createScore(),this.createTime(),this.createMoves()},n.createMoves=function(){this.movesBlock=new Rd(this.scene),this.add(this.movesBlock)},n.createTime=function(){this.timeBlock=new Nd(this.scene),this.add(this.timeBlock)},n.createScore=function(){this.scoreBlock=new Gd(this.scene),this.add(this.scoreBlock)},n.alignChildren=function(){var e=this.scene.world.isLandscape()?-19:-8;Phaser.Display.Align.In.LeftCenter(this.scoreBlock,this,e),Phaser.Display.Align.In.RightCenter(this.movesBlock,this,e)},t}(Phaser.GameObjects.Container),Fd=Md,Ud=function(e){function t(t){var n;(n=e.call(this,t)||this).scene=void 0,n.movesBlock=void 0,n.timeBlock=void 0,n.scoreBlock=void 0,n.scene=t;var i=n.scene.world.getWorldSize().width;return n.scene.world.isLandscape()&&(i=710),n.setSize(i,54),n.createContent(),n}(0,ot.Z)(t,e);var n=t.prototype;return n.createContent=function(){this.createScore(),this.createTime(),this.createMoves()},n.createMoves=function(){this.movesBlock=new Rd(this.scene),this.add(this.movesBlock)},n.createTime=function(){this.timeBlock=new Nd(this.scene),this.add(this.timeBlock)},n.createScore=function(){this.scoreBlock=new Gd(this.scene),this.add(this.scoreBlock)},n.alignChildren=function(){var e=this.scene.world.isLandscape()?-19:-8;Phaser.Display.Align.In.LeftCenter(this.scoreBlock,this,e,-26),Phaser.Display.Align.In.RightCenter(this.movesBlock,this,e,-26)},t}(Phaser.GameObjects.Container),Zd=Ud,Hd=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n._tournamentTitle=void 0,n.scene=t,n.setSize(375,62),n.createContent(),n}(0,ot.Z)(t,e);var n=t.prototype;return n.createContent=function(){this.createTitle()},n.createTitle=function(){this._tournamentTitle=this.scene.make.bitmapText({font:Go.Z.PRIMARY.KEY,size:this.scene.fontSize(18),text:"Tournament",origin:{x:.5,y:.5},y:-15}),this.add(this._tournamentTitle),Phaser.Display.Align.In.BottomCenter(this._tournamentTitle,this)},(0,Wt.Z)(t,[{key:"tournamentTitle",get:function(){return this._tournamentTitle}}]),t}(Phaser.GameObjects.Container),Wd=Hd,zd=function(e){function t(t){var n;(n=e.call(this,t)||this).scene=void 0,n._statBlock=void 0,n._titleBlock=void 0,n.scene=t,n.createContent();var i=n.scene.world.getWorldSize().width;return n.scene.world.isLandscape()&&(i=710),n.setSize(i,n._titleBlock.height+n._statBlock.height),n.alignChildren(),n}(0,ot.Z)(t,e);var n=t.prototype;return n.createContent=function(){this.createTitle(),this.createStat()},n.createTitle=function(){this._titleBlock=new Wd(this.scene),this.add(this._titleBlock)},n.createStat=function(){this._statBlock=new Zd(this.scene),this.add(this._statBlock)},n.alignChildren=function(){Phaser.Display.Align.In.TopCenter(this._titleBlock,this),Phaser.Display.Align.In.BottomCenter(this._statBlock,this,0,-5)},(0,Wt.Z)(t,[{key:"statBlock",get:function(){return this._statBlock}},{key:"titleBlock",get:function(){return this._titleBlock}}]),t}(Phaser.GameObjects.Container),Yd=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.singleInfo=void 0,n.challengeInfo=void 0,n.tournamentInfo=void 0,n.scene=t,n.setSize(375,62),t.add.existing((0,Cs.Z)(n)),n.createSingleInfo(),n.createChallengeInfo(),n.createTournamentInfo(),n}(0,ot.Z)(t,e);var n=t.prototype;return n.getInfoContainersWithout=function(e){var t;return u()(t=[this.singleInfo,this.challengeInfo,this.tournamentInfo]).call(t,(function(t){return t!==e}))},n.useChallengeInfo=function(){var e=this,t=[this.tournamentInfo];this.challengeInfo.revive(),this.singleInfo.revive(),this.scene.tweens.add({targets:this.challengeInfo,y:{from:-200,to:0},duration:500,ease:Phaser.Math.Easing.Sine.Out,onStart:function(){var t=e.scene.world.isLandscape()?110:75;Ys(t),e.scene.gameplay.boardGame.alignBoard()}}),this.scene.tweens.add({targets:this.singleInfo,y:{from:-200,to:35},duration:500,ease:Phaser.Math.Easing.Sine.Out}),this.scene.tweens.add({targets:t,y:{from:0,to:-200},duration:500,ease:Phaser.Math.Easing.Sine.In,onComplete:function(){return z()(t).call(t,(function(e){return e.kill()}))}})},n.useSingleInfo=function(){var e=this,t=this.getInfoContainersWithout(this.singleInfo);z()(t).call(t,(function(e){return e.kill()})),this.singleInfo.revive(),this.scene.tweens.add({targets:this.singleInfo,y:{from:-200,to:0},duration:500,ease:Phaser.Math.Easing.Sine.Out,onStart:function(){var t=e.scene.world.isLandscape()?70:40;Ys(t),e.scene.gameplay.boardGame.alignBoard()}}),this.scene.tweens.add({targets:t,y:{from:0,to:-200},duration:500,ease:Phaser.Math.Easing.Sine.In,onComplete:function(){return z()(t).call(t,(function(e){return e.kill()}))}})},n.useTournamentInfo=function(){var e=this,t=this.getInfoContainersWithout(this.tournamentInfo);this.tournamentInfo.revive(),this.scene.tweens.add({targets:this.tournamentInfo,y:{from:-200,to:0},duration:500,ease:Phaser.Math.Easing.Sine.Out,onStart:function(){var t=e.scene.world.isLandscape()?90:75;Ys(t),e.scene.gameplay.boardGame.alignBoard()}}),this.scene.tweens.add({targets:t,y:{from:0,to:-200},duration:500,ease:Phaser.Math.Easing.Sine.In,onComplete:function(){return z()(t).call(t,(function(e){return e.kill()}))}})},n.createChallengeInfo=function(){var e=new Dd(this.scene);this.challengeInfo=e,this.add(e),this.challengeInfo.kill()},n.createSingleInfo=function(){var e=new Fd(this.scene);this.singleInfo=e,this.add(e)},n.createTournamentInfo=function(){var e=new zd(this.scene);this.tournamentInfo=e,this.add(e),this.tournamentInfo.kill()},n.update=function(){var e=this.scene.gameplay.boardGame,t=e.getScore(),n=e.getTime(),i=e.getMoves(),a=this.singleInfo,r=a.scoreBlock,s=a.timeBlock,o=a.movesBlock;switch(r.text.setText(""+t),s.text.setText((0,Rn.F0)(n,!1)),o.text.setText(""+i),as.instance.getGameMode()){case ts.CHALLENGE_FRIENDS:var c=this.challengeInfo.leftBlock;this.scene.gameplay.boardGame.getMoves()>0?c.scoreText.setText(""+t):c.runScoreAnimation(0,t),c.timeText.setText((0,Rn.F0)(n,!1)),c.moveText.setText(""+i);break;case ts.TOURNAMENT:var u=this.tournamentInfo.statBlock,l=u.movesBlock,h=u.timeBlock;u.scoreBlock.text.setText(""+t),h.text.setText((0,Rn.F0)(n,!1)),l.text.setText(""+i)}},n.alignChildren=function(){this.singleInfo.alignChildren(),this.challengeInfo.alignChildren(),this.tournamentInfo.statBlock.alignChildren()},t}(Phaser.GameObjects.Container),Vd=Yd,Kd=n(548),jd={targets:[],duration:600,ease:Phaser.Math.Easing.Back.Out,props:{y:{from:500,to:0}}},Xd=function(e){function t(t){return e.call(this,jd,t)||this}return(0,ot.Z)(t,e),t}(uc.Z),Jd=Xd,qd=n(549),Qd=n(25),$d=n(554),ef=function(e){function t(t){var n;return(n=e.call(this,t)||this).bg=void 0,n.createBackground(),n.createContent(),t.add.existing((0,Cs.Z)(n)),n}(0,ot.Z)(t,e);var n=t.prototype;return n.createBackground=function(){this.setSize(360,120);var e=new Qd.Z(this.scene,0,0,360,180,16,16119285);e.setAlpha(.85),this.add(e),this.bg=e},n.createContent=function(){this.createChallengeButton(),this.createNewDealButton(),this.createReplayButton(),this.createCloseButton();var e=this.scene.add.line(0,-30,0,0,this.width,0,3947587);e.setLineWidth(.5),e.setAlpha(.36);var t=this.scene.add.line(0,30,0,0,this.width,0,3947587);t.setLineWidth(.5),t.setAlpha(.36),this.add(e),this.add(t)},n.createChallengeButton=function(){var e=this,t=new Ho.Z(this.scene,360,60);t.setName("ChallengeFriend"),t.onClick=(0,st.Z)(ut().mark((function t(){return ut().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.scene.screen.close(As.o4.PLAY_SCREEN),!(e.scene instanceof Mb)){t.next=4;break}return t.next=4,e.scene.handlePlayWithFriend();case 4:case"end":return t.stop()}}),t)})));var n=this.scene.make.bitmapText({font:Go.Z.PRIMARY.KEY,size:this.scene.fontSize(18),text:"Play With Friends",origin:{x:.5,y:.5}});n.setTint(31487),t.add([n]),Phaser.Display.Align.In.TopCenter(t,this.bg,0),this.add([t])},n.createNewDealButton=function(){var e=this,t=new Ho.Z(this.scene,360,60);t.setName("NewDeal"),t.onClick=(0,st.Z)(ut().mark((function t(){return ut().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.scene.screen.close(As.o4.PLAY_SCREEN),!(e.scene instanceof Mb)){t.next=4;break}return t.next=4,e.scene.handlePlaySingle();case 4:case"end":return t.stop()}}),t)})));var n=this.scene.make.bitmapText({font:Go.Z.PRIMARY.KEY,size:this.scene.fontSize(18),text:"New Deal",origin:{x:.5,y:.5}});n.setTint(31487),t.add([n]),Phaser.Display.Align.In.Center(t,this.bg,0),this.add([t])},n.createReplayButton=function(){var e=this,t=new Ho.Z(this.scene,360,60);t.setName("Replay"),t.onClick=function(){e.scene instanceof Mb&&e.scene.gameplay.replayGame(),e.scene.screen.close(As.o4.PLAY_SCREEN)};var n=this.scene.make.bitmapText({font:Go.Z.PRIMARY.KEY,size:this.scene.fontSize(18),text:"Replay",origin:{x:.5,y:.5}});n.setTint(31487),t.add([n]),Phaser.Display.Align.In.BottomCenter(t,this.bg,0),this.add([t])},n.createCloseButton=function(){var e=this,t=new $d.Z(this.scene,360,60,16,16579837);t.setName("NewDeal"),t.onClick=function(){e.scene.screen.close(As.o4.PLAY_SCREEN)};var n=this.scene.make.bitmapText({font:Go.Z.BOLD.KEY,size:this.scene.fontSize(18),text:"Cancel",origin:{x:.5,y:.5}});n.setTint(31487),t.add([n]),Phaser.Display.Align.In.TopCenter(t,this.bg,0,3),Phaser.Display.Align.To.BottomCenter(t,this.bg,0,8),this.add([t])},t}(Phaser.GameObjects.Container),tf=ef,nf=function(e){function t(t,n,i,a){var r;return(r=e.call(this,t,n,i,a)||this).slideInAnimation=void 0,r.fadeInAnimation=void 0,r.fadeOutAnimation=void 0,r.playContainer=void 0,r.setDepth(As.Ks.POPUP),r.playContainer=new tf(t),r.add(r.playContainer),r}(0,ot.Z)(t,e);var n=t.prototype;return n.open=function(){var t=this;e.prototype.open.call(this),this.playContainer.setAlpha(1),this.background.setAlpha(.8),this.playContainer.setInteractive(),this.background.setInteractive().once(Phaser.Input.Events.POINTER_DOWN,(function(){return t.scene.screen.close(As.o4.PLAY_SCREEN)})),this.runOpenAnimation()},n.close=function(){this.runCloseAnimation()},n.runOpenAnimation=function(){var e,t;if(null==(e=this.slideInAnimation)||null==(t=e.tween)||!t.isPlaying()){this.scene.audio.playSound(Bt.POPUP_SHOW);var n=this.scene.game.world.isLandscape()?33:13,i=this.scene.ads.getBannerHeight(),a=this.scene.gameZone.height;this.slideInAnimation||(this.slideInAnimation=new Jd({targets:[this.playContainer],props:{y:{from:a/2,to:a/2-160-i-n,ease:Phaser.Math.Easing.Back.Out}},duration:300})),this.fadeInAnimation||(this.fadeInAnimation=new Kd.Z({targets:[this],duration:300})),this.slideInAnimation.play(),this.fadeInAnimation.play()}},n.runCloseAnimation=function(){var t,n,i=this;null!=(t=this.fadeOutAnimation)&&null!=(n=t.tween)&&n.isPlaying()||(this.scene.audio.playSound(Bt.POPUP_OFF),this.fadeOutAnimation||(this.fadeOutAnimation=new qd.Z({targets:[this],props:{alpha:0},duration:300,onComplete:function(){e.prototype.close.call(i)}})),this.fadeOutAnimation.play())},t}(GameCore.Screen),af=nf,rf=Ds.Z.GAMEPLAY_DEFAULT.KEY,sf=function(e){function t(t,n){var i;return(i=e.call(this,t,60,50)||this).options=void 0,i.button=void 0,i.getBackgroundByStatus=function(){var e=i.options,t=e.enable,n=e.backgroundOn,a=e.backgroundOff;return t?n:a},i.createButton=function(e){var t=i.getBackgroundByStatus();i.button=i.scene.add.image(0,0,e,t),i.add(i.button)},i.button=t.add.image(0,0,rf,"ic_switch_off"),i.button.setWorldSize(40,25),i.add(i.button),i.options={enable:n,backgroundOn:"ic_switch_on",backgroundOff:"ic_switch_off"},i.updateStatus(n),i}(0,ot.Z)(t,e);var n=t.prototype;return n.processCallback=function(e){var t=this.options.enable;this.updateStatus(!t),e(!t)},n.updateStatus=function(e){this.options.enable=e;var t=this.getBackgroundByStatus();this.button.setFrame(t)},n.logButtonEvent=function(){var e=this.getParentName(),t=this.name,n=!this.options.enable;this.scene.analytics.event(Vi._.BUTTON_CLICK,{button_name:t,screen_name:e,enable:n})},t}(Ho.Z),of=sf,cf=function(e){if("string"!==typeof e||!e)throw new Vc(null,{imageShare:e})},uf=Ds.Z.GAMEPLAY_DEFAULT,lf=uf.KEY,hf=uf.FRAME,df=function(e){function t(t,n,i){var a;return(a=e.call(this,t,60,50)||this).options=void 0,a.buttons=void 0,a.callback=void 0,a.createButton=function(e,t){var n=new Ho.Z(a.scene,40,40),i=a.scene.add.image(0,0,lf,hf.IC_SQUARE_OFF);i.setName("bg"),i.setWorldSize(32,32);var r=a.scene.make.bitmapText({font:Go.Z.BOLD.KEY,size:a.scene.fontSize(16),text:t,origin:{x:.5,y:.5}});return a.add(n),n.add([i,r]),Phaser.Display.Align.In.Center(r,i),Phaser.Display.Align.In.Center(i,n),n.x=40*e,n},a.handleSelectOption=function(e){return function(){a.options.checked=e,a.updateSelectedOption(),a.callback&&a.callback(e)}},a.options={checked:n,options:i},a.buttons={},a.createButtons(),a.updateSelectedOption(),a.scene.add.existing((0,Cs.Z)(a)),a}(0,ot.Z)(t,e);var n=t.prototype;return n.createButtons=function(){var e=this;this.options.options.forEach((function(t,n){var i=e.createButton(n,t);e.buttons[t]=i,i.onClick=e.handleSelectOption(t)}))},n.updateStatus=function(e){this.options.checked=e,this.updateSelectedOption()},n.updateSelectedOption=function(){var e=this,t=this.options,n=t.options,i=t.checked;n.forEach((function(t){e.buttons[t].getByName("bg").setFrame(hf.IC_SQUARE_OFF)})),this.buttons[i].getByName("bg").setFrame(hf.IC_SQUARE_ON)},(0,Wt.Z)(t,[{key:"onClick",set:function(e){this.callback=e}}]),t}(Phaser.GameObjects.Container),ff=df,pf=Ds.Z.GAMEPLAY_DEFAULT,gf=pf.KEY,mf=pf.FRAME,vf=function(e){function t(t){var n;return(n=e.call(this,t)||this).bg=void 0,n.relaxedSpiderBtn=void 0,n.suitSizeCheckBoxBtn=void 0,n.createBackground(),n.createContent(),n.createCloseButton(),t.add.existing((0,Cs.Z)(n)),n}(0,ot.Z)(t,e);var n=t.prototype;return n.createBackground=function(){var e=new Qd.Z(this.scene,0,0,340,562,20,16579837);this.add(e),this.bg=e,this.setSize(e.width,e.height)},n.createContent=function(){var e=this.scene.make.bitmapText({font:Go.Z.BOLD.KEY,size:this.scene.fontSize(20),text:"Settings",origin:{x:.5,y:.5}});e.setTint(1907997),this.add(e),Phaser.Display.Align.In.TopCenter(e,this,0,-16);var t=this.scene.player.getPlayerSettings(),n=t.sound,i=void 0===n||n,a=t.tapToMove,r=void 0===a||a,s=t.autoHints,o=void 0===s||s,c=t.autoComplete,u=void 0===c||c,l=t.relaxedSpider,h=void 0===l||l,d=t.suitSize,f=void 0===d?"one":d,p="1";"one"===f?p="1":"two"===f?p="2":"four"===f&&(p="4");var g=[this.createInviteButton(),this.createThemeButton(),this.createStatisticsButton(),this.createCheckboxButton("suitSize","Suit Size",p,["1","2","4"],mf.IC_SUIT_SIZE),this.createToggleButton("sound","Sound Effects",i,mf.IC_SOUND),this.createToggleButton("tapToMove","Tap To Move",r,mf.IC_MOVE),this.createToggleButton("autoHints","Auto Hints",o,mf.IC_AUTO_HINT),this.createToggleButton("autoComplete","Auto Complete",u,mf.IC_AUTO_COMPLETE),this.createToggleButton("relaxedSpider","Relaxed Spider",h,mf.IC_RELAX),this.createHowToPlayButton()],m=e.y+55,v=this.scene.add.line(0,+m-27,0,0,340,0,3774208,1);v.setLineWidth(.6),this.add(v);for(var y=0;y<g.length;y++)if(g[y].setY(50*y+m),y<g.length-1){var b=this.scene.add.line(0,50*y+m+25,0,0,300,0,1907997,.2);b.setLineWidth(.4),this.add(b)}this.add(g)},n.createToggleButton=function(e,t,n,i){var a=this,r=this.scene.add.container(0,0);r.setSize(340,50);var s=new of(this.scene,n);s.setName(e),s.onClick=function(t){a.scene.player.setSetting(e,t),a.scene.events.emit("settings-changed",e,t),"sound"==e?a.handleSoundChanged(t):"relaxedSpider"===e&&a.scene.screen.open(As.o4.NOTIFICATION_SCREEN,{message:"New settings will take effect\nin the next deal!"})},"relaxedSpider"===e&&(this.relaxedSpiderBtn=s);var o=this.scene.make.bitmapText({font:Go.Z.BOLD.KEY,size:this.scene.fontSize(16),text:t,origin:{x:.5,y:.5}}),c=this.scene.add.image(0,0,gf,i);return c.setWorldSize(24,24),o.setTint(1907997),r.add([s,o,c]),Phaser.Display.Align.In.LeftCenter(c,r,-20,0),Phaser.Display.Align.In.LeftCenter(o,r,-50,0),Phaser.Display.Align.In.RightCenter(s,r,-10,0),r},n.createCheckboxButton=function(e,t,n,i,a){var r=this,s=this.scene.add.container(0,0);s.setSize(340,50);var o=new ff(this.scene,n,i);o.setName(e),o.onClick=function(t){var n;"suitSize"==e&&("1"==t?n="one":"2"==t?n="two":"4"==t&&(n="four"),r.scene.player.setSetting(e,n),r.scene.screen.open(As.o4.NOTIFICATION_SCREEN,{message:"New settings will take effect\nin the next deal!"}))},this.suitSizeCheckBoxBtn=o;var c=this.scene.make.bitmapText({font:Go.Z.BOLD.KEY,size:this.scene.fontSize(16),text:t,origin:{x:.5,y:.5}}),u=this.scene.add.image(0,0,gf,a);return u.setWorldSize(24,24),c.setTint(1907997),s.add([o,c,u]),Phaser.Display.Align.In.LeftCenter(u,s,-20,0),Phaser.Display.Align.In.LeftCenter(c,s,-50,0),Phaser.Display.Align.In.RightCenter(o,s,-115,0),s},n.createThemeButton=function(){var e=this,t=new Ho.Z(this.scene,300,50);t.setName("Theme"),t.onClick=function(){e.scene.screen.close(As.o4.SETTINGS_SCREEN),e.scene.screen.open(As.o4.THEME_SCREEN)};var n=this.scene.make.bitmapText({font:Go.Z.BOLD.KEY,size:this.scene.fontSize(16),text:"Theme",origin:{x:.5,y:.5}});n.setTint(1907997);var i=this.scene.add.image(0,0,gf,"ic_theme");i.setWorldSize(24,24);var a=this.scene.add.image(0,0,gf,mf.IC_NEXT);return a.setWorldSize(16,16),Phaser.Display.Align.In.LeftCenter(n,t,-30),Phaser.Display.Align.In.RightCenter(a,t),Phaser.Display.Align.In.LeftCenter(i,t),t.add([n,i,a]),t},n.createHowToPlayButton=function(){var e=this,t=new Ho.Z(this.scene,300,50);t.setName("HowToPlay"),t.onClick=function(){e.scene.screen.close(As.o4.SETTINGS_SCREEN),e.scene.screen.open(As.o4.HOW_TO_PLAY_SCREEN)};var n=this.scene.make.bitmapText({font:Go.Z.BOLD.KEY,size:this.scene.fontSize(16),text:"How To Play?",origin:{x:.5,y:.5}});n.setTint(1907997);var i=this.scene.add.image(0,0,gf,mf.IC_BOOK);i.setWorldSize(24,24);var a=this.scene.add.image(0,0,gf,mf.IC_NEXT);return a.setWorldSize(16,16),Phaser.Display.Align.In.LeftCenter(n,t,-30),Phaser.Display.Align.In.LeftCenter(i,t),Phaser.Display.Align.In.RightCenter(a,t),t.add([n,i,a]),t},n.createInviteButton=function(){var e=this,t=new Ho.Z(this.scene,300,50);t.setName("Invite"),t.onClick=function(){e.scene.storage.dispatch((0,st.Z)(ut().mark((function e(){var t,n,i,a,r,s,o,c,u,l;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=window.game,n=t.player,i=t.analytics,a=t.facebook,r=t.globalScene,e.prev=1,r.screen.open(As.o4.NOTIFY_SCREEN,{message:"Loading...",loading:!0}),e.next=5,wu();case 5:return s=e.sent,cf(s),o=n.getPlayer(),c=o.playerId,u=o.name,l=o.photo,e.next=10,a.inviteAsync({template:Zr,text:{default:"Great! I have a best score!",localizations:{en_US:"Great! I have a best score!",vi_VN:"Th\u1eadt tuy\u1ec7t! M\xecnh v\u1eeba ph\xe1 k\u1ef7 l\u1ee5c n\xe0y!"}},image:s||"",data:{playerId:c,playerName:u,playerPhoto:l,type:Zr}});case 10:i.event(Vi._.INVITE,{invite_content_type:"BestScore",success:!0}),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),i.event(Vi._.INVITE,{invite_content_type:"BestScore",success:!1}),(0,at.tO)(e.t0);case 17:return e.prev=17,r.screen.close(As.o4.NOTIFY_SCREEN),e.finish(17);case 20:case"end":return e.stop()}}),e,null,[[1,13,17,20]])}))))};var n=this.scene.make.bitmapText({font:Go.Z.BOLD.KEY,size:this.scene.fontSize(16),text:"Invite Friends",origin:{x:.5,y:.5}});n.setTint(1907997);var i=this.scene.add.image(0,0,gf,mf.IC_INVITE);return i.setWorldSize(24,24),t.add([n,i]),Phaser.Display.Align.In.LeftCenter(i,t),Phaser.Display.Align.In.LeftCenter(n,t,-32),t},n.createStatisticsButton=function(){var e=this,t=new Ho.Z(this.scene,300,50);t.setName("Statistics"),t.onClick=function(){e.scene.screen.close(As.o4.SETTINGS_SCREEN),e.scene.screen.open(As.o4.GAME_STATS_SCREEN)};var n=this.scene.make.bitmapText({font:Go.Z.BOLD.KEY,size:this.scene.fontSize(16),text:"Statistics",origin:{x:.5,y:.5}});n.setTint(1907997);var i=this.scene.add.image(0,0,gf,mf.IC_STATISTICS);i.setWorldSize(24,24);var a=this.scene.add.image(0,0,gf,mf.IC_NEXT);return a.setWorldSize(16,16),Phaser.Display.Align.In.LeftCenter(n,t,-30),Phaser.Display.Align.In.LeftCenter(i,t),Phaser.Display.Align.In.RightCenter(a,t),t.add([n,i,a]),t},n.handleSoundChanged=function(e){this.scene.player.setSetting("sound",e)},n.createCloseButton=function(){var e=this,t=new Ho.Z(this.scene,40,40);t.setName("Close"),t.onClick=function(){e.scene.screen.close(As.o4.SETTINGS_SCREEN)};var n=this.scene.add.image(0,0,gf,"ic_close_gray");n.setWorldSize(24,24),t.add(n),Phaser.Display.Align.In.TopRight(t,this.bg,-4,-6),this.add([t])},n.updateSettings=function(){var e=this.scene.player.getPlayerSettings(),t=e.relaxedSpider,n=e.suitSize;this.relaxedSpiderBtn.updateStatus(!0===t);var i="1";"two"===n?i="2":"four"===n&&(i="4"),this.suitSizeCheckBoxBtn.updateStatus(i)},t}(Phaser.GameObjects.Container),yf=vf,bf=function(e){function t(t,n,i,a){var r;return(r=e.call(this,t,n,i,a)||this).slideInAnimation=void 0,r.fadeInAnimation=void 0,r.fadeOutAnimation=void 0,r.settingsContainer=void 0,r.setDepth(As.Ks.POPUP),r.settingsContainer=new yf(t),r.add(r.settingsContainer),r}(0,ot.Z)(t,e);var n=t.prototype;return n.open=function(){var t=this;e.prototype.open.call(this),this.settingsContainer.updateSettings(),this.settingsContainer.setAlpha(1),this.background.setAlpha(.8),this.settingsContainer.setInteractive(),this.background.setInteractive().once(Phaser.Input.Events.POINTER_DOWN,(function(){return t.scene.screen.close(As.o4.SETTINGS_SCREEN)})),this.runOpenAnimation()},n.close=function(){this.runCloseAnimation()},n.runOpenAnimation=function(){var e,t;if(null==(e=this.slideInAnimation)||null==(t=e.tween)||!t.isPlaying()){this.scene.audio.playSound(Bt.POPUP_SHOW);var n=this.scene.ads.getBannerHeight();this.slideInAnimation||(this.slideInAnimation=new Jd({targets:[this.settingsContainer],props:{y:{from:this.height/2,to:this.height/2-this.settingsContainer.height/2-20-n,ease:Phaser.Math.Easing.Back.Out}},duration:300})),this.fadeInAnimation||(this.fadeInAnimation=new Kd.Z({targets:[this],duration:300})),this.slideInAnimation.play(),this.fadeInAnimation.play()}},n.runCloseAnimation=function(){var t,n,i=this;null!=(t=this.fadeOutAnimation)&&null!=(n=t.tween)&&n.isPlaying()||(this.scene.audio.playSound(Bt.POPUP_OFF),this.fadeOutAnimation||(this.fadeOutAnimation=new qd.Z({targets:[this],props:{alpha:0},duration:300,onComplete:function(){e.prototype.close.call(i)}})),this.fadeOutAnimation.play())},t}(GameCore.Screen),Sf=bf,Tf={wins:0,winRate:0,totalGame:0,winsWithoutUndo:0,bestScore:0,averageScore:0,bestWinningTime:0,averageWinningTime:0,mostWinningTime:0,bestWinningMoves:0,mostWinningMoves:0,currentWinningStreak:0,longestWinningStreak:0,targetLevelTracking:{difficultyScore:0,lose:[],win:[]}},Ef={score:0,suitSize:"one",difficulty:"easy",playedTime:0,currentMoves:0,usedUndo:!1},Cf=function(){function e(e){this.scene=void 0,this.oneSuitStats=void 0,this.twoSuitStats=void 0,this.fourSuitStats=void 0,this.currentGame=void 0,this.scene=e,this.setupInitGameStats(),this.setupInitialStats(),this.loadUserStats(e)}var t=e.prototype;return t.setupInitGameStats=function(){this.currentGame=(0,Me.Z)({},Ef)},t.setupInitialStats=function(){this.oneSuitStats={easy:GameCore.Utils.Json.clone(Tf),medium:GameCore.Utils.Json.clone(Tf),hard:GameCore.Utils.Json.clone(Tf),dynamic:GameCore.Utils.Json.clone(Tf)},this.twoSuitStats={easy:GameCore.Utils.Json.clone(Tf),medium:GameCore.Utils.Json.clone(Tf),hard:GameCore.Utils.Json.clone(Tf),dynamic:GameCore.Utils.Json.clone(Tf)},this.fourSuitStats={easy:GameCore.Utils.Json.clone(Tf),medium:GameCore.Utils.Json.clone(Tf),hard:GameCore.Utils.Json.clone(Tf),dynamic:GameCore.Utils.Json.clone(Tf)}},t.loadUserStats=function(e){var t=this,n=e.player.getCustomData("gameStats");if(GameCore.Utils.Valid.isObject(n)){if(GameCore.Utils.Object.hasOwn(n,"one")){var i=(0,Me.Z)({},this.oneSuitStats);this.oneSuitStats=(0,Fe.TS)(i,n.one)}if(GameCore.Utils.Object.hasOwn(n,"two")){var a=(0,Me.Z)({},this.twoSuitStats);this.twoSuitStats=(0,Fe.TS)(a,n.two)}if(GameCore.Utils.Object.hasOwn(n,"four")){var r=(0,Me.Z)({},this.fourSuitStats);this.fourSuitStats=(0,Fe.TS)(r,n.four)}M()(this.oneSuitStats).forEach((function(e){var n,i,a=t.oneSuitStats[e].targetLevelTracking;a.win=u()(n=a.win).call(n,(function(e){return(0,Rn.VY)(e)})),a.lose=u()(i=a.lose).call(i,(function(e){return(0,Rn.VY)(e)}))})),M()(this.twoSuitStats).forEach((function(e){var n,i,a=t.twoSuitStats[e].targetLevelTracking;a.win=u()(n=a.win).call(n,(function(e){return(0,Rn.VY)(e)})),a.lose=u()(i=a.lose).call(i,(function(e){return(0,Rn.VY)(e)}))})),M()(this.fourSuitStats).forEach((function(e){var n,i,a=t.fourSuitStats[e].targetLevelTracking;a.win=u()(n=a.win).call(n,(function(e){return(0,Rn.VY)(e)})),a.lose=u()(i=a.lose).call(i,(function(e){return(0,Rn.VY)(e)}))})),this.postGameStats()}},t.makeWin=function(){console.log("makeWin: ",this.currentGame);var e=this.currentGame,t=e.suitSize,n=e.difficulty,i=this.getGameStats(t,n),a=this.calculateNewStats(i,this.currentGame,"win");switch(t){case"one":var r=(0,Me.Z)({},this.oneSuitStats[n]);this.oneSuitStats[n]=(0,Fe.TS)(r,a);break;case"two":var s=(0,Me.Z)({},this.twoSuitStats[n]);this.twoSuitStats[n]=(0,Fe.TS)(s,a);break;case"four":var o=(0,Me.Z)({},this.fourSuitStats[n]);this.fourSuitStats[n]=(0,Fe.TS)(o,a);break;default:throw new Error("Invalid suit size")}this.postGameStats()},t.makeLose=function(e){console.log("add lose: ",this.currentGame);var t=this.currentGame,n=t.suitSize,i=t.difficulty,a=this.getGameStats(n,i),r=this.calculateNewStats(a,this.currentGame,e?"lose":"giveUp");switch(n){case"one":var s=(0,Me.Z)({},this.oneSuitStats[i]);this.oneSuitStats[i]=(0,Fe.TS)(s,r);break;case"two":var o=(0,Me.Z)({},this.twoSuitStats[i]);this.twoSuitStats[i]=(0,Fe.TS)(o,r);break;case"four":var c=(0,Me.Z)({},this.fourSuitStats[i]);this.fourSuitStats[i]=(0,Fe.TS)(c,r);break;default:throw new Error("Invalid suit size")}this.postGameStats()},t.calculateNewStats=function(e,t,n){var i,a,r=t.score,s=t.playedTime,o=t.currentMoves,c=t.usedUndo;if("lose"===n||"giveUp"===n){var u,l,h=e.totalGame+1,d=e.wins/(e.totalGame+1)*100,f=e.targetLevelTracking.difficultyScore;"lose"===n&&(f-=4);var p={difficultyScore:f,win:fe()(u=[]).call(u,e.targetLevelTracking.win),lose:fe()(l=[]).call(l,e.targetLevelTracking.lose)};return p.lose.push(Date.now()),(0,Me.Z)({},e,{totalGame:h,currentWinningStreak:0,winRate:d,targetLevelTracking:p})}var g=e.wins+1,m=g/(e.totalGame+1)*100,v=e.totalGame+1,y=e.winsWithoutUndo+(c?0:1),b=Math.max(e.bestScore,r),S=(e.averageScore*e.wins+r)/g,T=(e.averageWinningTime*e.wins+s)/g,E=Math.min(s,e.bestWinningTime)||s,C=Math.max(s,e.mostWinningTime),A=Math.min(o,e.bestWinningMoves)||o,w=Math.max(o,e.mostWinningMoves),I=e.currentWinningStreak+1,P=Math.max(I,e.longestWinningStreak),k={difficultyScore:e.targetLevelTracking.difficultyScore+4,win:fe()(i=[]).call(i,e.targetLevelTracking.win),lose:fe()(a=[]).call(a,e.targetLevelTracking.lose)};return k.win.push(Date.now()),{wins:g,winRate:m,totalGame:v,winsWithoutUndo:y,bestScore:b,averageScore:S,averageWinningTime:T,bestWinningTime:E,mostWinningTime:C,bestWinningMoves:A,mostWinningMoves:w,currentWinningStreak:I,longestWinningStreak:P,targetLevelTracking:k}},t.postGameStats=function(){var e={one:GameCore.Utils.Json.clone(this.oneSuitStats),two:GameCore.Utils.Json.clone(this.twoSuitStats),four:GameCore.Utils.Json.clone(this.fourSuitStats)};this.scene.player.setCustomData("gameStats",e)},t.getTotalDifficultyScore=function(e){if("one"===e){var t=0;return t+=this.oneSuitStats.easy.targetLevelTracking.difficultyScore,t+=this.oneSuitStats.medium.targetLevelTracking.difficultyScore,t+=this.oneSuitStats.hard.targetLevelTracking.difficultyScore}if("two"===e){var n=0;return n+=this.twoSuitStats.easy.targetLevelTracking.difficultyScore,n+=this.twoSuitStats.medium.targetLevelTracking.difficultyScore,n+=this.twoSuitStats.hard.targetLevelTracking.difficultyScore}if("four"===e){var i=0;return i+=this.fourSuitStats.easy.targetLevelTracking.difficultyScore,i+=this.fourSuitStats.medium.targetLevelTracking.difficultyScore,i+=this.fourSuitStats.hard.targetLevelTracking.difficultyScore}throw new Error("Invalid suit size: "+e)},t.getGameStats=function(e,t){switch(e){case"one":return this.oneSuitStats[t];case"two":return this.twoSuitStats[t];case"four":return this.fourSuitStats[t];default:throw new Error("Invalid suit size: "+e+" "+t)}},t.getTotalGameStats=function(e){var t=this.oneSuitStats;switch(e){case"two":t=this.twoSuitStats;break;case"four":t=this.fourSuitStats}var n=0;M()(t).forEach((function(e){n+=t[e].wins}));var i=0;M()(t).forEach((function(e){i+=t[e].totalGame}));var a=n/i*100,r=0;M()(t).forEach((function(e){r+=t[e].winsWithoutUndo}));var s=0;M()(t).forEach((function(e){s=Math.max(s,t[e].bestScore)}));var o=0,c=0;M()(t).forEach((function(e){t[e].averageScore>0&&(o+=t[e].averageScore,c++)})),o=c>0?o/c:0;var u=99999;c=0,M()(t).forEach((function(e){t[e].bestWinningTime<=0||(c++,u=Math.min(u,t[e].bestWinningTime))})),u=c>0?u:0;var l=0;return c=0,M()(t).forEach((function(e){t[e].averageWinningTime>0&&(l+=t[e].averageWinningTime,c++)})),{wins:n,winRate:a,totalGame:i,winsWithoutUndo:r,bestScore:s,averageScore:o,bestWinningTime:u,averageWinningTime:l=c>0?l/c:0,mostWinningTime:0,bestWinningMoves:0,mostWinningMoves:0,currentWinningStreak:0,longestWinningStreak:0,targetLevelTracking:{difficultyScore:0,win:[],lose:[]}}},t.getCurrentGameStats=function(){return this.currentGame},t.updateCurrentGameStats=function(e){this.currentGame=(0,Me.Z)({},this.currentGame,e)},e}(),Af=Cf,wf=function(){function e(e){this.scene=void 0,this.scene=e,this.loadLevels()}var t=e.prototype;return t.loadLevels=function(){},t.isLevelLoaded=function(){return!0},t.getLevelGroup=function(e){var t=this.scene.gameStats.getGameStats("one","easy"),n=this.getLevelByUserStats(t);return e?"draw3/level"+n:"draw1/level"+n},t.getLevelByUserStats=function(e){e.winRate,e.totalGame;return 1},e}(),If=wf,Pf=function(e){function t(t){var n;return(n=e.call(this,t)||this).columns=void 0,n.rows=void 0,n.cellWidths=void 0,n.cellHeight=void 0,n.textGroup=void 0,n.iconGroup=void 0,n.aligns=void 0,n.tableData=void 0,n.background=void 0,n.columns=0,n.rows=0,n.tableData=[],n.aligns=[],n.cellWidths=[],n.cellHeight=0,n.textGroup=n.scene.add.group(),n.iconGroup=n.scene.add.group(),t.add.existing((0,Cs.Z)(n)),n}(0,ot.Z)(t,e);var n=t.prototype;return n.setTableSize=function(e,t,n,i,a){this.columns=t,this.rows=e,this.cellWidths=n,this.cellHeight=i,this.aligns=a,this.updateTable()},n.setTableData=function(e){this.tableData=e,this.updateTable()},n.updateTable=function(){var e;this.textGroup.getChildren().forEach((function(e){return e instanceof Phaser.GameObjects.BitmapText&&e.kill()})),this.iconGroup.getChildren().forEach((function(e){return e instanceof Phaser.GameObjects.Image&&e.kill()}));var t=G()(e=this.cellWidths).call(e,(function(e,t){return e+t}),0),n=this.rows*this.cellHeight;this.setSize(t,n);var i=this.tableData;if(i)for(var a=0;a<this.rows;a++){var r=i[a];if(!r)break;var s=this.cellHeight*(.5+a)-this.height/2,o=-this.width/2,c=this.spawnIcon();c.setTexture(Ds.Z.GAMEPLAY_DEFAULT.KEY,r[2]),c.setWorldSize(24,24),c.setPosition(o-22,s);for(var u=0;u<this.columns;u++)if(r[u]){var l=this.cellWidths[u],h=this.spawnText();h.setText(r[u]),1==this.aligns[u]?(h.setOrigin(1,.5),h.setPosition(o+l,s)):0==this.aligns[u]?(h.setOrigin(.5,.5),h.setPosition(o+.5*l,s)):(h.setOrigin(0,.5),h.setPosition(o,s)),o+=l}}},n.drawBorder=function(){this.drawRowBorder(),this.drawColumnBorder();var e=this.scene.add.rectangle(0,0,0,0);e.setOrigin(.5,.5),e.setStrokeStyle(1,1907997,.2),e.setSize(this.width,this.height),e.setPosition(-this.width/2,-this.height/2),this.add(e)},n.drawRowBorder=function(){for(var e=-this.height/2,t=1;t<this.rows;t++){var n=this.scene.add.line(-15,e+this.cellHeight*t,0,0,this.width+35,0,1907997,.1);n.setLineWidth(.2),this.add(n)}},n.drawColumnBorder=function(){for(var e=-this.width/2,t=1;t<this.rows;t++){e+=this.cellWidths[t-1]||0;var n=this.scene.add.line(e,0,0,0,0,this.height,1907997,.1);n.setLineWidth(.2),this.add(n)}},n.spawnText=function(){var e=this.textGroup.getFirstDead()||this.createText();return e.revive(),e},n.createText=function(){var e=this.scene.make.bitmapText({font:Go.Z.BOLD.KEY,size:this.scene.fontSize(16),origin:{x:.5,y:.5}});return e.setTint(1907997),this.textGroup.add(e),this.add(e),e},n.spawnIcon=function(){var e=this.iconGroup.get();return e.revive(),e.clearTint(),this.add(e),e},t}(Phaser.GameObjects.Container),kf=Pf,xf=43282,_f=15672868,Of=13425357,Df=303,Bf=24,Lf=12,Rf=24,Gf=66,Nf=1e3,Mf=Phaser.Math.Easing.Quadratic.Out,Ff=xf,Uf=_f,Zf=Of,Hf=function(e){function t(t){var n;return(n=e.call(this,t)||this).emptyBar=void 0,n.winRateBar=void 0,n.loseRateBar=void 0,n.cornerRadius=void 0,n.isPlayingAnimation=!1,n.updatedLoseGraphicsWidth=-1,n.setSize(Df,Lf),n.cornerRadius=n.height/2,n.createEmptyBar(),n.createWinRateBar(),n.createLoseRateBar(),n}(0,ot.Z)(t,e);var n=t.prototype;return n.createEmptyBar=function(){var e=this.width,t=this.height;this.emptyBar=new Qd.Z(this.scene,0,0,e,t,this.cornerRadius).setFillStyle(Zf),this.add(this.emptyBar)},n.createWinRateBar=function(){var e=this.width,t=this.height;this.winRateBar=new Qd.Z(this.scene,0,0,e,t,this.cornerRadius).setFillStyle(Ff).setOrigin(0,.5),this.add(this.winRateBar),Phaser.Display.Align.In.LeftCenter(this.winRateBar,this)},n.createLoseRateBar=function(){var e=this.width,t=this.height;this.loseRateBar=new Qd.Z(this.scene,0,0,e/2,t,this.cornerRadius).setFillStyle(Uf).setOrigin(1,.5),this.add(this.loseRateBar),Phaser.Display.Align.In.RightCenter(this.loseRateBar,this)},n.updateWinLoseCount=function(e,t){var n=e+t;if(n<=0)return this.winRateBar.kill(),void this.loseRateBar.kill();e?this.winRateBar.revive():this.winRateBar.kill(),t?this.loseRateBar.revive():this.loseRateBar.kill(),this.bringToTop(t<e?this.loseRateBar:this.winRateBar);var i=t/n*this.width;this.updatedLoseGraphicsWidth=i},n.initAnimation=function(){this.isPlayingAnimation||(this.loseRateBar.width=2*this.cornerRadius,this.winRateBar.width=2*this.cornerRadius)},n.playAnimation=function(){var e=this;this.isPlayingAnimation||(this.isPlayingAnimation=!0,-1!==this.updatedLoseGraphicsWidth?(this.scene.tweens.addCounter({from:2*this.cornerRadius,to:this.updatedLoseGraphicsWidth,ease:Mf,duration:Nf,onUpdate:function(t){e.loseRateBar.width=t.getValue()},onComplete:function(){e.isPlayingAnimation=!1}}),this.scene.tweens.addCounter({from:2*this.cornerRadius,to:this.width-this.updatedLoseGraphicsWidth+2*this.cornerRadius,ease:Mf,duration:Nf,onUpdate:function(t){var n=t.getValue();e.winRateBar.width=n>e.width?e.width:n}})):this.isPlayingAnimation=!1)},t}(Phaser.GameObjects.Container),Wf=12,zf=xf,Yf=_f,Vf=16,Kf=function(e){function t(t){var n;return(n=e.call(this,t)||this).winCountLabel=void 0,n.loseCountLabel=void 0,n.setSize(Df,Bf),n.createWinCountLabel(),n.createLoseCountLabel(),n.alignComponents(),n}(0,ot.Z)(t,e);var n=t.prototype;return n.createWinCountLabel=function(){this.winCountLabel=this.scene.make.bitmapText({font:Go.Z.PRIMARY.KEY,size:this.scene.fontSize(Vf),text:"Win: 62",origin:{x:0,y:.5}}).setTint(zf),this.add(this.winCountLabel)},n.createLoseCountLabel=function(){this.loseCountLabel=this.scene.make.bitmapText({font:Go.Z.PRIMARY.KEY,size:this.scene.fontSize(Vf),text:"Lose: 32",origin:{x:1,y:.5}}).setTint(Yf),this.add(this.loseCountLabel)},n.alignComponents=function(){Phaser.Display.Align.In.LeftCenter(this.winCountLabel,this),Phaser.Display.Align.In.RightCenter(this.loseCountLabel,this)},n.updateWinLoseCount=function(e,t){this.winCountLabel.setText("Win: "+e),this.loseCountLabel.setText("Lose: "+t)},t}(Phaser.GameObjects.Container),jf=xf,Xf=_f,Jf=Wf,qf=function(e){function t(t){var n;return(n=e.call(this,t)||this).winRateLabel=void 0,n.loseRateLabel=void 0,n.isPlayingAnimation=!1,n.updatedRoundedWinPercentage=-1,n.updatedRoundedLosePercentage=-1,n.setSize(Df,Rf),n.createWinRateLabel(),n.createLoseRateLabel(),n.alignComponents(),n}(0,ot.Z)(t,e);var n=t.prototype;return n.createWinRateLabel=function(){this.winRateLabel=this.scene.make.bitmapText({font:Go.Z.PRIMARY.KEY,size:this.scene.fontSize(Jf),text:"67%",origin:{x:0,y:.5}}).setTint(jf),this.add(this.winRateLabel)},n.createLoseRateLabel=function(){this.loseRateLabel=this.scene.make.bitmapText({font:Go.Z.PRIMARY.KEY,size:this.scene.fontSize(Jf),text:"33%",origin:{x:1,y:.5}}).setTint(Xf),this.add(this.loseRateLabel)},n.alignComponents=function(){Phaser.Display.Align.In.LeftCenter(this.winRateLabel,this),Phaser.Display.Align.In.RightCenter(this.loseRateLabel,this)},n.getRoundedWinLosePercentage=function(e,t){if(0===e&&0===t)return{win:0,lose:0};var n=Math.round(100*e);return{win:n,lose:100-n}},n.updateWinLoseRate=function(e,t){var n=e+t,i=n<=0?0:e/n,a=n<=0?0:t/n,r=this.getRoundedWinLosePercentage(i,a),s=r.win,o=r.lose;this.winRateLabel.setText(s+"%"),this.loseRateLabel.setText(o+"%"),this.updatedRoundedWinPercentage=s,this.updatedRoundedLosePercentage=o},n.initAnimation=function(){this.isPlayingAnimation||(this.winRateLabel.setText("0%"),this.loseRateLabel.setText("0%"))},n.playAnimation=function(){var e=this;this.isPlayingAnimation||(this.isPlayingAnimation=!0,-1!==this.updatedRoundedWinPercentage&&-1!==this.updatedRoundedLosePercentage?(this.scene.tweens.addCounter({from:0,to:this.updatedRoundedWinPercentage,ease:Mf,duration:Nf,onUpdate:function(t){var n=Math.round(t.getValue());e.winRateLabel.setText(n+"%")},onComplete:function(){e.isPlayingAnimation=!1}}),this.scene.tweens.addCounter({from:0,to:this.updatedRoundedLosePercentage,ease:Mf,duration:Nf,onUpdate:function(t){var n=Math.round(t.getValue());e.loseRateLabel.setText(n+"%")}})):this.isPlayingAnimation=!1)},t}(Phaser.GameObjects.Container),Qf=function(e){function t(t){var n;return(n=e.call(this,t)||this).countLabel=void 0,n.rateLabel=void 0,n.barChart=void 0,n.setSize(Df,Gf),n.createCountLabel(),n.createRateLabel(),n.createBarChart(),n.alignComponents(),n}(0,ot.Z)(t,e);var n=t.prototype;return n.setWinLoseCount=function(e,t){this.countLabel.updateWinLoseCount(e,t),this.barChart.updateWinLoseCount(e,t),this.rateLabel.updateWinLoseRate(e,t)},n.initAnimation=function(){this.barChart.initAnimation(),this.rateLabel.initAnimation()},n.playAnimation=function(){this.barChart.playAnimation(),this.rateLabel.playAnimation()},n.createCountLabel=function(){this.countLabel=new Kf(this.scene),this.add(this.countLabel)},n.createRateLabel=function(){this.rateLabel=new qf(this.scene),this.add(this.rateLabel)},n.createBarChart=function(){this.barChart=new Hf(this.scene),this.add(this.barChart)},n.alignComponents=function(){Phaser.Display.Align.In.TopCenter(this.countLabel,this),Phaser.Display.Align.In.Center(this.barChart,this),Phaser.Display.Align.In.BottomCenter(this.rateLabel,this)},n.addBackground=function(){var e="win-lose-chart-background";if(!this.scene.textures.exists(e)){var t=this.width,n=this.height,i=this.scene.add.graphics();i.fillStyle(65280,.2),i.fillRect(0,0,t,n),i.generateTexture(e,t,n),i.destroy()}var a=this.scene.add.image(0,0,e);this.add(a)},t}(Phaser.GameObjects.Container),$f=Ds.Z.GAMEPLAY_DEFAULT.FRAME,ep=function(e){function t(t){var n;return(n=e.call(this,t)||this).chart=void 0,n.tableStats=void 0,n.chart=new Qf(t),n.tableStats=new kf(t),n.tableStats.setTableSize(6,2,[135,125],60,[-1,1]),n.tableStats.drawRowBorder(),n.setSize(340,n.chart.height+n.tableStats.height),n.add([n.chart,n.tableStats]),Phaser.Display.Align.In.TopCenter(n.chart,(0,Cs.Z)(n)),Phaser.Display.Align.To.BottomCenter(n.tableStats,n.chart,15),t.add.existing((0,Cs.Z)(n)),n}return(0,ot.Z)(t,e),t.prototype.setStats=function(e){var t=e.totalGame,n=e.wins,i=e.winsWithoutUndo,a=e.bestScore,r=e.averageScore,s=e.bestWinningTime,o=e.averageWinningTime;this.chart.setWinLoseCount(n,t-n),this.tableStats.setTableData([["Total game",""+t,$f.STATS_FLASH],["Wins Without Undo",""+i,$f.STATS_CROWN],["Best Score",""+a,$f.STATS_MEDAL_START],["Average Score",""+Math.round(r),$f.STATS_STAR],["Best Winning Time",""+(0,Rn.F0)(s,!1),$f.STATS_CUP],["Average Winning Time",""+(0,Rn.F0)(o,!1),$f.STATS_TIMER]])},t}(Phaser.GameObjects.Container),tp=ep,np=function(e){function t(t,n,i,a,r){var s;return void 0===r&&(r=10),(s=e.call(this,t)||this).borderRadius=void 0,s.numOfTabs=void 0,s.tabs=void 0,s.currentIdx=void 0,s.callback=void 0,s.borderRadius=r,s.numOfTabs=a,s.setSize(n,i),s.createBg(),s.createTabs(),s.listenInput(),t.add.existing((0,Cs.Z)(s)),s}(0,ot.Z)(t,e);var n=t.prototype;return n.addLabels=function(e){this.add(e);var t=this.width/this.numOfTabs;this.placeCenter(e,0,0,t+1)},n.createBg=function(){var e=new Qd.Z(this.scene,0,0,this.width+this.numOfTabs+1,this.height+2,this.borderRadius,this.themeColor);this.add([e])},n.createTabs=function(){this.tabs=[];for(var e=this.width/this.numOfTabs,t=0;t<this.numOfTabs;t++){var n=0==t?{tl:this.borderRadius,bl:this.borderRadius}:t==this.numOfTabs-1?{tr:this.borderRadius,br:this.borderRadius}:0,i=new Qd.Z(this.scene,0,0,e,this.height,n,this.backgroundColor);0==t&&i.setAlpha(0),this.tabs.push(i)}this.add(this.tabs),this.placeCenter(this.tabs,0,0,e+1)},n.placeCenter=function(e,t,n,i,a){void 0===a&&(a=0);for(var r=t-(this.numOfTabs/2-.5-a)*i,s=0;s<e.length;s++)e[s].setPosition(r+s*i,n)},n.getIdx=function(e){var t=this.width/this.tabs.length;return Math.floor((e+this.width/2)/t)},n.listenInput=function(){var e=this,t=!1;this.setInteractive({useHandCursor:!0}).on(Phaser.Input.Events.POINTER_DOWN,(function(){t=!0})).on(Phaser.Input.Events.POINTER_OUT,(function(){t=!1})).on(Phaser.Input.Events.POINTER_UP,(function(n){if(t){var i=e.getLocalPoint(n.worldX,n.worldY).x;e.selectTab(e.getIdx(i))}t=!1}))},n.selectTab=function(e){if(e!=this.currentIdx){this.currentIdx=e,this.callback&&this.callback(e);for(var t=0;t<this.tabs.length;t++)this.scene.tweens.add({targets:this.tabs[t],alpha:t!==e?1:0,duration:200,ease:Phaser.Math.Easing.Sine.InOut})}},(0,Wt.Z)(t,[{key:"themeColor",get:function(){return 3774208}},{key:"backgroundColor",get:function(){return 16579837}}]),t}(Phaser.GameObjects.Container),ip=np,ap=Ds.Z.GAMEPLAY_DEFAULT.KEY,rp=400,sp=20,op=function(e){function t(t){var n;return(n=e.call(this,t)||this).bg=void 0,n.tab=void 0,n.gameStats=void 0,n.oneSuitStats=void 0,n.twoSuitsStats=void 0,n.fourSuitsStats=void 0,n.currentContainerIdx=void 0,n.createBackground(),n.createTitle(),n.createGameStats(),n.createTab(),n.createCloseButton(),t.add.existing((0,Cs.Z)(n)),n}(0,ot.Z)(t,e);var n=t.prototype;return n.createBackground=function(){var e=new Qd.Z(this.scene,0,0,340,520,20,16579837),t=this.scene.add.line(0,0,0,0,340,0,3774208,1);t.setLineWidth(.6),this.add([e,t]),this.bg=e,this.setSize(e.width,e.height),Phaser.Display.Align.In.TopCenter(t,this,0,-88)},n.createTitle=function(){var e=this.scene.make.bitmapText({font:Go.Z.BOLD.KEY,size:this.scene.fontSize(20),text:"Statistics",origin:{x:.5,y:.5}});e.setTint(1907997),this.add(e),Phaser.Display.Align.In.TopCenter(e,this,0,-12)},n.createTab=function(){var e,t=this,n=sp,i=rp;this.tab=new ip(this.scene,300,30,3),this.add(this.tab),Phaser.Display.Align.In.TopCenter(this.tab,this,0,-45);var a=z()(e=["1 suit","2 suits","4 suits"]).call(e,(function(e){return t.scene.make.bitmapText({font:Go.Z.PRIMARY.KEY,size:t.scene.fontSize(14),text:e,origin:{x:.5,y:.5}})}));this.tab.addLabels(a),this.tab.callback=function(e){a.forEach((function(t,n){return t.setTint(e==n?16579837:3774208)}));var r=[t.oneSuitStats,t.twoSuitsStats,t.fourSuitsStats],s=r[t.currentContainerIdx],o=r[e];if(s!==o){var c=r[3-t.currentContainerIdx-e];t.scene.tweens.killTweensOf(s),t.scene.tweens.killTweensOf(o),t.scene.tweens.add({targets:o,alpha:{from:0,to:1},x:{from:-n,to:0},duration:i,ease:Phaser.Math.Easing.Sine.In}),t.scene.tweens.add({targets:s,alpha:{from:1,to:0},x:{from:0,to:n},duration:i,ease:Phaser.Math.Easing.Sine.Out}),t.currentContainerIdx=e,c&&(t.scene.tweens.killTweensOf(c),c.setAlpha(0),c.setX(n))}},this.tab.selectTab(0),this.currentContainerIdx=0,this.oneSuitStats.alpha=1,this.twoSuitsStats.alpha=0,this.fourSuitsStats.alpha=0},n.createGameStats=function(){var e=this.scene.add.container(0,0);this.oneSuitStats=new tp(this.scene),this.twoSuitsStats=new tp(this.scene),this.twoSuitsStats.setAlpha(0),this.fourSuitsStats=new tp(this.scene),this.fourSuitsStats.setAlpha(0),e.setSize(this.twoSuitsStats.width,this.twoSuitsStats.height),e.add(this.oneSuitStats),e.add(this.twoSuitsStats),e.add(this.fourSuitsStats),this.add(e),Phaser.Display.Align.In.TopCenter(e,this,0,-95),this.gameStats=e},n.createCloseButton=function(){var e=this,t=new Ho.Z(this.scene,40,40);t.setName("Close"),t.onClick=function(){e.scene.screen.close(As.o4.GAME_STATS_SCREEN)};var n=this.scene.add.image(0,0,ap,"ic_close_gray");n.setWorldSize(24,24),n.setTint(8750210),t.add(n),Phaser.Display.Align.In.TopRight(t,this.bg,-4,-4),this.add([t])},n.addMask=function(){var e=this,t=this.scene.make.graphics({fillStyle:{color:255,alpha:0},visible:!1});t.setName("MaskGraphics");var n=this.width,i=this.height;t.fillRoundedRect(-(n-10)/2,-i/2,n-10,i,0),this.gameStats.setMask(t.createGeometryMask()),this.scene.events.on("update",(function(){var n=e.getWorldPosition(),i=n.x,a=n.y;t.setPosition(i,a)}))},t}(Phaser.GameObjects.Container),cp=op,up=function(e){function t(t,n,i,a){var r;return(r=e.call(this,t,n,i,a)||this).scene=void 0,r.slideInAnimation=void 0,r.fadeInAnimation=void 0,r.fadeOutAnimation=void 0,r.gameStatsContainer=void 0,r.scene=t,r.setDepth(As.Ks.POPUP),r.gameStatsContainer=new cp(t),r.add(r.gameStatsContainer),r}(0,ot.Z)(t,e);var n=t.prototype;return n.open=function(){var t=this;e.prototype.open.call(this),this.gameStatsContainer.setAlpha(1),this.background.setAlpha(.8),this.gameStatsContainer.setInteractive(),this.updateStatistics(),this.background.setInteractive().once(Phaser.Input.Events.POINTER_DOWN,(function(){return t.scene.screen.close(As.o4.GAME_STATS_SCREEN)})),this.runOpenAnimation()},n.updateStatistics=function(){var e=this.gameStatsContainer,t=e.oneSuitStats,n=e.twoSuitsStats,i=e.fourSuitsStats,a=this.scene.gameStats.getTotalGameStats("one"),r=this.scene.gameStats.getTotalGameStats("two"),s=this.scene.gameStats.getTotalGameStats("four");t.setStats(a),n.setStats(r),i.setStats(s)},n.close=function(){this.runCloseAnimation()},n.runOpenAnimation=function(){var e,t;if(null==(e=this.slideInAnimation)||null==(t=e.tween)||!t.isPlaying()){this.scene.audio.playSound(Bt.POPUP_SHOW);var n=this.gameStatsContainer,i=[n.oneSuitStats,n.twoSuitsStats,n.fourSuitsStats];i.forEach((function(e){e.chart.initAnimation()}));var a=this.scene.ads.getBannerHeight();this.slideInAnimation||(this.slideInAnimation=new Jd({targets:[this.gameStatsContainer],props:{y:{from:this.height/2,to:this.height/2-this.gameStatsContainer.height/2-20-a,ease:Phaser.Math.Easing.Back.Out}},duration:300})),this.fadeInAnimation||(this.fadeInAnimation=new Kd.Z({targets:[this],duration:300,onComplete:function(){var e=(0,st.Z)(ut().mark((function e(){return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i.forEach((function(e){e.chart.playAnimation()}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()})),this.slideInAnimation.play(),this.fadeInAnimation.play()}},n.runCloseAnimation=function(){var t,n,i=this;null!=(t=this.fadeOutAnimation)&&null!=(n=t.tween)&&n.isPlaying()||(this.scene.audio.playSound(Bt.POPUP_OFF),this.fadeOutAnimation||(this.fadeOutAnimation=new qd.Z({targets:[this],props:{alpha:0},duration:300,onComplete:function(){e.prototype.close.call(i)}})),this.fadeOutAnimation.play())},t}(GameCore.Screen),lp=up,hp={STATUS:{READY:"ready",RUNNING:"running",STOPPED:"stopped"}},dp=hp.STATUS,fp=function(){function e(e){this.state=void 0,this.scene=void 0,this.scene=e}var t=e.prototype;return t.init=function(){this.setState(dp.READY)},t.start=function(){this.isRunning()||this.setState(dp.RUNNING)},t.stop=function(){this.isRunning()&&this.setState(dp.STOPPED)},t.setState=function(e){this.state=e},t.isReady=function(){return this.state===dp.READY},t.isRunning=function(){return this.state===dp.RUNNING},t.isStopped=function(){return this.state===dp.STOPPED},e}(),pp=fp,gp=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.setBackground=function(){var e=n.scene.theme.getCurrentThemeConfig().backgroundKey;if(n.scene.load.off("filecomplete-image-"+e,n.setBackground),n.scene.textures.exists(e))return n.scene.setBackground(e),void n.scene.events.emit(es.BACKGROUND_CHANGED,e);n.scene.load.once("filecomplete-image-"+e,n.setBackground)},n.updateCardStyle=function(){var e=n.scene.theme.getCurrentThemeConfig().cardFaceKey;if(n.scene.load.off("filecomplete-json-"+e,n.updateCardStyle),n.scene.textures.exists(e)){var t=n.scene.gameplay.boardGame,i=t.stock,a=t.foundations,r=t.piles;return i.cards.forEach((function(e){return e.updateCardStyle()})),a.forEach((function(e){e.cards.forEach((function(e){return e.updateCardStyle()}))})),void r.forEach((function(e){e.cards.forEach((function(e){return e.updateCardStyle()}))}))}n.scene.load.once("filecomplete-json-"+e,n.updateCardStyle)},n.scene=t,n.setBackground(),n}(0,ot.Z)(t,e);var n=t.prototype;return n.changeBackground=function(e){this.scene.theme.changeBackground(e),this.setBackground(),this.scene.analytics.event(Vi._.THEME_CHANGED,{theme_type:"background",theme_idx:e})},n.changeCardFace=function(e){this.scene.theme.changeCardFace(e),this.updateCardStyle(),this.scene.analytics.event(Vi._.THEME_CHANGED,{theme_type:"card_face",theme_idx:e})},n.changeCardBack=function(e){this.scene.theme.changeCardBack(e),this.updateCardStyle(),this.scene.analytics.event(Vi._.THEME_CHANGED,{theme_type:"card_back",theme_idx:e})},t}(pp),mp=gp,vp=function(e){function t(t,n,i,a,r){var s;(s=e.call(this,t,n,i)||this).border=void 0;var o=s.scene.add.image(0,0,a,r);return o.setWorldSize(n,i),s.add([o]),s.createBorder1(),s.createBorder(),s}(0,ot.Z)(t,e);var n=t.prototype;return n.createBorder1=function(){var e=new Qd.Z(this.scene,0,0,this.width+4,this.height+4,10,16579837,0);e.setStrokeStyle(4,16579837),this.add(e)},n.createBorder=function(){var e=new Qd.Z(this.scene,0,0,this.width+2,this.height+2,10,16579837,0);e.setStrokeStyle(2,3774208),this.add(e),e.kill(),this.border=e},n.showBorder=function(){this.border.revive()},n.hideBorder=function(){this.border.kill()},t}(Ho.Z),yp=vp,bp=function(e){function t(t,n,i,a,r,s){var o;return void 0===r&&(r=0),void 0===s&&(s=0),(o=e.call(this,t)||this).margin=void 0,o.viewContainer=void 0,o.items=void 0,o.currentItemInteractive=void 0,o.itemsLength=void 0,o.currentX=void 0,o.offsetLeft=void 0,o.offsetRight=void 0,o.pointerDownX=void 0,o.pointerDownY=void 0,o.lastPointerX=void 0,o.canClickItem=void 0,o.pointerDown=void 0,o.handlePointerDown=function(e){var t=e.worldX,n=e.worldY;o.pointerDown=!0,o.pointerDownX=e.worldX,o.pointerDownY=e.worldY,o.lastPointerX=e.worldX,o.canClickItem=!0,o.items.forEach((function(i){var a=i.item,r=i.onClick;r&&a.getBounds().contains(t,n)&&(a.emit(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,e),o.currentItemInteractive={item:a,onClick:r})}))},o.handlePointerMove=function(e){if(o.pointerDown){var t=e.worldX,n=e.worldY;if(Phaser.Math.Distance.Between(o.pointerDownX,o.pointerDownY,t,n)>15&&(o.canClickItem=!1),!o.canClickItem){o.viewContainer.x+=t-o.lastPointerX,o.viewContainer.x>0&&(o.viewContainer.x=0);var i=o.itemsLength-o.width+o.offsetLeft+o.offsetRight;o.viewContainer.x<-i&&(o.viewContainer.x=-i)}if(o.currentItemInteractive){var a=o.currentItemInteractive,r=a.item;a.onClick&&!r.getBounds().contains(t,n)&&(r.emit(Phaser.Input.Events.GAMEOBJECT_POINTER_OUT,e),o.currentItemInteractive=void 0)}o.items.forEach((function(i){var a=i.item,r=i.onClick;r&&a.getBounds().contains(t,n)&&(a.emit(Phaser.Input.Events.GAMEOBJECT_POINTER_MOVE,e),o.currentItemInteractive={item:a,onClick:r})})),o.lastPointerX=t}},o.handlePointerUp=function(e){o.pointerDown=!1;var t=e.worldX,n=e.worldY;o.items.forEach((function(i){var a=i.item,r=i.onClick;r&&a.getBounds().contains(t,n)&&(a.emit(Phaser.Input.Events.GAMEOBJECT_POINTER_UP,e),o.canClickItem&&GameCore.Utils.Valid.isFunction(r)&&r())})),o.currentItemInteractive=void 0},o.handlePointerOut=function(e){if(o.pointerDown=!1,o.currentItemInteractive){var t=o.currentItemInteractive,n=t.item;t.onClick&&(n.emit(Phaser.Input.Events.GAMEOBJECT_POINTER_OUT,e),o.currentItemInteractive=void 0)}o.currentItemInteractive=void 0},o.setSize(n,i),o.margin=a,o.items=[],o.canClickItem=!0,o.pointerDown=!1,o.itemsLength=0,o.offsetLeft=r,o.offsetRight=s,o.currentX=-n/2+r,o.viewContainer=t.make.container({}),o.add(o.viewContainer),o.setInteractive(),o.listenEvents(),o}(0,ot.Z)(t,e);var n=t.prototype;return n.addDebug=function(){var e=new Qd.Z(this.scene,0,0,this.width,this.height,0,0);this.add(e)},n.listenEvents=function(){this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,this.handlePointerDown),this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_MOVE,this.handlePointerMove),this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_UP,this.handlePointerUp),this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_OUT,this.handlePointerOut)},n.addItem=function(e,t){this.items.push({item:e,onClick:t}),this.viewContainer.add(e);var n=this.currentX+e.width/2+this.margin;e.x=n,this.itemsLength+=e.width+2*this.margin,this.currentX=n+e.width/2+this.margin},t}(Phaser.GameObjects.Container),Sp=bp,Tp=Ds.Z.GAMEPLAY_DEFAULT.KEY,Ep=Ds.Z.THEME_PREVIEW,Cp=function(e){function t(t){var n;return(n=e.call(this,t)||this).bg=void 0,n.tab=void 0,n.chooseContainers=void 0,n.currentIdx=0,n.backgroundPreView=void 0,n.cardFacePreView=void 0,n.cardBackPreview=void 0,n.createBackground(),n.createTitle(),n.createTab(),n.createChooseContainer(),n.scene.world.isLandscape()&&n.addMask(),n.createBgMask(),n.createCloseButton(),t.add.existing((0,Cs.Z)(n)),n}(0,ot.Z)(t,e);var n=t.prototype;return n.createBackground=function(){var e=new Qd.Z(this.scene,0,0,375,250,{tl:20,tr:20,bl:0,br:0},16579837),t=this.scene.add.line(0,0,0,0,e.width,0,3774208);t.setLineWidth(.5),Phaser.Display.Align.In.TopCenter(t,e,0,-90),this.add([e,t]),this.bg=e,this.setSize(e.width,e.height)},n.createTitle=function(){var e=this.scene.make.bitmapText({font:Go.Z.BOLD.KEY,size:this.scene.fontSize(20),text:"Theme",origin:{x:.5,y:.5}});e.setTint(1907997),this.add(e),Phaser.Display.Align.In.TopCenter(e,this,0,-12)},n.createTab=function(){var e,t=this;this.tab=new ip(this.scene,303,30,3),this.add(this.tab),Phaser.Display.Align.In.TopCenter(this.tab,this,0,-45);var n=z()(e=["Background","Card Face","Card Back"]).call(e,(function(e,n){var i=t.scene.make.bitmapText({font:Go.Z.PRIMARY.KEY,size:t.scene.fontSize(14),text:e,origin:{x:.5,y:.5}});return n>0&&i.setTint(3774208),i}));this.tab.addLabels(n),this.tab.callback=function(e){n.forEach((function(t,n){return t.setTint(e==n?16579837:3774208)}));var i=t.currentIdx<e?375:-375;t.scene.tweens.add({targets:t.chooseContainers[t.currentIdx],x:t.currentIdx<e?-375:375,alpha:0,duration:200,ease:Phaser.Math.Easing.Sine.InOut}),t.scene.tweens.add({targets:t.chooseContainers[e],x:{from:i,to:0},alpha:1,duration:200,ease:Phaser.Math.Easing.Sine.InOut}),t.currentIdx=e}},n.createChooseContainer=function(){this.chooseContainers=[],this.createBackgroundChoose(),this.createCardFaceChoose(),this.createCardBackChoose(),this.chooseContainers[1].setAlpha(0),this.chooseContainers[2].setAlpha(0)},n.createBackgroundChoose=function(){var e=this,t=new Sp(this.scene,375,180,10,20,20);t.setPosition(0,40),this.add(t);for(var n=[],i=this.scene.theme.getThemePreview().Background,a=0;a<5;a++){var r=i[a]||"blank",s=new yp(this.scene,72,112,Ep.KEY,r);s.name="Background",n.push(s)}n.forEach((function(a,r){r<i.length&&(a.onClick=function(){},a.disableInteractive()),t.addItem(a,(function(){n.forEach((function(e){return e.hideBorder()})),a.showBorder(),e.scene instanceof Nb&&e.scene.themeHandler.changeBackground(r)}))})),this.chooseContainers.push(t),this.backgroundPreView=n},n.createCardFaceChoose=function(){var e=this,t=new Sp(this.scene,375,180,10,20,20);t.setPosition(0,40),this.add(t);for(var n=[],i=this.scene.theme.getThemePreview().CardFace,a=0;a<4;a++){var r=i[a]||"blank",s=new yp(this.scene,108,112,Ep.KEY,r);s.name="CardFace",n.push(s)}n.forEach((function(a,r){r<i.length&&(a.onClick=function(){},a.disableInteractive(),t.addItem(a,(function(){n.forEach((function(e){return e.hideBorder()})),a.showBorder(),e.scene instanceof Nb&&e.scene.themeHandler.changeCardFace(r)})))})),this.chooseContainers.push(t),this.cardFacePreView=n},n.createCardBackChoose=function(){var e=this,t=new Sp(this.scene,375,180,10,20,20);t.setPosition(0,40),this.add(t);for(var n=[],i=this.scene.theme.getThemePreview().CardBack,a=0;a<6;a++){var r=i[a]||"blank",s=new yp(this.scene,72,112,Ep.KEY,r);s.name="CardBack",n.push(s)}n.forEach((function(a,r){r<i.length&&(a.onClick=function(){},a.disableInteractive(),t.addItem(a,(function(){n.forEach((function(e){return e.hideBorder()})),a.showBorder(),e.scene instanceof Nb&&e.scene.themeHandler.changeCardBack(r)})))})),this.chooseContainers.push(t),this.cardBackPreview=n},n.addMask=function(){var e=this,t=this.scene.make.graphics({fillStyle:{color:255,alpha:0},visible:!1});t.setName("MaskGraphics");var n=this.width,i=this.height;t.fillRoundedRect(-(n-10)/2,-i/2,n-10,i,0),this.chooseContainers[0].setMask(t.createGeometryMask()),this.chooseContainers[1].setMask(t.createGeometryMask()),this.chooseContainers[2].setMask(t.createGeometryMask()),this.scene.events.on("update",(function(){var n=e.getWorldPosition(),i=n.x,a=n.y;t.setPosition(i,a)}))},n.createBgMask=function(){var e=this.scene.add.rectangle(-this.width/2+10,20,20,this.height-20,16777215),t=this.scene.add.rectangle(this.width/2-10,20,20,this.height-20,16777215);this.add(e),this.add(t)},n.createCloseButton=function(){var e=this,t=new Ho.Z(this.scene,40,40);t.setName("Close"),t.onClick=function(){e.scene.screen.close(As.o4.THEME_SCREEN)};var n=this.scene.add.image(0,0,Tp,"ic_close_gray");n.setWorldSize(24,24),n.setTint(8750210),t.add(n),Phaser.Display.Align.In.TopRight(t,this.bg,-4,-4),this.add([t])},t}(Phaser.GameObjects.Container),Ap=Cp,wp=function(e){function t(t,n,i,a){var r;return(r=e.call(this,t,n,i,a)||this).scene=void 0,r.slideInAnimation=void 0,r.fadeInAnimation=void 0,r.fadeOutAnimation=void 0,r.themeContainer=void 0,r.scene=t,r.setDepth(As.Ks.POPUP),r.themeContainer=new Ap(t),r.add(r.themeContainer),r}(0,ot.Z)(t,e);var n=t.prototype;return n.open=function(){var t=this;e.prototype.open.call(this),this.scene.world.isLandscape()||this.scene.ads.hideBannerAdAsync().catch((function(e){console.warn(e)})),this.themeContainer.setAlpha(1),this.background.setAlpha(0),this.updateSelected(),this.background.setInteractive().once(Phaser.Input.Events.POINTER_DOWN,(function(){return t.scene.screen.close(As.o4.GAME_STATS_SCREEN)})),this.runOpenAnimation()},n.updateSelected=function(){var e=this.scene.theme.getCurrentIdxConfig(),t=e.backgroundIdx,n=e.cardFaceIdx,i=e.cardBackIdx;this.themeContainer.backgroundPreView[t].showBorder(),this.themeContainer.cardFacePreView[n].showBorder(),this.themeContainer.cardBackPreview[i].showBorder()},n.close=function(){this.runCloseAnimation(),this.scene.world.isLandscape()||this.scene.ads.showBannerAdAsync().catch((function(e){console.warn(e)}))},n.runOpenAnimation=function(){var e,t;null!=(e=this.slideInAnimation)&&null!=(t=e.tween)&&t.isPlaying()||(this.scene.audio.playSound(Bt.POPUP_SHOW),this.slideInAnimation||(this.slideInAnimation=new Jd({targets:[this.themeContainer],props:{y:{from:this.height/2,to:this.height/2-this.themeContainer.height/2,ease:Phaser.Math.Easing.Sine.Out}},duration:300})),this.fadeInAnimation||(this.fadeInAnimation=new Kd.Z({targets:[this],duration:300})),this.slideInAnimation.play(),this.fadeInAnimation.play())},n.runCloseAnimation=function(){var t,n,i=this;null!=(t=this.fadeOutAnimation)&&null!=(n=t.tween)&&n.isPlaying()||(this.scene.audio.playSound(Bt.POPUP_OFF),this.fadeOutAnimation||(this.fadeOutAnimation=new qd.Z({targets:[this],props:{alpha:0},duration:300,onComplete:function(){e.prototype.close.call(i)}})),this.fadeOutAnimation.play())},t}(GameCore.Screen),Ip=wp,Pp=n(555),kp=function(e){function t(t,n,i,a){var r;return(r=e.call(this,t,n,i,a)||this).slideInAnimation=void 0,r.fadeOutAnimation=void 0,r.howToPlayContainer=void 0,r.setDepth(As.Ks.POPUP),r.howToPlayContainer=new Pp.Z(t),r.add(r.howToPlayContainer),r}(0,ot.Z)(t,e);var n=t.prototype;return n.open=function(){e.prototype.open.call(this),this.howToPlayContainer.setAlpha(1),this.background.setAlpha(.8),this.howToPlayContainer.selectStep(0),this.scene.analytics.event(Vi._.TUTORIAL_BEGIN),this.runOpenAnimation()},n.close=function(){this.runCloseAnimation()},n.runOpenAnimation=function(){var e,t;null!=(e=this.slideInAnimation)&&null!=(t=e.tween)&&t.isPlaying()||(this.scene.audio.playSound(Bt.POPUP_SHOW),this.slideInAnimation||(this.slideInAnimation=new Kd.Z({targets:[this],duration:300})),this.slideInAnimation.play())},n.runCloseAnimation=function(){var t,n,i=this;null!=(t=this.fadeOutAnimation)&&null!=(n=t.tween)&&n.isPlaying()||(this.scene.audio.playSound(Bt.POPUP_OFF),this.fadeOutAnimation||(this.fadeOutAnimation=new qd.Z({targets:[this],props:{alpha:0},duration:300,onComplete:function(){e.prototype.close.call(i)}})),this.fadeOutAnimation.play())},t}(GameCore.Screen),xp=kp,_p=function(e){function t(t){var n;return(n=e.call(this,t)||this).icon=void 0,n.label=void 0,n.value=void 0,n.setSize(271,24),n.createIcon(),n.createLabel(),n.createValue(),t.add.existing((0,Cs.Z)(n)),n}(0,ot.Z)(t,e);var n=t.prototype;return n.setIcon=function(e,t){this.icon.setTexture(e,t),this.icon.setWorldSize(24,24)},n.setLabel=function(e){this.label.setText(e)},n.setValue=function(e){this.value.setText(e)},n.createIcon=function(){var e=this.scene.add.image(0,0,"");e.setWorldSize(24,24),e.setTint(16579837),this.add(e),this.icon=e},n.createLabel=function(){var e=this.scene.make.bitmapText({font:Go.Z.PRIMARY.KEY,size:this.scene.fontSize(16),text:"",origin:{x:0,y:.5}});e.setTint(16579837),this.add(e),this.label=e},n.createValue=function(){var e=this.scene.make.bitmapText({font:Go.Z.BOLD.KEY,size:this.scene.fontSize(16),text:"",origin:{x:1,y:.5}});e.setTint(16579837),e.setRightAlign(),this.add(e),this.value=e},n.alignProperties=function(){Phaser.Display.Align.In.LeftCenter(this.icon,this),Phaser.Display.Align.To.RightCenter(this.label,this.icon,12),Phaser.Display.Align.In.RightCenter(this.value,this)},t}(Phaser.GameObjects.Container),Op=_p,Dp=Ds.Z.GAMEPLAY_DEFAULT,Bp=Dp.KEY,Lp=Dp.FRAME,Rp=function(e){function t(t,n,i,a){var r;return void 0===n&&(n=8),void 0===i&&(i="New Game"),void 0===a&&(a=Lp.ADD_SQUARE),(r=e.call(this,t)||this).icon=void 0,r.text=void 0,r.iconTextPadding=void 0,r.labelText=void 0,r.iconFrame=void 0,r.iconTextPadding=n,r.labelText=i,r.iconFrame=a,r.createIcon(),r.createLabelText(),r.updateContainerSize(),r.alignIcon(),r.alignText(),r}(0,ot.Z)(t,e);var n=t.prototype;return n.getIcon=function(){return this.icon},n.getText=function(){return this.text},n.clearTint=function(){this.icon.clearTint(),this.text.clearTint()},n.createIcon=function(){this.icon=this.scene.add.image(0,0,Bp,this.iconFrame),this.icon.setWorldSize(20,20),this.icon.setTint(43282),this.add(this.icon)},n.alignIcon=function(){Phaser.Display.Align.In.LeftCenter(this.icon,this)},n.createLabelText=function(){this.text=this.scene.make.bitmapText({font:Go.Z.PRIMARY.KEY,size:this.scene.fontSize(16),text:this.labelText,origin:{x:.5,y:.5}}),this.text.setTint(43282),this.add(this.text)},n.alignText=function(){Phaser.Display.Align.In.RightCenter(this.text,this,0,0)},n.updateContainerSize=function(){this.setSize(this.icon.width+this.iconTextPadding+this.text.width,this.icon.height>this.text.height?this.icon.height:this.text.height)},t}(Phaser.GameObjects.Container),Gp=Ds.Z.GAMEPLAY_DEFAULT,Np=Gp.KEY,Mp=Gp.FRAME,Fp=143.5,Up=48,Zp=function(e){function t(t){var n;return(n=e.call(this,t)||this).bg=void 0,n.score=void 0,n.time=void 0,n.bestTime=void 0,n.moves=void 0,n.draw=void 0,n.lines=[],n.buttons=[],n.createBackground(),n.createTitle(),n.createStats(),n.createNewGameButton(),n.createShareButton(),n.createDevButtons(),t.add.existing((0,Cs.Z)(n)),n}(0,ot.Z)(t,e);var n=t.prototype;return n.setScore=function(e){this.score.setValue(e)},n.setWinningTime=function(e){this.time.setValue(e)},n.setBestWinningTime=function(e){this.bestTime.setValue(e)},n.setMoves=function(e){this.moves.setValue(e)},n.setGameText=function(e,t){var n="One suit";switch(e){case"two":n="Two suits";break;case"four":n="Four suits"}var i=", "+t+" difficulty";this.setDraw(""+n+i)},n.setDraw=function(e){this.draw.setText(e)},n.createBackground=function(){this.setSize(343,374);var e=new Jo(this.scene,{key:"_awesome",radius:6,border:24,width:343,height:374});this.bg=e,this.add(e)},n.createTitle=function(){var e=this.scene.make.bitmapText({font:Go.Z.BOLD.KEY,size:this.scene.fontSize(24),text:"Awesome!",origin:{x:.5,y:.5}});e.setTint(16777215),this.add(e),Phaser.Display.Align.In.TopCenter(e,this,0,-20);var t=this.scene.make.bitmapText({font:Go.Z.PRIMARY.KEY,size:this.scene.fontSize(16),text:"Standard mode, Draw 1",origin:{x:.5,y:.5}});t.setTint(16777215),this.draw=t,this.add([t]),Phaser.Display.Align.To.BottomCenter(t,e,0,8)},n.createStats=function(){var e=[],t=new Op(this.scene);t.setIcon(Np,Mp.MEDAL_STAR),t.setLabel("Score"),t.setValue("687"),this.score=t,e.push(t);var n=new Op(this.scene);n.setIcon(Np,Mp.ARROW_SWAP_HORIZONTAL),n.setLabel("Moves"),n.setValue("798"),this.moves=n,e.push(n);var i=new Op(this.scene);i.setIcon(Np,Mp.TIMER),i.setLabel("Time"),i.setValue("09:48"),this.time=i,e.push(i);var a=new Op(this.scene);a.setIcon(Np,Mp.CUP),a.setLabel("Best time"),a.setValue("05:30"),this.bestTime=a,e.push(a),this.add(e);for(var r=0;r<e.length;r++){var s=e[r];if(s.alignProperties(),Phaser.Display.Align.In.TopCenter(s,this,0,-(50*r+112)),r==e.length-1)break;var o=this.scene.add.line(0,0,0,0,271,0,16579837,.2);this.add(o),this.lines.push(o),Phaser.Display.Align.To.BottomCenter(o,s,0,12)}},n.createNewGameButton=function(){var e=this,t=new $d.Z(this.scene,Fp,Up,16,16777215);t.onClick=(0,st.Z)(ut().mark((function t(){return ut().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e.scene instanceof Nb)){t.next=3;break}return t.next=3,e.scene.handlePlayWithFriend(!0);case 3:e.scene.screen.close(As.o4.VICTORY_SCREEN);case 4:case"end":return t.stop()}}),t)}))),t.setName("NewGame");var n=new Rp(this.scene);t.add(n).setSize(Fp,Up),this.add([t]),this.buttons.push(t),Phaser.Display.Align.In.BottomRight(t,this,-16,-18),new qo.Z({targets:[t],duration:1e3,props:{scale:{from:1,to:1.05}}}).play()},n.createShareButton=function(){var e=this,t=new Ho.Z(this.scene,Fp,Up);t.onClick=function(){e.scene.storage.dispatch((0,st.Z)(ut().mark((function e(){var t,n,i,a,r,s,o,c,u,l;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=window.game,n=t.player,i=t.analytics,a=t.facebook,r=t.globalScene,e.prev=1,r.screen.open(As.o4.NOTIFY_SCREEN,{message:"Loading...",loading:!0}),e.next=5,Iu(window.game.storage.getState());case 5:return s=e.sent,Eu(s),o=n.getPlayer(),c=o.playerId,u=o.name,l=o.photo,e.next=10,a.shareAsync({text:"Easy! I have a new score!",intent:"SHARE",image:s||"",data:{playerId:c,playerName:u,playerPhoto:l,type:Zr}});case 10:i.event(Vi._.SHARE,{share_content_type:"CurrentScore",success:!0}),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),i.event(Vi._.SHARE,{share_content_type:"CurrentScore",success:!1}),(0,at.tO)(e.t0);case 17:return e.prev=17,r.screen.close(As.o4.NOTIFY_SCREEN),e.finish(17);case 20:case"end":return e.stop()}}),e,null,[[1,13,17,20]])}))))},t.setName("Share");var n=new Qd.Z(this.scene,0,0,Fp,Up,16,16777215,.24),i=this.scene.add.graphics();i.lineStyle(1,16777215),i.strokeRoundedRect(-71.75,-24,Fp,Up,16);var a=new Rp(this.scene,8,"Share",Mp.IC_SHARE);a.clearTint(),a.getIcon().setTintFill(16777215),t.add([n,i,a]).setSize(Fp,Up),Phaser.Display.Align.In.BottomLeft(t,this.bg,-16,-18),this.add([t]),this.buttons.push(t)},n.createDevButtons=function(){GameCore.Utils.Valid.isDebugger()&&this.createCloseButton()},n.createCloseButton=function(){var e=this,t=new Ho.Z(this.scene,40,40),n=this.scene.add.image(0,0,Np,Mp.IC_BG_OFF);n.setWorldSize(40,40);var i=this.scene.make.bitmapText({font:Go.Z.PRIMARY.KEY,size:this.scene.fontSize(10),text:"Close",origin:{x:.5,y:.5}});i.setCenterAlign(),t.add([n,i]),this.add(t),Phaser.Display.Align.In.BottomLeft(t,this,0,-200),t.onClick=function(){e.scene.screen.close(As.o4.VICTORY_SCREEN)}},n.hideContent=function(){[this.score,this.moves,this.time,this.bestTime].forEach((function(e){return e.setAlpha(0)})),this.lines.forEach((function(e){e.setAlpha(0),e.scaleX=0})),this.buttons.forEach((function(e){e.setAlpha(0)}))},n.runEntranceAnimationButtons=function(){var e=(0,st.Z)(ut().mark((function e(){var t,n,i=this;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=z()(t=this.buttons).call(t,(function(e){return new(xe())((function(t){i.scene.add.tween({targets:[e],alpha:1,duration:200,onComplete:function(){e.setDisabled(!1),t()}})}))})),e.next=3,xe().all(n);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runEntranceAnimationRows=function(){var e=(0,st.Z)(ut().mark((function e(){var t,n,i=this;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[this.score,this.moves,this.time,this.bestTime],200,n=z()(t).call(t,(function(e,t){return new(xe())((function(n){i.scene.add.tween({targets:[e],duration:200,delay:200*t/2,ease:Phaser.Math.Easing.Sine.Out,props:{alpha:{from:0,to:1},y:{from:e.y+e.height/2,to:e.y}},onComplete:n})}))})),e.next=5,xe().all(n);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runEntranceAnimationLines=function(){var e=(0,st.Z)(ut().mark((function e(){var t,n,i=this;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return 200,n=z()(t=this.lines).call(t,(function(e,t){return new(xe())((function(n){i.scene.add.tween({targets:[e],duration:200,delay:200*t/2,props:{alpha:{from:0,to:1},scaleX:{from:0,to:1}},onComplete:n})}))})),e.next=4,xe().all(n);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runEntranceAnimationRowsLines=function(){var e=(0,st.Z)(ut().mark((function e(){return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,xe().all([this.runEntranceAnimationRows(),this.runEntranceAnimationLines()]);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runEntranceAnimation=function(){var e=(0,st.Z)(ut().mark((function e(){return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.runEntranceAnimationRowsLines();case 2:return e.next=4,this.runEntranceAnimationButtons();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t}(Phaser.GameObjects.Container),Hp=Zp,Wp=Ds.Z.GAMEPLAY_DEFAULT,zp=Wp.KEY,Yp=Wp.FRAME,Vp=23.5,Kp=47,jp=68.5,Xp={AXIS:0,FIRST_FROM_LEFT:Vp,SECOND_FROM_LEFT:Kp,THIRD_FROM_LEFT:jp,FIRST_FROM_RIGHT:-Vp,SECOND_FROM_RIGHT:-Kp,THIRD_FROM_RIGHT:-jp},Jp=function(e){function t(t){var n;return(n=e.call(this,t)||this).beamAxis=void 0,n.beamFirstFromLeft=void 0,n.beamSecondFromLeft=void 0,n.beamThirdFromLeft=void 0,n.beamFirstFromRight=void 0,n.beamSecondFromRight=void 0,n.beamThirdFromRight=void 0,n.pivot=void 0,n.setSize(375,295),n.createBeamsPivot(),n.createBeams(),n.alignBeams(),n.playAnimation(),n}(0,ot.Z)(t,e);var n=t.prototype;return n.rotateBeamToAngleInDegree=function(e,t){Phaser.Actions.RotateAroundDistance([e],this.pivot,t*Math.PI/180,e.height/2+30);var n=180*Math.atan2(e.y-this.pivot.y,e.x-this.pivot.x)/Math.PI;e.angle=n+90+180},n.createBeamsPivot=function(){this.pivot=this.scene.add.image(0,0,zp,Yp.ADD_SQUARE),this.add(this.pivot),this.pivot.kill(),Phaser.Display.Align.In.Center(this.pivot,this,0,-this.height/2-30)},n.createBeams=function(){this.beamAxis=this.scene.add.image(0,0,zp,Yp.BEAM.AXIS),this.beamFirstFromLeft=this.scene.add.image(0,0,zp,Yp.BEAM.AXIS),this.beamSecondFromLeft=this.scene.add.image(0,0,zp,Yp.BEAM.AXIS),this.beamThirdFromLeft=this.scene.add.image(0,0,zp,Yp.BEAM.AXIS),this.beamFirstFromRight=this.scene.add.image(0,0,zp,Yp.BEAM.AXIS),this.beamSecondFromRight=this.scene.add.image(0,0,zp,Yp.BEAM.AXIS),this.beamThirdFromRight=this.scene.add.image(0,0,zp,Yp.BEAM.AXIS);var e=[this.beamAxis,this.beamFirstFromLeft,this.beamSecondFromLeft,this.beamThirdFromLeft,this.beamFirstFromRight,this.beamSecondFromRight,this.beamThirdFromRight];this.setWorldSizeImages(52,295,e),e.forEach((function(e){e.setAlpha(.6)})),this.add(e)},n.alignBeams=function(){this.rotateBeamToAngleInDegree(this.beamAxis,Xp.AXIS),this.rotateBeamToAngleInDegree(this.beamFirstFromLeft,Xp.FIRST_FROM_LEFT),this.rotateBeamToAngleInDegree(this.beamSecondFromLeft,Xp.SECOND_FROM_LEFT),this.rotateBeamToAngleInDegree(this.beamThirdFromLeft,Xp.THIRD_FROM_LEFT),this.rotateBeamToAngleInDegree(this.beamFirstFromRight,Xp.FIRST_FROM_RIGHT),this.rotateBeamToAngleInDegree(this.beamSecondFromRight,Xp.SECOND_FROM_RIGHT),this.rotateBeamToAngleInDegree(this.beamThirdFromRight,Xp.THIRD_FROM_RIGHT)},n.setWorldSizeImages=function(e,t,n){n.forEach((function(n){return n.setWorldSize(e,t)}))},n.playAnimation=function(){var e=this;[this.beamFirstFromLeft,this.beamSecondFromLeft,this.beamThirdFromLeft,this.beamAxis,this.beamThirdFromRight,this.beamSecondFromRight,this.beamFirstFromRight].forEach((function(t,n){e.scene.tweens.add({targets:t,props:{alpha:{from:.2,to:.6}},duration:700,delay:700*n,repeat:-1,yoyo:!0})}))},n.addBackground=function(){var e="win-beams-background";if(!this.scene.textures.exists(e)){var t=this.width,n=this.height,i=this.scene.add.graphics();i.fillStyle(65280,.2),i.fillRect(0,0,t,n),i.generateTexture(e,t,n),i.destroy()}var a=this.scene.add.image(0,0,e);this.add(a)},t}(Phaser.GameObjects.Container),qp=n(376),Qp=n.n(qp);function $p(e,t){var n="undefined"!==typeof wo()&&Po()(e)||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){var n;if(!e)return;if("string"===typeof e)return eg(e,t);var i=s()(n=Object.prototype.toString.call(e)).call(n,8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return a()(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return eg(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function eg(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var tg=Ds.Z.GAMEPLAY_DEFAULT,ng=tg.KEY,ig=tg.FRAME,ag=ig.FLAG.LEFT,rg=function(e){function t(t){var n;return(n=e.call(this,t)||this).flags=[],n.string=void 0,n.tweens=[],n.flagsData=[],n.setSize(230.5,136),n.createString(),n.createFlags(),n}(0,ot.Z)(t,e);var n=t.prototype;return n.createFlags=function(){var e=this,t=this.scene.add.image(0,0,ng,ag+"1");t.setWorldSize(35.5,15.5),Phaser.Display.Align.In.TopLeft(t,this,-180.5,0);var n=this.scene.add.image(0,0,ng,ag+"2");n.setWorldSize(33.5,37),Phaser.Display.Align.In.TopLeft(n,this,-153,-2);var i=this.scene.add.image(0,0,ng,ag+"3");i.setWorldSize(32,38),Phaser.Display.Align.In.TopLeft(i,this,-124.5,-23);var a=this.scene.add.image(0,0,ng,ag+"4");a.setWorldSize(30,38.5),Phaser.Display.Align.In.TopLeft(a,this,-94,-40.25);var r=this.scene.add.image(0,0,ng,ag+"5");r.setWorldSize(28,38.5),Phaser.Display.Align.In.TopLeft(r,this,-63.235,-56);var s=this.scene.add.image(0,0,ng,ag+"6");s.setWorldSize(28.5,38.5),Phaser.Display.Align.In.TopLeft(s,this,-31.07,-68.5);var o=this.scene.add.image(0,0,ng,ag+"7");o.setWorldSize(29.5,38.5),Phaser.Display.Align.In.TopLeft(o,this,2,-79),this.flags=[t,n,i,a,r,s,o],this.add(Qp()(this)),Qp()(this).forEach((function(t){var n=t.x,i=t.y,a=t.angle;e.flagsData.push({x:n,y:i,angle:a})}))},n.createString=function(){this.string=this.scene.add.image(0,0,ng,ig.STRING.LEFT),this.string.setWorldSize(215.5,96.5),this.add(this.string),Phaser.Display.Align.In.TopLeft(this.string,this)},n.addBackground=function(){var e="lb-background";if(!this.scene.textures.exists(e)){var t=this.width,n=this.height,i=this.scene.add.graphics();i.fillStyle(65280,.2),i.fillRect(0,0,t,n),i.generateTexture(e,t,n),i.destroy()}var a=this.scene.add.image(0,0,e);this.add(a)},n.playWavingAnimation=function(){var e,t=this;if(!(this.tweens.length>0)){for(var n,i=$p(this.tweens);!(n=i()).done;){if(n.value.isPlaying())return}z()(e=Qp()(this)).call(e,(function(e,n){var i=t.flagsData[n],a=i.x,r=i.y,s=i.angle;t.scene.add.tween({targets:e,duration:300,props:{x:{from:a,to:a-2},y:{from:r,to:r-1},angle:{from:s,to:s+5}},yoyo:!0,delay:50*n,repeat:-1})}))}},n.stopWavingAnimation=function(){var e=this;if(0!==this.tweens.length){for(var t,n=$p(this.tweens);!(t=n()).done;){t.value.stop()}this.tweens=[],Qp()(this).forEach((function(t,n){e.scene.tweens.killTweensOf(t),t.x=e.flagsData[n].x,t.y=e.flagsData[n].y,t.angle=e.flagsData[n].angle}))}},t}(Phaser.GameObjects.Container);function sg(e,t){var n="undefined"!==typeof wo()&&Po()(e)||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){var n;if(!e)return;if("string"===typeof e)return og(e,t);var i=s()(n=Object.prototype.toString.call(e)).call(n,8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return a()(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return og(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function og(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var cg=Ds.Z.GAMEPLAY_DEFAULT,ug=cg.KEY,lg=cg.FRAME,hg=lg.FLAG.RIGHT,dg=function(e){function t(t){var n;return(n=e.call(this,t)||this).flags=[],n.string=void 0,n.tweens=[],n.flagsData=[],n.setSize(218,123.5),n.createString(),n.createFlags(),n}(0,ot.Z)(t,e);var n=t.prototype;return n.createFlags=function(){var e=this,t=this.scene.add.image(0,0,ug,hg+"1");t.setWorldSize(30.5,26),this.alignTopLeft(t,44.5,26);var n=this.scene.add.image(0,0,ug,hg+"2");n.setWorldSize(29,32.5),this.alignTopLeft(n,93,60.5);var i=this.scene.add.image(0,0,ug,hg+"3");i.setWorldSize(27,33),this.alignTopLeft(i,145.5,95.5);var a=this.scene.add.image(0,0,ug,hg+"4");a.setWorldSize(25.5,33.5),this.alignTopLeft(a,199,124.5);var r=this.scene.add.image(0,0,ug,hg+"5");r.setWorldSize(24,33.5),this.alignTopLeft(r,256.5,152);var s=this.scene.add.image(0,0,ug,hg+"6");s.setWorldSize(25,33.5),this.alignTopLeft(s,311,173.5);var o=this.scene.add.image(0,0,ug,hg+"7");o.setWorldSize(25.5,33),this.alignTopLeft(o,367.5,189.5);var c=this.scene.add.image(0,0,ug,hg+"8");c.setWorldSize(25.5,32),this.alignTopLeft(c,418,201,-3),this.flags=[t,n,i,a,r,s,o,c],this.add(Qp()(this)),Qp()(this).forEach((function(t){var n=t.x,i=t.y,a=t.angle;e.flagsData.push({x:n,y:i,angle:a})}))},n.createString=function(){this.string=this.scene.add.image(0,0,ug,lg.STRING.RIGHT),this.string.setWorldSize(209,91.5),this.add(this.string),Phaser.Display.Align.In.TopRight(this.string,this)},n.alignTopLeft=function(e,t,n,i,a){void 0===i&&(i=0),void 0===a&&(a=0),Phaser.Display.Align.In.TopLeft(e,this,-(t-e.width)/2+i,-(n-e.height)/2+a)},n.addBackground=function(){var e="rb-background";if(!this.scene.textures.exists(e)){var t=this.width,n=this.height,i=this.scene.add.graphics();i.fillStyle(65280,.2),i.fillRect(0,0,t,n),i.generateTexture(e,t,n),i.destroy()}var a=this.scene.add.image(0,0,e);this.add(a)},n.playWavingAnimation=function(){var e,t=this;if(!(this.tweens.length>0)){for(var n,i=sg(this.tweens);!(n=i()).done;){if(n.value.isPlaying())return}z()(e=Qp()(this)).call(e,(function(e,n){var i=t.flagsData[n],a=i.x,r=i.y,s=i.angle,o=t.scene.add.tween({targets:e,duration:300,props:{x:a+2,y:r-1,angle:s-5},yoyo:!0,delay:50*n,repeat:-1});t.tweens.push(o)}))}},n.stopWavingAnimation=function(){var e=this;if(0!==this.tweens.length){for(var t,n=sg(this.tweens);!(t=n()).done;){t.value.stop()}this.tweens=[],Qp()(this).forEach((function(t,n){e.scene.tweens.killTweensOf(t),t.x=e.flagsData[n].x,t.y=e.flagsData[n].y,t.angle=e.flagsData[n].angle}))}},t}(Phaser.GameObjects.Container),fg=function(e){function t(t){var n;return(n=e.call(this,t)||this).leftBunting=void 0,n.rightBunting=void 0,n.leftBuntingInitialPosition=void 0,n.rightBuntingInitialPosition=void 0,n.setSize(375,136),n.createLeftBunting(),n.createRightBunting(),n.moveBelow(n.leftBunting,n.rightBunting),n.leftBuntingInitialPosition={x:n.leftBunting.x,y:n.leftBunting.y},n.rightBuntingInitialPosition={x:n.rightBunting.x,y:n.rightBunting.y},n}(0,ot.Z)(t,e);var n=t.prototype;return n.createLeftBunting=function(){var e=new rg(this.scene);this.add(e),Phaser.Display.Align.In.TopLeft(e,this),this.leftBunting=e},n.createRightBunting=function(){var e=new dg(this.scene);this.add(e),Phaser.Display.Align.In.TopRight(e,this),this.rightBunting=e},n.hideContent=function(){this.leftBunting.setPosition(this.leftBuntingInitialPosition.x-50,this.leftBuntingInitialPosition.y+-100),this.rightBunting.setPosition(this.rightBuntingInitialPosition.x+50,this.rightBuntingInitialPosition.y+-100)},n.runEntranceAnimation=function(){var e=(0,st.Z)(ut().mark((function e(){var t,n,i=this;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return 50,-100,t=new(xe())((function(e){new Jd({targets:[i.leftBunting],ease:Phaser.Math.Easing.Back.Out,props:{y:{from:i.leftBuntingInitialPosition.y+-100,to:i.leftBuntingInitialPosition.y},x:{from:i.leftBuntingInitialPosition.x-50,to:i.leftBuntingInitialPosition.x}},duration:300,onComplete:e}).play()})),n=new(xe())((function(e){new Jd({targets:[i.rightBunting],ease:Phaser.Math.Easing.Back.Out,props:{y:{from:i.rightBuntingInitialPosition.y+-100,to:i.rightBuntingInitialPosition.y},x:{from:i.rightBuntingInitialPosition.x+50,to:i.rightBuntingInitialPosition.x}},duration:300,onComplete:e}).play()})),e.next=6,xe().all([t,n]);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),n.playWavingAnimation=function(){this.leftBunting.playWavingAnimation(),this.rightBunting.playWavingAnimation()},n.stopWavingAnimation=function(){this.leftBunting.stopWavingAnimation(),this.rightBunting.stopWavingAnimation()},t}(Phaser.GameObjects.Container),pg="Global",gg="Friends",mg="You",vg=375,yg={WIDTH:375,HEIGHT:50},bg={WIDTH:342,HEIGHT:28},Sg=4,Tg={WIDTH:303,HEIGHT:126},Eg={WIDTH:375,HEIGHT:68},Cg=4937547,Ag=.5,wg={OutOfMoves:{SCREEN:"OUT_OF_MOVES_SCREEN_FILTER",POPUP:"OUT_OF_MOVES_POPUP_FILTER"},Challenge:{SCREEN:"CHALLENGE_SCREEN_FILTER",POPUP:"CHALLENGE_POPUP_FILTER"}},Ig=function(e){function t(t,n,i,a,r,s){var o;return(o=e.call(this,t,n,i)||this).icon=void 0,o.text=void 0,o.createIcon(a,r),o.createText(s),o.add([o.icon,o.text]),o}(0,ot.Z)(t,e);var n=t.prototype;return n.createIcon=function(e,t){this.icon=this.scene.add.image(0,-10,e,t).setTint(16579837),this.icon.setWorldSize(28,28)},n.createText=function(e){this.text=this.scene.make.bitmapText({font:Go.Z.PRIMARY.KEY,size:this.scene.fontSize(cd.FOOTER),text:e,origin:{x:.5,y:.5},y:14}).setTint(13355979)},t}(Ho.Z),Pg=Ds.Z.GAMEPLAY_DEFAULT,kg=Pg.KEY,xg=Pg.FRAME,_g=function(e){function t(t){var n;return(n=e.call(this,t,40,40,kg,xg.IC_SETTINGS,"Settings")||this).onClick=function(){t.screen.open(As.o4.SETTINGS_SCREEN)},n}return(0,ot.Z)(t,e),t}(Ig),Og=Ds.Z.GAMEPLAY_DEFAULT,Dg=Og.KEY,Bg=Og.FRAME,Lg=function(e){function t(t){return e.call(this,t,40,40,Dg,Bg.CUP,"Tournaments")||this}return(0,ot.Z)(t,e),t}(Ig),Rg=Eg,Gg=Rg.WIDTH,Ng=Rg.HEIGHT,Mg=function(e){function t(t,n,i){var a;return void 0===n&&(n=!1),void 0===i&&(i=As.o4.TOURNAMENTS_SCREEN),(a=e.call(this,t)||this).scene=void 0,a.settingsButton=void 0,a.tournamentsButton=void 0,a.buttons=[],a.parentScreenKeys=void 0,a.scene=t,a.parentScreenKeys=i,a.setSize(Gg,Ng),n&&a.createBackgroundMask(),a.createBackground(),a.createButtons(),a}(0,ot.Z)(t,e);var n=t.prototype;return n.createBackgroundMask=function(){var e=this.scene.world.getPixelRatio(),t=this.scene.gameZone,n=t.width,i=t.height,a=this.scene.ads.getBannerHeight(),r=this.scene.theme.getCurrentThemeConfig().backgroundKey,s=this.scene.add.image(0,a+this.height/2,r);s.setOrigin(.5,1),s.setWorldSize(n,i),s.setCrop(0,667*e-(76+a)/s.scaleY,this.width*e,i*e),s.setAlpha(1),this.add(s),this.scene.events.on(es.BACKGROUND_CHANGED,(function(e){s.setTexture(e)}))},n.createBackground=function(){var e=this.scene.gameZone.width>Gg?20:0,t=new Qd.Z(this.scene,0,0,this.width,this.height,e,2039583,.4);this.add(t),t.removeInteractive()},n.createButtons=function(){this.buttons=[],this.createSettingsButton(),this.createTournamentsButton(),this.alignButtons()},n.createSettingsButton=function(){this.settingsButton=new _g(this.scene),this.add(this.settingsButton),this.buttons.push(this.settingsButton)},n.createTournamentsButton=function(){this.tournamentsButton=new Lg(this.scene),this.add(this.tournamentsButton),this.buttons.push(this.tournamentsButton)},n.alignButtons=function(){if(0!==this.buttons.length)for(var e=this.width/this.buttons.length,t=0;t<this.buttons.length;++t)this.buttons[t].setX((t-this.buttons.length/2+.5)*e),this.buttons[t].setY(2)},t}(Phaser.GameObjects.Container),Fg=Ds.Z.GAMEPLAY_DEFAULT,Ug=Fg.KEY,Zg=Fg.FRAME,Hg=function(e){function t(t){var n,i=(n=e.call(this,t)||this).scene.ads.getBannerHeight();return n.setSize(375,i),n.createBackground(),n.createLogo(),n}(0,ot.Z)(t,e);var n=t.prototype;return n.createBackground=function(){var e=this.scene.ads.getBannerHeight(),t=this.scene.add.image(0,0,Ug,Zg.BOTTOM_BG);t.setWorldSize(375,e),Phaser.Display.Align.In.BottomCenter(t,this),t.setDepth(fc.Z.FOOTER_LOGO),this.add(t)},n.createLogo=function(){var e=this.scene.ads.getBannerHeight(),t=this.scene.add.image(0,0,Ug,Zg.BOTTOM_LOGO);t.setWorldSize(325.5,34.5),Phaser.Display.Align.In.BottomCenter(t,this,0,21-e/2),t.setDepth(fc.Z.FOOTER_LOGO),this.add(t)},t}(Phaser.GameObjects.Container),Wg=function(e){function t(t,n,i,a){var r;return(r=e.call(this,t,n,i,a)||this).scene=void 0,r.fadeInAnimation=void 0,r.fadeOutAnimation=void 0,r.slideInAnimation=void 0,r.awesomeContainer=void 0,r.beams=void 0,r.bunting=void 0,r.footer=void 0,r.closed=!1,r.handleClickTournaments=function(){r.scene.time.delayedCall(100,(function(){r.closed||r.close()}))},r.setBackground=function(){var e=r.scene.theme.getCurrentThemeConfig().backgroundKey;r.background.setTexture(e);var t=r.scene.gameZone,n=t.width,i=t.height;r.background.setWorldSize(n,i),r.scene.events.on(es.BACKGROUND_CHANGED,(function(e){r.background.setTexture(e)}))},r.scene=t,r.setBackground(),r.createAwesomeContainer(),r.createBeams(),r.createBuntings(),r.createFooter(),r.createBottomLogo(),r.setDepth(As.Ks.POPUP),r}(0,ot.Z)(t,e);var n=t.prototype;return n.createAwesomeContainer=function(){this.awesomeContainer=new Hp(this.scene),this.add(this.awesomeContainer)},n.createBeams=function(){this.beams=new Jp(this.scene),this.add(this.beams),Phaser.Display.Align.In.TopCenter(this.beams,this)},n.createBuntings=function(){this.bunting=new fg(this.scene),this.add(this.bunting),Phaser.Display.Align.In.TopCenter(this.bunting,this)},n.createFooter=function(){var e=this;this.footer=new Mg(this.scene,!1,As.o4.VICTORY_SCREEN),this.add(this.footer),this.bringToTop(this.footer),this.footer.setInteractive();var t=this.scene.ads.getBannerHeight(),n=this.scene.gameZone.width>375?-20:0;Phaser.Display.Align.In.BottomCenter(this.footer,this.background,0,-t+n),this.footer.tournamentsButton.onClick=function(){e.scene.events.off(es.GAME_START,e.handleClickTournaments),e.scene.events.once(es.GAME_START,e.handleClickTournaments),e.stopConfettiAnimation(),e.scene.gameplay.confettiSmallFallDown.emitter.killAll(),e.scene.screen.open(As.o4.TOURNAMENTS_SCREEN)}},n.createBottomLogo=function(){if(!this.scene.game.world.isLandscape()){var e=new Hg(this.scene);this.add(e),Phaser.Display.Align.In.BottomCenter(e,this)}},n.open=function(t){e.prototype.open.call(this,t),this.closed=!1,this.updateVictoryStats(),this.awesomeContainer.setAlpha(1),this.awesomeContainer.setInteractive(),this.background.setAlpha(1),this.runOpenAnimation(),this.scene.children.bringToTop(this.scene.gameplay.confettiSmallFallDown),this.scene.gameplay.confettiSmallFallDown.run(8,0,0)},n.close=function(){this.closed=!0,this.runCloseAnimation(),this.stopConfettiAnimation()},n.closeWithoutAnimation=function(){this.closed=!0,this.alpha=0,this.stopConfettiAnimation(),this.scene.gameplay.confettiSmallFallDown.emitter.killAll(),e.prototype.close.call(this)},n.updateVictoryStats=function(){var e,t=null==(e=this.data)?void 0:e.list;if(t){var n=t,i=n.score,a=n.suitSize,r=n.difficulty,s=n.currentMoves,o=n.playedTime,c=this.scene.gameStats.getGameStats(a,r).bestWinningTime;this.awesomeContainer.setScore(""+i),this.awesomeContainer.setMoves(""+s),this.awesomeContainer.setWinningTime((0,Rn.F0)(o,!1)),this.awesomeContainer.setBestWinningTime((0,Rn.F0)(c,!1)),this.awesomeContainer.setGameText(a,r)}},n.runOpenAnimation=function(){var e=(0,st.Z)(ut().mark((function e(){var t,n,i,a=this;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==(t=this.slideInAnimation)||null==(n=t.tween)||!n.isPlaying()){e.next=2;break}return e.abrupt("return");case 2:return this.scene.audio.playSound(Bt.POPUP_SHOW),i=this.scene.ads.getBannerHeight(),this.awesomeContainer.setAlpha(0),this.awesomeContainer.y=i,this.awesomeContainer.hideContent(),this.bunting.stopWavingAnimation(),this.slideInAnimation||(this.slideInAnimation=new Jd({targets:[this.awesomeContainer],ease:Phaser.Math.Easing.Back.Out,props:{y:{from:i,to:-i/2},alpha:{from:0,to:1}},duration:300,onComplete:function(){var e=(0,st.Z)(ut().mark((function e(){return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.awesomeContainer.runEntranceAnimation();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()})),this.fadeInAnimation||(this.fadeInAnimation=new Kd.Z({targets:[this],duration:300})),this.fadeInAnimation.play(),e.next=13,this.bunting.runEntranceAnimation();case 13:this.bunting.playWavingAnimation(),this.slideInAnimation.play();case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runCloseAnimation=function(){var t,n,i=this;null!=(t=this.fadeOutAnimation)&&null!=(n=t.tween)&&n.isPlaying()||(this.scene.audio.playSound(Bt.POPUP_OFF),this.fadeOutAnimation||(this.fadeOutAnimation=new qd.Z({targets:[this],props:{alpha:0},duration:300,onComplete:function(){e.prototype.close.call(i)}})),this.fadeOutAnimation.play(),this.bunting.stopWavingAnimation())},n.stopConfettiAnimation=function(){this.scene.gameplay.confettiSmallFallDown.emitter.stop()},t}(GameCore.Screen),zg=Wg,Yg=Ds.Z.GAMEPLAY_DEFAULT,Vg=Yg.KEY,Kg=Yg.FRAME,jg=143.5,Xg=function(e){function t(t){var n;return(n=e.call(this,t)||this).bg=void 0,n.score=void 0,n.time=void 0,n.bestTime=void 0,n.moves=void 0,n.draw=void 0,n.lines=[],n.buttons=[],n.createBackground(),n.createTitle(),n.createStats(),n.createNewGameButton(),n.createReplayButton(),n.createDevButtons(),t.add.existing((0,Cs.Z)(n)),n}(0,ot.Z)(t,e);var n=t.prototype;return n.setScore=function(e){this.score.setValue(e)},n.setWinningTime=function(e){this.time.setValue(e)},n.setBestWinningTime=function(e){this.bestTime.setValue(e)},n.setMoves=function(e){this.moves.setValue(e)},n.setGameText=function(e,t){var n="One suit";switch(e){case"two":n="Two suits";break;case"four":n="Four suits"}var i=", "+t+" difficulty";this.setDraw(""+n+i)},n.setDraw=function(e){this.draw.setText(e)},n.createBackground=function(){this.setSize(343,374);var e=new Jo(this.scene,{key:"_outOfMoves",radius:6,border:24,width:343,height:374});this.bg=e,this.add(e),this.bg.setPipeline("Grayscale")},n.createTitle=function(){var e=this.scene.make.bitmapText({font:Go.Z.BOLD.KEY,size:this.scene.fontSize(24),text:"Out of moves!",origin:{x:.5,y:.5}});e.setTint(16777215),this.add(e),Phaser.Display.Align.In.TopCenter(e,this,0,-20);var t=this.scene.make.bitmapText({font:Go.Z.PRIMARY.KEY,size:this.scene.fontSize(16),text:"Standard mode, Draw 1",origin:{x:.5,y:.5}});t.setTint(16777215),this.draw=t,this.add([t]),Phaser.Display.Align.To.BottomCenter(t,e,0,8)},n.createStats=function(){var e=[],t=new Op(this.scene);t.setIcon(Vg,Kg.MEDAL_STAR),t.setLabel("Score"),t.setValue("687"),this.score=t,e.push(t);var n=new Op(this.scene);n.setIcon(Vg,Kg.ARROW_SWAP_HORIZONTAL),n.setLabel("Moves"),n.setValue("798"),this.moves=n,e.push(n);var i=new Op(this.scene);i.setIcon(Vg,Kg.TIMER),i.setLabel("Time"),i.setValue("09:48"),this.time=i,e.push(i);var a=new Op(this.scene);a.setIcon(Vg,Kg.CUP),a.setLabel("Best time"),a.setValue("05:30"),this.bestTime=a,e.push(a),this.add(e);for(var r=0;r<e.length;r++){var s=e[r];if(s.alignProperties(),Phaser.Display.Align.In.TopCenter(s,this,0,-(50*r+112)),r==e.length-1)break;var o=this.scene.add.line(0,0,0,0,271,0,16579837,.2);this.add(o),this.lines.push(o),Phaser.Display.Align.To.BottomCenter(o,s,0,12)}},n.createNewGameButton=function(){var e=this,t=new $d.Z(this.scene,143.5,48,16,16777215);t.onClick=(0,st.Z)(ut().mark((function t(){return ut().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e.scene instanceof Nb)){t.next=3;break}return t.next=3,e.scene.handlePlayWithFriend(!0);case 3:e.scene.screen.close(As.o4.NO_MORE_MOVES_SCREEN);case 4:case"end":return t.stop()}}),t)}))),t.setName("NewGame");var n=new Rp(this.scene);t.add(n),Phaser.Display.Align.In.BottomRight(t,this,-16,-18),this.add([t]),this.buttons.push(t),new qo.Z({targets:[t],duration:1e3,props:{scale:"*=1.05"}}).play()},n.createReplayButton=function(){var e=this,t=new $d.Z(this.scene,143.5,48,16,16777215);t.button.setAlpha(.24),t.button.setStrokeStyle(1,16777215),t.onClick=function(){e.scene instanceof Nb&&(console.log("replay"),e.scene.gameplay.replayGame(!0)),e.scene.screen.close(As.o4.NO_MORE_MOVES_SCREEN)},t.setName("Replay");var n=this.scene.add.graphics();n.lineStyle(1,16777215),n.strokeRoundedRect(-71.75,-24,jg,48,16);var i=new Rp(this.scene,8,"Replay",Kg.IC_REPLAY);i.clearTint(),i.getIcon().setTintFill(16777215),t.add([n,i]).setSize(jg,48),Phaser.Display.Align.In.BottomLeft(t,this.bg,-16,-18),this.add([t]),this.buttons.push(t)},n.createDevButtons=function(){GameCore.Utils.Valid.isDebugger()&&this.createCloseButton()},n.createCloseButton=function(){var e=this,t=new Ho.Z(this.scene,40,40),n=this.scene.add.image(0,0,Vg,Kg.IC_BG_OFF);n.setWorldSize(40,40);var i=this.scene.make.bitmapText({font:Go.Z.PRIMARY.KEY,size:this.scene.fontSize(10),text:"Close",origin:{x:.5,y:.5}});i.setCenterAlign(),t.add([n,i]),this.add(t),Phaser.Display.Align.In.BottomLeft(t,this,0,-200),t.onClick=function(){e.scene.screen.close(As.o4.NO_MORE_MOVES_SCREEN)}},n.hideContent=function(){[this.score,this.moves,this.time,this.bestTime].forEach((function(e){return e.setAlpha(0)})),this.lines.forEach((function(e){e.setAlpha(0),e.scaleX=0})),this.buttons.forEach((function(e){e.setAlpha(0)}))},n.runEntranceAnimationButtons=function(){var e=(0,st.Z)(ut().mark((function e(){var t,n,i=this;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=z()(t=this.buttons).call(t,(function(e){return new(xe())((function(t){i.scene.add.tween({targets:[e],alpha:1,duration:200,onComplete:function(){e.setDisabled(!1),t()}})}))})),e.next=3,xe().all(n);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runEntranceAnimationRows=function(){var e=(0,st.Z)(ut().mark((function e(){var t,n,i=this;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[this.score,this.moves,this.time,this.bestTime],200,n=z()(t).call(t,(function(e,t){return new(xe())((function(n){i.scene.add.tween({targets:[e],duration:200,delay:200*t/2,ease:Phaser.Math.Easing.Sine.Out,props:{alpha:{from:0,to:1},y:{from:e.y+e.height/2,to:e.y}},onComplete:n})}))})),e.next=5,xe().all(n);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runEntranceAnimationLines=function(){var e=(0,st.Z)(ut().mark((function e(){var t,n,i=this;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return 200,n=z()(t=this.lines).call(t,(function(e,t){return new(xe())((function(n){i.scene.add.tween({targets:[e],duration:200,delay:200*t/2,props:{alpha:{from:0,to:1},scaleX:{from:0,to:1}},onComplete:n})}))})),e.next=4,xe().all(n);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runEntranceAnimationRowsLines=function(){var e=(0,st.Z)(ut().mark((function e(){return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,xe().all([this.runEntranceAnimationRows(),this.runEntranceAnimationLines()]);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runEntranceAnimation=function(){var e=(0,st.Z)(ut().mark((function e(){return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.runEntranceAnimationRowsLines();case 2:return e.next=4,this.runEntranceAnimationButtons();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t}(Phaser.GameObjects.Container),Jg=Xg,qg=Ds.Z.GAMEPLAY_DEFAULT,Qg=qg.KEY,$g=qg.FRAME,em=function(e){function t(t){var n;return(n=e.call(this,t)||this).leftLightning=void 0,n.middleLightning=void 0,n.rightLightning=void 0,n.initialLeftX=void 0,n.initialLeftY=void 0,n.initialMidX=void 0,n.initialMidY=void 0,n.initialRightX=void 0,n.initialRightY=void 0,n.setSize(374,416),n.createLightnings(),n.alignLightnings(),n.initialLeftX=n.leftLightning.x,n.initialLeftY=n.leftLightning.y,n.initialMidX=n.middleLightning.x,n.initialMidY=n.middleLightning.y,n.initialRightX=n.rightLightning.x,n.initialRightY=n.rightLightning.y,n}(0,ot.Z)(t,e);var n=t.prototype;return n.createLightnings=function(){this.createLeftLightning(),this.createMiddleLightning(),this.createRightLightning();var e=[this.leftLightning,this.middleLightning,this.rightLightning];e.forEach((function(e){return e.setAlpha(.2)})),this.add(e)},n.createLeftLightning=function(){this.leftLightning=this.scene.add.image(0,0,Qg,$g.LIGHTNING.LEFT),this.leftLightning.setWorldSize(182.5,180)},n.createMiddleLightning=function(){this.middleLightning=this.scene.add.image(0,0,Qg,$g.LIGHTNING.MIDDLE),this.middleLightning.setWorldSize(106,125.5)},n.createRightLightning=function(){this.rightLightning=this.scene.add.image(0,0,Qg,$g.LIGHTNING.RIGHT),this.rightLightning.setWorldSize(130.5,116)},n.alignLightnings=function(){Phaser.Display.Align.In.TopLeft(this.leftLightning,this,0,-60.28),Phaser.Display.Align.In.TopRight(this.middleLightning,this,-125.92,0),Phaser.Display.Align.In.TopRight(this.rightLightning,this,-9.23,-55.4)},n.hideContent=function(){var e=0,t=-300;[this.leftLightning,this.middleLightning,this.rightLightning].forEach((function(n){n.setPosition(e,t).setAlpha(0)}))},n.runEntranceAnimation=function(){var e=(0,st.Z)(ut().mark((function e(){var t,n,i,a,r,s=this;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={x:0,y:-300},n=new(xe())((function(e){new Jd({targets:[s.leftLightning],ease:Phaser.Math.Easing.Cubic.Out,props:{x:{from:t.x,to:s.initialLeftX},y:{from:t.y,to:s.initialLeftY},alpha:{from:0,to:.2}},duration:150,onComplete:e}).play()})),i=new(xe())((function(e){new Jd({targets:[s.rightLightning],ease:Phaser.Math.Easing.Cubic.Out,props:{x:{from:t.x,to:s.initialRightX},y:{from:t.y,to:s.initialRightY},alpha:{from:0,to:.2}},duration:250,onComplete:e}).play()})),a=new(xe())((function(e){new Jd({targets:[s.middleLightning],ease:Phaser.Math.Easing.Cubic.Out,props:{x:{from:t.x,to:s.initialMidX},y:{from:t.y,to:s.initialMidY},alpha:{from:0,to:.2}},duration:300,onComplete:e}).play()})),e.next=6,xe().all([n,a,i]);case 6:return r=[this.leftLightning,this.middleLightning,this.rightLightning],e.next=9,new(xe())((function(e){s.scene.add.tween({targets:r,props:{alpha:.4},yoyo:!0,duration:100,onComplete:e})}));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t}(Phaser.GameObjects.Container),tm=Ds.Z.GAMEPLAY_DEFAULT,nm=tm.KEY,im=tm.FRAME,am=10.4,rm=30.5,sm=50.5,om={FIRST_FROM_LEFT:am,SECOND_FROM_LEFT:rm,THIRD_FROM_LEFT:sm,FIRST_FROM_RIGHT:-am,SECOND_FROM_RIGHT:-rm,THIRD_FROM_RIGHT:-sm},cm=function(e){function t(t){var n;return(n=e.call(this,t)||this).pivot=void 0,n.beams=[],n.setSize(375,415.5),n.createBeamsPivot(),n.createBeams(),n.playAnimation(),n}(0,ot.Z)(t,e);var n=t.prototype;return n.createBeams=function(){for(var e=0,t=M()(om);e<t.length;e++){var n=t[e],i=om[n],a=this.scene.add.image(0,0,nm,im.BEAM.LOSE_AXIS);a.setWorldSize(65.5,533),this.add(a),this.beams.push(a),this.rotateBeamToAngleInDegree(a,i)}},n.playAnimation=function(){var e=this;this.beams.forEach((function(t,n){e.scene.tweens.add({targets:t,props:{alpha:{from:.2,to:.4}},duration:700,delay:700*n,repeat:-1,yoyo:!0})}))},n.createBeamsPivot=function(){this.pivot=this.scene.add.image(0,0,nm,im.ADD_SQUARE),this.add(this.pivot),this.pivot.kill(),Phaser.Display.Align.In.Center(this.pivot,this,0,-this.height/2-148.2)},n.rotateBeamToAngleInDegree=function(e,t){Phaser.Actions.RotateAroundDistance([e],this.pivot,t*Math.PI/180,e.height/2);var n=180*Math.atan2(e.y-this.pivot.y,e.x-this.pivot.x)/Math.PI;e.angle=n+90+180},t}(Phaser.GameObjects.Container),um=function(e){function t(t,n,i,a){var r;return(r=e.call(this,t,n,i,a)||this).scene=void 0,r.fadeInAnimation=void 0,r.fadeOutAnimation=void 0,r.slideInAnimation=void 0,r.outOfMovesContainer=void 0,r.lightnings=void 0,r.beams=void 0,r.footer=void 0,r.closed=!1,r.handleClickTournaments=function(){r.scene.time.delayedCall(100,(function(){r.closed||r.close()}))},r.setBackground=function(){var e=r.scene.theme.getCurrentThemeConfig().backgroundKey;r.background.setTexture(e);var t=r.scene.gameZone,n=t.width,i=t.height;r.background.setWorldSize(n,i),r.background.setPipeline("Grayscale"),r.scene.events.on(es.BACKGROUND_CHANGED,(function(e){r.background.setTexture(e)}))},r.scene=t,r.setBackground(),r.createOutOfMovesContainer(),r.createLightnings(),r.createBeams(),r.createFooter(),r.createBottomLogo(),r.setDepth(As.Ks.POPUP),r}(0,ot.Z)(t,e);var n=t.prototype;return n.createBeams=function(){this.beams=new cm(this.scene),this.add(this.beams),Phaser.Display.Align.In.TopCenter(this.beams,this)},n.createOutOfMovesContainer=function(){this.outOfMovesContainer=new Jg(this.scene),this.add(this.outOfMovesContainer)},n.createLightnings=function(){this.lightnings=new em(this.scene),this.add(this.lightnings),Phaser.Display.Align.In.TopCenter(this.lightnings,this)},n.createFooter=function(){var e=this;this.footer=new Mg(this.scene,!1,As.o4.NO_MORE_MOVES_SCREEN),this.add(this.footer),this.bringToTop(this.footer),this.footer.setInteractive();var t=this.scene.ads.getBannerHeight(),n=this.scene.gameZone.width>375?-20:0;Phaser.Display.Align.In.BottomCenter(this.footer,this.background,0,-t+n),this.footer.tournamentsButton.onClick=function(){e.scene.events.off(es.GAME_START,e.handleClickTournaments),e.scene.events.once(es.GAME_START,e.handleClickTournaments),e.scene.screen.open(As.o4.TOURNAMENTS_SCREEN)}},n.createBottomLogo=function(){if(!this.scene.world.isLandscape()){var e=new Hg(this.scene);this.add(e),Phaser.Display.Align.In.BottomCenter(e,this)}},n.open=function(t){e.prototype.open.call(this,t),this.updateVictoryStats(),this.outOfMovesContainer.setAlpha(1),this.outOfMovesContainer.setInteractive(),this.background.setAlpha(1),this.runOpenAnimation(),this.closed=!1},n.close=function(){this.closed=!0,this.runCloseAnimation()},n.closeWithoutAnimation=function(){this.closed=!0,this.alpha=0,e.prototype.close.call(this)},n.updateVictoryStats=function(){var e,t=null==(e=this.data)?void 0:e.list;if(t){var n=t,i=n.score,a=n.suitSize,r=n.difficulty,s=n.currentMoves,o=n.playedTime,c=this.scene.gameStats.getGameStats(a,r).bestWinningTime;this.outOfMovesContainer.setScore(""+i),this.outOfMovesContainer.setMoves(""+s),this.outOfMovesContainer.setWinningTime((0,Rn.F0)(o,!1)),this.outOfMovesContainer.setBestWinningTime((0,Rn.F0)(c,!1)),this.outOfMovesContainer.setGameText(a,r)}},n.runOpenAnimation=function(){var e=(0,st.Z)(ut().mark((function e(){var t,n,i,a=this;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==(t=this.slideInAnimation)||null==(n=t.tween)||!n.isPlaying()){e.next=2;break}return e.abrupt("return");case 2:return this.scene.audio.playSound(Bt.POPUP_SHOW),i=this.scene.ads.getBannerHeight(),this.outOfMovesContainer.setAlpha(0),this.outOfMovesContainer.y=i,this.outOfMovesContainer.hideContent(),this.slideInAnimation||(this.slideInAnimation=new Jd({targets:[this.outOfMovesContainer],ease:Phaser.Math.Easing.Back.Out,props:{y:{from:i,to:-i/2},alpha:{from:0,to:1}},duration:300,onComplete:function(){var e=(0,st.Z)(ut().mark((function e(){return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.outOfMovesContainer.runEntranceAnimation();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()})),this.fadeInAnimation||(this.fadeInAnimation=new Kd.Z({targets:[this],duration:300})),this.fadeInAnimation.play(),e.next=12,this.lightnings.runEntranceAnimation();case 12:this.slideInAnimation.play();case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runCloseAnimation=function(){var t,n,i=this;null!=(t=this.fadeOutAnimation)&&null!=(n=t.tween)&&n.isPlaying()||(this.scene.audio.playSound(Bt.POPUP_OFF),this.fadeOutAnimation||(this.fadeOutAnimation=new qd.Z({targets:[this],props:{alpha:0},duration:300,onComplete:function(){e.prototype.close.call(i)}})),this.fadeOutAnimation.play())},t}(GameCore.Screen),lm=um,hm=function(e){function t(t){var n;return(n=e.call(this,t)||this).bg=void 0,n.message=void 0,n.createBackground(),n.createMessage(),n.createOKButton(),t.add.existing((0,Cs.Z)(n)),n}(0,ot.Z)(t,e);var n=t.prototype;return n.setMessage=function(e){this.message.setText(e)},n.createBackground=function(){var e=new Qd.Z(this.scene,0,0,340,160,20,16579837);e.setAlpha(.95),this.add(e),this.bg=e,this.setSize(e.width,e.height)},n.createMessage=function(){var e=this.scene.make.bitmapText({font:Go.Z.PRIMARY.KEY,size:this.scene.fontSize(16),text:"Hello, world!",origin:{x:.5,y:.5}});e.setCenterAlign(),e.setTint(1907997),this.add(e),Phaser.Display.Align.In.Center(e,this,0,-24),this.message=e,this.add([e])},n.createOKButton=function(){var e=this,t=new $d.Z(this.scene,300,40,12,3774208);t.setName("OK"),t.onClick=function(){e.scene.screen.close(As.o4.NOTIFICATION_SCREEN)};var n=this.scene.make.bitmapText({font:Go.Z.PRIMARY.KEY,size:this.scene.fontSize(16),text:"OK",origin:{x:.5,y:.5}});n.setTint(16579837),Phaser.Display.Align.In.Center(n,t,0),t.add([n]),Phaser.Display.Align.In.BottomCenter(t,this.bg,0,-16),this.add([t])},t}(Phaser.GameObjects.Container),dm=hm,fm=function(e){function t(t,n,i,a){var r;return(r=e.call(this,t,n,i,a)||this).slideInAnimation=void 0,r.fadeInAnimation=void 0,r.fadeOutAnimation=void 0,r.notificationContainer=void 0,r.setDepth(As.Ks.POPUP),r.notificationContainer=new dm(t),r.add(r.notificationContainer),r}(0,ot.Z)(t,e);var n=t.prototype;return n.open=function(t){var n=this;e.prototype.open.call(this,t);var i=this.data.list.message,a=void 0===i?"":i;this.notificationContainer.setMessage(a),this.notificationContainer.setAlpha(1),this.background.setAlpha(.8),this.notificationContainer.setInteractive();var r=function(){n.scene.screen.close(n.name)};this.background.off(Phaser.Input.Events.POINTER_DOWN,r),this.background.setInteractive().once(Phaser.Input.Events.POINTER_DOWN,r),this.runOpenAnimation()},n.close=function(){this.runCloseAnimation()},n.runOpenAnimation=function(){var e,t;null!=(e=this.fadeInAnimation)&&null!=(t=e.tween)&&t.isPlaying()||(this.scene.audio.playSound(Bt.POPUP_SHOW),this.fadeInAnimation||(this.fadeInAnimation=new Kd.Z({targets:[this],duration:300})),this.fadeInAnimation.play())},n.runCloseAnimation=function(){var t,n,i=this;null!=(t=this.fadeOutAnimation)&&null!=(n=t.tween)&&n.isPlaying()||(this.scene.audio.playSound(Bt.POPUP_OFF),this.fadeOutAnimation||(this.fadeOutAnimation=new qd.Z({targets:[this],props:{alpha:0},duration:300,onComplete:function(){e.prototype.close.call(i)}})),this.fadeOutAnimation.play())},t}(GameCore.Screen),pm=fm,gm=hp.STATUS,mm=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.gameMode=void 0,n.handleGameModeChanged=function(){n.stop(),n.start()},n.scene=t,n.init(),n}(0,ot.Z)(t,e);var n=t.prototype;return n.init=function(){e.prototype.init.call(this),this.gameMode=ts.SINGLE,as.instance.on(es.GAME_MODE_CHANGED,this.handleGameModeChanged)},n.start=function(){if(!this.isRunning()){switch(this.gameMode=as.instance.getGameMode(),console.log("\ud83e\udd16 ? Start game with mode:",this.gameMode),this.gameMode){case ts.SINGLE:this.startSingleMode();break;case ts.TOURNAMENT:this.startTournamentMode();break;case ts.CHALLENGE_FRIENDS:this.startChallengeMode();break;default:this.stopChallengeMode(),this.stopTournamentMode()}this.setState(gm.RUNNING)}},n.stop=function(){switch(console.log("\ud83e\udd16 ? Stop game with mode:",this.gameMode),this.gameMode){case ts.SINGLE:this.stopSingleMode();break;case ts.TOURNAMENT:this.stopTournamentMode();break;case ts.CHALLENGE_FRIENDS:this.stopChallengeMode()}this.setState(gm.STOPPED)},n.startSingleMode=function(){this.scene.header.useSingleInfo()},n.stopSingleMode=function(){},n.startTournamentMode=function(){var e=(0,st.Z)(ut().mark((function e(){var t,n,i,a,r,s,o,c,l;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.scene.header.useTournamentInfo(),e.next=3,this.updateTournamentInfo();case 3:return e.prev=3,n=this.scene.storage.getState(),i=Uu(n),a=Fu(n),console.log("start tournament",{leaderboardId:i,tournamentId:a}),e.next=10,Xu(i,{limit:7}).catch((function(e){return console.warn("get leader board",e,i),[]}));case 10:if(r=e.sent,console.log({leaders:r,leaderboardId:i}),!(r.length<1)){e.next=14;break}return e.abrupt("return");case 14:return s=z()(r).call(r,(function(e){return e.playerId})),e.next=17,this.scene.profile.requestProfiles(s).catch((function(e){console.warn("request profile ids",e)}));case 17:if(o=this.scene.profile.getProfiles(),console.log({profiles:o}),c=z()(r).call(r,(function(e){var t=e.playerId,n=e.score,i=e.rank,a=o[t];if(!a)return null;var r=a.name;return{playerId:t,photo:a.photo,score:n,rank:i,name:r}})),!((l=rr()(t=u()(c).call(c,(function(e){return null!==e}))).call(t,(function(e,t){return t.score-e.score}))).length<1)){e.next=23;break}return e.abrupt("return");case 23:console.log({players:l}),this.scene.analytics.event(Vi._.TOURNAMENT_START,{tournament_id:a,leaderboard_id:i}),e.next=33;break;case 27:if(e.prev=27,e.t0=e.catch(3),!(e.t0 instanceof Wu)){e.next=31;break}return e.abrupt("return");case 31:console.warn({error:e.t0}),(0,at.tO)(e.t0);case 33:case"end":return e.stop()}}),e,this,[[3,27]])})));return function(){return e.apply(this,arguments)}}(),n.updateTournamentInfo=function(){var e=(0,st.Z)(ut().mark((function e(){var t,n,i,a,r;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.scene.storage.getState(),n=Uu(t),e.next=4,Ju(n);case 4:if(e.t0=e.sent,e.t0){e.next=7;break}e.t0={};case 7:i=e.t0,a="Your tournament",GameCore.Utils.Object.hasOwn(i,"name")&&"string"===typeof i.name&&(a=i.name),r=GameCore.Utils.String.removeDiacritics(a||"Your tournament"),console.log("update tournament title",a),this.scene.header.tournamentInfo.titleBlock.tournamentTitle.setText(r);case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.stopTournamentMode=function(){},n.startChallengeMode=function(){this.scene.header.useChallengeInfo();var e=this.scene.header.challengeInfo,t=e.leftBlock,n=e.rightBlock;t.updateData(0,0,0),n.updateData();var i=this.scene.storage.getState(),a=this.scene.player.getPlayer(),r=a.playerId,s=a.photo;t.avatar.loadPhoto(r,s,100);var o=pu(i),c=o.playerId,u=o.photo;n.avatar.loadPhoto(c,u,100);var l=hu(i),h=l.whitePlayerId,d=l.extraData,f=void 0===d?{}:d;console.warn({matchData:l});var p=r===h?f.blackPlayerData:f.whitePlayerData;if(p){var g=p.score,m=p.moves,v=p.time;n.updateData(g,v,m)}},n.stopChallengeMode=function(){},t}(pp),vm=mm,ym=function(e){function t(t){var n;return(n=e.call(this,t,0,0,Go.Z.BOLD.KEY,"Tournaments",t.fontSize(cd.TITLE))||this).setOrigin(.5,.5),n.setTint(15527148),n}return(0,ot.Z)(t,e),t}(Phaser.GameObjects.BitmapText),bm=yg,Sm=bm.WIDTH,Tm=bm.HEIGHT,Em=function(e){function t(t){var n;return(n=e.call(this,t)||this).background=void 0,n.setSize(Sm,Tm),n.createTopBar(),n}(0,ot.Z)(t,e);var n=t.prototype;return n.createTopBar=function(){this.createTitle()},n.createTitle=function(){var e=new ym(this.scene);this.add(e),Phaser.Display.Align.In.LeftCenter(e,this,-12)},t}(Phaser.GameObjects.Container),Cm=Em,Am=16579837,wm=function(e){function t(t,n,i,a){var r;return(r=e.call(this,t)||this).numOfTabs=void 0,r.tabs=void 0,r.currentIdx=0,r.callback=void 0,r.borderLineWidth=1,r.numOfTabs=a,r.setSize(n,i),r.createBg(),r.createTabs(),r.listenInput(),t.add.existing((0,Cs.Z)(r)),r}(0,ot.Z)(t,e);var n=t.prototype;return n.addLabels=function(e){this.add(e);var t=this.width/this.numOfTabs;this.placeCenter(e,0,0,t+1)},n.createBg=function(){var e=this.scene.add.graphics();e.lineStyle(this.borderLineWidth,Am);var t=this.width+this.numOfTabs+this.borderLineWidth,n=this.height+2*this.borderLineWidth;e.strokeRoundedRect(-t/2,-this.height/2-this.borderLineWidth,t,n,6),this.add([e])},n.getTabRadius=function(e){if(1===this.numOfTabs)return 6;switch(e){case 0:return{tl:6,bl:6};case this.numOfTabs-1:return{tr:6,br:6};default:return 0}},n.createTabs=function(){this.tabs=[];for(var e=this.width/this.numOfTabs,t=0;t<this.numOfTabs;t++){var n=this.getTabRadius(t),i=new Qd.Z(this.scene,0,0,e+1,this.height+2,n,this.themeColor);i.setAlpha(0===t?1:0),this.tabs.push(i)}this.add(this.tabs),this.placeCenter(this.tabs,0,0,e+1)},n.placeCenter=function(e,t,n,i,a){void 0===a&&(a=0);for(var r=t-(this.numOfTabs/2-.5-a)*i,s=0;s<e.length;s++)e[s].setPosition(r+s*i,n)},n.getIdx=function(e){var t=this.width/this.tabs.length;return Math.floor((e+this.width/2)/t)},n.listenInput=function(){var e=this,t=!1;this.setInteractive({useHandCursor:!0}).on(Phaser.Input.Events.POINTER_DOWN,(function(){t=!0})).on(Phaser.Input.Events.POINTER_OUT,(function(){t=!1})).on(Phaser.Input.Events.POINTER_UP,(function(n){if(t){var i=e.getLocalPoint(n.worldX,n.worldY).x;e.selectTab(e.getIdx(i))}t=!1}))},n.selectTab=function(e){if(e!=this.currentIdx){this.currentIdx=e,this.callback&&this.callback(e);for(var t=0;t<this.tabs.length;t++)this.scene.tweens.add({targets:this.tabs[t],alpha:t!==e?0:1,duration:200,ease:Phaser.Math.Easing.Sine.InOut})}},(0,Wt.Z)(t,[{key:"themeColor",get:function(){return Am}},{key:"highlightColor",get:function(){return 3774208}}]),t}(Phaser.GameObjects.Container),Im=wm,Pm=bg,km=Pm.WIDTH,xm=Pm.HEIGHT,_m=function(e){function t(t){var n,i=t.scene,a=t.tabNames;return(n=e.call(this,i,km,xm,a.length)||this).tournamentsContainer=void 0,n.tabNames=void 0,n.labels=void 0,n.currentIndex=0,n.tournamentsContainer=t,n.tabNames=a,n.createLabels(),n.createTabSwitchingAnimation(),n}(0,ot.Z)(t,e);var n=t.prototype;return n.createLabels=function(){var e,t=this,n=z()(e=this.tabNames).call(e,(function(e,n){var i=t.scene.make.bitmapText({font:Go.Z.PRIMARY.KEY,size:t.scene.fontSize(cd.TAB_SELECTOR_LABEL),text:e,origin:{x:.5,y:.5}});return n>0?i.setTint(t.themeColor):i.setTint(t.highlightColor),i}));this.addLabels(n),this.labels=n},n.createTabSwitchingAnimation=function(){var e=this;this.callback=function(t){e.labels.forEach((function(n,i){n.setTint(t==i?e.highlightColor:e.themeColor)}));var n=e.currentIndex<t?40:-40;e.scene.tweens.add({targets:[e.tournamentsContainer.scrollers[e.currentIndex],e.tournamentsContainer.scrollerManagers[e.currentIndex].noTournamentBlock],x:-n,alpha:0,duration:400,ease:Phaser.Math.Easing.Sine.Out}),e.tournamentsContainer.scrollers[e.currentIndex].setEnable(!1),e.scene.tweens.add({targets:[e.tournamentsContainer.scrollers[t],e.tournamentsContainer.scrollerManagers[t].noTournamentBlock],x:{from:n,to:0},alpha:1,duration:300,ease:Phaser.Math.Easing.Sine.In}),e.tournamentsContainer.scrollers[t].setEnable(!0),e.currentIndex=t}},t}(Im),Om=_m,Dm="This competition is over",Bm=function(e){function t(t){var n;return(n=e.call(this,t)||this).endTime=void 0,n.countdownTimer=void 0,n.timerText=void 0,n.updateCountdown=(0,st.Z)(ut().mark((function e(){var t,i,a,r;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=Date.now(),i=1e3*n.endTime-t,a=Math.round(Math.abs(i)/864e5),i<0&&(i=0),0!==i){e.next=7;break}return n.timerText.setText(Dm),e.abrupt("return");case 7:a>=1?(r=1===a,n.timerText.setText("Competition ends in "+a+" "+(r?"day":"days"))):n.timerText.setText("Competition ends in "+(0,Rn.F0)(Math.abs(i),!0));case 8:case"end":return e.stop()}}),e)}))),n.setSize(375,30),n.createTimerContainer(),n.createCountdownTimer(),t.add.existing((0,Cs.Z)(n)),n}(0,ot.Z)(t,e);var n=t.prototype;return n.createTimerContainer=function(){this.timerText=this.scene.make.bitmapText({font:Go.Z.PRIMARY.KEY,size:this.scene.fontSize(15.5),origin:{x:.5,y:.5}}),this.timerText.setTint(16579837),this.add([this.timerText])},n.createCountdownTimer=function(){var e;void 0!=this.endTime&&(0!=this.endTime?(null==(e=this.countdownTimer)||e.destroy(),this.countdownTimer=this.scene.time.addEvent({loop:!0,delay:1e3,startAt:1e3,callback:this.updateCountdown})):this.timerText.setText(Dm))},n.setCountdown=function(e){this.endTime=e,this.createCountdownTimer()},n.getRemain=function(){if(void 0!=this.endTime){var e=Date.now(),t=1e3*this.endTime-e;return t<0?0:t}},t}(Phaser.GameObjects.Container),Lm=Bm,Rm=n(544),Gm=Ds.Z.GAMEPLAY_DEFAULT,Nm=Gm.KEY,Mm=Gm.FRAME,Fm=function(e){function t(t){var n;return(n=e.call(this,t)||this).medalNo123=void 0,n.customizedMedal=void 0,n.rankLabel=void 0,n.rank=1,n.setSize(20,20),n.createMedal123(),n.createCustomizedMedal(),n.createRankLabel(),n}(0,ot.Z)(t,e);var n=t.prototype;return n.getRank=function(){return this.rank},n.setRank=function(e){var t=function(e){return e>99?"99+":0===e?"?":e.toString()}(e);switch(this.rank=e,this.rankLabel.setText(t),this.medalNo123.kill(),this.customizedMedal.kill(),t){case"1":this.medalNo123.revive(),this.medalNo123.setFrame(Mm.GOLD),this.rankLabel.setTint(16777215),Phaser.Display.Align.In.Center(this.rankLabel,this.customizedMedal,.5,1.25);break;case"2":this.medalNo123.revive(),this.medalNo123.setFrame(Mm.SILVER),this.rankLabel.setTint(5658198),Phaser.Display.Align.In.Center(this.rankLabel,this.customizedMedal,.5,1.25);break;case"3":this.medalNo123.revive(),this.medalNo123.setFrame(Mm.BRONZE),this.rankLabel.setTint(16777215),Phaser.Display.Align.In.Center(this.rankLabel,this.customizedMedal,.5,1.25);break;default:this.customizedMedal.revive(),this.rankLabel.setTint(3774208),Phaser.Display.Align.In.Center(this.rankLabel,this.customizedMedal,0,.5)}},n.createMedal123=function(){this.medalNo123=this.scene.add.image(0,0,Nm,Mm.GOLD),this.medalNo123.setWorldSize(19,20.5),this.add(this.medalNo123)},n.createCustomizedMedal=function(){this.customizedMedal=this.scene.add.image(0,0,Nm,Mm.CUSTOM_MEDAL),this.customizedMedal.setWorldSize(20,20),this.add(this.customizedMedal)},n.createRankLabel=function(){this.rankLabel=this.scene.make.bitmapText({font:Go.Z.PRIMARY.KEY,size:this.scene.fontSize(10),origin:{x:.5,y:.5},text:""+this.rank}),this.add(this.rankLabel)},t}(Phaser.GameObjects.Container);var Um=Ds.Z.DEFAULT,Zm=Um.KEY,Hm=Um.FRAME,Wm=Ds.Z.GAMEPLAY_DEFAULT,zm=Wm.KEY,Ym=Wm.FRAME,Vm={x:0,y:.5},Km=/^[A-Za-z0-9 ]*$/,jm=function(e){function t(t,n){var i;return void 0===n&&(n=!1),(i=e.call(this,t)||this).scene=void 0,i._isPlayer=!1,i.currentPlayerBackground=void 0,i.avatar=void 0,i.normalTextUsername=void 0,i.bitmapTextUsername=void 0,i.score=void 0,i.medalIcon=void 0,i.scoreIcon=void 0,i.payload=void 0,i.scene=t,i.setSize(303,32),i.createCurrentPlayerBackground(),i.createMedalIcon(),i.createAvatar(),i.createNormalTextUsername(),i.createBitmapTextUsername(),i.createScore(),i.createScoreIcon(),i.alignComponents(),i.isPlayer=n,i}(0,ot.Z)(t,e);var n=t.prototype;return n.createCurrentPlayerBackground=function(){this.currentPlayerBackground=new Qd.Z(this.scene,0,0,303,44,8,0).setAlpha(.25),this.add(this.currentPlayerBackground)},n.createAvatar=function(){this.avatar=new Ad(this.scene,{key:Zm,background:Hm.BLANK,width:42,height:42,loadDelay:100}),this.avatar.update(),this.avatar.background.kill(),this.avatar.loadPhoto(GameCore.Utils.String.generateObjectId(),Yr.Z.AVATAR.FILE,100),this.add(this.avatar)},n.createNormalTextUsername=function(){this.normalTextUsername=this.scene.make.text({style:{fontFamily:Go.Z.FONT_FAMILY},origin:Vm}),this.normalTextUsername.setHighQuality(),this.normalTextUsername.setFontSize(16),this.add(this.normalTextUsername)},n.createBitmapTextUsername=function(){this.bitmapTextUsername=this.scene.make.bitmapText({font:Go.Z.PRIMARY.KEY,size:this.scene.fontSize(16),origin:Vm,text:"Waiting"}),this.add(this.bitmapTextUsername)},n.createScore=function(){this.score=this.scene.make.bitmapText({font:Go.Z.PRIMARY.KEY,size:this.scene.fontSize(14),origin:{x:1,y:.5}}),this.add(this.score),this.setScore(0)},n.createScoreIcon=function(){this.scoreIcon=this.scene.add.image(0,0,zm,Ym.MEDAL_STAR),this.scoreIcon.setWorldSize(20,20),this.add(this.scoreIcon)},n.createMedalIcon=function(){this.medalIcon=new Fm(this.scene),this.medalIcon.kill(),this.add(this.medalIcon)},n.setScore=function(e){this.score.setText(0===e?"?":""+e)},n.setUsername=function(e){var t=GameCore.Utils.String.getShortName(e,12),n=GameCore.Utils.String.removeDiacritics(t);Km.test(n)?(this.bitmapTextUsername.setText(n),this.normalTextUsername.kill(),this.bitmapTextUsername.revive()):(this.normalTextUsername.setText(n),this.normalTextUsername.revive(),this.bitmapTextUsername.kill())},n.getTimerIcon=function(){return this.scoreIcon},n.updateData=function(e){var t,n,i=e.playerId,a=void 0===i?"10":i,r=e.name,s=void 0===r?"???":r,o=e.photo,c=void 0===o?"":o,u=e.score,l=void 0===u?0:u,h=e.rank,d=void 0===h?0:h;this.payload&&(t=e,n=this.payload,t.playerId===n.playerId&&t.photo===n.photo&&t.score===n.score&&t.rank===n.rank&&t.name===n.name)||(this.payload=e,this.isPlayer=a===this.scene.player.getPlayerId(),this.scoreIcon.setAlpha(0),this.score.setAlpha(0),this.normalTextUsername.setAlpha(0),this.bitmapTextUsername.setAlpha(0),this.avatar.setAlpha(0),this.setScore(l),0!==l||this.isPlayer?(this.setUsername(s),this.avatar.loadPhoto(a,c,100),this.medalIcon.setRank(d)):(this.setUsername("Waiting..."),this.avatar.loadPhoto(GameCore.Utils.String.generateObjectId(),Yr.Z.AVATAR.FILE,100),this.medalIcon.setRank(0)),this.medalIcon.revive(),Phaser.Display.Align.To.LeftCenter(this.scoreIcon,this.score,8),this.playRecentlyUpdatedComponentEntrancesAnimation())},n.alignComponents=function(){var e=this;Phaser.Display.Align.In.LeftCenter(this.medalIcon,this,-8),Phaser.Display.Align.To.RightCenter(this.avatar,this.medalIcon,6),[this.normalTextUsername,this.bitmapTextUsername].forEach((function(t){Phaser.Display.Align.To.RightCenter(t,e.avatar,3)})),Phaser.Display.Align.In.RightCenter(this.score,this,-8),Phaser.Display.Align.To.LeftCenter(this.scoreIcon,this.score,8)},n.playRecentlyUpdatedComponentEntrancesAnimation=function(){this.scene.add.tween({targets:[this.scoreIcon,this.score,this.avatar,this.bitmapTextUsername,this.normalTextUsername],props:{alpha:{from:0,to:1}},duration:150})},(0,Wt.Z)(t,[{key:"isPlayer",get:function(){return this._isPlayer},set:function(e){this._isPlayer=e,this._isPlayer?this.currentPlayerBackground.revive():this.currentPlayerBackground.kill()}}]),t}(Phaser.GameObjects.Container);var Xm=Sg,Jm=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.leaders=[],n.loading=void 0,n.payload=[],n.scene=t,n.createLeaders(),n.alignLeaders(),n.createLoading(),n}(0,ot.Z)(t,e);var n=t.prototype;return n.updateLeaders=function(e){if(!function(e,t){var n,i;if(e.length!==t.length)return!1;for(var a=rr()(n=s()(e).call(e)).call(n,(function(e,t){return e.rank-t.rank})),r=rr()(i=s()(t).call(t)).call(i,(function(e,t){return e.rank-t.rank})),o=0;o<a.length;o++){var c=a[o],u=r[o];if(c.playerId!==u.playerId||c.photo!==u.photo||c.score!==u.score||c.rank!==u.rank||c.name!==u.name)return!1}return!0}(this.payload,e)){this.payload=e;var t=z()(e).call(e,(function(t){var n=u()(e).call(e,(function(e){return e.score>t.score})).length+1;return(0,Me.Z)({},t,{rank:n})}));console.log("updateLeaders: ",e),this.leaders.forEach((function(e,n){e.updateData(t[n])}))}},n.createLeaders=function(){for(var e=0;e<Xm;e++){var t=new jm(this.scene);this.leaders.push(t),e===Xm-1&&(t.isPlayer=!0);var n={playerId:e.toString(),photo:"",score:0,rank:e+1,name:"player"};t.updateData(n)}this.add(this.leaders)},n.alignLeaders=function(){var e=this,t=this.leaders.length,n=t*this.leaders[0].height+12*(t-1);this.setSize(303,n),this.leaders.forEach((function(t,n){0!==n?Phaser.Display.Align.To.BottomCenter(t,e.leaders[n-1],0,12):Phaser.Display.Align.In.TopCenter(t,e)}))},n.createLoading=function(){this.loading=new Rm.Z(this.scene),this.loading.setScale(.8),this.add(this.loading)},t}(Phaser.GameObjects.Container);var qm=n(381),Qm=new(n.n(qm)());function $m(e,t){var n="undefined"!==typeof wo()&&Po()(e)||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){var n;if(!e)return;if("string"===typeof e)return ev(e,t);var i=s()(n=Object.prototype.toString.call(e)).call(n,8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return a()(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return ev(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ev(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}for(var tv=Sg,nv={playerId:"10",name:"???",photo:"",score:0,rank:0},iv=[],av=0;av<tv;av++)iv.push((0,Me.Z)({},nv,{rank:av+1}));for(var rv=function(){function e(e,t,n){void 0===n&&(n=tv),this.scene=void 0,this.leaderboardId=void 0,this.maxLeaderCount=tv,this.scene=e,this.leaderboardId=t,this.maxLeaderCount=n}var t=e.prototype;return t.updateLeaderboardId=function(e){this.leaderboardId=e},t.getLeaderPayloadPlaceholders=function(){var e;return fe()(e=[]).call(e,iv)},t.getRawLeadersAsync=function(){var e=(0,st.Z)(ut().mark((function e(){var t;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.leaderboardId){e.next=2;break}return e.abrupt("return",[]);case 2:return e.next=4,Xu(this.leaderboardId,{limit:this.maxLeaderCount});case 4:return t=e.sent,e.abrupt("return",u()(t).call(t,(function(e){return null!==e&&void 0!==e})));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.getRawLeadersProfileIds=function(e){for(var t,n=[],i=$m(e);!(t=i()).done;){var a=t.value;if(a&&GameCore.Utils.Object.hasOwn(a,"playerId")){var r=a.playerId;"string"===typeof r&&n.push(r)}}return n},t.getProfilesDataAsync=function(){var e=(0,st.Z)(ut().mark((function e(t){return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.scene.profile.requestProfiles(t);case 2:return e.abrupt("return",this.scene.profile.getProfiles());case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.parseRawLeadersIntoPayloadsAsync=function(){var e=(0,st.Z)(ut().mark((function e(t){var n,i,a,r,s,o,c,u,l,h,d,f,p,g;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.getRawLeadersProfileIds(t),e.next=3,this.getProfilesDataAsync(n);case 3:i=e.sent,a=[],r=$m(t);case 6:if((s=r()).done){e.next=27;break}if(o=s.value){e.next=10;break}return e.abrupt("continue",25);case 10:if(GameCore.Utils.Object.hasOwn(o,"playerId")){e.next=12;break}return e.abrupt("continue",25);case 12:if(GameCore.Utils.Object.hasOwn(o,"score")){e.next=14;break}return e.abrupt("continue",25);case 14:if(GameCore.Utils.Object.hasOwn(o,"rank")){e.next=16;break}return e.abrupt("continue",25);case 16:if(c=o.playerId,u=o.score,l=o.rank,"string"===typeof c){e.next=19;break}return e.abrupt("continue",25);case 19:if("string"===typeof u){e.next=21;break}return e.abrupt("continue",25);case 21:if("number"===typeof l){e.next=23;break}return e.abrupt("continue",25);case 23:(h=i[c])?(d=h.name,f=h.photo,p={playerId:c,photo:f,score:yt()(u),rank:l,name:d},a.push(p)):(g={playerId:c,photo:"",score:yt()(u),rank:l,name:"Player"},a.push(g));case 25:e.next=6;break;case 27:return e.abrupt("return",a);case 28:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.isPlayerInLeaderPayloads=function(e){for(var t,n=this.scene.player.getPlayer().playerId,i=$m(e);!(t=i()).done;){if(t.value.playerId===n)return!0}return!1},t.getYouLeaderPayloadPlaceholder=function(){var e=this.scene.player.getPlayer();return{playerId:e.playerId,photo:e.photo,score:0,rank:0,name:"You"}},t.getYouLeaderPayloadAsync=function(){var e=(0,st.Z)(ut().mark((function e(){var t,n,i,a,r,s,o;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.leaderboardId){e.next=2;break}return e.abrupt("return",null);case 2:return t=this.scene.player.getPlayer(),n=t.playerId,i=t.name,a=t.photo,e.next=5,$u(n,this.leaderboardId);case 5:if(r=e.sent){e.next=8;break}return e.abrupt("return",null);case 8:return s=r.score,o=r.rank,e.abrupt("return",{playerId:n,photo:a,score:s,rank:o,name:i});case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.getProcessedLeaderPayloadAsync=function(){var e=(0,st.Z)(ut().mark((function e(){var t,n,i,a,r,s,o,c,u;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.getLeaderPayloadPlaceholders(),n=t.length,e.next=4,xe().all([this.getRawLeadersAsync(),this.getYouLeaderPayloadAsync()]);case 4:return i=e.sent,a=i[0],r=i[1],e.next=9,this.parseRawLeadersIntoPayloadsAsync(a);case 9:if(s=e.sent,o=s.length,s.forEach((function(e,n){t[n]=e})),this.isPlayerInLeaderPayloads(s));else for(t[c=o<n?o:n-1]=r||this.getYouLeaderPayloadPlaceholder(),u=c+1;u<n;u++)t[u].rank=0;return e.abrupt("return",t);case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),e}(),sv=Sg,ov={playerId:"10",name:"???",photo:"",score:0,rank:0},cv=[],uv=0;uv<sv;uv++)cv.push((0,Me.Z)({},ov,{rank:uv+1}));var lv,hv=function(e){function t(t,n,i){var a;return(a=e.call(this,t)||this).background=void 0,a.leaderList=void 0,a.payload=void 0,a.leaderListApiService=void 0,a.setSizeContainer(n,i),a.addLeaderList(),a.createLeaderListApiService(),a.scene.add.existing((0,Cs.Z)(a)),a}(0,ot.Z)(t,e);var n=t.prototype;return n.createLeaderListApiService=function(){this.leaderListApiService=new rv(this.scene,void 0)},n.updateInfo=function(){var e=(0,st.Z)(ut().mark((function e(t){return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("payload: ",t),this.payload=t,e.next=5,this.fetchLeaderboardData();case 5:e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.warn("updateInfo",e.t0),this.kill();case 11:return e.prev=11,Qm.emit("tournament_block_update_done"),e.finish(11);case 14:case"end":return e.stop()}}),e,this,[[0,7,11,14]])})));return function(t){return e.apply(this,arguments)}}(),n.fetchLeaderboardData=function(){var e=(0,st.Z)(ut().mark((function e(){var t,n,i;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.leaderList.loading.revive(),this.leaderList.bringToTop(this.leaderList.loading),e.prev=2,this.payload.payload){e.next=5;break}throw new Error("Payload is empty");case 5:if(!this.payload.payload.leaderboard){e.next=9;break}this.leaderList.updateLeaders(this.payload.payload.leaderboard),e.next=18;break;case 9:if(n=null==(t=this.payload.payload)?void 0:t.leaderboardId){e.next=12;break}throw new Error("Leaderboard ID is not defined");case 12:return this.leaderListApiService.updateLeaderboardId(n),e.next=15,this.leaderListApiService.getProcessedLeaderPayloadAsync();case 15:i=e.sent,this.leaderList.revive(),this.leaderList.updateLeaders(i);case 18:e.next=23;break;case 20:throw e.prev=20,e.t0=e.catch(2),new Error("Error while fetching leaderboard data");case 23:return e.prev=23,this.leaderList.loading.kill(),e.finish(23);case 26:case"end":return e.stop()}}),e,this,[[2,20,23,26]])})));return function(){return e.apply(this,arguments)}}(),n.setSizeContainer=function(e,t){var n=e||343,i=t||372;this.setSize(n,i);this.background=new Jo(this.scene,{key:"block-background",radius:6,border:24,width:n,height:i}),this.add(this.background)},n.addLeaderList=function(){this.leaderList=new Jm(this.scene),this.add(this.leaderList)},t}(Phaser.GameObjects.Container),dv=function(e){function t(t,n,i){var a;a=e.call(this,t,n,i)||this;var r=new Qd.Z(a.scene,0,0,n,i,16,16777215,1);return a.add(r),a}return(0,ot.Z)(t,e),t.prototype.playAnimation=function(){new qo.Z({targets:this.getAll(),duration:1e3,props:{scale:"*=1.05"}}).play()},t}(Ho.Z),fv=Ds.Z.GAMEPLAY_DEFAULT.FRAME,pv=Tg;!function(e){e.JOIN="join",e.CONTINUE="continue"}(lv||(lv={}));var gv=function(e){function t(t){var n;return(n=e.call(this,t,pv.WIDTH,42)||this)._playLabel=void 0,n._cupIcon=void 0,n._buttonState=lv.JOIN,n.joinLabel=void 0,n.continueLabel=void 0,n.setName("joinButton"),n.createJoinLabel(),n.createContinueLabel(),n.playAnimation(),n}(0,ot.Z)(t,e);var n=t.prototype;return n.createJoinLabel=function(){this.joinLabel=new Rp(this.scene,8,"Join tournament",fv.CUP),this.add(this.joinLabel)},n.createContinueLabel=function(){this.continueLabel=new Rp(this.scene,8,"Continue tournament",fv.CUP),this.add(this.continueLabel),this.continueLabel.kill()},n.switchState=function(e){if(e!==this._buttonState)switch(e){case lv.JOIN:this._buttonState=lv.JOIN,this.joinLabel.revive(),this.continueLabel.kill();break;case lv.CONTINUE:this._buttonState=lv.CONTINUE,this.joinLabel.kill(),this.continueLabel.revive();break;default:console.log("unhandled state")}},(0,Wt.Z)(t,[{key:"playLabel",get:function(){return this._playLabel}},{key:"cupIcon",get:function(){return this._cupIcon}},{key:"buttonState",get:function(){return this._buttonState}}]),t}(dv),mv=function(){function e(){this.payload=void 0}var t=e.prototype;return t.getData=function(){var e=(0,st.Z)(ut().mark((function e(){var t,n,i;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.payload){e.next=2;break}return e.abrupt("return",this.payload);case 2:return e.next=4,xe().all([this.getAPITournamentData(),this.getFacebookTournamentData()]);case 4:return t=e.sent,n=t[0],i=t[1],this.payload=n||i,e.abrupt("return",this.payload);case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.setData=function(e){this.payload=e},t.clearData=function(){this.payload=void 0},t.getAPITournamentData=function(){var e=(0,st.Z)(ut().mark((function e(){var t,n,i;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=window.game.storage.getState(),n=Fu(t),e.next=4,Qu();case 4:if(0!==(i=e.sent).length){e.next=7;break}return e.abrupt("return",void 0);case 7:return e.abrupt("return",un()(i).call(i,(function(e){return e.id===n})));case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),t.getFacebookTournamentData=function(){var e=(0,st.Z)(ut().mark((function e(){var t,n,i,a,r,s;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.game.facebook.getTournamentAsync();case 2:if(t=e.sent,n=t.getPayload()){e.next=6;break}return e.abrupt("return",void 0);case 6:i=null;try{i=JSON.parse(n)}catch(o){console.warn("Tournament payload parse error",o)}if(i){e.next=10;break}return e.abrupt("return",void 0);case 10:if(r=(a=i).playerName,a.leaderboardId){e.next=13;break}return e.abrupt("return",void 0);case 13:return s={id:t.getID(),title:t.getTitle()||r+"'s Tournament",payload:i,endTime:t.getEndTime(),contextID:t.getContextID()},e.abrupt("return",s);case 15:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),e}(),vv=new mv,yv=Ds.Z.DEFAULT,bv=yv.KEY,Sv=yv.FRAME,Tv=Ds.Z.GAMEPLAY_DEFAULT,Ev=Tv.KEY,Cv=Tv.FRAME,Av=function(e){function t(t,n){var i;return void 0===n&&(n=!1),(i=e.call(this,t)||this).scene=void 0,i._isPlayer=!1,i.normalPlayerBackground=void 0,i.border=void 0,i.avatar=void 0,i.username=void 0,i.score=void 0,i.medalIcon=void 0,i.scoreIcon=void 0,i.payload=void 0,i.instantPlayerVisualIndicator=!1,i.scene=t,i.setSize(303,44),i.createNormalPlayerBackground(),i.createBorder(),i.createMedalIcon(),i.createAvatar(),i.createUsername(),i.createScore(),i.createScoreIcon(),i.alignComponents(),i.isPlayer=n,i}(0,ot.Z)(t,e);var n=t.prototype;return n.createNormalPlayerBackground=function(){this.normalPlayerBackground=new Qd.Z(this.scene,0,0,this.width,this.height,8,16777215).setAlpha(1),this.add(this.normalPlayerBackground)},n.createBorder=function(){var e=this.scene.add.graphics();e.lineStyle(1,16777215),e.strokeRoundedRect(-this.width/2,-this.height/2,this.width,this.height,8),this.add(e),this.border=e},n.createAvatar=function(){this.avatar=new Ad(this.scene,{key:bv,background:Sv.BLANK,width:42,height:42,loadDelay:100}),this.avatar.update(),this.avatar.background.kill(),this.avatar.loadPhoto(GameCore.Utils.String.generateObjectId(),Yr.Z.AVATAR.FILE,100),this.add(this.avatar)},n.createUsername=function(){this.username=this.scene.make.text({style:{fontFamily:Go.Z.FONT_FAMILY},origin:{x:0,y:.5}}),this.username.setHighQuality(),this.username.setFontSize(16),this.add(this.username)},n.createScore=function(){this.score=this.scene.make.bitmapText({font:Go.Z.PRIMARY.KEY,size:this.scene.fontSize(14),origin:{x:1,y:.5}}),this.add(this.score),this.setScore(0)},n.createScoreIcon=function(){this.scoreIcon=this.scene.add.image(0,0,Ev,Cv.MEDAL_STAR),this.scoreIcon.setWorldSize(20,20),this.add(this.scoreIcon)},n.createMedalIcon=function(){this.medalIcon=new Fm(this.scene),this.medalIcon.kill(),this.add(this.medalIcon)},n.setScore=function(e){this.score.setText(""+e)},n.setUsername=function(e){var t=GameCore.Utils.String.getShortName(e,12),n=GameCore.Utils.String.removeDiacritics(t);this.username.setText(n)},n.getTimerIcon=function(){return this.scoreIcon},n.updateData=function(e){var t,n,i=e.playerId,a=void 0===i?"10":i,r=e.name,s=void 0===r?"???":r,o=e.photo,c=void 0===o?"":o,u=e.score,l=void 0===u?0:u,h=e.rank,d=void 0===h?0:h;this.payload&&(t=e,n=this.payload,t.playerId===n.playerId&&t.photo===n.photo&&t.score===n.score&&t.rank===n.rank&&t.name===n.name)||(this.payload=e,this.isPlayer=a===this.scene.player.getPlayerId(),this.scoreIcon.setAlpha(0),this.score.setAlpha(0),this.username.setAlpha(0),this.avatar.setAlpha(0),this.setScore(l),this.medalIcon.setRank(d),this.updateNormalPlayerBackground(d),0===l?(this.setUsername("Waiting..."),this.avatar.loadPhoto(GameCore.Utils.String.generateObjectId(),Yr.Z.AVATAR.FILE,100)):(this.setUsername(s),this.avatar.loadPhoto(a,c,100)),this.medalIcon.revive(),Phaser.Display.Align.To.LeftCenter(this.scoreIcon,this.score,8),this.playRecentlyUpdatedComponentEntrancesAnimation())},n.getBackgroundColorViaRank=function(e){switch(e){case 1:return 16771094;case 2:return 16777215;case 3:return 14265494;default:return 0}},n.getBackgroundAlphaViaRank=function(e){return 1===e||2===e||3===e?.32:.25},n.updateNormalPlayerBackground=function(e){var t=this.getBackgroundColorViaRank(e),n=this.getBackgroundAlphaViaRank(e);this.normalPlayerBackground.setFillStyle(t,n)},n.alignComponents=function(){Phaser.Display.Align.In.LeftCenter(this.medalIcon,this,-8),Phaser.Display.Align.To.RightCenter(this.avatar,this.medalIcon,6),Phaser.Display.Align.To.RightCenter(this.username,this.avatar,3),Phaser.Display.Align.In.RightCenter(this.score,this,-8),Phaser.Display.Align.To.LeftCenter(this.scoreIcon,this.score,8)},n.playRecentlyUpdatedComponentEntrancesAnimation=function(){this.scene.add.tween({targets:[this.scoreIcon,this.score,this.username,this.avatar],props:{alpha:{from:0,to:1}},duration:150})},n.hideContent=function(){var e;if(this._isPlayer){this.border.kill(),this.normalPlayerBackground.revive();var t=this.getBackgroundAlphaViaRank((null==(e=this.payload)?void 0:e.rank)||1);this.normalPlayerBackground.setAlpha(t)}},n.showSpecialBackgroundAnimation=function(){var e=(0,st.Z)(ut().mark((function e(){var t=this;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new(xe())((function(e){var n=[t.border];t.scene.add.tween({targets:n,duration:200,onStart:function(){n.forEach((function(e){return e.revive()}))},props:{alpha:{from:0,to:.25}},onComplete:e})})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),n.runScalingAnimation=function(){var e=(0,st.Z)(ut().mark((function e(){var t=this;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new(xe())((function(e){t.scene.add.tween({targets:t,duration:200,ease:Phaser.Math.Easing.Cubic.In,props:{scale:.95},onComplete:function(){t.scene.add.tween({targets:t,ease:Phaser.Math.Easing.Elastic.Out,easeParams:[.1,.45],props:{scale:1},onComplete:e})}})})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),n.runEntranceAnimation=function(){var e=(0,st.Z)(ut().mark((function e(){return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._isPlayer){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,xe().all([this.showSpecialBackgroundAnimation(),this.runScalingAnimation()]);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),(0,Wt.Z)(t,[{key:"isPlayer",get:function(){return this._isPlayer},set:function(e){this._isPlayer=e,this._isPlayer&&this.instantPlayerVisualIndicator?(this.border.revive(),this.normalPlayerBackground.kill()):(this.border.kill(),this.normalPlayerBackground.revive())}}]),t}(Phaser.GameObjects.Container);var wv=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.leaders=[],n.loading=void 0,n.payload=[],n.scene=t,n.createLeaders(),n.alignLeaders(),n.createLoading(),n}(0,ot.Z)(t,e);var n=t.prototype;return n.updateLeaders=function(e){(function(e,t){var n,i;if(e.length!==t.length)return!1;for(var a=rr()(n=s()(e).call(e)).call(n,(function(e,t){return e.rank-t.rank})),r=rr()(i=s()(t).call(t)).call(i,(function(e,t){return e.rank-t.rank})),o=0;o<a.length;o++){var c=a[o],u=r[o];if(c.playerId!==u.playerId||c.photo!==u.photo||c.score!==u.score||c.rank!==u.rank||c.name!==u.name)return!1}return!0})(this.payload,e)||(this.payload=e,this.leaders.forEach((function(t,n){t.updateData((0,Me.Z)({},e[n]))})))},n.createLeaders=function(){for(var e=0;e<4;e++){var t=new Av(this.scene);this.leaders.push(t),3===e&&(t.isPlayer=!0);var n={playerId:e.toString(),photo:"",score:0,rank:e+1,name:"player"};t.updateData(n)}this.add(this.leaders)},n.alignLeaders=function(){var e=this,t=this.leaders.length,n=t*this.leaders[0].height+8*(t-1);this.setSize(303,n),this.leaders.forEach((function(t,n){0!==n?Phaser.Display.Align.To.BottomCenter(t,e.leaders[n-1],0,8):Phaser.Display.Align.In.TopCenter(t,e)}))},n.createLoading=function(){this.loading=new Rm.Z(this.scene).setTint(12237498),this.add(this.loading)},n.hideContent=function(){this.leaders.forEach((function(e){return e.setAlpha(0)})),this.leaders.forEach((function(e){return e.hideContent()}))},n.runEntranceAnimation=function(){var e=(0,st.Z)(ut().mark((function e(){var t,n,i,a,r=this;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=z()(t=this.leaders).call(t,(function(e,t){return new(xe())((function(n){r.scene.add.tween({targets:[e],duration:250,delay:250*t/2,ease:Phaser.Math.Easing.Cubic.Out,props:{alpha:{from:0,to:1},y:{from:e.y+e.height/2,to:e.y},scale:{from:.85,to:1,ease:Phaser.Math.Easing.Elastic.Out,easeParams:[.1,.45],duration:1e3}},onComplete:n})}))})),e.next=3,xe().all(i);case 3:return a=z()(n=this.leaders).call(n,(function(e){return e.runEntranceAnimation()})),e.next=6,xe().all(a);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t}(Phaser.GameObjects.Container);for(var Iv=Ds.Z.GAMEPLAY_DEFAULT,Pv=Iv.KEY,kv=Iv.FRAME,xv=Tg,_v=cd.TOURNAMENT_BLOCK.TITLE,Ov=16777215,Dv=xv.WIDTH,Bv=143.5,Lv=48,Rv={playerId:"10",name:"???",photo:"",score:0,rank:0},Gv=[],Nv=0;Nv<4;Nv++)Gv.push((0,Me.Z)({},Rv,{rank:Nv+1}));var Mv=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.title=void 0,n.timer=void 0,n.topLine=void 0,n.bottomLine=void 0,n.leaderList=void 0,n.rematchButton=void 0,n.newGameButton=void 0,n.lines=[],n.buttons=[],n.scene=t,n.setSize(343,418),n.createBackground(),n.createTitle(),n.createTimer(),n.createTopLine(),n.createLeaderList(),n.createBottomLine(),n.createRematchButton(),n.createNewGameButton(),n.alignComponents(),n.createCloseButton(),n}(0,ot.Z)(t,e);var n=t.prototype;return n.createBackground=function(){this.setSize(this.width,this.height);var e=new Jo(this.scene,{key:"tournament-result-container",radius:6,border:24,width:this.width,height:this.height});this.add(e)},n.createTitle=function(){this.title=this.scene.make.bitmapText({font:Go.Z.BOLD.KEY,size:this.scene.fontSize(_v),text:"Summer Tournament",origin:{x:.5,y:.5}}),this.add(this.title)},n.createTimer=function(){this.timer=new Lm(this.scene),this.add(this.timer)},n.createTopLine=function(){this.topLine=this.scene.add.line(0,0,0,0,xv.WIDTH,0,Ov,.2),this.add(this.topLine),this.lines.push(this.topLine)},n.createLeaderList=function(){this.leaderList=new wv(this.scene),this.add(this.leaderList)},n.createBottomLine=function(){this.bottomLine=this.scene.add.line(0,0,0,0,xv.WIDTH,0,Ov,.2),this.add(this.bottomLine),this.lines.push(this.bottomLine)},n.createRematchButton=function(){var e=this;this.rematchButton=new Ho.Z(this.scene,Bv,Lv),this.rematchButton.onClick=function(){e.scene instanceof Nb&&e.scene.gameplay.replayGame(!0),e.scene.screen.close(As.o4.TOURNAMENTS_RESULT_SCREEN)},this.rematchButton.setName("RetryTournament");var t=new Qd.Z(this.scene,0,0,Bv,Lv,16,16777215,.24),n=this.scene.add.graphics();n.lineStyle(1,16777215),n.strokeRoundedRect(-71.75,-24,Bv,Lv,16);var i=new Rp(this.scene,8,"Try Again",kv.IC_REPLAY);i.clearTint(),i.getIcon().setTintFill(16777215),this.rematchButton.add([t,n,i]).setSize(Bv,Lv),this.add([this.rematchButton]),this.buttons.push(this.rematchButton)},n.createNewGameButton=function(){var e=this;this.newGameButton=new $d.Z(this.scene,Bv,Lv,16,16777215),this.newGameButton.onClick=(0,st.Z)(ut().mark((function t(){return ut().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.scene.handlePlayWithFriend(!0);case 2:e.scene.screen.close(As.o4.TOURNAMENTS_RESULT_SCREEN);case 3:case"end":return t.stop()}}),t)}))),this.newGameButton.setName("NewGame");var t=new Rp(this.scene);this.newGameButton.add(t),this.newGameButton.setSize(Bv,Lv),this.add([this.newGameButton]),this.buttons.push(this.newGameButton)},n.createCloseButton=function(){var e=this;if(GameCore.Utils.Valid.isDebugger()){var t=new Ho.Z(this.scene,40,40);this.add(t);var n=this.scene.add.image(0,0,Pv,kv.IC_BG_OFF);n.setWorldSize(40,40);var i=this.scene.make.bitmapText({font:Go.Z.PRIMARY.KEY,size:this.scene.fontSize(10),text:"Close",origin:{x:.5,y:.5}});i.setCenterAlign(),t.add([n,i]),Phaser.Display.Align.In.TopRight(t,this,0,-0),t.onClick=(0,st.Z)(ut().mark((function t(){return ut().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.scene.screen.close(As.o4.TOURNAMENTS_RESULT_SCREEN);case 1:case"end":return t.stop()}}),t)})))}},n.alignComponents=function(){Phaser.Display.Align.In.TopCenter(this.title,this,0,-16),Phaser.Display.Align.To.BottomCenter(this.timer,this.title,0,6),Phaser.Display.Align.To.BottomCenter(this.topLine,this.timer,0,20),Phaser.Display.Align.To.BottomCenter(this.leaderList,this.topLine,0,20),Phaser.Display.Align.To.BottomCenter(this.bottomLine,this.leaderList,0,20),Phaser.Display.Align.To.BottomLeft(this.rematchButton,this.bottomLine,0,24),Phaser.Display.Align.To.BottomRight(this.newGameButton,this.bottomLine,0,24);var e=this.rematchButton.x,t=this.newGameButton.x;Phaser.Display.Align.In.BottomCenter(this.rematchButton,this,0,-16),Phaser.Display.Align.In.BottomCenter(this.newGameButton,this,0,-16),this.rematchButton.x=e,this.newGameButton.x=t},n.updateTitle=function(e){void 0===e&&(e="Your tournament");var t=GameCore.Utils.String.removeDiacritics(e);if(this.title.setText(t),!(this.title.width<=Dv))for(var n=1;n<t.length;n++)if(this.title.setText(t.substring(0,n)+"..."),this.title.width>Dv){this.title.setText(t.substring(0,n-1)+"...");break}},n.updateTimer=function(e){this.timer.setCountdown(e)},n.updateLeadersViaId=function(){var e=(0,st.Z)(ut().mark((function e(t){var n,i,a,r,s,o,c,l,h,d=this;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=fe()(n=[]).call(n,Gv),this.leaderList.loading.revive(),this.leaderList.bringToTop(this.leaderList.loading),e.prev=3,e.next=6,Xu(t,{limit:4});case 6:if(a=e.sent,console.log("update tournament result",{leaders:a}),!(a.length>0)){e.next=24;break}return s=z()(a).call(a,(function(e){return e.playerId})),e.next=12,this.scene.profile.requestProfiles(s);case 12:if(o=this.scene.profile.getProfiles(),c=!1,l=u()(r=z()(a).call(a,(function(e){var t=e.playerId,n=e.score,i=e.rank,a=o[t];if(t===d.scene.player.getPlayerId()&&(c=!0),!a)return{playerId:t,photo:"",score:n,rank:i,name:"Player"};var r=a.name;return{playerId:t,photo:a.photo,score:n,rank:i,name:r}}))).call(r,(function(e){return null!==e})),!(l.length<1)){e.next=17;break}throw new Error("Leaderboard is empty");case 17:if(this.leaderList.revive(),l.forEach((function(e,t){i[t]=e})),c){e.next=24;break}return e.next=22,this.getCurrentPlayerLeaderDataPayload(t);case 22:h=e.sent,i[3]=(0,Me.Z)({},h);case 24:console.log("update tournament result",{leadersDataPayload:i}),this.leaderList.updateLeaders(i),e.next=31;break;case 28:e.prev=28,e.t0=e.catch(3),console.warn(e.t0);case 31:return e.prev=31,this.leaderList.loading.kill(),e.finish(31);case 34:case"end":return e.stop()}}),e,this,[[3,28,31,34]])})));return function(t){return e.apply(this,arguments)}}(),n.getCurrentPlayerLeaderDataPayload=function(){var e=(0,st.Z)(ut().mark((function e(t){var n,i,a,r,s,o,c;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.scene.player.getPlayer(),i=n.playerId,a=n.name,r=n.photo,e.next=3,$u(i,t);case 3:return s=e.sent,console.log({player:s}),o=s.score,c=s.rank,e.abrupt("return",{playerId:i,photo:r,score:o,rank:c,name:a});case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.hideContent=function(){this.leaderList.hideContent(),this.lines.forEach((function(e){e.setAlpha(0),e.scaleX=0})),this.buttons.forEach((function(e){return e.setAlpha(0)}))},n.runEntranceAnimationLines=function(){var e=(0,st.Z)(ut().mark((function e(){var t,n,i=this;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return 200,n=z()(t=this.lines).call(t,(function(e,t){return new(xe())((function(n){i.scene.add.tween({targets:[e],duration:200,delay:200*t/2,props:{alpha:{from:0,to:1},scaleX:{from:0,to:1}},onComplete:n})}))})),e.next=4,xe().all(n);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runEntranceAnimationButtons=function(){var e=(0,st.Z)(ut().mark((function e(){var t,n,i=this;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=z()(t=this.buttons).call(t,(function(e){return new(xe())((function(t){i.scene.add.tween({targets:e,alpha:1,duration:200,onComplete:function(){e.setDisabled(!1),t(),i.newGameButton.runPulsate()}})}))})),e.next=3,xe().all(n);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runEntranceAnimation=function(){var e=(0,st.Z)(ut().mark((function e(){return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.runEntranceAnimationLines();case 2:return e.next=4,this.leaderList.runEntranceAnimation();case 4:return e.next=6,this.runEntranceAnimationButtons();case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t}(Phaser.GameObjects.Container),Fv=function(e){function t(t,n,i,a){var r;return(r=e.call(this,t,n,i,a)||this).scene=void 0,r.fadeInAnimation=void 0,r.fadeOutAnimation=void 0,r.slideInAnimation=void 0,r.container=void 0,r.beams=void 0,r.bunting=void 0,r.footer=void 0,r.closed=!1,r.handleClickTournaments=function(){r.scene.time.delayedCall(100,(function(){r.closed||r.close()}))},r.setBackground=function(){var e=r.scene.theme.getCurrentThemeConfig().backgroundKey;r.background.setTexture(e);var t=r.scene.gameZone,n=t.width,i=t.height;r.background.setWorldSize(n,i),r.scene.events.on(es.BACKGROUND_CHANGED,(function(e){r.background.setTexture(e)}))},r.scene=t,r.setBackground(),r.createContainer(),r.createBeams(),r.createBuntings(),r.createFooter(),r.createBottomLogo(),r.setDepth(As.Ks.POPUP),r}(0,ot.Z)(t,e);var n=t.prototype;return n.createContainer=function(){this.container=new Mv(this.scene),this.add(this.container)},n.createBeams=function(){this.beams=new Jp(this.scene),this.add(this.beams),Phaser.Display.Align.In.TopCenter(this.beams,this)},n.createBuntings=function(){this.bunting=new fg(this.scene),this.add(this.bunting),Phaser.Display.Align.In.TopCenter(this.bunting,this)},n.createFooter=function(){var e=this;this.footer=new Mg(this.scene,!1,As.o4.NO_MORE_MOVES_SCREEN),this.add(this.footer),this.bringToTop(this.footer),this.footer.setInteractive();var t=this.scene.ads.getBannerHeight(),n=this.scene.gameZone.width>375?-20:0;Phaser.Display.Align.In.BottomCenter(this.footer,this.background,0,-t+n),this.footer.tournamentsButton.onClick=function(){e.scene.events.off(es.GAME_START,e.handleClickTournaments),e.scene.events.once(es.GAME_START,e.handleClickTournaments),e.stopConfettiAnimation(),e.scene.gameplay.confettiSmallFallDown.emitter.killAll(),e.scene.screen.open(As.o4.TOURNAMENTS_SCREEN)}},n.createBottomLogo=function(){if(!this.scene.world.isLandscape()){var e=new Hg(this.scene);this.add(e),Phaser.Display.Align.In.BottomCenter(e,this)}},n.open=function(){var t=(0,st.Z)(ut().mark((function t(n){return ut().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.prototype.open.call(this,n),this.updateInfo(),this.container.setAlpha(1),this.container.setInteractive(),this.background.setAlpha(1),this.runOpenAnimation(),this.closed=!1,this.scene.children.bringToTop(this.scene.gameplay.confettiSmallFallDown),this.scene.gameplay.confettiSmallFallDown.run(8,0,0);case 9:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.updateInfo=function(){var e=(0,st.Z)(ut().mark((function e(){var t,n,i;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,vv.getData().catch((function(){return{id:0,title:"Summer tournament",endTime:2e9,contextID:""}}));case 2:if(n=e.sent){e.next=5;break}return e.abrupt("return");case 5:if(this.container.updateTitle(n.title),this.container.updateTimer(n.endTime),!(i=null==(t=n.payload)?void 0:t.leaderboardId)){e.next=11;break}return e.next=11,this.container.updateLeadersViaId(i);case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.close=function(){this.closed=!0,this.runCloseAnimation(),this.stopConfettiAnimation()},n.closeWithoutAnimation=function(){this.closed=!0,this.alpha=0,this.stopConfettiAnimation(),this.scene.gameplay.confettiSmallFallDown.emitter.killAll(),e.prototype.close.call(this)},n.runOpenAnimation=function(){var e=(0,st.Z)(ut().mark((function e(){var t,n,i,a=this;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==(t=this.slideInAnimation)||null==(n=t.tween)||!n.isPlaying()){e.next=2;break}return e.abrupt("return");case 2:return this.scene.audio.playSound(Bt.POPUP_SHOW),i=this.scene.ads.getBannerHeight(),this.container.setAlpha(0),this.container.y=i,this.container.hideContent(),this.bunting.stopWavingAnimation(),this.container.newGameButton.stopPulsate(),this.slideInAnimation||(this.slideInAnimation=new Jd({targets:[this.container],ease:Phaser.Math.Easing.Back.Out,props:{y:{from:i,to:-i/2},alpha:{from:0,to:1}},duration:300,onComplete:function(){var e=(0,st.Z)(ut().mark((function e(){return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.container.runEntranceAnimation();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()})),this.fadeInAnimation||(this.fadeInAnimation=new Kd.Z({targets:[this],duration:300})),this.fadeInAnimation.play(),e.next=14,this.bunting.runEntranceAnimation();case 14:this.bunting.playWavingAnimation(),this.slideInAnimation.play();case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runCloseAnimation=function(){var t,n,i=this;null!=(t=this.fadeOutAnimation)&&null!=(n=t.tween)&&n.isPlaying()||(this.scene.audio.playSound(Bt.POPUP_OFF),this.fadeOutAnimation||(this.fadeOutAnimation=new qd.Z({targets:[this],props:{alpha:0},duration:300,onComplete:function(){e.prototype.close.call(i)}})),this.fadeOutAnimation.play(),this.bunting.stopWavingAnimation())},n.stopConfettiAnimation=function(){this.scene.gameplay.confettiSmallFallDown.emitter.stop()},t}(GameCore.Screen),Uv=Fv,Zv=Tg,Hv=cd.TOURNAMENT_BLOCK.TITLE,Wv=Ds.Z.GAMEPLAY_DEFAULT,zv=Wv.KEY,Yv=Wv.FRAME,Vv=16777215,Kv=Zv.WIDTH,jv=function(e){function t(t){var n;return(n=e.call(this,t)||this).button=void 0,n.timerContainer=void 0,n.title=void 0,n.topLine=void 0,n.handleJoinTournament=(0,st.Z)(ut().mark((function e(){var t,i,a,r,s,o,c,u,l,h,d,f,p,g;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return vv.setData(n.payload),a=n.payload.id,r=n.payload.endTime,s=(null==(t=n.payload.payload)?void 0:t.leaderboardId)||"",o=(null==(i=n.payload.payload)?void 0:i.level)||1,console.warn({leaderboardId:s,tournamentID:a}),e.prev=6,e.next=9,n.scene.facebook.tournament.joinAsync(a.toString());case 9:return e.next=11,n.scene.storage.dispatch(tl(a.toString(),s));case 11:return e.next=13,n.scene.storage.dispatch(yh());case 13:c={leaderboardId:s,endTime:r,level:o},n.scene.player.joinTournament(c),(u=n.scene.screen.get(As.o4.NO_MORE_MOVES_SCREEN))&&u instanceof lm&&u.visible&&u.closeWithoutAnimation(),(l=n.scene.screen.get(As.o4.VICTORY_SCREEN))&&l instanceof zg&&l.visible&&l.closeWithoutAnimation(),(h=n.scene.screen.get(As.o4.TOURNAMENTS_RESULT_SCREEN))&&h instanceof Uv&&h.visible&&h.closeWithoutAnimation(),n.scene.screen.close(As.o4.TOURNAMENTS_SCREEN),d=n.scene,f=n.payload.payload||{suitSize:"one",difficulty:"easy"},p=f.suitSize,g=f.difficulty,null==d||d.gameplay.startGame({suitSize:p,difficulty:g}),e.next=36;break;case 27:if(e.prev=27,e.t0=e.catch(6),console.warn("error",e.t0),vv.clearData(),!GameCore.Utils.Valid.isObject(e.t0)){e.next=35;break}if(!GameCore.Utils.Object.hasOwn(e.t0,"code")){e.next=35;break}if("USER_INPUT"!==e.t0.code){e.next=35;break}return e.abrupt("return");case 35:throw e.t0;case 36:case"end":return e.stop()}}),e,null,[[6,27]])}))),n.createTitle(),n.addTimerContainer(),n.createTopLine(),n.createButton(),n.createBottomLine(),n.createDebugButton(),n.alignLeaderList(),n.handleInput(),t.events.on(Phaser.Scenes.Events.UPDATE,(function(){var e;null!=(e=t.screen.get(As.o4.TOURNAMENTS_SCREEN))&&e.visible&&n.updateJoinButton()})),n}(0,ot.Z)(t,e);var n=t.prototype;return n.updateInfo=function(){var t=(0,st.Z)(ut().mark((function t(n){return ut().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.updateTitle(n.title),this.updateTimer(n.endTime),t.next=4,e.prototype.updateInfo.call(this,n);case 4:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.updateTitle=function(e){var t=GameCore.Utils.String.removeDiacritics(e);if(this.title.setText(t),!(this.title.width<=Kv))for(var n=1;n<t.length;n++)if(this.title.setText(t.substring(0,n)+"..."),this.title.width>Kv){this.title.setText(t.substring(0,n-1)+"...");break}},n.updateTimer=function(e){this.timerContainer.setCountdown(e)},n.createTitle=function(){var e=this.scene.make.bitmapText({font:Go.Z.BOLD.KEY,size:this.scene.fontSize(Hv),text:Xv(!0)+" Tournament",origin:{x:.5,y:.5}});this.add(e),this.title=e,Phaser.Display.Align.In.TopCenter(e,this,0,-16)},n.createTopLine=function(){var e=this.scene.add.line(0,0,0,0,Zv.WIDTH,0,Vv,.2);this.add(e),this.topLine=e,e.y=this.timerContainer.y+this.timerContainer.height/2+20},n.createButton=function(){this.button=new gv(this.scene),this.add(this.button),Phaser.Display.Align.In.BottomCenter(this.button,this.background,0,-16)},n.createBottomLine=function(){var e=this.scene.add.line(0,0,0,0,Zv.WIDTH,0,Vv,.2);this.add(e),e.y=this.button.y-this.button.height/2-24},n.addTimerContainer=function(){this.timerContainer=new Lm(this.scene),this.add(this.timerContainer),Phaser.Display.Align.In.Center(this.timerContainer,this.background),this.timerContainer.y=this.title.y+this.title.height+6},n.createDebugButton=function(){var e=this;if(GameCore.Utils.Valid.isDebugger()){var t=new Ho.Z(this.scene,40,40),n=this.scene.add.image(0,0,zv,Yv.IC_BG_OFF);n.setWorldSize(40,40);var i=this.scene.make.bitmapText({font:Go.Z.PRIMARY.KEY,size:this.scene.fontSize(10),text:"PL",origin:{x:.5,y:.5}});i.setCenterAlign(),t.add([n,i]),this.add(t),Phaser.Display.Align.In.TopRight(t,this),t.onClick=function(){console.log("payload",e.payload);var t=e.isCurrentTournamentBeingPlayed();if(console.log({beingPlayed:t}),!t){var n=e.scene.storage.getState(),i=Fu(n);console.log({tournamentId:i,thisID:e.payload.id})}console.log("title width",e.title.width),console.log("block width",e.width),console.log("top line width",e.topLine.width)}}},n.alignLeaderList=function(){Phaser.Display.Align.In.Center(this.leaderList,this),this.leaderList.setY(this.topLine.y+17+this.leaderList.height/2)},n.handleInput=function(){var e=this;this.button.onClick=(0,st.Z)(ut().mark((function t(){return ut().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.button.buttonState!==lv.JOIN){t.next=18;break}return t.prev=1,e.scene.game.globalScene.screen.open(As.o4.NOTIFY_SCREEN,{message:"Joining tournament...",loading:!0}),t.next=5,(0,Rn.qZ)(500);case 5:return t.next=7,e.handleJoinTournament();case 7:qv(100),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(1),window.game.globalScene.screen.open(As.o4.NOTIFY_SCREEN,{message:"Sorry, you cannot join at this time.",duration:3e3,loading:!1});case 13:return t.prev=13,e.updateTextPlay(),t.finish(13);case 16:t.next=19;break;case 18:e.scene.screen.close(As.o4.TOURNAMENTS_SCREEN);case 19:e.updateTextPlay();case 20:case"end":return t.stop()}}),t,null,[[1,10,13,16]])})))},n.updateJoinButton=function(){0===this.timerContainer.getRemain()?this.button.setDisabled(!0):this.button.setDisabled(!1),this.updateTextPlay()},n.isThisTournamentIdIdenticalToCurrentTournament=function(){var e=this.scene.storage.getState(),t=Fu(e);return GameCore.Utils.Valid.isNumber(t)?t===this.payload.id:!!GameCore.Utils.Valid.isString(t)&&t===""+this.payload.id},n.isCurrentTournamentBeingPlayed=function(){return this.isThisTournamentIdIdenticalToCurrentTournament()&&as.instance.isTournamentMode()},n.updateTextPlay=function(){this.button.switchState(this.isCurrentTournamentBeingPlayed()?lv.CONTINUE:lv.JOIN)},t}(hv);function Xv(e){void 0===e&&(e=!1);var t=new Date,n=e?Phaser.Math.RND.between(0,11):t.getMonth();return n<3?"Spring":n<6?"Summer":n<9?"Autumn":"Winter"}var Jv=null,qv=function(e){Jv&&clearTimeout(Jv),Jv=setTimeout((function(){window.game.globalScene.screen.close(As.o4.NOTIFY_SCREEN)}),e)};function Qv(e,t){var n="undefined"!==typeof wo()&&Po()(e)||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){var n;if(!e)return;if("string"===typeof e)return $v(e,t);var i=s()(n=Object.prototype.toString.call(e)).call(n,8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return a()(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return $v(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function $v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var ey,ty=function(e){function t(t,n){var i,a;(a=e.call(this,t)||this).config=void 0,a.isEnable=void 0,a.maxHeight=void 0,a.isScrolling=void 0,a.boundTop=void 0,a.boundBottom=void 0,a.maskGraphics=void 0,a.objects=void 0,a._value=0,a.velocity=0,a.isScrollingSmooth=void 0,a.lastScrollY=void 0,a.isScrollingBack=void 0,a.scrollingBackTo=void 0,a.lastScrollYCount=0,a.hitArea=void 0,a.onScrollEvents=[],a.update=function(e,t){a.isScrollingSmooth&&a.velocity&&a.scrollingSmooth(t),a.isScrollingBack&&a.scrollingBack(t)},a.checkReachBound=function(){return a.isReachTop()||a.isReachBottom()},a.onMouseScroll=(0,Qe.D)((function(e,t,n){if(a.isEnable){var i;if(a.isScrolling=!0,a.checkReachBound())return a.lastScrollY=z()(i=a.lastScrollY).call(i,(function(){return 0})),void(a.isScrolling=!1);a.stopScrollingBack(),a.startScrollSmooth(-n*a.scrollSmooth/15)}}),100,{isImmediate:!0,maxWait:100}),a.onTouchScroll=function(e){if(a.isEnable){a.velocity&&a.stopScrollSmooth(),a.stopScrollingBack(),a.isScrolling=!0;var t=a.scene.game.world.getZoomRatio(),n=e.position,i=e.prevPosition,r=(n.y-i.y)/t,s=a.height*a.maxScrollOver,o=1;if(a.lastScrollY[++a.lastScrollYCount%a.lastScrollY.length]=r,a.isReachTop()&&r>=0){var c=(s-(a.value-a.marginTop))/s;o=Math.min(o,c)}if(a.isReachBottom()&&r<=0){var u=(s-(-a.maxHeight-a.value))/s;o=Math.min(o,u)}var l=r*o,h=a.maxScrollOver*a.height;a.value+l>a.marginTop+h?a.value=a.marginTop+h:a.value+l<-a.maxHeight-h?a.value=-a.maxHeight-h:a.value+=l,a.callOnScrollEvents(a.value,l)}},a.onTouchDown=function(){a.isEnable&&(a.velocity&&a.stopScrollSmooth(),a.stopScrollingBack())},a.onTouchEnd=function(){var e,t;if(a.isReachTop()&&(a.startScrollingBack(a.marginTop),a.stopScrollSmooth()),a.isReachBottom()&&(a.startScrollingBack(-a.maxHeight),a.stopScrollSmooth()),a.isScrolling){var n=G()(e=a.lastScrollY).call(e,(function(e,t){return e+t}))/a.lastScrollY.length;a.startScrollSmooth(n*a.scrollSmooth),a.lastScrollY=z()(t=a.lastScrollY).call(t,(function(){return 0}))}},a.config=(0,Me.Z)({marginTop:0,marginBottom:0,acceleration:1400,maxScrollOver:.15,scrollSmooth:40,scrollingBackRate:5},n);var r=n.width,s=n.height;return a.isEnable=!1,a.maxHeight=0,a.lastScrollY=S()(i=new Array(3)).call(i,0),a.setSize(r,s),a.createGroup(),a.createInput(),a.createEvents(),a.scene.add.existing((0,Cs.Z)(a)),a}(0,ot.Z)(t,e);var n=t.prototype;return n.onScroll=function(e){this.onScrollEvents.push(e)},n.gotoTop=function(){this.value=this.config.marginTop},n.reset=function(){this.maxHeight=0,this.isScrolling=!1,this.isScrollingBack=!1,this.isScrollingSmooth=!1,this.gotoTop(),this.setEnable(!1)},n.createDebug=function(){var e=this.drawDebugBox(16711680,.8);console.log(null==e?void 0:e.x,null==e?void 0:e.y,null==e?void 0:e.displayWidth,null==e?void 0:e.displayHeight)},n.setEnable=function(e){this.isEnable=e,e?this.setInteractive({draggable:!0,useHandCursor:!0}):this.disableInteractive()},n.addItem=function(e){this.addAt(e),this.objects.add(e);var t=e.y+e.height+this.marginBottom-this.height/2;this.maxHeight=Math.max(this.maxHeight,t,0),this.updateObjectVisible()},n.addItems=function(e){var t=this;this.addAt(e),this.objects.addMultiple(e);var n=z()(e).call(e,(function(e){return e.y+e.height+t.marginBottom-t.height/2}));this.maxHeight=Math.max(this.maxHeight,Math.max.apply(Math,n),0),this.updateObjectVisible()},n.clearItem=function(){this.objects.clear(!0,!0),this.reset()},n.getChildren=function(){var e;return u()(e=this.objects.getChildren()).call(e,(function(e){return e.active}))},n.createBound=function(e,t,n,i){this.boundTop=this.scene.make.image({key:e,frame:t}),this.boundBottom=this.scene.make.image({key:e,frame:t}),this.boundTop.setTint(i),this.boundBottom.setTint(i),this.boundTop.setAlpha(1,1,0,0),this.boundBottom.setAlpha(0,0,1,1),this.boundTop.setDepth(fc.Z.PRIORITY),this.boundBottom.setDepth(fc.Z.PRIORITY);var a=this.width,r=n,s=this.getWorldPosition(),o=s.x,c=s.y;this.boundTop.setDisplaySize(a,r),this.boundBottom.setDisplaySize(a,r),this.boundTop.setY(-this.displayHeight/2+r/2+c-this.y-1),this.boundBottom.setY(this.displayHeight/2-r/2+c-this.y+1),this.boundTop.setX(o-this.x),this.boundBottom.setX(o-this.x),this.add([this.boundTop,this.boundBottom])},n.createMask=function(){var e;null==(e=this.maskGraphics)||e.destroy(),this.maskGraphics=this.scene.make.graphics({fillStyle:{color:255,alpha:1},visible:!0}),this.maskGraphics.setName("MaskGraphics");var t=this.width,n=this.height;this.maskGraphics.fillRoundedRect(0-t/2,0-n/2,t,n,0),this.setMask(this.maskGraphics.createGeometryMask()),this.scene.events.off(Phaser.Scenes.Events.UPDATE,this.updateMask,this),this.scene.events.on(Phaser.Scenes.Events.UPDATE,this.updateMask,this)},n.updateMask=function(){var e=this.getWorldPosition(),t=e.x,n=e.y;this.maskGraphics.setPosition(t,n)},n.createGroup=function(){this.objects=this.scene.make.group({})},n.updateObject=function(e){this.objects.incY(e),this.updateObjectVisible()},n.updateObjectVisible=function(){for(var e=this.objects.getChildren(),t=0;t<e.length;t++){var n=e[t];n.y+n.height<-this.height/2||n.y-n.height>this.height/2?n.setVisible(!1):n.setVisible(!0)}},n.createInput=function(){this.setInteractive({draggable:!0,useHandCursor:!0}),this.on(Phaser.Input.Events.POINTER_WHEEL,this.onMouseScroll),this.on(Phaser.Input.Events.GAMEOBJECT_DRAG,this.onTouchScroll),this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,this.onTouchDown),this.scene.input.on(Phaser.Input.Events.POINTER_UP,this.onTouchEnd,this)},n.createEvents=function(){this.scene.events.on(Phaser.Scenes.Events.UPDATE,this.update)},n.callOnScrollEvents=function(e,t){for(var n,i=Qv(this.onScrollEvents);!(n=i()).done;){(0,n.value)(this,e,t)}},n.scrollingBack=function(e){var t=(this.scrollingBackTo-this.value)*e*this.scrollingBackRate/1e3;this.value+=t,Math.abs(this.scrollingBackTo-this.value)<.5&&(this.value=this.scrollingBackTo,this.stopScrollingBack()),this.callOnScrollEvents(this.value,t)},n.startScrollingBack=function(e){this.isScrollingBack=!0,this.scrollingBackTo=e},n.stopScrollingBack=function(){this.isScrollingBack=!1},n.scrollingSmooth=function(e){var t=this.velocity*e/1e3;this.value+=t;var n=Math.abs(this.velocity)/this.velocity;this.velocity-=n*this.acceleration*e/1e3,Math.abs(this.velocity)<this.acceleration*e/1e3&&this.stopScrollSmooth(),this.isReachTop()&&(this.startScrollingBack(this.marginTop),this.stopScrollSmooth()),this.isReachBottom()&&(this.startScrollingBack(-this.maxHeight),this.stopScrollSmooth()),this.callOnScrollEvents(this.value,t)},n.startScrollSmooth=function(e){this.isScrollingSmooth=!0,e&&(e*this.velocity>0?this.velocity+=e:this.velocity=e)},n.stopScrollSmooth=function(){this.isScrollingSmooth=!1,this.isScrolling=!1,this.velocity=0},n.isReachTop=function(){return this.value>this.marginTop},n.isReachBottom=function(){return-this.value>this.maxHeight},(0,Wt.Z)(t,[{key:"marginTop",get:function(){return this.config.marginTop}},{key:"marginBottom",get:function(){return this.config.marginBottom}},{key:"acceleration",get:function(){return this.config.acceleration}},{key:"maxScrollOver",get:function(){return this.config.maxScrollOver}},{key:"scrollSmooth",get:function(){return this.config.scrollSmooth}},{key:"scrollingBackRate",get:function(){return this.config.scrollingBackRate}},{key:"value",get:function(){return this._value},set:function(e){var t=e-this._value;this._value=e,this.updateObject(t)}}]),t}(Phaser.GameObjects.Container),ny=ty,iy=(function(e){function t(t){var n;return(n=e.call(this,t,"UpdateAbleObject")||this).updateInfo=void 0,n}(0,ot.Z)(t,e)}(Phaser.GameObjects.GameObject),function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).classType=void 0,i.listConfigs=void 0,i.padding=void 0,i.startObjectIndex=void 0,i.endObjectIndex=void 0,i.listObjects=void 0,i.classType=n.classType,i.listConfigs=n.listConfigs,i.padding=n.padding?n.padding:0,i.objects.classType=i.classType,i.updateConfig(i.listConfigs),i}(0,ot.Z)(t,e);var n=t.prototype;return n.reset=function(){e.prototype.reset.call(this),this.killAndHideAll()},n.getChildren=function(){var e;return u()(e=this.listObjects).call(e,(function(e){return void 0!=e&&e.active}))},n.updateConfig=function(e){var t;this.reset(),this.listConfigs=e,this.listObjects=S()(t=new Array(e.length)).call(t,void 0),this.addObjectIndex(0,0);var n=this.getEndObjectIndex();this.addObjectIndex(1,n),this.startObjectIndex=this.getStartObjectIndex(),this.endObjectIndex=this.getEndObjectIndex(),this.updateMaxHeight(),this.value=this.marginTop},n.killAndHideAll=function(){var e,t=this;this.listObjects instanceof Array&&z()(e=this.listObjects).call(e,(function(e){void 0!==e&&t.objects.killAndHide(e)}))},n.setItemPosition=function(e,t){var n=e.height;e.setPosition(0,n/2+(n+this.padding)*t-this.height/2)},n.updateMaxHeight=function(){return this.maxHeight=Math.max(this.listConfigs.length*(this.objHeight+this.padding)-this.padding+this.marginBottom-this.height,0)},n.updateObject=function(e){this.objects.incY(e);var t=this.getStartObjectIndex(),n=this.getEndObjectIndex();t!=this.startObjectIndex&&(t>this.startObjectIndex?this.killObjectIndex(this.startObjectIndex,t-1):this.addObjectIndex(t,this.startObjectIndex-1),this.startObjectIndex=t),n!=this.endObjectIndex&&(n<this.endObjectIndex?this.killObjectIndex(n+1,this.endObjectIndex):this.addObjectIndex(this.endObjectIndex+1,n),this.endObjectIndex=n)},n.killObjectIndex=function(e,t){for(var n=e;n<=t;n++){var i=this.listObjects[n];i&&(this.objects.killAndHide(i),this.listObjects[n]=void 0)}},n.addObjectIndex=function(e,t){for(var n=e;n<=t;n++){var i=this.padding,a=this.listConfigs;if(n>=a.length)return;if(this.listObjects[n])console.log("position "+n+" is not empty!");else{var r=this.objects.getFirstDead(!0),s=r.height,o=s/2+(s+i)*n+this.value-this.height/2;r.updateInfo(a[n]),r.setPosition(0,o),r.setActive(!0),r.setVisible(!0),this.addAt(r),this.listObjects[n]=r}}},n.getStartObjectIndex=function(){var e=this.objHeight,t=this.padding;return Math.max(Math.floor((0-this.value)/(e+t)),0)},n.getEndObjectIndex=function(){var e=this.objHeight,t=this.padding,n=this.listConfigs,i=e+t;return Math.min(Math.floor((this.height-this.value)/i),n.length)},(0,Wt.Z)(t,[{key:"objHeight",get:function(){var e=this.objects.getChildren();return 0==e.length?this.maxHeight=0:e[0].height}}]),t}(ny)),ay=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="TournamentPayloadInvalid",i.message=t||"The tournament payload invalid",i.payload=n,i}return(0,ot.Z)(t,e),t}((0,wt.Z)(Error)),ry=function(e){function t(t){var n;return(n=e.call(this,t,243,42)||this).buttonLabelContainer=void 0,n.setSize(243,42),n.setName("CreateNewTournament"),n.createButtonLabel(),n.playAnimation(),n}return(0,ot.Z)(t,e),t.prototype.createButtonLabel=function(){this.buttonLabelContainer=new Rp(this.scene,8,"Create Tournament"),this.add(this.buttonLabelContainer)},t}(dv),sy=Ds.Z.GAMEPLAY_DEFAULT,oy=sy.KEY,cy=sy.FRAME,uy=function(e){function t(t,n,i,a){var r;return(r=e.call(this,t,n,i)||this).illustration=void 0,r.createNewTournamentButton=void 0,r.payload=void 0,r.scrollerManager=void 0,r.handleCreateTournament=(0,st.Z)(ut().mark((function e(){var t,n,i,a,s;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.scene.game.globalScene,e.prev=1,n=r.scene.player.getPlayer(),i=n.playerId,a=n.name,s={playerId:i,playerName:a,score:0,autoStartGame:!0,success:!0},t.screen.open(As.o4.NOTIFY_SCREEN,{message:"Creating tournament...",loading:!0}),e.next=7,(0,Rn.qZ)(500);case 7:return e.next=9,Ph();case 9:return e.next=11,r.scene.storage.dispatch(nl(s));case 11:return e.next=13,r.scene.storage.dispatch(yh());case 13:return e.next=15,r.updateTournaments();case 15:r.scene.screen.close(As.o4.TOURNAMENTS_SCREEN),r.scene.gameplay.startNewGame(),hy(0),e.next=29;break;case 21:if(e.prev=21,e.t0=e.catch(1),!GameCore.Utils.Valid.isObject(e.t0)){e.next=28;break}if(!GameCore.Utils.Object.hasOwn(e.t0,"code")){e.next=28;break}if("USER_INPUT"!==e.t0.code){e.next=28;break}return hy(0),e.abrupt("return");case 28:t.screen.open(As.o4.NOTIFY_SCREEN,{message:"Oops!\n You are not able to create\ntournaments right now.\n\nPlease try again later.",duration:2e3,loading:!1});case 29:case"end":return e.stop()}}),e,null,[[1,21]])}))),r.updateTournaments=(0,st.Z)(ut().mark((function e(){var t,n,i;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,Cs.Z)(r),n=t.scrollerManager,i=n.tournamentsContainer,n.forceLoadData=!0,i.updateScrollerIdx(r.scrollerManager),e.next=6,i.updateContainer();case 6:n.scroller.setEnable(!0);case 7:case"end":return e.stop()}}),e)}))),r.scrollerManager=a,r.setSize(311,326),r.createIllustration(),r.createText(),r.createButton(),r}(0,ot.Z)(t,e);var n=t.prototype;return n.createIllustration=function(){var e=this.scene.add.image(0,0,oy,cy.NO_TOURNAMENT);e.setWorldSize(240,240),this.add(e),this.illustration=e,Phaser.Display.Align.In.TopCenter(e,this)},n.createText=function(){var e=this.scene.make.bitmapText({font:Go.Z.PRIMARY.KEY,size:this.scene.fontSize(14),text:"No tournaments found",origin:{x:.5,y:.5}}).setTint(16579837);this.add(e),this.alignUnder(e,this.illustration)},n.createButton=function(){var e=this;this.createNewTournamentButton=new ry(this.scene),this.add(this.createNewTournamentButton),this.createNewTournamentButton.onClick=function(){e.handleCreateTournament()},Phaser.Display.Align.In.BottomCenter(this.createNewTournamentButton,this)},n.alignUnder=function(e,t){var n=(e.height+t.height)/2;Phaser.Display.Align.In.Center(e,t,0,n)},t}(Phaser.GameObjects.Container),ly=null,hy=function(e){ly&&clearTimeout(ly),ly=setTimeout((function(){window.game.globalScene.screen.close(As.o4.NOTIFY_SCREEN)}),e)},dy=function(){function e(e,t,n){var i=this;this.scene=void 0,this.name=void 0,this.scroller=void 0,this.tournamentsContainer=void 0,this.noTournamentBlock=void 0,this.loadData=!1,this.debugNoTournament=!1,this.handleHideLoading=function(){i.scroller.revive(),i.noTournamentBlock.revive(),i.tournamentsContainer.showLoading(!1),M()(i.scroller.getChildren()).length>0&&i.noTournamentBlock.kill()},this.scene=e.scene,this.tournamentsContainer=e,this.scroller=t,this.name=n||"",this.createNoTournamentBlock(),Qm.on("tournament_block_update_done",this.handleHideLoading)}var t=e.prototype;return t.createNoTournamentBlock=function(){var e=this;this.noTournamentBlock=new uy(this.scene,0,0,this),this.tournamentsContainer.add(this.noTournamentBlock),this.tournamentsContainer.bringToTop(this.noTournamentBlock),this.noTournamentBlock.kill(),this.scene.events.on(Phaser.Scenes.Events.UPDATE,(function(){e.noTournamentBlock.active&&Phaser.Display.Align.In.Center(e.noTournamentBlock,e.scroller)}))},t.setMask=function(e){this.scroller.setMask(e),this.noTournamentBlock.setMask(e)},t.updateScroller=function(){var e=(0,st.Z)(ut().mark((function e(){var t,n;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((t=this.getListData()).length<1)){e.next=4;break}return this.scroller.setEnable(!1),e.abrupt("return");case 4:this.scroller.setEnable(!0),n=this.scroller.value,this.scroller.updateConfig(t),this.scroller.value=n,this.scroller.onTouchEnd();case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.parseResponsesIntoTournaments=function(){var e=[];return this.filterTournament().forEach((function(t){try{var n=t.getID(),i=t.getPayload();if(!i)return;var a=JSON.parse(i),r=a.playerName;if(!a.leaderboardId)throw new ay(null,a);var s={id:n,title:t.getTitle()||r+"'s Tournament",payload:a,endTime:t.getEndTime(),contextID:t.getContextID()};e.push(s)}catch(o){console.warn("parseResponsesIntoTournaments",o)}})),e},(0,Wt.Z)(e,[{key:"forceLoadData",get:function(){return this.loadData},set:function(e){this.loadData=e}},{key:"forceNoTournament",get:function(){return this.debugNoTournament&&!this.loadData},set:function(e){this.debugNoTournament=e}}]),e}(),fy=function(e){function t(t,n,i){var a;return(a=e.call(this,t,n,i)||this).noTournamentBlock.createNewTournamentButton.kill(),a}(0,ot.Z)(t,e);var n=t.prototype;return n.getListData=function(){if(this.forceNoTournament)return[];var e=this.tournamentsContainer.getWorldTournamentsData();return u()(e).call(e,(function(e){return!!(e.payload&&e.payload.suitSize&&e.payload.difficulty)}))},n.filterTournament=function(){var e=this.tournamentsContainer.getTournaments();return u()(e).call(e,(function(e){var t=e.getPayload();if(!t)return!1;try{var n=JSON.parse(t);if(!n.suitSize||!n.difficulty)return!1}catch(i){return!1}return!0}))},t}(dy),py=function(e){function t(t,n,i){var a;return(a=e.call(this,t,n,i)||this).noTournamentBlock.createNewTournamentButton.kill(),a}(0,ot.Z)(t,e);var n=t.prototype;return n.getListData=function(){return this.forceNoTournament?[]:this.parseResponsesIntoTournaments()},n.filterTournament=function(){var e=this.scene.player.getPlayerId(),t=this.tournamentsContainer.getTournaments();return u()(t).call(t,(function(t){var n=t.getPayload();if(!n)return!1;try{var i=JSON.parse(n);return!(!i.suitSize||!i.difficulty)&&(i.playerId&&e!=i.playerId)}catch(a){return!1}}))},t}(dy),gy=py,my=function(e){function t(t,n,i){var a;return(a=e.call(this,t,n,i)||this).handleShowNoTournamentBlock=function(){M()(a.scroller.getChildren()).length<1&&(a.noTournamentBlock.revive(),a.noTournamentBlock.createNewTournamentButton.revive())},a.handleHideLoading=function(){a.scroller.revive(),a.tournamentsContainer.showLoading(!1),M()(a.scroller.getChildren()).length<1&&a.noTournamentBlock.createNewTournamentButton.revive()},a.forceNoTournament=!1,a}(0,ot.Z)(t,e);var n=t.prototype;return n.getListData=function(){return this.forceNoTournament?[]:this.parseResponsesIntoTournaments()},n.filterTournament=function(){var e=this.scene.player.getPlayerId(),t=this.tournamentsContainer.getTournaments(),n=u()(t).call(t,(function(t){var n=t.getPayload();if(!n)return!1;try{var i=JSON.parse(n);return!(!i.suitSize||!i.difficulty)&&(i.playerId&&e===i.playerId)}catch(a){return!1}}));return console.log(">>>>>>>>>>>>>",{result:n,tournaments:t}),n},t}(dy),vy=my,yy=function(e){function t(t,n,i,a,r,s){var o;return(o=e.call(this,t,n,i)||this).icon=void 0,o.text=void 0,o.createIcon(a,r),o.createText(s),o.add([o.icon,o.text]),o}(0,ot.Z)(t,e);var n=t.prototype;return n.createIcon=function(e,t){this.icon=this.scene.add.image(0,-10,e,t).setTint(16579837),this.icon.setWorldSize(28,28)},n.createText=function(e){this.text=this.scene.make.bitmapText({font:Go.Z.PRIMARY.KEY,size:this.scene.fontSize(cd.FOOTER),text:e,origin:{x:.5,y:.5},y:14}).setTint(13355979)},t}(Ho.Z),by=yy,Sy=Ds.Z.GAMEPLAY_DEFAULT,Ty=Sy.KEY,Ey=Sy.FRAME,Cy=function(e){function t(t){var n;return(n=e.call(this,t,40,40,Ty,Ey.IC_SETTINGS,"Settings")||this).onClick=function(){t.screen.open(As.o4.SETTINGS_SCREEN)},n}return(0,ot.Z)(t,e),t}(by),Ay=Ds.Z.GAMEPLAY_DEFAULT,wy=Ay.KEY,Iy=Ay.FRAME,Py=function(e){function t(t){var n;return(n=e.call(this,t,40,40,wy,Iy.CUP,"Tournaments")||this).onClick=function(){},n}return(0,ot.Z)(t,e),t}(by),ky=Ds.Z.GAMEPLAY_DEFAULT,xy=ky.KEY,_y=ky.FRAME,Oy=function(e){function t(t){var n;return(n=e.call(this,t,40,40,xy,_y.IC_UNDO,"Back to Game")||this).onClick=function(){t.screen.close(As.o4.TOURNAMENTS_SCREEN)},n}return(0,ot.Z)(t,e),t}(by),Dy=Eg,By=Dy.WIDTH,Ly=Dy.HEIGHT,Ry=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.settingsButton=void 0,n.tournamentsButton=void 0,n.gameButton=void 0,n.buttons=[],n.background=void 0,n.scene=t,n.setSize(By,Ly),n.createBackgroundMask(),n.createBackground(),n.createButtons(),n}(0,ot.Z)(t,e);var n=t.prototype;return n.createBackgroundMask=function(){var e=this.scene.theme.getCurrentThemeConfig().backgroundKey,t=this.scene.add.image(0,0,e);t.setOrigin(.5,1),this.add(t),this.background=t,this.scene.events.on(es.BACKGROUND_CHANGED,(function(e){t.setTexture(e)})),this.updateBackgroundMask()},n.updateBackgroundMask=function(){var e=this.scene.world.isLandscape()?20:0,t=this.scene.world.getPixelRatio(),n=this.scene.ads.getBannerHeight(),i=this.background,a=this.scene.gameZone,r=a.width,s=a.height;i.setWorldSize(r,s),i.setCrop(0,667*t-(76+n)/i.scaleY-e*t,this.width*t,s*t),i.setY(n+this.height/2+e)},n.createBackground=function(){var e=this.scene.gameZone.width>By?20:0,t=new Qd.Z(this.scene,0,0,this.width,this.height,e,2039583,.4);this.add(t),t.removeInteractive()},n.createButtons=function(){this.buttons=[],this.createSettingsButton(),this.createGameButton(),this.alignButtons()},n.createSettingsButton=function(){this.settingsButton=new Cy(this.scene),this.add(this.settingsButton),this.buttons.push(this.settingsButton)},n.createTournamentsButton=function(){this.tournamentsButton=new Py(this.scene),this.add(this.tournamentsButton),this.buttons.push(this.tournamentsButton)},n.createGameButton=function(){this.gameButton=new Oy(this.scene),this.add(this.gameButton),this.buttons.push(this.gameButton)},n.alignButtons=function(){if(0!==this.buttons.length)for(var e=this.width/this.buttons.length,t=0;t<this.buttons.length;++t)this.buttons[t].setX((t-this.buttons.length/2+.5)*e),this.buttons[t].setY(2)},t}(Phaser.GameObjects.Container),Gy=Ry,Ny=vg,My=yg,Fy=gg,Uy=pg,Zy=mg,Hy=[Uy,Fy,Zy],Wy=function(e){function t(t){var n;return(n=e.call(this,t)||this).background=void 0,n.header=void 0,n.footer=void 0,n.tab=void 0,n.scrollers=[],n.scrollerManagers=[],n.tabNames=Hy,n.moveState=void 0,n.currentIdx=0,n.tournaments=[],n.worldTournament=[],n.loading=void 0,n.updateContainer=(0,st.Z)(ut().mark((function e(){var t,i;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.showLoading(!0),n.scrollerManagers.forEach((function(e){e.scroller.kill(),e.noTournamentBlock.kill()})),e.next=4,n.loadTournament();case 4:return e.next=6,n.loadWorldTournament();case 6:if(i=n.tab.currentIdx,n.scrollerManagers.forEach((function(e){e.updateScroller()})),n.tab.selectTab(i),null==(t=n.scrollers[i])||t.setEnable(!0),!GameCore.Utils.Device.isMobile()){e.next=12;break}return e.abrupt("return");case 12:n.scrollers.forEach((function(e,t){t!==i&&e.setEnable(!1)}));case 13:case"end":return e.stop()}}),e)}))),n.setSizeContainer(),n.addBackground(),GameCore.Utils.Device.isMobile()&&n.createHeaderBackground(),n.createHeader(),n.createFooter(),n.createTabSelector(),n.createScrollers(),n.createLoading(),GameCore.Utils.Device.isMobile()||n.addMask(),n}(0,ot.Z)(t,e);var n=t.prototype;return n.createLoading=function(){this.loading=new Rm.Z(this.scene),this.add(this.loading)},n.showLoading=function(e){e?this.loading.revive():this.loading.kill()},n.createHeaderBackground=function(){var e=this,t=this.scene.world.getPixelRatio(),n=this.scene.gameZone,i=n.width,a=n.height,r=this.scene.theme.getCurrentThemeConfig().backgroundKey,s=this.scene.add.image(0,-a/2,r);s.setOrigin(.5,0),s.setWorldSize(i,a);var o=108/s.scaleY;s.setCrop(0,0,this.width*t,o),s.setAlpha(1),this.add(s),this.scene.events.on(Phaser.Scenes.Events.UPDATE,(function(){s.y=-e.y-a/2})),this.scene.events.on(es.BACKGROUND_CHANGED,(function(e){s.setTexture(e)}))},n.getWorldTournamentsData=function(){return this.worldTournament},n.getTournaments=function(){return this.tournaments},n.setSizeContainer=function(){var e=this.scene.gameZone,t=e.width,n=e.height-My.HEIGHT;this.setSize(t,n)},n.createHeader=function(){this.header=new Cm(this.scene),this.add(this.header),this.bringToTop(this.header),this.header.setInteractive(),Phaser.Display.Align.In.TopCenter(this.header,this.background,0,-10)},n.createTabSelector=function(){this.tab=new Om(this),this.add(this.tab),this.bringToTop(this.tab),this.alignTabSelectorUnderHeader()},n.alignTabSelectorUnderHeader=function(){this.tab&&(Phaser.Display.Align.In.Center(this.tab,this.background),this.tab.y=this.header.y+this.header.height)},n.createScrollers=function(){var e=this;this.scrollers=[],this.scrollerManagers=[],Hy.forEach((function(t){e.createScroller(t)})),this.scrollers.forEach((function(e,t){e.setX(Ny*t),t>0&&e.setAlpha(0)}))},n.createScroller=function(e){var t=GameCore.Utils.Device.isMobile()?this.header.height+this.tab.height:0,n=GameCore.Utils.Device.isMobile()?this.footer.height+10:0,i=Ny,a=this.distanceBetweenTabBottomAndFooterTop()+(GameCore.Utils.Device.isMobile()?t+this.footer.height:0),r=new iy(this.scene,{classType:jv,listConfigs:[],width:i,height:a,padding:24,marginTop:10+t,marginBottom:10+n});this.add(r),this.sendToBack(r),r.setEnable(!0),GameCore.Utils.Device.isMobile()?Phaser.Display.Align.In.TopCenter(r,this):this.alignUnder(r,this.tab),this.scrollers.push(r);var s=this.createScrollerManager(r,e);s&&this.scrollerManagers.push(s)},n.createScrollerManager=function(e,t){switch(t){case Uy:return new fy(this,e,t);case Fy:return new gy(this,e,t);case Zy:return new vy(this,e,t);default:return null}},n.distanceBetweenTabBottomAndFooterTop=function(){return this.footer.y-this.tab.y-(this.footer.height+this.tab.height)/2},n.alignUnder=function(e,t){var n=(e.height+t.height)/2;Phaser.Display.Align.In.Center(e,t,0,n)},n.updateScrollerIdx=function(e){for(var t=0;t<this.scrollerManagers.length;t++)e===this.scrollerManagers[t]&&(this.currentIdx=t)},n.loadTournament=function(){var e=(0,st.Z)(ut().mark((function e(){return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.scene.facebook.tournament.getTournamentsAsync();case 3:this.tournaments=e.sent,e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),this.tournaments=[];case 9:case"end":return e.stop()}}),e,this,[[0,6]])})));return function(){return e.apply(this,arguments)}}(),n.loadWorldTournament=function(){var e=(0,st.Z)(ut().mark((function e(){return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Qu();case 3:this.worldTournament=e.sent,console.log("worldTournament",this.worldTournament),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),this.worldTournament=[];case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),n.createFooter=function(){this.footer=new Gy(this.scene),this.add(this.footer),this.bringToTop(this.footer),this.footer.setInteractive();var e=this.scene.ads.getBannerHeight(),t=this.scene.world.isLandscape()?-20:0;Phaser.Display.Align.In.BottomCenter(this.footer,this.background,0,-e+t),this.footer.updateBackgroundMask()},n.addBackground=function(){var e="screen-background";if(!this.scene.textures.exists(e)){var t=this.width,n=this.height,i=this.scene.add.graphics();i.fillStyle(859421,1),i.fillRect(0,0,t,n),i.generateTexture(e,t,n),i.destroy()}this.background=this.scene.add.image(0,0,e),this.background.kill(),this.add(this.background)},n.addMask=function(){var e=this,t=this.scene.make.graphics({fillStyle:{color:255,alpha:0},visible:!1});t.setName("MaskGraphics");var n=this.tab.borderLineWidth,i=this.tab.x,a=(this.footer.y-this.footer.height/2+(this.tab.y+this.tab.height/2))/2,r=this.distanceBetweenTabBottomAndFooterTop()-n-8,s=i-200,o=a-r/2+n;t.fillRoundedRect(s,o,400,r,0),this.scrollerManagers.forEach((function(e){e.setMask(t.createGeometryMask())})),this.scene.events.on(Phaser.Scenes.Events.UPDATE,(function(){var n=e.getWorldPosition(),i=n.x,a=n.y;t.setPosition(i,a)}))},t}(Phaser.GameObjects.Container),zy=Wy,Yy=function(e){function t(t,n,i,a){var r;return(r=e.call(this,t,n,i,a)||this).fadeInAnimation=void 0,r.fadeOutAnimation=void 0,r.tournamentsContainer=void 0,r.setBackground=function(){var e=r.scene.theme.getCurrentThemeConfig().backgroundKey;r.background.setTexture(e);var t=r.scene.gameZone,n=t.width,i=t.height;r.background.setWorldSize(n,i)},r.setDepth(As.Ks.POPUP),r.tournamentsContainer=new zy(t),r.add(r.tournamentsContainer),r.setBackground(),r.scene.events.on(es.BACKGROUND_CHANGED,r.setBackground),r.createBottomLogo(),r}(0,ot.Z)(t,e);var n=t.prototype;return n.createBottomLogo=function(){if(!this.scene.world.isLandscape()){var e=new Hg(this.scene);this.add(e),Phaser.Display.Align.In.BottomCenter(e,this)}},n.open=function(){e.prototype.open.call(this),this.setBlockInputOutsideEnabled(!0),this.tournamentsContainer.setAlpha(1),this.tournamentsContainer.updateContainer(),this.runOpenAnimation()},n.close=function(){this.runCloseAnimation()},n.runOpenAnimation=function(){this.scene.audio.playSound(Bt.POPUP_SHOW),this.fadeInAnimation||(this.fadeInAnimation=new Kd.Z({targets:[this],duration:300})),this.fadeInAnimation.play()},n.runCloseAnimation=function(){var t,n,i=this;null!=(t=this.fadeOutAnimation)&&null!=(n=t.tween)&&n.isPlaying()||(this.scene.audio.playSound(Bt.POPUP_OFF),this.fadeOutAnimation||(this.fadeOutAnimation=new qd.Z({targets:[this],props:{alpha:0},duration:300,onComplete:function(){e.prototype.close.call(i)}})),this.fadeOutAnimation.play())},t}(GameCore.Screen),Vy=Yy;!function(e){e.WIN="win",e.LOSE="lose",e.DRAW="draw",e.WAITING_FOR_OPPONENT="waiting_for_opponent"}(ey||(ey={}));var Ky,jy=ey,Xy=Ds.Z.DEFAULT,Jy=Xy.KEY,qy=Xy.FRAME,Qy=Ds.Z.GAMEPLAY_DEFAULT,$y=Qy.KEY,eb=Qy.FRAME,tb=function(e){function t(t){var n;return(n=e.call(this,t)||this)._avatar=void 0,n._username=void 0,n._crownZone=void 0,n.setSize(54,94),n.createAvatarFrame(),n.createCrownZone(),n.createText(),n.alignComponents(),n}(0,ot.Z)(t,e);var n=t.prototype;return n.createAvatarFrame=function(){this._avatar=new Ad(this.scene,{key:Jy,background:qy.BLANK,width:64,height:64,loadDelay:100}),this._avatar.update(),this._avatar.background.kill(),this._avatar.loadPhoto("avatar",Yr.Z.AVATAR.FILE,100),this.add(this._avatar)},n.createText=function(){this._username=this.scene.make.text({style:{fontFamily:Go.Z.FONT_FAMILY},origin:{x:.5,y:.5}}),this._username.setHighQuality(),this._username.setFontSize(12),this._username.setText("Name"),this.add(this._username)},n.createCrownZone=function(){this._crownZone=this.scene.add.container(),this._crownZone.setSize(20,20),this.add(this._crownZone);var e=this.scene.add.image(0,0,$y,eb.AVATAR_CROWN);e.setWorldSize(19,14),Phaser.Display.Align.In.Center(e,this._crownZone),this._crownZone.add(e)},n.alignComponents=function(){Phaser.Display.Align.In.BottomCenter(this._username,this),Phaser.Display.Align.In.TopCenter(this._crownZone,this),Phaser.Display.Align.In.Center(this._avatar,this)},n.addBackground=function(){var e="player-avatar-background";if(!this.scene.textures.exists(e)){var t=this.width,n=this.height,i=this.scene.add.graphics();i.fillStyle(65280,.2),i.fillRect(0,0,t,n),i.generateTexture(e,t,n),i.destroy()}var a=this.scene.add.image(0,0,e);this.add(a)},n.setWinner=function(e){void 0===e&&(e=!0),this._crownZone.setVisible(e)},n.hideContent=function(){this._avatar.setScale(0),this._username.setAlpha(0),this._crownZone.setAlpha(0)},n.runEntranceAnimationAvatar=function(){var e=(0,st.Z)(ut().mark((function e(){var t=this;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new(xe())((function(e){t.scene.add.tween({targets:t._avatar,duration:300,ease:Phaser.Math.Easing.Cubic.Out,props:{scale:{from:0,to:1}},onComplete:e})})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),n.runEntranceAnimationUsername=function(){var e=(0,st.Z)(ut().mark((function e(){var t=this;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new(xe())((function(e){t.scene.add.tween({targets:t._username,duration:300,ease:Phaser.Math.Easing.Sine.Out,props:{alpha:{from:0,to:1}},onComplete:e})})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),n.runEntranceAnimationCrown=function(){var e=(0,st.Z)(ut().mark((function e(){var t=this;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new(xe())((function(e){t.scene.add.tween({targets:t._crownZone,ease:Phaser.Math.Easing.Sine.Out,duration:100,props:{alpha:{from:0,to:1},y:{from:t._crownZone.y-t._crownZone.height/4,to:t._crownZone.y}},onComplete:e})})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),n.runEntranceAnimation=function(){var e=(0,st.Z)(ut().mark((function e(){return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,xe().all([this.runEntranceAnimationAvatar(),this.runEntranceAnimationUsername()]);case 2:return e.next=4,this.runEntranceAnimationCrown();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),(0,Wt.Z)(t,[{key:"avatar",get:function(){return this._avatar}},{key:"username",get:function(){return this._username}},{key:"crownZone",get:function(){return this._crownZone}}]),t}(Phaser.GameObjects.Container),nb=16762624,ib=function(e){function t(t){var n;return(n=e.call(this,t)||this)._youAvatar=void 0,n._opponentAvatar=void 0,n._versusText=void 0,n.setSize(231,94),n.createAvatars(),n.createVersusText(),n.alignComponents(),n}(0,ot.Z)(t,e);var n=t.prototype;return n.createAvatars=function(){this._youAvatar=new tb(this.scene),this._opponentAvatar=new tb(this.scene),this.add([this._youAvatar,this._opponentAvatar])},n.createVersusText=function(){this._versusText=this.scene.make.bitmapText({font:Go.Z.BOLD.KEY,size:this.scene.fontSize(18),origin:{x:.5,y:.5}}),this._versusText.setText("VS"),this.setTintVersusText(),this.add(this._versusText)},n.setTintVersusText=function(e){void 0===e&&(e=!0),e?this._versusText.setTint(11222016,nb,nb,nb):this._versusText.clearTint()},n.alignComponents=function(){Phaser.Display.Align.In.Center(this._versusText,this),Phaser.Display.Align.In.LeftCenter(this._youAvatar,this,-20),Phaser.Display.Align.In.RightCenter(this._opponentAvatar,this,-20)},n.addBackground=function(){var e="avatar-zone-background";if(!this.scene.textures.exists(e)){var t=this.width,n=this.height,i=this.scene.add.graphics();i.fillStyle(65280,.2),i.fillRect(0,0,t,n),i.generateTexture(e,t,n),i.destroy()}var a=this.scene.add.image(0,0,e);this.add(a)},n.updateState=function(e){switch(e){case jy.WIN:this._youAvatar.setWinner(!0),this._opponentAvatar.setWinner(!1),this.setTintVersusText();break;case jy.LOSE:this._youAvatar.setWinner(!1),this._opponentAvatar.setWinner(!0),this.setTintVersusText(!1);break;case jy.DRAW:default:this._youAvatar.setWinner(!1),this._opponentAvatar.setWinner(!1),this.setTintVersusText()}},n.hideContent=function(){this._youAvatar.hideContent(),this._opponentAvatar.hideContent(),this._versusText.setAlpha(0)},n.runEntranceAnimationVersusText=function(){var e=(0,st.Z)(ut().mark((function e(){var t=this;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new(xe())((function(e){t.scene.add.tween({targets:t.versusText,duration:100,ease:Phaser.Math.Easing.Sine.Out,props:{alpha:{from:0,to:1},y:{from:t.versusText.y+t.versusText.height/4,to:t.versusText.y}},onComplete:e})})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),n.runEntranceAnimation=function(){var e=(0,st.Z)(ut().mark((function e(){return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,xe().all([this._youAvatar.runEntranceAnimation(),this._opponentAvatar.runEntranceAnimation()]);case 2:return e.next=4,this.runEntranceAnimationVersusText();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),(0,Wt.Z)(t,[{key:"youAvatar",get:function(){return this._youAvatar}},{key:"opponentAvatar",get:function(){return this._opponentAvatar}},{key:"versusText",get:function(){return this._versusText}}]),t}(Phaser.GameObjects.Container),ab=function(e){function t(t,n,i,a,r){var s;return(s=e.call(this,t)||this).playerStat=void 0,s.opponentStat=void 0,s.setSize(231,40),s.addIcon(n),s.createLabel(i),s.createPlayerStat(a),s.createOpponentStat(r),s}(0,ot.Z)(t,e);var n=t.prototype;return n.addBackground=function(){var e="avatar-zone-background";if(!this.scene.textures.exists(e)){var t=this.width,n=this.height,i=this.scene.add.graphics();i.fillStyle(65280,.2),i.fillRect(0,0,t,n),i.generateTexture(e,t,n),i.destroy()}var a=this.scene.add.image(0,0,e);this.add(a)},n.addIcon=function(e){e.setWorldSize(24,24),this.add(e),Phaser.Display.Align.In.TopCenter(e,this)},n.createLabel=function(e){var t=this.scene.make.bitmapText({font:Go.Z.PRIMARY.KEY,size:this.scene.fontSize(12),text:e,origin:{x:.5,y:.5}});this.add(t),Phaser.Display.Align.In.BottomCenter(t,this)},n.createPlayerStat=function(e){var t=this.scene.make.bitmapText({font:Go.Z.BOLD.KEY,size:this.scene.fontSize(16),text:e,origin:{x:0,y:.5}});this.add(t),Phaser.Display.Align.In.LeftCenter(t,this),this.playerStat=t},n.createOpponentStat=function(e){var t=this.scene.make.bitmapText({font:Go.Z.BOLD.KEY,size:this.scene.fontSize(16),text:e,origin:{x:1,y:.5}});this.add(t),Phaser.Display.Align.In.RightCenter(t,this),this.opponentStat=t},n.setPlayerStat=function(e){this.playerStat.setText(e)},n.setOpponentStat=function(e){this.opponentStat.setText(e)},t}(Phaser.GameObjects.Container),rb=Ds.Z.GAMEPLAY_DEFAULT,sb=rb.KEY,ob=rb.FRAME,cb=function(e){function t(t){var n;return(n=e.call(this,t)||this)._scoreStat=void 0,n._movesStat=void 0,n._timeStat=void 0,n.lines=[],n.setSize(231,170),n.createScoreStatEntry(),n.createMovesStatEntry(),n.createTimeStatEntry(),n.createLines(),n}(0,ot.Z)(t,e);var n=t.prototype;return n.addBackground=function(){var e="match-statistics-background";if(!this.scene.textures.exists(e)){var t=this.width,n=this.height,i=this.scene.add.graphics();i.fillStyle(65280,.2),i.fillRect(0,0,t,n),i.generateTexture(e,t,n),i.destroy()}var a=this.scene.add.image(0,0,e);this.add(a)},n.createScoreStatEntry=function(){var e=this.scene.add.image(0,0,sb,ob.MEDAL_STAR);this._scoreStat=new ab(this.scene,e,"Score","1234","687"),this.add(this._scoreStat),Phaser.Display.Align.In.TopCenter(this._scoreStat,this)},n.createMovesStatEntry=function(){var e=this.scene.add.image(0,0,sb,ob.ARROW_SWAP_HORIZONTAL);this._movesStat=new ab(this.scene,e,"Moves","335","687"),this.add(this._movesStat),this.alignUnder(this._movesStat,this._scoreStat,0,20)},n.createTimeStatEntry=function(){var e=this.scene.add.image(0,0,sb,ob.TIMER);this._timeStat=new ab(this.scene,e,"Time","07:25","09:45"),this.add(this._timeStat),this.alignUnder(this._timeStat,this._movesStat,0,20)},n.createLines=function(){var e=this;this.list.forEach((function(t){if(t instanceof ab){var n=e.scene.add.line(0,0,0,0,231,0,16777215,.3);e.add(n),e.lines.push(n),Phaser.Display.Align.In.BottomCenter(n,t,0,10)}}))},n.alignUnder=function(e,t,n,i){void 0===n&&(n=0),void 0===i&&(i=0);var a=(e.height+t.height)/2;Phaser.Display.Align.In.Center(e,t,0+n,a+i)},n.runEntranceAnimationLines=function(){var e=(0,st.Z)(ut().mark((function e(){var t,n,i=this;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return 200,n=z()(t=this.lines).call(t,(function(e,t){return new(xe())((function(n){i.scene.add.tween({targets:e,duration:200,delay:200*t/2,props:{alpha:{from:0,to:1},scaleX:{from:0,to:1}},onComplete:n})}))})),e.next=4,xe().all(n);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runEntranceAnimationStats=function(){var e=(0,st.Z)(ut().mark((function e(){var t,n,i=this;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[this._scoreStat,this._movesStat,this._timeStat],200,n=z()(t).call(t,(function(e,t){return new(xe())((function(n){i.scene.add.tween({targets:e,duration:200,delay:200*t/2,ease:Phaser.Math.Easing.Sine.Out,props:{alpha:{from:0,to:1},y:{from:e.y+e.height/2,to:e.y}},onComplete:n})}))})),e.next=5,xe().all(n);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.hideContent=function(){this.lines.forEach((function(e){e.setAlpha(0),e.scaleX=0})),[this._scoreStat,this._movesStat,this._timeStat].forEach((function(e){return e.setAlpha(0)}))},n.runEntranceAnimation=function(){var e=(0,st.Z)(ut().mark((function e(){return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,xe().all([this.runEntranceAnimationStats(),this.runEntranceAnimationLines()]);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),(0,Wt.Z)(t,[{key:"scoreStat",get:function(){return this._scoreStat}},{key:"movesStat",get:function(){return this._movesStat}},{key:"timeStat",get:function(){return this._timeStat}}]),t}(Phaser.GameObjects.Container),ub=Ds.Z.GAMEPLAY_DEFAULT;ub.KEY,ub.FRAME;!function(e){e.NEW_GAME="new",e.CLOSE="close"}(Ky||(Ky={}));var lb=function(e){function t(t){var n;return(n=e.call(this,t,143.5,48,16,16777215)||this).closeLabel=void 0,n.newGameLabel=void 0,n._buttonState=void 0,n.icon=void 0,n.setSize(143.5,48),n.setName("NewGameButton"),n.createNewGameLabel(),n.switchState(Ky.NEW_GAME),n.initOnClick(),n.playPulsateAnimation(),n}(0,ot.Z)(t,e);var n=t.prototype;return n.createNewGameLabel=function(){this.newGameLabel=new Rp(this.scene),this.add(this.newGameLabel)},n.initOnClick=function(){var e=this;this.onClick=(0,st.Z)(ut().mark((function t(){var n;return ut().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e._buttonState!==Ky.NEW_GAME){t.next=6;break}return n=e.scene,t.next=4,n.handlePlayWithFriend();case 4:t.next=7;break;case 6:e.switchState(Ky.NEW_GAME);case 7:e.scene.screen.close(As.o4.PLAY_WITH_FRIEND_GAME_OVER_SCREEN);case 8:case"end":return t.stop()}}),t)})))},n.playPulsateAnimation=function(){new qo.Z({targets:[this],duration:1e3,props:{scale:"*=1.05"}}).play()},n.hideContent=function(){this.setDisabled(!0)},n.runEntranceAnimation=function(){var e=(0,st.Z)(ut().mark((function e(){var t=this;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new(xe())((function(e){t.scene.add.tween({targets:t,alpha:1,duration:200,onStart:function(){t.setDisabled(!0)},onComplete:function(){t.setDisabled(!1),e()}})})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),n.switchState=function(e){if(e!==this._buttonState)switch(e){case Ky.CLOSE:this._buttonState=Ky.CLOSE;break;case Ky.NEW_GAME:this._buttonState=Ky.NEW_GAME}},n.updateContainerSize=function(){this.setSize(this.icon.width+this.closeLabel.width+8,this.icon.height>this.closeLabel.height?this.icon.height:this.closeLabel.height)},t}($d.Z),hb=143.5,db=function(e){function t(t){var n;return(n=e.call(this,t,hb,48)||this).background=void 0,n.border=void 0,n.labelContainer=void 0,n.setSize(hb,48),n.createBackground(),n.createBorder(),n.createLabel(),n.initOnClick(),n}(0,ot.Z)(t,e);var n=t.prototype;return n.createBackground=function(){this.background=new Qd.Z(this.scene,0,0,hb,48,16,16777215,.24),this.add(this.background)},n.createBorder=function(){this.border=this.scene.add.graphics(),this.border.lineStyle(1,16777215).strokeRoundedRect(-71.75,-24,hb,48,16),this.add(this.border)},n.createLabel=function(){this.labelContainer=new Rp(this.scene,8,"Share",Ds.Z.GAMEPLAY_DEFAULT.FRAME.IC_SHARE),this.labelContainer.clearTint(),this.labelContainer.getIcon().setTintFill(16777215),this.add(this.labelContainer)},n.initOnClick=function(){var e=this;this.onClick=function(){e.scene.storage.dispatch(Au())}},n.hideContent=function(){this.setDisabled(!0)},n.runEntranceAnimation=function(){var e=(0,st.Z)(ut().mark((function e(){var t=this;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new(xe())((function(e){t.scene.add.tween({targets:t,alpha:1,duration:200,onStart:function(){t.setDisabled(!0)},onComplete:function(){t.setDisabled(!1),e()}})})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),t}(Ho.Z),fb=function(e){function t(t){var n;return(n=e.call(this,t)||this)._newGameButton=void 0,n._shareButton=void 0,n._stat=void 0,n.setSize(303,244),n.createMatchStatistics(),n.createNewGameButton(),n.createShareButton(),n}(0,ot.Z)(t,e);var n=t.prototype;return n.createNewGameButton=function(){var e=new lb(this.scene);this.add(e),Phaser.Display.Align.In.BottomRight(e,this),this._newGameButton=e},n.createShareButton=function(){var e=new db(this.scene);this.add(e),Phaser.Display.Align.In.BottomLeft(e,this),this._shareButton=e},n.createMatchStatistics=function(){var e=new cb(this.scene);this.add(e),Phaser.Display.Align.In.TopCenter(e,this),this._stat=e},n.hideContent=function(){this._stat.hideContent(),this._newGameButton.hideContent(),this._shareButton.hideContent()},n.runEntranceAnimation=function(){var e=(0,st.Z)(ut().mark((function e(){return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._stat.runEntranceAnimation();case 2:return e.next=4,xe().all([this._newGameButton.runEntranceAnimation(),this._shareButton.runEntranceAnimation()]);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),(0,Wt.Z)(t,[{key:"newGameButton",get:function(){return this._newGameButton}},{key:"shareButton",get:function(){return this._shareButton}},{key:"stat",get:function(){return this._stat}}]),t}(Phaser.GameObjects.Container),pb="Waiting",gb=function(e){function t(t){var n;return(n=e.call(this,t)||this).winLoseText=void 0,n.modeText=void 0,n.waitingAnimationEvent=void 0,n.waitingAnimation=void 0,n.setSize(303,60),n.createWinLoseText(),n.createModeText(),n}(0,ot.Z)(t,e);var n=t.prototype;return n.createWinLoseText=function(){var e=this.scene.make.bitmapText({font:Go.Z.BOLD.KEY,size:this.scene.fontSize(24),origin:{x:.5,y:.5},text:"You win"});this.add(e),Phaser.Display.Align.In.TopCenter(e,this),this.winLoseText=e},n.createModeText=function(){var e=this.scene.make.bitmapText({font:Go.Z.PRIMARY.KEY,size:this.scene.fontSize(16),origin:{x:.5,y:.5},text:"Standard mode, Draw 1"});this.add(e),Phaser.Display.Align.In.BottomCenter(e,this),this.modeText=e},n.addBackground=function(){var e="popup-header-background";if(!this.scene.textures.exists(e)){var t=this.width,n=this.height,i=this.scene.add.graphics();i.fillStyle(65280,.2),i.fillRect(0,0,t,n),i.generateTexture(e,t,n),i.destroy()}var a=this.scene.add.image(0,0,e);this.add(a)},n.updateWinLoseText=function(e){switch(this.stopWaitingAnimation(),e){case jy.WIN:this.winLoseText.setText("You win");break;case jy.LOSE:this.winLoseText.setText("You lose");break;case jy.DRAW:this.winLoseText.setText("Draw");break;case jy.WAITING_FOR_OPPONENT:default:this.winLoseText.setText(pb),this.playWaitingAnimation()}},n.playWaitingAnimation=function(){var e=this,t=0;this.waitingAnimationEvent=this.scene.time.addEvent({delay:500,repeat:-1,callback:function(){t=(t+1)%4;var n=Array(t+1).join(".");e.winLoseText.setText(pb+n)}}),this.waitingAnimation=this.scene.add.tween({targets:this.winLoseText,alpha:.5,repeat:-1,yoyo:!0,delay:250,ease:Phaser.Math.Easing.Sine.InOut})},n.stopWaitingAnimation=function(){if(this.waitingAnimationEvent)try{this.waitingAnimationEvent.remove(),this.waitingAnimationEvent.destroy()}catch(e){console.log("cannot remove event")}if(this.waitingAnimation)try{this.waitingAnimation.remove(),this.waitingAnimation.destroy()}catch(t){console.log("cannot remove animation")}this.winLoseText.setAlpha(1)},n.updateDrawMode=function(e,t){var n="One suit";switch(e){case"two":n="Two suits";break;case"four":n="Four suits"}var i=", "+t+" difficulty";this.modeText.setText(""+n+i)},t}(Phaser.GameObjects.Container),mb=function(e){function t(t,n,i){var a;return(a=e.call(this,t,n,i)||this)._header=void 0,a._avatarZone=void 0,a._popupBody=void 0,a.background=void 0,a._darkFilter=void 0,a.setSize(343,486),a.createBackground(),a.createDarkFilter(),a.createHeader(),a.createAvatarZone(),a.createBody(),a}(0,ot.Z)(t,e);var n=t.prototype;return n.createBackground=function(){var e=new Jo(this.scene,{key:"play-with-friend-game-over-block-background",radius:6,border:24,width:this.width,height:this.height});this.add(e),this.background=e},n.createDarkFilter=function(){var e=wg.Challenge.POPUP;if(!this.scene.textures.exists(e)){var t=this.background,n=t.width,i=t.height,a=this.scene.add.graphics();a.fillStyle(Cg,Ag),a.fillRoundedRect(0,0,n,i,24),a.generateTexture(e,n,i),a.destroy()}var r=this.scene.add.image(0,0,e);r.kill(),this._darkFilter=r,this.add(r)},n.createHeader=function(){this._header=new gb(this.scene),this.add(this._header),Phaser.Display.Align.In.TopCenter(this._header,this,0,-20)},n.createAvatarZone=function(){this._avatarZone=new ib(this.scene),this.add(this._avatarZone),Phaser.Display.Align.In.TopCenter(this._avatarZone,this,0,-104)},n.createBody=function(){this._popupBody=new fb(this.scene),this.add(this._popupBody),Phaser.Display.Align.In.BottomCenter(this._popupBody,this,0,-20)},n.hideContent=function(){this._avatarZone.hideContent(),this._popupBody.hideContent()},n.runEntranceAnimation=function(){var e=(0,st.Z)(ut().mark((function e(){return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._avatarZone.runEntranceAnimation();case 2:return e.next=4,this._popupBody.runEntranceAnimation();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),(0,Wt.Z)(t,[{key:"header",get:function(){return this._header}},{key:"avatarZone",get:function(){return this._avatarZone}},{key:"popupBody",get:function(){return this._popupBody}},{key:"darkFilter",get:function(){return this._darkFilter}}]),t}(Phaser.GameObjects.Container),vb=Ds.Z.GAMEPLAY_DEFAULT,yb=vb.KEY,bb=vb.FRAME,Sb=function(e){function t(t){var n;return(n=e.call(this,t)||this)._popup=void 0,n.setContainerSize(),n.createPopup(),n.createDevButtons(),n}(0,ot.Z)(t,e);var n=t.prototype;return n.setContainerSize=function(){var e=this.scene.gameZone,t=e.width,n=e.height;this.setSize(t,n)},n.createDevButtons=function(){GameCore.Utils.Valid.isDebugger()&&this.createCloseButton()},n.createCloseButton=function(){var e=this,t=new Ho.Z(this.scene,40,40),n=this.scene.add.image(0,0,yb,bb.IC_BG_OFF);n.setWorldSize(40,40);var i=this.scene.make.bitmapText({font:Go.Z.PRIMARY.KEY,size:this.scene.fontSize(9),text:"Play Single",origin:{x:.5,y:.5}});i.setCenterAlign(),t.add([n,i]),this.add(t),Phaser.Display.Align.In.BottomLeft(t,this,0,-200),t.onClick=function(){e.scene.screen.close(As.o4.PLAY_WITH_FRIEND_GAME_OVER_SCREEN)}},n.createPopup=function(){this._popup=new mb(this.scene),this.add(this._popup),Phaser.Display.Align.In.Center(this._popup,this,0,0)},n.hideContent=function(){this._popup.hideContent()},n.runEntranceAnimation=function(){var e=(0,st.Z)(ut().mark((function e(){return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._popup.runEntranceAnimation();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),(0,Wt.Z)(t,[{key:"popup",get:function(){return this._popup}}]),t}(Phaser.GameObjects.Container),Tb=function(e){function t(t){var n;return(n=e.call(this,t)||this)._beams=void 0,n._bunting=void 0,n.setSize(375,295),n.createBeams(),n.createBunting(),n}(0,ot.Z)(t,e);var n=t.prototype;return n.createBeams=function(){this._beams=new Jp(this.scene),this.add(this._beams),Phaser.Display.Align.In.TopCenter(this._beams,this)},n.createBunting=function(){this._bunting=new fg(this.scene),this.add(this._bunting),Phaser.Display.Align.In.TopCenter(this._bunting,this)},(0,Wt.Z)(t,[{key:"beams",get:function(){return this._beams}},{key:"bunting",get:function(){return this._bunting}}]),t}(Phaser.GameObjects.Container),Eb=function(e){function t(t){var n;return(n=e.call(this,t)||this)._beams=void 0,n._lightnings=void 0,n.setSize(375,416),n.createBeams(),n.createLightnings(),n}(0,ot.Z)(t,e);var n=t.prototype;return n.createBeams=function(){this._beams=new cm(this.scene),this.add(this._beams),Phaser.Display.Align.In.TopCenter(this._beams,this)},n.createLightnings=function(){this._lightnings=new em(this.scene),this.add(this._lightnings),Phaser.Display.Align.In.TopCenter(this._lightnings,this)},(0,Wt.Z)(t,[{key:"beams",get:function(){return this._beams}},{key:"lightnings",get:function(){return this._lightnings}}]),t}(Phaser.GameObjects.Container),Cb="Waiting",Ab=new(function(){function e(){this._state=void 0,this._state=jy.WIN}return(0,Wt.Z)(e,[{key:"state",get:function(){return this._state},set:function(e){var t=window.game.globalScene.getActiveScene().screen.get(As.o4.PLAY_WITH_FRIEND_GAME_OVER_SCREEN);t instanceof wb&&t.setGameOverInfo({state:e}),this._state=e}}]),e}()),wb=function(e){function t(t,n,i,a){var r;return(r=e.call(this,t,n,i,a)||this).slideInAnimation=void 0,r.fadeInAnimation=void 0,r.fadeOutAnimation=void 0,r.playWithFriendGameOverContainer=void 0,r.winDecoration=void 0,r.loseDecoration=void 0,r.backgroundFilter=void 0,r.footer=void 0,r.closed=!1,r.setBackground=function(){var e=r.scene.theme.getCurrentThemeConfig().backgroundKey;r.background.setTexture(e);var t=r.scene.gameZone,n=t.width,i=t.height;r.background.setWorldSize(n,i),r.scene.events.on(es.BACKGROUND_CHANGED,(function(e){r.background.setTexture(e)}))},r.handleClickTournaments=function(){r.scene.time.delayedCall(100,(function(){r.closed||r.close()}))},r.scene instanceof Nb&&r.setBackground(),r.setDepth(As.Ks.POPUP),r.addBackgroundFilter(),r.createContainer(),r.createBanners(),r.createFooter(),r.createBottomLogo(),r}(0,ot.Z)(t,e);var n=t.prototype;return n.open=function(t){e.prototype.open.call(this,t),this.closed=!1,this.isGameZoneTooWide()&&(this.winDecoration.kill(),this.loseDecoration.kill()),this.background.setAlpha(1),this.runOpenAnimation(),Ab.state!==jy.LOSE&&(this.playConfettiAnimation(),this.updateResultInfo())},n.close=function(){this.closed=!0,this.runCloseAnimation(),this.stopConfettiAnimation()},n.runOpenAnimation=function(){var e=(0,st.Z)(ut().mark((function e(){var t,n,i,a,r=this;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==(t=this.slideInAnimation)||null==(n=t.tween)||!n.isPlaying()){e.next=2;break}return e.abrupt("return");case 2:if(this.scene.audio.playSound(Bt.POPUP_SHOW),i=this.scene.ads.getBannerHeight(),a=i,this.playWithFriendGameOverContainer.setAlpha(0).setY(a).hideContent(),this.winDecoration.bunting.stopWavingAnimation(),this.loseDecoration.lightnings.hideContent(),this.slideInAnimation||(this.slideInAnimation=new Jd({targets:[this.playWithFriendGameOverContainer],props:{y:{from:a,to:-i/2-21,ease:Phaser.Math.Easing.Back.Out},alpha:{from:0,to:1}},duration:300,onComplete:function(){var e=(0,st.Z)(ut().mark((function e(){return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.playWithFriendGameOverContainer.runEntranceAnimation();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()})),this.fadeInAnimation||(this.fadeInAnimation=new Kd.Z({targets:[this],duration:300})),this.fadeInAnimation.play(),!this.winDecoration.active){e.next=15;break}return e.next=14,this.winDecoration.bunting.runEntranceAnimation();case 14:this.winDecoration.bunting.playWavingAnimation();case 15:if(!this.loseDecoration.active){e.next=18;break}return e.next=18,this.loseDecoration.lightnings.runEntranceAnimation();case 18:this.slideInAnimation.play();case 19:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.runCloseAnimation=function(){var t,n,i=this;null!=(t=this.fadeOutAnimation)&&null!=(n=t.tween)&&n.isPlaying()||(this.scene.audio.playSound(Bt.POPUP_OFF),this.fadeOutAnimation||(this.fadeOutAnimation=new qd.Z({targets:[this],props:{alpha:0},duration:300,onComplete:function(){e.prototype.close.call(i)}})),this.fadeOutAnimation.play())},n.createBanners=function(){this.createRibbonBanner(),this.createLightningThunderBanner()},n.createRibbonBanner=function(){this.winDecoration=new Tb(this.scene),this.winDecoration.kill(),Phaser.Display.Align.In.TopCenter(this.winDecoration,this),this.add(this.winDecoration)},n.createLightningThunderBanner=function(){this.loseDecoration=new Eb(this.scene),this.loseDecoration.kill(),Phaser.Display.Align.In.TopCenter(this.loseDecoration,this),this.add(this.loseDecoration)},n.createContainer=function(){this.playWithFriendGameOverContainer=new Sb(this.scene),this.add(this.playWithFriendGameOverContainer)},n.createFooter=function(){var e=this;this.footer=new Mg(this.scene,!1,As.o4.PLAY_WITH_FRIEND_GAME_OVER_SCREEN),this.add(this.footer),this.bringToTop(this.footer),this.footer.setInteractive();var t=this.scene.ads.getBannerHeight(),n=this.scene.gameZone.width>375?-20:0;Phaser.Display.Align.In.BottomCenter(this.footer,this.background,0,-t+n),this.footer.tournamentsButton.onClick=function(){e.scene.events.off(es.GAME_START,e.handleClickTournaments),e.scene.events.once(es.GAME_START,e.handleClickTournaments),e.scene.screen.open(As.o4.TOURNAMENTS_SCREEN)}},n.createBottomLogo=function(){if(!this.scene.world.isLandscape()){var e=new Hg(this.scene);Phaser.Display.Align.In.BottomCenter(e,this),this.add(e)}},n.isGameZoneTooWide=function(){return this.scene.gameZone.width>450},n.playConfettiAnimation=function(){if(this.scene instanceof Nb){var e=this.scene.gameplay.confettiSmallFallDown;this.scene.children.bringToTop(e),e.run(8,0,0)}},n.stopConfettiAnimation=function(){this.scene instanceof Nb&&this.scene.gameplay.confettiSmallFallDown.stop()},n.updateResultInfo=function(){var e,t=this.scene.storage.getState(),n=Zu(t),i=Su(t),a=this.scene.player.getPlayer().playerId,r=pu(t).playerId,s=(i[a]||{}).score,o=(i[r]||{}).score,c=mu(t,{playerId:a}),u=vu(t,{opponentId:r});n===Xr&&(c=!0,u=!0),console.log({isPlayerFinish:c,isOpponentFinish:u});var l=hu(t);console.warn({matchData:l});var h,d=l.whitePlayerId,f=l.extraData,p=void 0===f?{}:f,g=a===d,m=g?p.blackPlayerData:p.whitePlayerData,v=(g?p.whitePlayerData:p.blackPlayerData)||{},y=v.moves,b=v.time,S=m||{},T=S.moves,E=S.time,C=c&&u,A=C&&s>o,w=C&&s<o;console.log({isPlayerWin:A,isOpponentWin:w}),h=C?A&&w?jy.DRAW:A?jy.WIN:jy.LOSE:jy.WAITING_FOR_OPPONENT,console.log({playerScore:s,opponentScore:o});var I,P="one",k="easy",x=null==(e=this.data)?void 0:e.list;if(x){var _=x,O=_.suitSize,D=void 0===O?"one":O,B=_.difficulty;P=D,k=void 0===B?"easy":B}else console.error("Please open PlayWithFriendGameOverScreen with data");this.setGameOverInfo({state:h,playerScore:c?s:void 0,opponentScore:u?o:void 0,playerMoves:c?y:void 0,opponentMoves:u?T:void 0,playerTime:c?b:void 0,opponentTime:u?E:void 0,suitSize:P,difficulty:k}),this.scene.storage.dispatch((void 0===(I=!1)&&(I=!1),{type:"MATCH_RESUTL_FROM_MESSAGE",payload:{matchResultFromMessage:I}}))},n.setGameOverInfo=function(e){var t=this.playWithFriendGameOverContainer.popup,n=t.header,i=t.avatarZone,a=t.popupBody,r=i.youAvatar,s=i.opponentAvatar,o=this.scene.player.getPlayer(),c=o.playerId,u=o.photo,l=o.name;r.avatar.loadPhoto(c,u,100),r.username.setText(l);var h=this.scene.storage.getState(),d=pu(h),f=d.playerId,p=d.photo,g=d.name;if(s.avatar.loadPhoto(f,p,100),s.username.setText(g),e.state)switch(n.updateWinLoseText(e.state),i.updateState(e.state),e.state){case jy.LOSE:this.winDecoration.kill(),this.loseDecoration.revive(),this.enableDarkBackground(),this.stopConfettiAnimation();break;case jy.WIN:case jy.DRAW:this.winDecoration.revive(),this.loseDecoration.kill(),this.enableDarkBackground(!1);break;case jy.WAITING_FOR_OPPONENT:default:this.winDecoration.kill(),this.loseDecoration.kill(),this.stopConfettiAnimation(),this.enableDarkBackground(!1)}e.suitSize&&e.difficulty&&n.updateDrawMode(e.suitSize,e.difficulty);var m=a.stat,v=m.scoreStat,y=m.movesStat,b=m.timeStat;void 0!==e.playerScore?v.setPlayerStat(""+e.playerScore):v.setPlayerStat(Cb),void 0!==e.opponentScore?v.setOpponentStat(""+e.opponentScore):v.setOpponentStat(Cb),void 0!==e.playerMoves?y.setPlayerStat(""+e.playerMoves):y.setPlayerStat(Cb),void 0!==e.opponentMoves?y.setOpponentStat(""+e.opponentMoves):y.setOpponentStat(Cb),void 0!==e.playerTime?b.setPlayerStat((0,Rn.F0)(e.playerTime,!1)):b.setPlayerStat(Cb),void 0!==e.opponentTime?b.setOpponentStat((0,Rn.F0)(e.opponentTime,!1)):b.setOpponentStat(Cb)},n.enableDarkBackground=function(e){void 0===e&&(e=!0);var t=this.playWithFriendGameOverContainer.popup.darkFilter;e?(this.backgroundFilter.revive(),t.revive()):(this.backgroundFilter.kill(),t.kill())},n.addBackgroundFilter=function(){var e,t=this,n=wg.Challenge.SCREEN;if(!this.scene.textures.exists(n)){var i=this.width,a=this.height,r=this.scene.add.graphics();r.fillStyle(Cg,Ag),r.fillRect(0,0,i,a),r.generateTexture(n,i,a),r.destroy()}this.backgroundFilter=this.scene.add.image(0,0,n),this.backgroundFilter.kill(),this.add(this.backgroundFilter);var s=Fs()(e=this.getAll()).call(e,(function(e){return e===t.background}));this.moveTo(this.backgroundFilter,s+1)},n.updateFinishingChallenge=function(){this.playWithFriendGameOverContainer.popup.popupBody.newGameButton.switchState(Ky.CLOSE)},t}(GameCore.Screen),Ib={ONE_SUIT:{KEY:"dynamic-levels-one-suit",PATH:"assets/levels/spider/one-suit/dynamic.txt",DECOMPRESSED_DATA:[]},TWO_SUIT:{KEY:"dynamic-levels-two-suit",PATH:"assets/levels/spider/two-suit/dynamic.txt",DECOMPRESSED_DATA:[]},FOUR_SUIT:{KEY:"dynamic-levels-four-suit",PATH:"assets/levels/spider/four-suit/dynamic.txt",DECOMPRESSED_DATA:[]}},Pb={TEST_LEVELS:{KEY:"test-journey-levels",PATH:"assets/levels/spider/journey/test.txt",DECOMPRESSED_DATA:[]}},kb={ONE_SUIT:{GROUP1:{KEY:"difficulty-1-one-suit",PATH:"assets/levels/spider/one-suit/levels1.txt",DECOMPRESSED_DATA:[]},GROUP2:{KEY:"difficulty-2-one-suit",PATH:"assets/levels/spider/one-suit/levels2.txt",DECOMPRESSED_DATA:[]},GROUP3:{KEY:"difficulty-3-one-suit",PATH:"assets/levels/spider/one-suit/levels3.txt",DECOMPRESSED_DATA:[]},GROUP4:{KEY:"difficulty-4-one-suit",PATH:"assets/levels/spider/one-suit/levels4.txt",DECOMPRESSED_DATA:[]},GROUP5:{KEY:"difficulty-5-one-suit",PATH:"assets/levels/spider/one-suit/levels5.txt",DECOMPRESSED_DATA:[]},GROUP6:{KEY:"difficulty-6-one-suit",PATH:"assets/levels/spider/one-suit/levels6.txt",DECOMPRESSED_DATA:[]},GROUP7:{KEY:"difficulty-7-one-suit",PATH:"assets/levels/spider/one-suit/levels7.txt",DECOMPRESSED_DATA:[]},GROUP8:{KEY:"difficulty-8-one-suit",PATH:"assets/levels/spider/one-suit/levels8.txt",DECOMPRESSED_DATA:[]},GROUP9:{KEY:"difficulty-9-one-suit",PATH:"assets/levels/spider/one-suit/levels9.txt",DECOMPRESSED_DATA:[]}},TWO_SUIT:{GROUP1:{KEY:"difficulty-1-two-suit",PATH:"assets/levels/spider/two-suit/levels1.txt",DECOMPRESSED_DATA:[]},GROUP2:{KEY:"difficulty-2-two-suit",PATH:"assets/levels/spider/two-suit/levels2.txt",DECOMPRESSED_DATA:[]},GROUP3:{KEY:"difficulty-3-two-suit",PATH:"assets/levels/spider/two-suit/levels3.txt",DECOMPRESSED_DATA:[]},GROUP4:{KEY:"difficulty-4-two-suit",PATH:"assets/levels/spider/two-suit/levels4.txt",DECOMPRESSED_DATA:[]},GROUP5:{KEY:"difficulty-5-two-suit",PATH:"assets/levels/spider/two-suit/levels5.txt",DECOMPRESSED_DATA:[]},GROUP6:{KEY:"difficulty-6-two-suit",PATH:"assets/levels/spider/two-suit/levels6.txt",DECOMPRESSED_DATA:[]},GROUP7:{KEY:"difficulty-7-two-suit",PATH:"assets/levels/spider/two-suit/levels7.txt",DECOMPRESSED_DATA:[]},GROUP8:{KEY:"difficulty-8-two-suit",PATH:"assets/levels/spider/two-suit/levels8.txt",DECOMPRESSED_DATA:[]},GROUP9:{KEY:"difficulty-9-two-suit",PATH:"assets/levels/spider/two-suit/levels9.txt",DECOMPRESSED_DATA:[]}},FOUR_SUIT:{GROUP1:{KEY:"difficulty-1-four-suit",PATH:"assets/levels/spider/four-suit/levels1.txt",DECOMPRESSED_DATA:[]},GROUP2:{KEY:"difficulty-2-four-suit",PATH:"assets/levels/spider/four-suit/levels2.txt",DECOMPRESSED_DATA:[]},GROUP3:{KEY:"difficulty-3-four-suit",PATH:"assets/levels/spider/four-suit/levels3.txt",DECOMPRESSED_DATA:[]},GROUP4:{KEY:"difficulty-4-four-suit",PATH:"assets/levels/spider/four-suit/levels4.txt",DECOMPRESSED_DATA:[]},GROUP5:{KEY:"difficulty-5-four-suit",PATH:"assets/levels/spider/four-suit/levels5.txt",DECOMPRESSED_DATA:[]},GROUP6:{KEY:"difficulty-6-four-suit",PATH:"assets/levels/spider/four-suit/levels6.txt",DECOMPRESSED_DATA:[]},GROUP7:{KEY:"difficulty-7-four-suit",PATH:"assets/levels/spider/four-suit/levels7.txt",DECOMPRESSED_DATA:[]},GROUP8:{KEY:"difficulty-8-four-suit",PATH:"assets/levels/spider/four-suit/levels8.txt",DECOMPRESSED_DATA:[]},GROUP9:{KEY:"difficulty-9-four-suit",PATH:"assets/levels/spider/four-suit/levels9.txt",DECOMPRESSED_DATA:[]}}},xb=function(){function e(e){this.scene=void 0,this.levelConfig=void 0,this.oneSuitLevels=void 0,this.twoSuitLevels=void 0,this.fourSuitLevels=void 0,this.dynamicGameLevels=void 0,this.journeyGameLevels=void 0,this.replayCardStatus=void 0,this.scene=e}var t=e.prototype;return t.init=function(){this.importLevels(),this.resetReplayCardStatus()},t.importLevels=function(){this.setupPrebuildLevels(),this.setupDynamicLevels(),this.setupJourneyLevels()},t.setupDynamicLevels=function(){var e=Ib.ONE_SUIT,t=Ib.TWO_SUIT,n=Ib.FOUR_SUIT,i={one:[],two:[],four:[]};i.one=e.DECOMPRESSED_DATA,i.two=t.DECOMPRESSED_DATA,i.four=n.DECOMPRESSED_DATA,this.dynamicGameLevels=i},t.setupPrebuildLevels=function(){var e=kb.ONE_SUIT,t=kb.TWO_SUIT,n=kb.FOUR_SUIT,i={1:[],2:[],3:[],4:[],5:[],6:[],7:[],8:[],9:[]},a=(0,Me.Z)({},i);ir()(e).forEach((function(e,t){var n,i=e.DECOMPRESSED_DATA;a[(t+1).toString()]=fe()(n=a[(t+1).toString()]).call(n,i)})),this.oneSuitLevels=a;var r=(0,Me.Z)({},i);ir()(t).forEach((function(e,t){var n,i=e.DECOMPRESSED_DATA;r[(t+1).toString()]=fe()(n=r[(t+1).toString()]).call(n,i)})),this.twoSuitLevels=r;var s=(0,Me.Z)({},i);ir()(n).forEach((function(e,t){var n,i=e.DECOMPRESSED_DATA;s[(t+1).toString()]=fe()(n=s[(t+1).toString()]).call(n,i)})),this.fourSuitLevels=s},t.setupJourneyLevels=function(){var e=Pb.TEST_LEVELS;this.journeyGameLevels=e.DECOMPRESSED_DATA},t.getConfigs=function(){return this.levelConfig},t.getClassicLevelConfig=function(e,t){var n=[];if(t){if("dynamic"===t)return this.getDynamicLevelConfig(e);n=this.getConstantPrebuiltLevels(t,e)}else n=this.getDynamicPrebuiltLevelsByScore(e);var i=Math.floor(Math.random()*n.length);return n[i]&&!n[i].mainMissions.win&&(n[i].mainMissions.win=25),n[i]&&this.handleOneAndTwoSuits(n[i]),n[i]||this.getDynamicLevelConfig(e)},t.getJourneyLevelConfig=function(){var e=Math.floor(Math.random()*this.journeyGameLevels.length);return this.journeyGameLevels[e]},t.handleOneAndTwoSuits=function(e){var t=e.suits,n=e.startingLayout;switch(t.length){case 1:for(var i=n.split(","),a=[],r=0;r<i.length;r++){var o=i[r],c=s()(o).call(o,0,o.length-1)+"c";a.push(c)}e.startingLayout=a.join(","),e.suits=["clubs"];break;case 2:for(var u=t[0][0],l=t[1][0],h=n.split(","),d=[],f=0;f<h.length;f++){var p=h[f],g=s()(p).call(p,0,p.length-1),m=s()(p).call(p,p.length-1,p.length);m===u?d.push(g+"h"):m===l&&d.push(g+"s")}e.startingLayout=d.join(","),e.suits=["hearts","spades"]}},t.getDynamicLevelConfig=function(e){var t=Math.floor(Math.random()*this.dynamicGameLevels[e].length),n=this.dynamicGameLevels[e][t];return this.convertDynamicLevelConfig(n)},t.getFromToDiffNearRatio=function(e){var t,n,i=Math.floor(10*e);return h()(t=[0,1,2]).call(t,i)?{from:1,to:3}:h()(n=[8,9,10]).call(n,i)?{from:7,to:9}:{from:i-1,to:i+1}},t.getDynamicPrebuiltLevelsByScore=function(e){for(var t=this.oneSuitLevels,n=this.twoSuitLevels,i=this.fourSuitLevels,a=this.scene.gameStats.getTotalDifficultyScore(e),r=[20,40,80,160,320,640,1280,2560],s=9,o=0;o<r.length;o++){if(a<r[o]){s=o+1;break}}var c="easy";if(s>=4&&s<=6?c="medium":s>=7&&(c="hard"),this.scene.player.setSetting("difficulty",c),this.scene.gameplay.difficulty=c,this.scene.gameStats.updateCurrentGameStats({suitSize:e,difficulty:c}),console.log("> \ud83e\udd16 ? Use difficulty "+s+" from "+e+" suit"),"one"===e)return t[s.toString()];if("two"===e)return n[s.toString()];if("four"===e)return i[s.toString()];throw new Error("Invalid suit size")},t.getConstantPrebuiltLevels=function(e,t){var n=this.oneSuitLevels,i=this.twoSuitLevels,a=this.fourSuitLevels,r=1,s=9;"easy"===e?(r=1,s=3):"medium"===e?(r=4,s=6):"hard"===e&&(r=7,s=9),console.log("\ud83e\udd16 ? Use "+r+" to "+s+" "+t+" suit");var o=[];switch(t){case"one":for(var c=r;c<=s;c++)o.push.apply(o,n[c.toString()]);return o;case"two":for(var u=r;u<=s;u++)o.push.apply(o,i[u.toString()]);return o;case"four":for(var l=r;l<=s;l++)o.push.apply(o,a[l.toString()]);return o;default:throw new Error("Invalid suit size")}},t.getDynamicPrebuiltLevelsByWinRate=function(e,t){var n=this.oneSuitLevels,i=this.twoSuitLevels,a=this.fourSuitLevels,r=1,s=9;if("easy"===e?(r=1,s=3):"medium"===e?(r=4,s=6):"hard"===e&&(r=7,s=9),"dynamic"!==e&&"random"!==e){var o=this.scene.gameStats.getGameStats(t,e),c=o.targetLevelTracking.win.length+o.targetLevelTracking.lose.length;if(c>10){var u=o.targetLevelTracking.win.length/c,l=this.getFromToDiffNearRatio(u),h=l.from,d=l.to;s<h?s=Math.min(s+3,9):r>d?r=Math.max(r-3,1):r<h?s=d:r>h&&(r=h)}}console.log("\ud83e\udd16 ? Use "+r+" to "+s+" "+t+" suit");var f=[];switch(t){case"one":for(var p=r;p<=s;p++)f.push.apply(f,n[p.toString()]);return f;case"two":for(var g=r;g<=s;g++)f.push.apply(f,i[g.toString()]);return f;case"four":for(var m=r;m<=s;m++)f.push.apply(f,a[m.toString()]);return f;default:throw new Error("Invalid suit size")}},t.convertDynamicLevelConfig=function(e){return(0,Me.Z)({},e,{type:"dynamic",difficulty:"dynamic"})},t.setConfig=function(e){if("replay"!==e){if("journey"===e)this.levelConfig=this.getJourneyLevelConfig();else if(GameCore.Utils.Object.hasOwn(e,"levelConfig")){var t=e;null===t?(console.error("> \ud83e\udd16 ? No previous game found"),this.levelConfig=this.getClassicLevelConfig("one","easy")):this.levelConfig=t.levelConfig}else if(e.suitSize&&GameCore.Utils.Object.hasOwn(e,"difficulty")){var n=e;this.levelConfig=this.getClassicLevelConfig(n.suitSize,n.difficulty)}else{var i=e;this.levelConfig=this.getClassicLevelConfig(i.suitSize)}var a={settings:{gameMode:as.instance.getGameMode(),suitSize:this.scene.gameStats.getCurrentGameStats().suitSize,difficulty:this.scene.gameStats.getCurrentGameStats().difficulty,relaxedSpider:this.scene.gameplay.boardGame.getCurrentGameRelaxedSpiderSetting()},levelConfig:(0,Me.Z)({},this.levelConfig)};rc("current-level",a)}},t.clearLevelConfigLocalStorage=function(){sc("current-level")},t.getLevelConfigLocalStorage=function(){var e=ac("current-level");return e&&GameCore.Utils.Valid.isObject(e)&&e.levelConfig&&e.settings?e:null},t.testCompress=function(){var e=X()(this.levelConfig);console.info("level binary size: ",e.length);var t=GameCore.Utils.Hash.lzwCompress(e);console.info("level compress: ",t),console.info("level compress binary size: ",t.length),console.info("compress ratio (%): ",100-t.length/e.length*100);var n=GameCore.Utils.Hash.encodeLZWCompress(t);console.info("level encode: ",n),console.info("level encode binary size: ",n.length);var i=GameCore.Utils.Hash.decodeLZWCompress(n);console.info("level decode: ",i),console.info("level decode binary size: ",i.length);var a=GameCore.Utils.Hash.lzwDecompress(i);console.info("level decompress: ",a),console.info("level decompress binary size: ",a.length)},t.setReplayCardStatus=function(e,t){this.replayCardStatus[e]=t},t.resetReplayCardStatus=function(){var e,t=(this.levelConfig||{}).foundations,n=void 0===t?8:t;this.replayCardStatus=S()(e=Array(13*n)).call(e,0)},e}(),_b=xb,Ob=function(e){function t(t){var n;return(n=e.call(this,t)||this).scene=void 0,n.foundationGroup=void 0,n.pileGroup=void 0,n.scene=t,n.init(),n}(0,ot.Z)(t,e);var n=t.prototype;return n.init=function(){e.prototype.init.call(this),this.foundationGroup=[],this.pileGroup=[]},n.requestNewFoundation=function(e){var t,n=un()(t=this.foundationGroup).call(t,(function(e){return!e.active}));if(n)return n.revive(),n.setIdx(e),n;var i=new bo(this.scene.gameplay.boardGame);return i.setIdx(e),this.foundationGroup.push(i),i},n.requestNewPile=function(e){var t,n=un()(t=this.pileGroup).call(t,(function(e){return!e.active}));if(n)return n.revive(),n.setIdx(e),n;var i=new co(this.scene.gameplay.boardGame);return i.setIdx(e),this.pileGroup.push(i),i},t}(pp),Db=Ob,Bb=Ds.Z.GAMEPLAY_DEFAULT,Lb=Bb.KEY,Rb=Bb.FRAME,Gb=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return(n=e.call.apply(e,fe()(t=[this]).call(t,a))||this).header=void 0,n.footer=void 0,n.gameplay=void 0,n.gameStats=void 0,n.levelLoader=void 0,n.themeHandler=void 0,n.gameModeManager=void 0,n.levelHandler=void 0,n.placementManager=void 0,n.handleFinishingChallenge=function(){var e=n.storage.getState(),t=yu(e)||{};console.log("finish challenge with extraData: ",t);var i=t.suitSize,a=void 0===i?"one":i,r=t.difficulty,s=void 0===r?"easy":r;n.screen.open(As.o4.PLAY_WITH_FRIEND_GAME_OVER_SCREEN,{suitSize:a,difficulty:s});var o=n.screen.get(As.o4.PLAY_WITH_FRIEND_GAME_OVER_SCREEN);o.updateFinishingChallenge(),o.once(Xi.CLOSE,(function(){window.isFinishingFriendMatch=!1,n.gameplay.loadAndPlayGame()}))},n.create=function(){e.prototype.create.call((0,Cs.Z)(n)),zs(),n.themeHandler=new mp((0,Cs.Z)(n)),n.gameModeManager=new vm((0,Cs.Z)(n)),n.placementManager=new Db((0,Cs.Z)(n)),n.gameStats=new Af((0,Cs.Z)(n)),n.levelLoader=new If((0,Cs.Z)(n)),n.levelHandler=new _b((0,Cs.Z)(n)),n.header=new Vd((0,Cs.Z)(n)),n.footer=new pd((0,Cs.Z)(n));var t=n.ads.getBannerHeight();Phaser.Display.Align.In.TopCenter(n.header,n.gameZone,0);var i=n.world.isLandscape()?-20:0;Phaser.Display.Align.In.BottomCenter(n.footer,n.gameZone,0,-t+i),n.gameplay=new od((0,Cs.Z)(n)),n.createScreens(),n.levelHandler.init(),n.placementManager.init(),n.gameModeManager.start(),n.ads.preloadInterstitialAdAsync().catch((function(){})),n.header.alignChildren(),GameCore.Utils.Valid.isDebugger()&&(n.gameplay.boardGame.createDevTools(),n.gameplay.boardGame.devTools.setVisible(!1)),n.gameplay.boardGame.createMarketingContainer()},n.setBackground=function(e){n.createBackground(e)},n.run=(0,st.Z)(ut().mark((function e(){return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!0!==window.isFinishingFriendMatch){e.next=3;break}return n.handleFinishingChallenge(),e.abrupt("return");case 3:return e.next=5,n.gameplay.loadAndPlayGame();case 5:case"end":return e.stop()}}),e)}))),n.handlePlayWithFriend=function(){var e=(0,st.Z)(ut().mark((function e(t){var i,a,r,s;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=!1),e.next=3,n.storage.dispatch(Eh());case 3:if(window.focus(),!as.instance.isChallengeMode()){e.next=15;break}if(i=n.storage.getState(),a=yu(i)||{},console.log("extraData",a),r=a.suitSize,s=a.difficulty,!r||!s){e.next=14;break}return n.gameplay.startGame({suitSize:r,difficulty:s}),e.abrupt("return");case 14:console.warn("Cannot get extra data");case 15:n.gameplay.startNewGame(t);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.handlePlaySingle=(0,st.Z)(ut().mark((function e(){return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ph();case 2:return e.next=4,n.storage.dispatch(bh());case 4:n.gameplay.startNewGame();case 5:case"end":return e.stop()}}),e)}))),n}(0,ot.Z)(t,e);var n=t.prototype;return n.preload=function(){this.events.on(Phaser.Scenes.Events.WAKE,this.run),this.events.on(Phaser.Scenes.Events.CREATE,this.run),this.events.once("player-finish-challenge",this.handleFinishingChallenge)},n.createBottomLogo=function(){var e=this.ads.getBannerHeight(),t=this.add.image(0,0,Lb,Rb.BOTTOM_BG);t.setWorldSize(375,e),Phaser.Display.Align.In.BottomCenter(t,this.gameZone),t.setDepth(fc.Z.FOOTER_LOGO);var n=this.add.image(0,0,Lb,Rb.BOTTOM_LOGO);n.setWorldSize(325.5,34.5),Phaser.Display.Align.In.BottomCenter(n,this.gameZone,0,21-e/2),n.setDepth(fc.Z.FOOTER_LOGO)},n.createScreens=function(){this.screen.add(As.o4.NO_MORE_MOVES_SCREEN,lm),this.screen.add(As.o4.VICTORY_SCREEN,zg),this.screen.add(As.o4.PLAY_SCREEN,af),this.screen.add(As.o4.SETTINGS_SCREEN,Sf),this.screen.add(As.o4.GAME_STATS_SCREEN,lp),this.screen.add(As.o4.THEME_SCREEN,Ip),this.screen.add(As.o4.HOW_TO_PLAY_SCREEN,xp),this.screen.add(As.o4.NOTIFICATION_SCREEN,pm),this.screen.add(As.o4.TOURNAMENTS_SCREEN,Vy),this.screen.add(As.o4.PLAY_WITH_FRIEND_GAME_OVER_SCREEN,wb),this.screen.add(As.o4.TOURNAMENTS_RESULT_SCREEN,Uv)},n.checkNewUser=function(){var e=this;(this.player.getPlayerIsNew()||GameCore.Configs.Tutorial.ForceUseTutorial)&&this.time.delayedCall(1e3,(function(){e.screen.open(As.o4.HOW_TO_PLAY_SCREEN),e.scene.scene.player.incUserGuideDisplays()}))},n.update=function(e,t){this.gameplay.update(t),this.header.update()},t}(Ss.Z),Nb=Gb,Mb=Nb,Fb=n(543),Ub=GameCore.Configs.Notification.ApiUrl,Zb=function(){var e=(0,st.Z)(ut().mark((function e(t){var n,i;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.playerId,e.next=3,zn("players/"+n,t,{},Ub,10);case 3:return i=e.sent,e.abrupt("return",(null==i?void 0:i.data)||{});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Hb=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).name="LoadResourceFail",i.message=t||"Load resource fail",i.payload=n,i}return(0,ot.Z)(t,e),t}((0,wt.Z)(Error)),Wb=function(){return function(e,t){var n=window.game,i=n.player,a=n.analytics,r=n.globalScene;try{var s=t(),o=qr(s),c=Qr(s),u=i.getPlayer(),l=(o.entryPointData||{}).type;if(u.isUserNew&&a.event(Vi._.NEW_USER),c===Jr)return void e(Yb());if(c===jr){if(l===Zr)return void e(Vb());if(l===Wr)return void e(Kb())}if(c===Xr)return void e(jb());if(u.isUserNew)return void e(Xb());if(c===Kr)return void e(bh());r.events.emit(fs.K.SWITCH,fs.C.DASHBOARD_SCENE)}catch(h){r.events.emit(fs.K.SWITCH,fs.C.DASHBOARD_SCENE),console.warn(h)}}},zb=function(e){try{var t=qr(e),n=window.game.player,i=t.entryPointData||{},a=i.playerId,r=i.playerName,s=i.playerPhoto;return n.getPlayer().playerId===a?Vr:new ei.Z(a,r,s).toObject()}catch(o){return console.warn(o),Vr}},Yb=function(){return function(e){try{window.game.facebook.getTournamentAsync().then((function(t){e(yh(t))})).catch((function(e){console.warn(e)}))}catch(t){console.warn(t)}}},Vb=function(){return function(e,t){try{var n=t(),i=qr(n),a=window.game.player,r=a.getPlayer(),s=i.contextId,o=(i.entryPointData||{}).playerId,c=r.playerId===o,u=zb(n);c||a.updateConnectedPlayers([u]);var l=u.playerId;e(Th(s,l,!0))}catch(h){throw new Error("processInviteMode: "+h)}}},Kb=function(){return function(e,t){try{var n=t(),i=qr(n),a=window.game.player.getPlayer(),r=i.entryPointData||{},s=r.matchId,o=r.opponentId,c=r.playerId,u=a.playerId===c;e(Ch(s,u?o:c))}catch(l){throw new Error("processChallengeFriendMode: "+l)}}},jb=function(){return function(e,t){try{var n=t(),i=qr(n).entryPointData||{},a=i.playerId,r=i.playerScore;e(fh(a,{score:r,level:0}));var s=zb(n);e(function(e){return function(){var t=(0,st.Z)(ut().mark((function t(n){var i,a,r,s,o;return ut().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,i=window.game,a=i.facebook,r=i.globalScene,s=i.analytics,r.screen.open(As.o4.NOTIFY_SCREEN,{message:"Loading...",loading:!0}),o=a.getContextID(),gh({contextId:o}),s.event(Vi._.JOIN_GROUP,{group_id:o}),t.next=8,n(wh(Xr,e));case 8:t.next=17;break;case 10:if(t.prev=10,t.t0=t.catch(0),!(t.t0 instanceof Ru)){t.next=14;break}return t.abrupt("return");case 14:if("INVALID_OPERATION"!==(null==t.t0?void 0:t.t0.code)){t.next=16;break}return t.abrupt("return");case 16:(0,at.tO)(t.t0);case 17:return t.prev=17,vh(100),t.finish(17);case 20:case"end":return t.stop()}}),t,null,[[0,10,17,20]])})));return function(e){return t.apply(this,arguments)}}()}((0,Me.Z)({},s,{score:r})))}catch(o){throw new Error("processMatchingGroupMode: "+o)}}},Xb=function(){return function(e){try{e(bh())}catch(t){throw new Error("processNewUserMode: "+t)}}},Jb=n(539),qb=GameCore.Configs,Qb=qb.AppId,$b=qb.Notification,eS=qb.Gameplay,tS=GameCore.Utils.Hash,nS=tS.decodeLZWCompress,iS=tS.lzwDecompress,aS=function(e){function t(){for(var t,n,i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return(n=e.call.apply(e,fe()(t=[this]).call(t,a))||this).handleFBInstantGameStarted=function(){window.__fbGameReady=!0,n.player.requestConnectedPlayers(),setTimeout(n.subscribebot,500)},n.processAfterUpdatePlayerProfile=function(){$b.Enable&&n.updatePlayerProfileToNotificationService()},n.startGame=function(){n.analytics.event(Vi._.APP_READY),n.storage.dispatch((0,Jb.I)(fs.C.LOAD_SCENE)),n.storage.dispatch(Wb())},n.subscribebot=function(){n.facebook.attemptToSubscribeBot()},n.handleLoadMusicCompleted=function(){n.audio.initMusic(Gt.BACKGROUND.KEY),n.audio.playMusic()},n}(0,ot.Z)(t,e);var n=t.prototype;return n.preload=function(){var e=this;this.facebook.progressLoading.loadingProgressFbLoadScene(),this.analytics.event(Vi._.SCREEN_OPEN,{screen_name:"LoadScene"}),this.load.on("progress",(function(t){e.facebook.progressLoading.onProgress(t)})),this.load.on(Phaser.Loader.Events.FILE_LOAD_ERROR,(function(e){var t=new Hb("Load resources at LoadScene failed.");(0,at.R0)(t,{file:null==e?void 0:e.url})}));var t=this.theme.getCurrentThemeResources(),n=t.backgroundKey,i=t.backgroundFile,a=t.cardFaceKey,r=t.cardFaceTexture,s=t.cardFaceJSON;this.theme.updateCurrentCardStyle(),this.load.image(n,i),this.load.atlas({key:a,textureURL:r,atlasURL:s}),this.load.atlas({key:Ds.Z.DEFAULT.KEY,textureURL:Ds.Z.DEFAULT.TEXTURE,atlasURL:Ds.Z.DEFAULT.JSON}),this.load.multiatlas({key:Ds.Z.EFFECTS.KEY,path:Ds.Z.EFFECTS.PATH,atlasURL:Ds.Z.EFFECTS.JSON}),this.load.atlas({key:Ds.Z.GAMEPLAY_DEFAULT.KEY,textureURL:Ds.Z.GAMEPLAY_DEFAULT.TEXTURE,atlasURL:Ds.Z.GAMEPLAY_DEFAULT.JSON}),this.load.atlas({key:Ds.Z.CARD_BACK.KEY,textureURL:Ds.Z.CARD_BACK.TEXTURE,atlasURL:Ds.Z.CARD_BACK.JSON}),this.load.atlas({key:Ds.Z.HOW_TO_PLAY.KEY,textureURL:Ds.Z.HOW_TO_PLAY.TEXTURE,atlasURL:Ds.Z.HOW_TO_PLAY.JSON}),this.load.atlas({key:Ds.Z.THEME_PREVIEW.KEY,textureURL:Ds.Z.THEME_PREVIEW.TEXTURE,atlasURL:Ds.Z.THEME_PREVIEW.JSON}),this.loadPrebuiltLevels(),this.loadDynamicLevels(),this.loadJourneyLevels(),this.textStyler.addFont({type:"local",fontType:"woff",fontName:Go.Z.FONT_FAMILY}),this.load.bitmapFont(Go.Z.PRIMARY.KEY,Go.Z.PRIMARY.TEXTURE,Go.Z.PRIMARY.DATA),this.load.bitmapFont(Go.Z.BOLD.KEY,Go.Z.BOLD.TEXTURE,Go.Z.BOLD.DATA),this.player.updateData().then(this.processAfterUpdatePlayerProfile).catch(at.tO)},n.loadPrebuiltLevels=function(){var e=this,t=kb.ONE_SUIT,n=kb.TWO_SUIT,i=kb.FOUR_SUIT;ir()(t).forEach((function(t){e.load.text(t.KEY,t.PATH)})),ir()(n).forEach((function(t){e.load.text(t.KEY,t.PATH)})),ir()(i).forEach((function(t){e.load.text(t.KEY,t.PATH)}))},n.loadDynamicLevels=function(){var e=Ib.ONE_SUIT,t=Ib.TWO_SUIT,n=Ib.FOUR_SUIT;this.load.text(e.KEY,e.PATH),this.load.text(t.KEY,t.PATH),this.load.text(n.KEY,n.PATH)},n.loadJourneyLevels=function(){var e=Pb.TEST_LEVELS;this.load.text(e.KEY,e.PATH)},n.initNewUserEasyGame=function(){-1===this.player.getCustomData("newUserEasyGameCount")&&(this.player.setMultiCustomData({newUserEasyGameCount:eS.NewUserEasyGameCount}),console.log("Init new user's easy game count"))},n.create=function(){this.audio.initSound(),this.analytics.event(Vi._.LOAD_COMPLETE),this.facebook.on("startgame",this.handleFBInstantGameStarted),this.facebook.gameStarted(),this.decompressPrebuiltLevels(),this.decompressDynamicLevels(),this.decompressJourneyLevels(),this.setupGlobalScene(),this.lazyLoadResource(),this.initNewUserEasyGame(),this.startGame()},n.updatePlayerProfileToNotificationService=function(){var e=this.player.getPlayer(),t=e.playerId,n=e.name,i=e.photo,a=e.locale,r=e.ASID,s={appId:Qb,playerId:t,name:n,photo:i,locale:a,ASID:r};console.info("\ud83d\ude80 > profileData",s),Zb(s)},n.sendNotificationForNewUser=function(){var e=this.player.getPlayerIsNew();if(console.info("\ud83d\ude80 > isNewUser",e),e){var t=this.player.getPlayerASID();console.info("\ud83d\ude80 > playerASID",t),t&&this.facebook.sendNotificationAsync({message:"Hi @["+t+"] your friends are waiting to play with you, play now!",delayTime:7200})}},n.setupGlobalScene=function(){var e=this.scene.get(fs.C.GLOBAL_SCENE);e instanceof Fb.Z&&e.setup()},n.lazyLoadResource=function(){var e=this;setTimeout((function(){e.scene.wake(),e.loadAllBackgrounds(),e.loadAllCardAtlas(),e.load.start(),e.load.once(Phaser.Loader.Events.COMPLETE,(function(){e.scene.sleep()}))}),500)},n.loadSounds=function(){var e=Phaser.Loader.Events.FILE_KEY_COMPLETE;this.load.once(e+"audio-"+Gt.BACKGROUND.KEY,this.handleLoadMusicCompleted);for(var t=Bt,n=0,i=M()(Bt);n<i.length;n++){var a=t[i[n]];""!=a&&this.load.audio(a,[Gt.EFFECTS.PATH+a+".ogg",Gt.EFFECTS.PATH+a+".mp3"])}this.load.start()},n.loadWideframesResource=function(){this.frameCapture.preload({"wide-frame-share":"./assets/wideframes/wide-frame-share.png","wide-frame-message-win":"./assets/wideframes/wide-frame-message-win.png","wide-frame-game-result":"./assets/wideframes/wide-frame-game-result.png"})},n.loadAllCardAtlas=function(){var e=this;this.theme.getCardStyleAtlasConfigs().forEach((function(t){var n=t.key,i=t.textureURL,a=t.atlasURL;e.textures.exists(n)||e.load.atlas(n,i,a)}))},n.loadAllBackgrounds=function(){var e=this;this.theme.getBackgroundConfigs().forEach((function(t){var n=t.key,i=t.url;e.textures.exists(n)||e.load.image(n,i)}))},n.decompressPrebuiltLevels=function(){var e=this,t=kb.ONE_SUIT,n=kb.TWO_SUIT,i=kb.FOUR_SUIT;ir()(t).forEach((function(t){var n=e.cache.text.get(t.KEY),i=nS(n),a=iS(i);t.DECOMPRESSED_DATA=JSON.parse(a)})),ir()(n).forEach((function(t){var n=e.cache.text.get(t.KEY),i=nS(n),a=iS(i);t.DECOMPRESSED_DATA=JSON.parse(a)})),ir()(i).forEach((function(t){var n=e.cache.text.get(t.KEY),i=nS(n),a=iS(i);t.DECOMPRESSED_DATA=JSON.parse(a)}))},n.decompressDynamicLevels=function(){var e=Ib.ONE_SUIT,t=Ib.TWO_SUIT,n=Ib.FOUR_SUIT,i=this.cache.text.get(e.KEY),a=nS(i),r=iS(a);e.DECOMPRESSED_DATA=JSON.parse(r);var s=this.cache.text.get(t.KEY),o=nS(s),c=iS(o);t.DECOMPRESSED_DATA=JSON.parse(c);var u=this.cache.text.get(n.KEY),l=nS(u),h=iS(l);n.DECOMPRESSED_DATA=JSON.parse(h)},n.decompressJourneyLevels=function(){var e=Pb.TEST_LEVELS,t=this.cache.text.get(e.KEY),n=nS(t),i=iS(n);e.DECOMPRESSED_DATA=JSON.parse(i)},t}(Phaser.Scene),rS=aS,sS=n(556),oS=["Enable"],cS=function(e){function t(t){return e.call(this,t)||this}(0,ot.Z)(t,e);var i=t.prototype;return i.boot=function(){var t=(0,st.Z)(ut().mark((function t(){return ut().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.prototype.boot.call(this),this.addExtraGameObjectMethods(),this.addExtraFBInstantFunctions(),this.addPlugins(),t.next=6,this.addDevPlugins();case 6:return t.next=8,this.initAds();case 8:this.addScenes(),this.addDevScenes(),this.initWorld(),this.initStorage(),this.initVisibilityChangeHandler(),this.initUtils(),this.initRollbar(),this.initConsole(),this.initDebugger(),this.initStatistics(),this.initParticleEditor(),this.initAdaptivePerformance(),this.initProfilerPlugin();case 21:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),i.start=function(){e.prototype.start.call(this)},i.addExtraGameObjectMethods=function(){var e=new mt(this);e.addKillRevive(),e.addKillReviveGroup(),e.addDrawDebugBox(),e.addSetWorldSize(),e.addSetWorldSizeForContainer(),e.addGetWorldPosition(),e.addHighQuality()},i.addExtraFBInstantFunctions=function(){var e=new lt.Z(this.facebook);this.facebook.shareAsync=e.shareAsync,this.facebook.inviteAsync=e.inviteAsync,this.facebook.switchAsync=e.switchAsync,this.facebook.chooseAsync=e.chooseAsync,this.facebook.createAsync=e.createAsync,this.facebook.sendMessage=e.sendMessage,this.facebook.getContextID=e.getContextID,this.facebook.getPlayerToken=e.getPlayerToken,this.facebook.matchPlayerAsync=e.matchPlayerAsync,this.facebook.getContextPlayers=e.getContextPlayers,this.facebook.setLoadingProgress=e.setLoadingProgress,this.facebook.attemptToAddShortcut=e.attemptToAddShortcut,this.facebook.attemptToSubscribeBot=e.attemptToSubscribeBot,this.facebook.postSessionScoreAsync=e.postSessionScoreAsync,this.facebook.getRewardedVideoAsync=e.getRewardedVideoAsync,this.facebook.getInterstitialAdAsync=e.getInterstitialAdAsync,this.facebook.sendNotificationAsync=e.sendNotificationAsync,e.injectTournament(),this.facebook.progressLoading=new pt(this)},i.addPlugins=function(){this.plugins.install("Storage",gr,!0,"storage"),this.plugins.install("Rollbar",Wi,!0,"rollbar"),this.plugins.install("AdsManager",xt,!0,"ads"),this.plugins.install("AuthManager",Qt,!0,"auth"),this.plugins.install("AudioManager",Ht,!0,"audio"),this.plugins.install("ThemeManager",xr,!0,"theme"),this.plugins.install("WorldManager",Br,!0,"world"),this.plugins.install("PlayerManager",Ei,!0,"player"),this.plugins.install("ProfileManager",Bi,!0,"profile"),this.plugins.install("AnalyticsManager",Dt,!0,"analytics"),this.plugins.install("AdaptivePerformance",on,!0,"performance"),this.plugins.install("VisibilityChangeHandler",Or,!0,"visibility"),this.plugins.installScenePlugin("textStyler",Tr,"textStyler"),this.plugins.installScenePlugin("ScreenManager",qi,"screen"),this.plugins.installScenePlugin("FrameCapture",tn,"frameCapture"),window.SpinePlugin&&this.plugins.installScenePlugin("SpinePlugin",SpinePlugin,"spine"),this.storage=this.plugins.get("Storage"),this.rollbar=this.plugins.get("Rollbar"),this.ads=this.plugins.get("AdsManager"),this.auth=this.plugins.get("AuthManager"),this.audio=this.plugins.get("AudioManager"),this.world=this.plugins.get("WorldManager"),this.player=this.plugins.get("PlayerManager"),this.profile=this.plugins.get("ProfileManager"),this.analytics=this.plugins.get("AnalyticsManager"),this.performance=this.plugins.get("AdaptivePerformance"),this.visibility=this.plugins.get("VisibilityChangeHandler"),this.plugins.install("KawaseBlurFilterPlugin",ds.Z)},i.addDevPlugins=function(){var e=(0,st.Z)(ut().mark((function e(){var t,i,a,r,s;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(GameCore.Utils.Valid.isDebugger()){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Promise.all([n.e(7),n.e(942)]).then(n.bind(n,508));case 4:return t=e.sent.default,e.next=7,Promise.all([n.e(498),n.e(114),n.e(530)]).then(n.bind(n,509));case 7:return i=e.sent.default,e.next=10,n.e(401).then(n.bind(n,512));case 10:return a=e.sent.default,e.next=13,Promise.all([n.e(498),n.e(803)]).then(n.bind(n,513));case 13:return r=e.sent.default,e.next=16,Promise.all([n.e(498),n.e(123)]).then(n.bind(n,515));case 16:s=e.sent.default,this.plugins.install("Console",t,!0,"console"),this.plugins.install("Debugger",i,!0,"debugger"),this.plugins.install("Statistics",a,!0,"statistics"),this.plugins.install("ParticleEditor",r,!0,"particle-editor"),this.plugins.install("Profiler",s,!0,"profiler"),this.eruda=this.plugins.get("Console"),this.debugger=this.plugins.get("Debugger"),this.statistics=this.plugins.get("Statistics"),this.particleEditor=this.plugins.get("ParticleEditor"),this.profiler=this.plugins.get("Profiler");case 27:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),i.addScenes=function(){this.scene.add(fs.C.BOOT_SCENE,bs,!0),this.scene.add(fs.C.LOAD_SCENE,rS,!1),this.scene.add(fs.C.GAME_SCENE,Mb,!1),this.scene.add(fs.C.DASHBOARD_SCENE,Es,!1),this.scene.add(fs.C.GLOBAL_SCENE,Fb.Z,!1)},i.addDevScenes=function(){var e=(0,st.Z)(ut().mark((function e(){var t;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(GameCore.Utils.Valid.isDebugger()){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,n.e(638).then(n.bind(n,516));case 4:t=e.sent.default,this.scene.add(fs.C.TEST_SCENE,t,!1);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),i.initAds=function(){var e=(0,st.Z)(ut().mark((function e(){var t,i,a;return ut().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=GameCore.Configs.Ads,sS.Z.setGame(this),i=sS.Z,!t.Mockup.Enable){e.next=8;break}return e.next=6,n.e(131).then(n.bind(n,517));case 6:a=e.sent.default,i=a;case 8:this.ads.configure(i,{enabled:t.Enabled,interstitialPID:t.InterstitialPlacementId,rewardedVideoPID:t.VideoRewardsPlacementId,interstitialAdOptions:t.InterstitialAdOptions,bannerPID:t.BannerPlacementId,bannerReloadPeriod:t.BannerReloadPeriod});case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),i.initWorld=function(){var e=GameCore.Configs.Game,t=e.AutoResize,n=e.PortraitRatio,i=e.PortraitWidth,a=e.PortraitHeight,r=e.LandscapeRatio,s=e.LandscapeWidth,o=e.LandscapeHeight,c=t,u=e.DisableLandscape,l=e.FullSizeOnLandscape,h=n,d=i,f=a,p=r,g=s,m=o;console.info("\ud83d\ude80 > portraitRatio",h),console.info("\ud83d\ude80 > landscapeRatio",p),this.world.configure({autoResize:c,portraitRatio:h,portraitWidth:d,portraitHeight:f,landscapeRatio:p,landscapeWidth:g,landscapeHeight:m,disableLandscape:u,fullSizeOnLandscape:l}),this.world.resize(e.ForcePixelRatio)},i.initStorage=function(){var e=new hs(this);this.storage.setInitiator(e)},i.initVisibilityChangeHandler=function(){this.visibility.configure()},i.initUtils=function(){this.handlePauseAudio(),this.addPipelines(),this.removeUnusedPipelines()},i.initConsole=function(){GameCore.Utils.Valid.isDebugger()&&(GameCore.Configs.Debugger.ShowConsole&&this.eruda.configure({tool:["console","info"],defaults:{theme:"Dark"}}))},i.initDebugger=function(){if(GameCore.Utils.Valid.isDebugger()){var e=GameCore.Configs.Debugger,t=e.ShowInspector,n=e.ShowMonitoring;(t||n)&&this.debugger.configure(GameCore.Configs.Debugger)}},i.initStatistics=function(){GameCore.Utils.Valid.isDebugger()&&(GameCore.Configs.Statistics.Enable&&this.statistics.configure(GameCore.Configs.Statistics))},i.initParticleEditor=function(){GameCore.Utils.Valid.isDebugger()&&(GameCore.Configs.ParticleEditor.Enable&&this.particleEditor.configure(GameCore.Configs.ParticleEditor))},i.initProfilerPlugin=function(){GameCore.Utils.Valid.isDebugger()&&(GameCore.Configs.ProfilerPlugin.Enable&&this.profiler.configure())},i.initAdaptivePerformance=function(){var e=GameCore.Configs.Performance,t=e.Enable,n=(0,rt.Z)(e,oS);if(t){var i=this.world.getPixelRatio();this.performance.configure((0,Me.Z)({pixelRatio:i},n)),this.performance.active()}},i.initRollbar=function(){var e=GameCore.Configs.Rollbar.Enable;console.warn({isRollbarEnabled:e}),e&&(this.rollbar.setup(),this.rollbar.sendException(new Error("test rollbar")))},i.handlePauseAudio=function(){var e=this;this.sound.pauseOnBlur=!1,this.visibility.addEventVisible((function(){e.audio.playMusic()})),this.visibility.addEventHidden((function(){e.audio.pauseMusic()}))},i.addPipelines=function(){var e=this.renderer;e instanceof Phaser.Renderer.WebGL.WebGLRenderer&&e.pipelines.add("Grayscale",new ps(this))},i.removeUnusedPipelines=function(){var e=this.renderer;if(e instanceof Phaser.Renderer.WebGL.WebGLRenderer){var t=e.pipelines,n=Phaser.Renderer.WebGL.Pipelines;[n.ROPE_PIPELINE,n.LIGHT_PIPELINE,n.POSTFX_PIPELINE,n.POINTLIGHT_PIPELINE,n.BITMAPMASK_PIPELINE].forEach((function(e){var n;null==(n=t.get(e))||n.destroy(),t.remove(e)}))}},t}(Phaser.Game),uS=cS,lS=GameCore.Configs.Debugger.ShowInspector,hS={parent:"app",type:Phaser.AUTO,width:0,height:0,scale:{autoRound:!0},dom:{createContainer:!1},loader:{maxParallelDownloads:6,crossOrigin:"no-cros"},audio:{noAudio:!1,disableWebAudio:!1},input:{gamepad:!1,keyboard:lS,touch:{capture:!0},smoothFactor:1,activePointers:1,windowEvents:!1},disableContextMenu:!0,render:{pixelArt:!1,antialias:!0,transparent:!1,desynchronized:!1,powerPreference:"high-performance",clearBeforeRender:!1,roundPixels:!1},plugins:{global:[]}};window.GameCore=it,(0,at.j6)();var dS=setInterval((function(){window.__analyticsInitiated&&(window.__fbGameReady=!1,clearInterval(dS),clearInterval(window.__fbInstantLoadingTimer),FBInstant.setLoadingProgress(30),gtag("event","app_initialize",{send_to:["GA"]}),function(){try{var e=new uS(hS);window.game=e}catch(t){(0,at.tO)(t)}}())}),50)},532:function(e,t,n){"use strict";n.d(t,{_:function(){return i}});var i={BUTTON_CLICK:"button_click",SCREEN_OPEN:"screen_open",LOAD_START:"load_start",LOAD_COMPLETE:"load_complete",APP_READY:"app_ready",TUTORIAL_BEGIN:"tutorial_begin",TUTORIAL_STEP:"tutorial_step",TUTORIAL_COMPLETE:"tutorial_complete",MATCH_START:"match_start",MATCH_RESCUE:"match_rescue",MATCH_END:"match_end",LEVEL_START:"level_start",LEVEL_RESCUE:"level_rescue",LEVEL_CONTINUE:"level_continue",LEVEL_END:"level_end",LEVEL_GIVE_UP:"level_give_up",SHARE:"share",MESSAGE:"message",INVITE:"invite",SHORTCUT_CREATE:"shortcut_create",SHORTCUT_CREATE_POPUP:"shortcut_create_popup",BOT_SUBSCRIBE:"bot_subscribe",BOT_SUBSCRIBE_POPUP:"bot_subscribe_popup",AD_SHOW:"ad_show",AD_SHOW_FAILED:"ad_show_failed",NEW_USER:"new_user",AD_IMPRESSION:"ad_impression",JOIN_GROUP:"join_group",THEME_CHANGED:"theme_changed",TOURNAMENT_SHARE:"tournament_share",TOURNAMENT_CREATE:"tournament_create",TOURNAMENT_POST_SCORE:"tournament_post_score",TOURNAMENT_START:"tournament_start",SWITCH_SOLO_CONTEXT:"switch_solo_context"}},528:function(e,t,n){"use strict";var i=n(529),a=function(){function e(e,t,n,a){this.playerId=void 0,this.name=void 0,this.photo=void 0,this.locale=void 0,this.playerId=e,this.name=t,this.photo=n||i.Z.AVATAR.FILE,this.locale=a||"en_US"}return e.prototype.toObject=function(){return{playerId:this.playerId,name:this.name,photo:this.photo,locale:this.locale}},e}();t.Z=a},539:function(e,t,n){"use strict";n.d(t,{I:function(){return a}});var i=n(536),a=function(e){return{type:i.DW,payload:{sceneKey:e}}}},531:function(e,t,n){"use strict";n.d(t,{qZ:function(){return o},Gm:function(){return c},VY:function(){return u},F0:function(){return l}});var i=n(16),a=n.n(i),r=n(23),s=n.n(r),o=function(e){return new(a())((function(t){return setTimeout(t,e)}))},c=function(e){var t=new Date(e),n=new Date;return t.getDate()===n.getDate()&&t.getMonth()===n.getMonth()&&t.getFullYear()===n.getFullYear()},u=function(e){return Date.now()-e<6048e5},l=function(e,t){void 0===t&&(t=!0);var n=new Date(e).toISOString();return t?s()(n).call(n,11,-5):s()(n).call(n,14,-5)}},525:function(e,t,n){"use strict";n.d(t,{j6:function(){return a},sw:function(){return r},Tv:function(){return s},R0:function(){return c},tO:function(){return u}});n(119),n(114),n(40),n(31);var i=!1,a=function(){var e=setInterval((function(){window.Sentry&&(clearInterval(e),console.warn({isSentryEnabled:i}))}),100)},r=function(e,t){window.Sentry&&window.Sentry.addBreadcrumb({category:e,message:t})},s=function(e){window.Sentry&&window.Sentry.setUser(e)},o=function(e){console.error(e)},c=function(e,t){e&&window.Sentry.withScope((function(n){n.setExtras(t),o(e)}))},u=function(e){e&&o(e)}},530:function(e,t,n){"use strict";n.d(t,{t:function(){return i}});var i=function(){return GameCore.Utils.Device.isDesktop()||GameCore.Utils.Device.pixelRatio()>1?2:1}}},t={};function n(i){var a=t[i];if(void 0!==a)return a.exports;var r=t[i]={id:i,loaded:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.loaded=!0,r.exports}n.m=e,n.amdO={},function(){var e=[];n.O=function(t,i,a,r){if(!i){var s=1/0;for(l=0;l<e.length;l++){i=e[l][0],a=e[l][1],r=e[l][2];for(var o=!0,c=0;c<i.length;c++)(!1&r||s>=r)&&Object.keys(n.O).every((function(e){return n.O[e](i[c])}))?i.splice(c--,1):(o=!1,r<s&&(s=r));if(o){e.splice(l--,1);var u=a();void 0!==u&&(t=u)}}return t}r=r||0;for(var l=e.length;l>0&&e[l-1][2]>r;l--)e[l]=e[l-1];e[l]=[i,a,r]}}(),n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.f={},n.e=function(e){return Promise.all(Object.keys(n.f).reduce((function(t,i){return n.f[i](e,t),t}),[]))},n.u=function(e){return e+".bundle.js"},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.hmd=function(e){return(e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:function(){throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e={},t="game-core:";n.l=function(i,a,r,s){if(e[i])e[i].push(a);else{var o,c;if(void 0!==r)for(var u=document.getElementsByTagName("script"),l=0;l<u.length;l++){var h=u[l];if(h.getAttribute("src")==i||h.getAttribute("data-webpack")==t+r){o=h;break}}o||(c=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,n.nc&&o.setAttribute("nonce",n.nc),o.setAttribute("data-webpack",t+r),o.src=i),e[i]=[a];var d=function(t,n){o.onerror=o.onload=null,clearTimeout(f);var a=e[i];if(delete e[i],o.parentNode&&o.parentNode.removeChild(o),a&&a.forEach((function(e){return e(n)})),t)return t(n)},f=setTimeout(d.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=d.bind(null,o.onerror),o.onload=d.bind(null,o.onload),c&&document.head.appendChild(o)}}}(),n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},function(){var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var i=t.getElementsByTagName("script");i.length&&(e=i[i.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e}(),function(){var e={757:0};n.f.j=function(t,i){var a=n.o(e,t)?e[t]:void 0;if(0!==a)if(a)i.push(a[2]);else{var r=new Promise((function(n,i){a=e[t]=[n,i]}));i.push(a[2]=r);var s=n.p+n.u(t),o=new Error;n.l(s,(function(i){if(n.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var r=i&&("load"===i.type?"missing":i.type),s=i&&i.target&&i.target.src;o.message="Loading chunk "+t+" failed.\n("+r+": "+s+")",o.name="ChunkLoadError",o.type=r,o.request=s,a[1](o)}}),"chunk-"+t,t)}},n.O.j=function(t){return 0===e[t]};var t=function(t,i){var a,r,s=i[0],o=i[1],c=i[2],u=0;if(s.some((function(t){return 0!==e[t]}))){for(a in o)n.o(o,a)&&(n.m[a]=o[a]);if(c)var l=c(n)}for(t&&t(i);u<s.length;u++)r=s[u],n.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return n.O(l)},i=self.webpackChunkgame_core=self.webpackChunkgame_core||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))}(),n.O(void 0,[216,542],(function(){return n(521)})),n.O(void 0,[216,542],(function(){return n(522)})),n.O(void 0,[216,542],(function(){return n(384)})),n.O(void 0,[216,542],(function(){return n(385)}));var i=n.O(void 0,[216,542],(function(){return n(418)}));i=n.O(i)})();